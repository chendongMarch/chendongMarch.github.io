<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Rxjava2.xå¼€å‘-n-Backpressure-todo]]></title>
    <url>%2Farticle%2F2a4b463b%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦è®°å½•æ€»ç»“èƒŒåŽ‹çš„ç›¸å…³çŸ¥è¯†ã€‚ å½“ä¸Šæ¸¸å‘é€çš„äº‹ä»¶çš„é€Ÿåº¦å¾ˆå¿«ï¼Œä¸‹æ¸¸å¤„ç†äº‹ä»¶çš„é€Ÿåº¦å¾ˆæ…¢ï¼Œå°±ä¼šå‡ºçŽ°èƒŒåŽ‹ï¼Œè¿™å¾ˆå¥½ç†è§£ï¼Œå°±å¥½æ¯”ä¸€æ¡æ°´ç®¡ï¼Œä¸Šæ¸¸æ°´æµé‡å¤ªå¤§ï¼Œä¸‹æ¸¸æ°´æµé‡å¤ªå°ï¼Œä¸Šæ¸¸é€è¿‡æ¥çš„æ°´ä¸‹æ¸¸ä¸èƒ½åŠæ—¶è¾“å‡ºï¼Œå°±ä¼šäº§ç”ŸåŽ‹åŠ›ï¼Œè¿™å°±æ˜¯èƒŒåŽ‹ã€‚ èƒŒåŽ‹æ˜¯æŒ‡åœ¨å¼‚æ­¥åœºæ™¯ä¸­ï¼Œè¢«è§‚å¯Ÿè€…å‘é€äº‹ä»¶é€Ÿåº¦è¿œå¿«äºŽè§‚å¯Ÿè€…çš„å¤„ç†é€Ÿåº¦çš„æƒ…å†µä¸‹ï¼Œä¸€ç§å‘Šè¯‰ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè€…é™ä½Žå‘é€é€Ÿåº¦çš„ç­–ç•¥ æœ¬æ¥æƒ³å†™ä¸€æ®µç¨‹åºè§¦å‘ä¸€ä¸‹ MissingBackpressureException ï¼Œç»“æžœæ²¡æˆåŠŸã€‚ åœ¨ RxJava2.x ä¸­ Observable æ˜¯é»˜è®¤ä¸æ”¯æŒèƒŒåŽ‹çš„ï¼Œè€Œ Flowable æ˜¯æ”¯æŒèƒŒåŽ‹çš„ã€‚]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Library</tag>
        <tag>RxJava2.x</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-12-ç©ºå€¼å®‰å…¨]]></title>
    <url>%2Farticle%2Fc5b3d729%2F</url>
    <content type="text"><![CDATA[åœ¨è¿›è¡Œå±žæ€§çš„åˆå§‹åŒ–æ—¶èƒ½å¤Ÿæ„Ÿå—åˆ° Kotlin åœ¨ç¼–è¯‘æ—¶å¯¹ null å€¼çš„æŽ§åˆ¶ï¼Œæ­£æ˜¯å› ä¸º Kotlin çš„è¿™äº›ç‰¹æ€§ï¼Œä½¿å¾— Kotlin æˆä¸ºä¸€ç§ ç©ºå®‰å…¨(Null Safaty) çš„è¯­è¨€ï¼Œéµå¾ª Kotlin çš„è§„èŒƒå°†æœ‰æ•ˆçš„é¿å…ç¨‹åºä¸­çš„ NPEã€‚ å…¶å®žéµå¾ª Kotlin çš„å˜é‡çš„å£°æ˜Žå’Œåˆå§‹åŒ–æ–¹å¼åŸºæœ¬å¯ä»¥é¿å… NPE çš„å‡ºçŽ°ï¼ŒKotlin ä¸å…è®¸ç»™ä¸€ä¸ª å˜é‡ null å€¼ï¼Œä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨ Type? çš„å½¢å¼(ä¾‹å¦‚ String? )å£°æ˜Žè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ä¸º null çš„å˜é‡ï¼Œä»–å°±å¯ä»¥è¢«åˆå§‹åŒ–ä¸º nullã€‚ å®‰å…¨è°ƒç”¨ (?.)å®‰å…¨è°ƒç”¨å³ safe callsï¼Œä½¿ç”¨?.æ“ä½œç¬¦ã€‚ å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå˜é‡çš„å±žæ€§æˆ–è€…æ–¹æ³•æ—¶ï¼Œä¸ºäº†é¿å… NPE æˆ‘ä»¬é€šå¸¸è¦åœ¨å‰æœŸåšä¸¥å¯†çš„ç©ºå€¼åˆ¤æ–­ç¡®ä¿è°ƒç”¨çš„å¯¹è±¡ä¸ä¸ºç©ºæ—¶æ‰èƒ½æ”¾å¿ƒè°ƒç”¨ï¼Œsafe calls çš„æœºåˆ¶å¤§å¤§ç®€åŒ–äº†è¿™ä¸ªè¿‡ç¨‹ã€‚ safe calls åªæœ‰å½“å¼•ç”¨ä¸ä¸º null æ—¶æ‰è¿›è¡Œè°ƒç”¨ï¼Œå¦åˆ™ç›´æŽ¥è¿”å›ž nullï¼Œå¦‚ä¸‹æƒ…å†µä¸­ b çš„ç±»åž‹ä¸º Int?ï¼Œå› ä¸º a å¯èƒ½ä¸º nullï¼Œè°ƒç”¨ a çš„ length å±žæ€§ï¼Œå¦‚æžœ a ä¸ä¸º nullï¼Œåˆ™è¿”å›ž Int ç±»åž‹çš„é•¿åº¦ï¼Œåä¹‹è¿”å›ž nullï¼Œå› æ­¤ b ä¸º Int?ï¼Œå³å¯èƒ½ä¸º null çš„ Int ç±»åž‹ã€‚ 12val a: String? = nullval b = a?.length ä¸€ä¸ªä½¿ç”¨ safe calls ç®€åŒ–è°ƒç”¨çš„å®žä¾‹ 123456789val myParam1:Student? = null// java ä¸­ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåšä¸€ç³»åˆ—åˆ¤ç©ºæ“ä½œif(myParam1!=null &amp;&amp; myParam1.myCls!=null)&#123; Log.e(TAG,"$&#123;myParam1.myCls.length&#125;")&#125;// Kotlin safe callsLog.e(TAG,"$&#123;myParam1?.myCls?.length&#125;") æœ‰æ—¶æˆ‘ä»¬åœ¨åˆ¤ç©ºä¹‹åŽä¼šæ‰§è¡Œä¸€ç³»åˆ—çš„æ“ä½œï¼Œæ­¤æ—¶å°±å¯ä»¥ç»“åˆ let å…³é”®å­—ï¼Œä½¿ç”¨ ?.let{} æ¥ç¡®ä¿å˜é‡ä¸ä¸ºç©ºæ—¶æ‰§è¡Œæ–¹æ³•ï¼ŒåŒæ—¶åœ¨ let æ–¹æ³•ä½“å†…ï¼Œå¯ä»¥ä½¿ç”¨ it å…³é”®å­—è®¿é—®å˜é‡ã€‚ 1234val a: String? = nullval b = a?.length// bä¸ä¸ºnullæ—¶è¿›è¡Œæ‰“å°b?.let &#123; log("$it") &#125; Elvis æ“ä½œç¬¦ (?:)Elvis æ“ä½œç¬¦ å³ ?: æ“ä½œç¬¦ã€‚å½“ä½¿ç”¨ ?. æ“ä½œç¬¦è¿›è¡Œå®‰å…¨è°ƒç”¨æ—¶ï¼Œå¦‚æžœé‡åˆ° null åˆ™ä¼šç›´æŽ¥è¿”å›ž nullï¼Œé‚£å¦‚æžœå½“ä¸º null æ—¶è¿”å›žå…¶ä»–å€¼æ—¶å¦‚ä½•æ“ä½œå‘¢ï¼ŸElvis æ“ä½œç¬¦ å°±æ˜¯ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ å¦‚æžœ ?: å·¦ä¾§çš„è¡¨è¾¾å¼å€¼ä¸æ˜¯ null, Elvis æ“ä½œç¬¦ å°±ä¼šè¿”å›žå®ƒçš„å€¼, å¦åˆ™, è¿”å›žå³ä¾§è¡¨è¾¾å¼çš„å€¼. æ³¨æ„, åªæœ‰åœ¨å·¦ä¾§è¡¨è¾¾å¼å€¼ä¸º null æ—¶, æ‰ä¼šè®¡ç®—å³ä¾§è¡¨è¾¾å¼ã€‚ 1234// åŽŸå§‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ if...elseval l: Int = if (b != null) b.length else -1// ä½¿ç”¨ ?: æ“ä½œç¬¦val l = b?.length ?: -1 ç”±äºŽåœ¨ Kotlin ä¸­ throw å’Œ return éƒ½æ˜¯è¡¨è¾¾å¼, å› æ­¤å®ƒä»¬ä¹Ÿå¯ä»¥ç”¨åœ¨ Elvis æ“ä½œç¬¦ sçš„å³ä¾§. è¿™ç§ç”¨æ³•å¯ä»¥å¸¦æ¥å¾ˆå¤§çš„æ–¹ä¾¿, æ¯”å¦‚, å¯ä»¥ç”¨æ¥æ£€æŸ¥å‡½æ•°å‚æ•°å€¼æ˜¯å¦åˆæ³•: 12345fun foo(node: Node): String? &#123; val parent = node.getParent() ?: return null val name = node.getName() ?: throw IllegalArgumentException("name expected") // ...&#125; !! æ“ä½œç¬¦å¦‚æžœä½ ç¡®å®žæ¸…æ¥šæ­¤æ—¶å¯ä»¥æŠ›å‡ºä¸€ä¸ª NPEï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ !! æ“ä½œç¬¦ã€‚ å¯¹äºŽ b ä¸ä¸º null çš„æƒ…å†µ, è¿™ä¸ªè¡¨è¾¾å¼å°†ä¼šè¿”å›žè¿™ä¸ªéž null çš„å€¼, å¦‚æžœ b æ˜¯ null, è¿™ä¸ªè¡¨è¾¾å¼å°±ä¼šæŠ›å‡ºä¸€ä¸ª NPEã€‚ 1val l = b!!.length as? æ“ä½œç¬¦å¦‚æžœå¯¹è±¡ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ç›®æ ‡ç±»åž‹, é‚£ä¹ˆé€šå¸¸çš„ç±»åž‹è½¬æ¢å°±ä¼šå¯¼è‡´ ClassCastException ã€‚ ä½¿ç”¨ as? è¿›è¡Œå®‰å…¨çš„ç±»åž‹è½¬æ¢, å¦‚æžœè½¬æ¢ä¸æˆåŠŸ, å®ƒå°†ä¼šè¿”å›ž nullã€‚ 1val aInt: Int? = a as? Int]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-11-å‡½æ•°]]></title>
    <url>%2Farticle%2Facb7c552%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡å­¦ä¹  Kotlin å‡½æ•°çš„ç›¸å…³ç”¨æ³•ã€‚ä¸»è¦åŒ…æ‹¬ ï¼š å‡½æ•°çš„å£°æ˜Žå’Œä½¿ç”¨ï¼Œå‡½æ•°çš„å‚æ•°å’Œè¿”å›žå€¼ï¼Œå•è¡¨è¾¾å¼å‡½æ•°çš„ä½¿ç”¨ï¼Œä½¿ç”¨ä¸å®šé•¿å‚æ•°ã€‚ å±€éƒ¨å‡½æ•°ï¼Œå°¾é€’å½’å‡½æ•°ï¼Œé«˜é˜¶å‡½æ•°ï¼Œå†…è”å‡½æ•°ç­‰ã€‚ Lambda è¡¨è¾¾å¼ï¼ŒåŒ¿åå‡½æ•°å’Œé—­åŒ…ã€‚ å…¶ä»–å¦‚ï¼Œreifeid å…³é”®å­—ï¼Œéžå±€éƒ¨è¿”å›žåŠå¸¦æœ‰æŽ¥å—è€…çš„å‡½æ•°å­—é¢å€¼ã€‚ å£°æ˜Žå’Œä½¿ç”¨å‡½æ•°å£°æ˜Žçš„ä¸€èˆ¬å½¢å¼ä¸º 123fun functionName(param1:Type,param2:Type...)[:ReturnType]&#123;&#125; å¦‚æžœæ˜¯ top-level çº§åˆ«çš„å‡½æ•°å¯ä»¥ç›´æŽ¥ä½¿ç”¨å‡½æ•°åè°ƒç”¨ï¼Œå¦‚æžœæ˜¯ä¸€ä¸ªç±»å‡½æ•°ï¼Œéœ€è¦æ‹¿åˆ°ç±»å®žä¾‹ï¼Œä½¿ç”¨ç‚¹å·æ ‡è®°æ³•è°ƒç”¨ã€‚ 1234567fun simpleFunction(param:String):Int&#123; return param.length&#125;// è°ƒç”¨simpleFunction("100")Engineer().test() Kotlin æ”¯æŒä¸­ç¼€æ ‡è®°æ³•è°ƒç”¨å‡½æ•°ï¼Œå¦‚æžœéœ€è¦æ”¯æŒä¸­ç¼€æ ‡è®°æ³•è°ƒç”¨ï¼Œéœ€è¦æ»¡è¶³æ¡ä»¶ï¼š æ˜¯ä¸€ä¸ªç±»å‡½æ•°æˆ–æ‰©å±•å‡½æ•°ï¼Œä½¿ç”¨ infix å…³é”®å­—å£°æ˜Žï¼Œåªæœ‰ä¸€ä¸ªå‚æ•° 12345678910infix fun Int.cross(another: Int): Int &#123; return this * another&#125;class Engineer(var name: String = "", var age: Int = 0)&#123; // together å‡½æ•° infix fun together(e: Engineer): Int &#123; return this.age + e.age &#125;&#125; å®ƒä½¿å¾—å‡½æ•°å¯ä»¥åƒè¿ç®—ç¬¦é‚£æ ·ä½¿ç”¨ 123456789val x = 100val result = x cross 10// ç›¸å½“äºŽval result2 = x.cross(10)val e = Engineer()var newEngineer = e together Engineer(name = "new")// ç›¸å½“äºŽvar newEngineer2 = e.together(Engineer(name = "new")) å‚æ•°å’Œè¿”å›žå€¼åœ¨ Kotlin ä¸­ï¼Œå‚æ•°ä½¿ç”¨ param:Type çš„å½¢å¼å£°æ˜Žï¼Œæ¯ä¸ªå‚æ•°å¿…é¡»å£°æ˜Žæ•°æ®ç±»åž‹ï¼›è¿”å›žå€¼åœ¨å‡½æ•°çš„æœ€åŽï¼Œå‡½æ•°ä½“ä¹‹å‰ï¼Œä½¿ç”¨ :returnType çš„å½¢å¼å£°æ˜Žï¼Œå¦‚æžœæ²¡æœ‰è¿”å›žå€¼ï¼Œå¯ä»¥ä½¿ç”¨ :Unit æˆ–è€…ä¸å†™è¿”å›žå€¼çš„å½¢å¼æ¥è¡¨ç¤ºã€‚ å‚æ•°æ”¯æŒ é»˜è®¤å€¼ å’Œ å‚æ•°åæŒ‡å®šå‚æ•° è°ƒç”¨ï¼Œç®€åŒ–å‡½æ•°çš„é‡è½½ã€‚ä¸»è¦ä½“çŽ°åœ¨ï¼š å…·æœ‰é»˜è®¤å€¼çš„å‚æ•°æˆ‘ä»¬åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­å¯ä»¥ä¸ä¼ è¯¥å‚æ•°ï¼Œå°†ä¼šä½¿ç”¨å‚æ•°çš„é»˜è®¤å€¼ï¼Œå¦å¤–æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚æ•°åæŒ‡å®šæŸäº›å‚æ•°ï¼Œä¹Ÿå°±æ˜¯åªä¼ éƒ¨åˆ†å‚æ•°ï¼Œå½“ç„¶æ²¡æœ‰é»˜è®¤å€¼çš„å‚æ•°æ˜¯å¿…é¡»ä¼ çš„ã€‚ ä½¿ç”¨å‡½æ•°çš„é»˜è®¤å€¼è¿›è¡Œå‡½æ•°é‡è½½æ—¶ï¼Œéœ€è¦æ³¨æ„å‚æ•°æ˜¯ä»Žç¬¬ä¸€ä¸ªå‚æ•°å¼€å§‹å¾€åŽé¢åŒ¹é…çš„ï¼Œå› æ­¤æ— é»˜è®¤çš„å‚æ•°è¦å¾€å‰é¢æ”¾ï¼Œå¦‚ä¸‹å‡½æ•° 123456789fun testDefParam(p1: String = "", p2: Int = 10, p3: Int = 1, p4: String) &#123;&#125;// æˆ‘ä»¬å¦‚æ­¤è°ƒç”¨æ˜¯ä¸å¯ä»¥çš„testDefParam("", "") // error// æˆ‘ä»¬éœ€è¦å°†æ— é»˜è®¤å€¼çš„å‚æ•°æåˆ°å‰é¢ï¼Œæ‰èƒ½è‡ªåŠ¨åŒ¹é…ä¸Šfun testDefParam(p4: String, p1: String = "", p2: Int = 10, p3: Int = 1) &#123;&#125; ä½¿ç”¨é»˜è®¤å€¼è°ƒç”¨æ—¶ï¼Œå½“å‚æ•°è¿‡å¤šæ—¶ï¼Œé»˜è®¤åŒ¹é…çš„æ–¹å¼ä¹Ÿå¤šï¼Œè€Œä¸”æˆ‘ä»¬å¿…é¡»å°†æ²¡æœ‰é»˜è®¤å€¼çš„å‚æ•°æå‰ï¼Œä¼šå¯¼è‡´ä»£ç é˜…è¯»æ€§å˜å·®ï¼Œä¸å®¹æ˜“ç»´æŠ¤ï¼Œå› æ­¤ç›¸å¯¹æ›´æŽ¨èä½¿ç”¨å‚æ•°åæŒ‡å®šå‚æ•°çš„æ–¹å¼ï¼Œä»£ç ä¼šæ›´æ¸…æ™°ï¼Œå‚æ•°åˆ—è¡¨ä¹Ÿæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œä½†æ˜¯å¦‚æžœæ²¡æœ‰é»˜è®¤å€¼çš„å‚æ•°æ˜¯å¿…é¡»ä¼ å€¼çš„ã€‚ 12345fun testNamedParam(p1: String = "", p2: Int = 10, p3: Int = 1,p4: String) &#123;&#125;// p4 å‚æ•°æ˜¯å¿…é¡»ä¼ çš„testNamedParam(p2 = 11,p4 = "test") ç±»å‡½æ•°åœ¨ç»§æ‰¿æ—¶ï¼Œå­ç±»ä¸å¯ä»¥å£°æ˜Žé»˜è®¤å€¼ï¼Œä¸è®ºçˆ¶ç±»ä¸­åŒå‡½æ•°å‚æ•°æœ‰æ²¡æœ‰é»˜è®¤å€¼éƒ½ä¸å¯ä»¥ã€‚ 1234567891011open class ATest &#123; open fun test(p1: Int, p2: String = "") &#123; &#125;&#125;class BTest : ATest() &#123; // p1 p2 å‚æ•°éƒ½ä¸èƒ½å†å£°æ˜Žé»˜è®¤å€¼ override fun test(p1: Int, p2: String) &#123; super.test(p1, p2) &#125;&#125; è™½ç„¶åœ¨å­ç±»ä¸­æˆ‘ä»¬ä¸èƒ½å£°æ˜Žå‚æ•°é»˜è®¤å€¼ï¼Œä½†æ˜¯çˆ¶ç±»ä¸­çš„å‚æ•°é»˜è®¤å€¼åœ¨å­ç±»ä¸­åŒæ ·ç”Ÿæ•ˆï¼Œå¦‚ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹è°ƒç”¨ï¼š 12ATest().test(1)BTest().test(1) å‡½æ•°çš„å‚æ•°ä¸­çš„åŸºæœ¬æ•°æ®ç±»åž‹éƒ½æ˜¯ val ç±»åž‹çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯åœ¨å‡½æ•°ä½“å†…æ— æ³•æ”¹å˜å…¶å€¼ 1234fun testFuncParamVal(index:Int,user:User)&#123; index = 100 // error. val can not be reassigned user.name = "" // error. val can not be reassigned&#125; å•è¡¨è¾¾å¼å‡½æ•°(Single-Expression)å•è¡¨è¾¾å¼å‡½æ•° (Single-Expression function) å¦‚æžœå‡½æ•°å¯ä»¥ç›´æŽ¥ä½¿ç”¨ä¸€æ¡ç®€å•çš„è¡¨è¾¾å¼è¡¨ç¤ºï¼Œå¯ä»¥çœç•¥å‡½æ•°ä½“ï¼Œç›´æŽ¥åœ¨ = ä¹‹åŽå£°æ˜Žï¼Œå¦‚æžœå‡½æ•°çš„è¿”å›žç±»åž‹å¯ä»¥é€šè¿‡ç±»åž‹æŽ¨æ–­å¾—åˆ°ï¼Œé‚£ä¹ˆè¿”å›žç±»åž‹ä¹Ÿå¯ä»¥çœç•¥ã€‚ 123fun singleExpressionFunc(): Int = 12 * 10// çœç•¥è¿”å›žç±»åž‹fun singleExpressionFunc() = 12 * 10 ä¸å®šé•¿å‚æ•°(varargs)ç±»ä¼¼ java ä¸­çš„ ... ï¼Œkotlin ä½¿ç”¨ varargs æ¥è¡¨ç¤ºä¸å®šé•¿å‚æ•°ï¼Œvarargs å£°æ˜Žçš„å‚æ•°çš„ç±»åž‹å®žé™…ä¸Šæ˜¯ä¸€ä¸ª Array&lt;out T&gt; ç±»åž‹çš„å€¼ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä¸‹æ ‡è®¿é—®æ¯ä¸€ä¸ªå‚æ•° 12345678910fun asList(vararg args: String): List&lt;String&gt; &#123; val list = ArrayList&lt;String&gt;() for (arg in args) &#123; list.add(arg) &#125; return list&#125;// ç®€å•è°ƒç”¨ asList("1","@","3") é€šå¸¸æƒ…å†µä¸‹ varargs ç±»åž‹çš„å‚æ•°åº”è¯¥æ˜¯æœ€åŽä¸€ä¸ªå‚æ•°ï¼Œå› ä¸ºç”±äºŽ varargs ç±»åž‹çš„å‚æ•°æŽ¥å—çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŽé¢çš„å‚æ•°å°†æ— æ³•è¯†åˆ«ï¼Œä¸è¿‡å¥½åœ¨ kotlin æœ‰ä½¿ç”¨å‚æ•°åæŒ‡å®šå‚æ•°çš„ä¼ å‚æ–¹æ³•ã€‚ 12345678fun asList(vararg args: String,count:Int): List&lt;String&gt; &#123; val list = ArrayList&lt;String&gt;() list += args return list&#125;// testasList("1","@","3",count = 1) å½“æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå¸Œæœ›å°†è¿™ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ç›´æŽ¥ä¼ é€’ç»™å‡½æ•°ï¼Œæ­¤æ—¶æ˜¯æ— æ³•ä¼ å‚çš„ï¼Œå› ä¸ºå®ƒä¼šå°†æ•´ä¸ª Array ä½œä¸ºä¸€é¡¹ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¼šæç¤ºç±»åž‹ä¸å¯¹ï¼Œè¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ å±•å¼€æ“ä½œç¬¦(*)ï¼Œå°†æ•°ç»„å±•å¼€ 1234567val strings = arrayOf("1", "2", "3")// error. Required:String,Found:Array&lt;String&gt;asList(strings,count = 1) // æ­£ç¡®å§¿åŠ¿val strings = arrayOf("1", "2", "3")asList(*strings,count = 1) å‡ ç§å‡½æ•°ç±»åž‹é¡¶çº§å‡½æ•°ï¼šå‡½æ•°å¯ä»¥å£°æ˜Žä¸º top-level çº§åˆ«ï¼Œæˆ‘ä»¬ä¸éœ€è¦å•ç‹¬å®šä¹‰ä¸€ä¸ªç±»æ¥å®¹çº³è¿™ä¸ªå‡½æ•°ï¼Œé¡¶çº§å‡½æ•°å¯ä»¥è®¿é—®å…¬å¼€çš„ç±»å’Œå±žæ€§ã€‚ å±€éƒ¨å‡½æ•°ï¼šæŒ‡çš„æ˜¯å£°æ˜Žåœ¨å‡½æ•°å†…éƒ¨çš„å‡½æ•°ï¼Œå±€éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚ 12345678910111213141516// MainActivity ä¸­çš„å˜é‡val valueInMainActivity = 100// å¤–éƒ¨å‡½æ•°fun localFunctionOutter()&#123; // å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ val valueInLocalFunctionOuter = 10 // å±€éƒ¨å‡½æ•° fun localFunctionInner()&#123; // å±€éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ val valueInLocalFunctionInner = 1 // å±€éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ log("$valueInMainActivity $valueInLocalFunctionOuter $valueInLocalFunctionInner") &#125; // è°ƒç”¨å±€éƒ¨å‡½æ•° localFunctionInner()&#125; æˆå‘˜å‡½æ•°ï¼šå£°æ˜Žåœ¨ç±»å’Œå¯¹è±¡ä¸­çš„å‡½æ•°ï¼Œå®ƒä½œä¸ºç±»çš„æˆå‘˜å¯ä»¥è®¿é—®å…¶ä»–æˆå‘˜ã€‚ èŒƒåž‹å‡½æ•°ï¼šå‡½æ•°ä¸­å¯ä»¥å¸¦æœ‰èŒƒåž‹ï¼Œå…³äºŽèŒƒåž‹çš„ç›¸å…³é—®é¢˜åœ¨ kotlin-èŒƒåž‹ ä¼šæœ‰æ›´ç»†è‡´çš„æè¿°ã€‚ 123fun &lt;T&gt; test2(t:T) where T : Box&lt;T&gt;, T : Cloneable&#123;&#125; æ‰©å±•å‡½æ•°ï¼šå¯¹å·²æœ‰ç±»è¿›è¡Œæ‰©å±•ï¼Œå…³äºŽæ‰©å±•å‡½æ•°çš„ç›¸å…³é—®é¢˜åœ¨ kotlin-æ‰©å±• ä¼šæœ‰æ›´ç»†è‡´çš„æè¿°ã€‚ 12345fun &lt;E&gt; MutableList&lt;E&gt;.swap(index1: Int, index2: Int) &#123; val temp = this[index1] this[index1] = this[index2] this[index2] = temp&#125; å°¾é€’å½’å‡½æ•°(tailrec)æˆ‘ä»¬åœ¨ Java ä¸­ä½¿ç”¨é€’å½’å‡½æ•°æ—¶ï¼Œå¦‚æžœé€’å½’çš„æ¬¡æ•°å¤ªå¤šï¼Œå…·ä½“èƒ½å¤Ÿæ‰¿è½½çš„é€’å½’æ¬¡æ•°ä¸Žå‡½æ•°çš„å¤æ‚ç¨‹åº¦æœ‰å…³ï¼Œä¼šå¯¼è‡´å †æ ˆæº¢å‡ºï¼Œkotlin å¯¹é€’å½’å‡½æ•°åšäº†ä¼˜åŒ–ï¼Œä½¿ç”¨ tailrec å…³é”®å­—å£°æ˜Žå°¾é€’å½’å‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³è¦æ±‚çš„å½¢å¼ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œä¼šæ¶ˆé™¤å‡½æ•°çš„é€’å½’è°ƒç”¨ï¼Œäº§ç”Ÿä¸€æ®µåŸºäºŽå¾ªçŽ¯çš„ä»£ç ï¼Œé¿å…åµŒå¥—è¿‡æ·±å¯¼è‡´å †æ ˆæº¢å‡ºã€‚ è¦ç¬¦åˆ tailrec ä¿®é¥°ç¬¦çš„è¦æ±‚ï¼Œå‡½æ•°å¿…é¡»åœ¨å®ƒæ‰§è¡Œçš„æ‰€æœ‰æ“ä½œçš„æœ€åŽä¸€æ­¥ï¼Œé€’å½’è°ƒç”¨å®ƒè‡ªèº«ã€‚å¦‚æžœåœ¨è¿™ä¸ªé€’å½’è°ƒç”¨ä¹‹åŽè¿˜å­˜åœ¨å…¶ä»–ä»£ç ï¼Œé‚£ä¹ˆä½ ä¸èƒ½ä½¿ç”¨å°¾é€’å½’ï¼Œè€Œä¸”ä½ ä¸èƒ½å°†å°¾é€’å½’ç”¨åœ¨ try/catch/finally ç»“æž„å†…ã€‚ å°¾é€’å½’å‡½æ•°å’Œæˆ‘ä»¬å¹³å¸¸çš„é€’å½’å‡½æ•°æ²¡æœ‰å¾ˆå¤§å·®åˆ«ï¼Œä½¿ç”¨ tailrec å…³é”®å­—å£°æ˜Žï¼Œå‚ç…§å®˜ç½‘ä¸Šé¢çš„ä¾‹å­ã€‚ 12tailrec fun findFixPoint(x: Double = 1.0): Double = if (Math.cos(x) == x) x else findFixPoint(Math.cos(x)) åœ¨ç¼–è¯‘æ—¶ï¼Œä»–å°†ä¼šç”Ÿæˆç±»ä¼¼å¦‚ä¸‹çš„ç»“æž„ 12345678private fun findFixPoint(): Double &#123; var x = 1.0 while (true) &#123; val y = Math.cos(x) if (x == y) return y x = y &#125;&#125; é«˜é˜¶å‡½æ•°åœ¨ kotlin ä¸­å‡½æ•°å’Œå±žæ€§ä¸€æ ·å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°æˆ–è¿”å›žå€¼ï¼Œè¿™ç±»å‡½æ•°è¢«ç§°ä¸ºé«˜é˜¶å‡½æ•°ï¼Œå®ƒä½¿å¾—å‡½æ•°å¯ä»¥å¦‚åŒå¯¹è±¡ä¸€æ ·è¿›è¡Œä¼ é€’ã€‚ å¦‚åŒå­—ç¬¦ä¸²ç±»åž‹æ˜¯ Stringï¼Œæ•´åž‹çš„ç±»åž‹æ˜¯ Intï¼Œå‡½æ•°å…·æœ‰è‡ªå·±çš„ç±»åž‹ï¼Œå‡½æ•°çš„ç±»åž‹ä½¿ç”¨ (p1:Type1,p2:Type2...) -&gt; returnTypeï¼Œå…¶ä¸­å‚æ•°çš„åç§° p1,p2 æ˜¯å¯ä»¥çœç•¥çš„ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å³ä½¿å‡½æ•°è¿”å›žå€¼æ˜¯ Unit ä¹Ÿæ— æ³•çœç•¥ï¼Œå› ä¸ºç¼–è¯‘å™¨å°†æ— æ³•è¯†åˆ« (Type) æ˜¯ä¸€ä¸ªä»€ä¹ˆç±»åž‹ã€‚ 1234567891011121314151617181920// å£°æ˜Žå‡½æ•°çš„ç±»åž‹val fun1: (String, Int) -&gt; Int = &#123; p1, p2 -&gt; p1.length + p2&#125;// å¸¦æœ‰å‚æ•°åval fun2: (p1: Int) -&gt; Int = &#123; p1 -&gt; p1&#125;// è¿”å›žå€¼ä¸º Unitval fun3: (String) -&gt; Unit = &#123;&#125;// error. ä¸èƒ½çœç•¥ Unitval fun4: (String) = &#123; &#125; å‡½æ•°ä½œä¸ºè¿”å›žå€¼å‡½æ•°å¯ä»¥ä½œä¸ºè¿”å›žå€¼ï¼Œä½œä¸ºè¿”å›žå€¼æ—¶ï¼Œéœ€è¦ä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„æ–¹å¼ä¹¦å†™ã€‚ 123456789101112// å‡½æ•°ä½œä¸ºè¿”å›žå€¼fun testReturnFunction(): (String, Int) -&gt; Int &#123; // è¿”å›žä¸€ä¸ª å‚æ•°ä¸º (String,Int) è¿”å›žå€¼ä¸º Int çš„å‡½æ•° return &#123; p1: String, p2: Int -&gt; p1.length + p2 &#125;&#125;// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å‡½æ•°èŽ·å–å†…éƒ¨è¿”å›žçš„å‡½æ•°val returnFunction = testReturnFunction()var value = returnFunction("2", 1) å‡½æ•°ä½œä¸ºå‚æ•°å‡½æ•°å¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œå£°æ˜Žå‡½æ•°æ—¶å¯ä»¥åƒæ™®é€šå¯¹è±¡é‚£æ ·å¯¹å¾…å‡½æ•°ç±»åž‹çš„å‚æ•° 1234// å‡½æ•°ä½œä¸ºå‚æ•°fun testParamFunction(inFun: (String, Int) -&gt; Int): Int &#123; return inFun("1", 1)&#125; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª Lambda è¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå½“å‡½æ•° A çš„æœ€åŽä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯å‡½æ•°æ—¶ï¼Œå¯ä»¥åœ¨å‡½æ•° A åŽé¢ç›´æŽ¥ç”¨ {} å£°æ˜Žå‡½æ•°ä½“ã€‚ 12345678// æ™®é€šç”¨æ³•testParamFunction(inFun = &#123; s, i -&gt; s.length + i&#125;)// ç®€å•ç”¨æ³•testParamFunction &#123; s, i -&gt; s.length + i &#125; å¦‚æžœè¯¥å‡½æ•°è¿˜æœ‰å…¶ä»–å‚æ•°ï¼Œé‚£å°±å¿…é¡»ä½¿ç”¨ () æ¥æ”¾ç½®è¿™äº›å‚æ•°ï¼Œå¦‚ä¸‹ï¼š 123456789101112// å‡½æ•°ä½œä¸ºå‚æ•°fun testParamFunction(count:Int,inFun: (String, Int) -&gt; Int): Int &#123; return inFun("1", 1)&#125;// æ™®é€šç”¨æ³•testParamFunction(1,inFun = &#123; s, i -&gt; s.length + i&#125;)// ç®€å•ç”¨æ³•testParamFunction(1) &#123; s, i -&gt; s.length + i &#125; èžä¼šè´¯é€šï¼Œè®©å‡½æ•°å¦‚åŒå¯¹è±¡ä¸€æ ·è‡ªç”±çš„ä¼ é€’ï¼Œæˆ‘ä»¬ä»¥ä¸Šé¢çš„ä¸¤ç§å‡½æ•°ä¸ºä¾‹ 12345678910111213141516171819202122232425// å£°æ˜Žä¸€ä¸ªå‡½æ•°val fun1: (String, Int) -&gt; Int = &#123; p1, p2 -&gt; p1.length + p2&#125;testParamFunction(1, inFun = fun1)// ä»Žå¦ä¸€ä¸ªå‡½æ•°ä¸­è¿”å›žä¸€ä¸ªå‡½æ•°val fun5: (String, Int) -&gt; Int = testReturnFunction()testParamFunction(1, inFun = fun5)// ä½¿ç”¨ lambda è¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªå‡½æ•°testParamFunction(1, inFun = &#123; p1, p2 -&gt; p1.length + p2 &#125;)// ä½¿ç”¨å£°æ˜Žå¥½çš„å‡½æ•° kt 1.2-M1 fun fun6(p1:String,p2:Int):Int&#123; return p1.length + p2&#125;testParamFunction(1, inFun = ::fun6) Lambda è¡¨è¾¾å¼åœ¨ Kotlin ä¸­ä½¿ç”¨ Lambda è¡¨è¾¾å¼ï¼ŒLambda è¡¨è¾¾å¼ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ã€‚ 1234&#123; param1,param2 -&gt; ...å‡½æ•°ä½“...&#125; å½“æŸä¸ªå‚æ•°æˆ‘ä»¬ä¸ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ _ ä»£æ›¿ï¼Œå¦‚å‡½æ•° 1234567891011121314fun testLambda(inFun: (String, Int) -&gt; Int): Int &#123; return inFun("1", 1)&#125;testLambda&#123; p1,p2 -&gt; p1.length + p2&#125;// ä¸ä½¿ç”¨ p2 å‚æ•°testLambda&#123; p1, _ -&gt; p1.length&#125; å½“åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå¦‚æžœæ²¡æœ‰ç”¨åˆ°è¿™ä¸ªå‚æ•°å¯ä»¥ç›´æŽ¥ä¸ç”¨å£°æ˜Žï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å•ä¸€å‚æ•°çš„éšå«åç§° it ä»£æ›¿ã€‚ 12345678910111213fun testLambda(inFun: (String) -&gt; Int): Int &#123; return inFun("1")&#125;// å½“ä¸ä½¿ç”¨å‚æ•°æ—¶ï¼Œå¯ä»¥ä¸ç”¨å£°æ˜ŽtestLambda &#123; 0&#125;// éšå«å‚æ•° ittestLambda &#123; it.length&#125; é»˜è®¤å‡½æ•°ä½“çš„æœ€åŽä¸€æ¡è¯­å¥å°†ä¼šä½œä¸ºå‡½æ•°çš„è¿”å›žå€¼ï¼Œä½†æ˜¯ä¸éœ€è¦æ˜¾å¼ä½¿ç”¨ return å…³é”®å­—ã€‚å¦‚æžœæƒ³åœ¨å…¶ä»–ä½ç½®è¿”å›žå€¼ï¼Œéœ€è¦ä½¿ç”¨å¸¦æœ‰åŽç¼€çš„ return è¯­å¥ã€‚ 123456789101112// æœ€åŽä¸€å¥å°†ä½œä¸ºè¿”å›žå€¼testLambda &#123; it.length&#125;// ä½¿ç”¨å¸¦åŽç¼€çš„ return è¯­å¥è¿”å›žæŒ‡å®šå€¼testLambda &#123; if (it.length &gt; 100) return@testLambda it.length else return@testLambda 100&#125; åŒ¿åå‡½æ•°åŒ¿åå‡½æ•°ä¸Žæ™®é€šå‡½æ•°ç±»ä¼¼ï¼Œä½†æ˜¯ä¸éœ€è¦æŒ‡å®šå‡½æ•°åï¼Œæ”¯æŒå•å•è¡¨è¾¾å¼å‡½æ•°ï¼Œä¹Ÿæ”¯æŒå¤šè¡Œå‡½æ•°ã€‚ åŒ¿åå‡½æ•°å¿…é¡»ä½¿ç”¨ () ä¼ é€’ï¼Œå¯¹ Lambda è¡¨è¾¾å¼æ”¯æŒçš„ä¸€äº›ä½¿ç”¨æ–¹å¼ï¼Œå¯¹åŒ¿åå‡½æ•°å¹¶ä¸æ”¯æŒã€‚ Lambda è¡¨è¾¾å¼ä¸ŽåŒ¿åå‡½æ•°ä¹‹é—´çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå®ƒä»¬çš„ éžå±€éƒ¨è¿”å›ž(non-local return) çš„è¡Œä¸ºä¸åŒã€‚ä¸ä½¿ç”¨æ ‡ç­¾çš„ return è¯­å¥æ€»æ˜¯ä»Ž fun å…³é”®å­—å®šä¹‰çš„å‡½æ•°ä¸­è¿”å›žã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒLambda è¡¨è¾¾å¼å†…çš„ return å°†ä¼šä»ŽåŒ…å«è¿™ä¸ª Lambda è¡¨è¾¾å¼çš„å‡½æ•°ä¸­è¿”å›žï¼Œè€ŒåŒ¿åå‡½æ•°å†…çš„ return åªä¼šä»ŽåŒ¿åå‡½æ•°æœ¬èº«è¿”å›žã€‚ 12345testParamFunction(1, inFun = (fun(p1, p2) = p1.length + p2))testParamFunction(1, inFun = (fun(p1, p2): Int &#123; return p1.length + p2&#125;)) å‡½æ•°çš„é—­åŒ…Lambda è¡¨è¾¾å¼å’ŒåŒ¿åå‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡ï¼Œå› æ­¤ä¼šå½¢æˆé—­åŒ…ã€‚ å‡½æ•° å’Œ å‡½æ•°èƒ½è®¿é—®åˆ°çš„å˜é‡(çŽ¯å¢ƒ) çš„æ€»å’Œ å°±å½¢æˆäº†ä¸€ä¸ªé—­åŒ…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªå†…éƒ¨å‡½æ•°è®¿é—®äº†å¤–éƒ¨å‡½æ•°çš„å˜é‡ï¼Œæ­¤æ—¶ä¼šå½¢æˆä¸€ä¸ªé—­åŒ…ã€‚ ä½¿ç”¨é—­åŒ…çš„ç›®çš„æ˜¯éšè—ä¸€äº›å˜é‡ï¼Œè¿™äº›å˜é‡åªåœ¨å¤–éƒ¨å‡½æ•°ä¸­å£°æ˜Žï¼Œä½†æ˜¯ä¸éœ€è¦å£°æ˜Žä¸ºå…¨å±€å±žæ€§ã€‚ å¦‚ä¸‹å‡½æ•°å£°æ˜Žï¼Œåœ¨ MainActivity ä¸­å’Œå¤–éƒ¨å‡½æ•°ä¸­åˆ†åˆ«éƒ½æœ‰å˜é‡ï¼Œå†…éƒ¨å‡½æ•°è®¿é—®è¿™äº›å˜é‡ã€‚ 123456789101112131415161718// MainActivity ä¸­çš„å˜é‡val valueInMainActivity = 100// å¤–éƒ¨å‡½æ•°fun localFunctionOuter(): () -&gt; Unit &#123; // å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ val valueInLocalFunctionOuter = 10 // å±€éƒ¨å‡½æ•° fun localFunctionInner() &#123; // å±€éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ val valueInLocalFunctionInner = 1 // å±€éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ log("valueInMainActivity = $valueInMainActivity " + ",valueInLocalFunctionOuter = $valueInLocalFunctionOuter " + ",valueInLocalFunctionInner = $valueInLocalFunctionInner") &#125; // è°ƒç”¨å±€éƒ¨å‡½æ•° return ::localFunctionInner&#125; åœ¨ä¸‹é¢çš„è°ƒç”¨ä¸­ï¼Œè™½ç„¶ localFunctionOuter() å‡½æ•°å·²ç»ç»“æŸäº†ï¼Œ ä½†æ˜¯ä»ç„¶å¯ä»¥ä½¿ç”¨è¿”å›žçš„å‡½æ•°è®¿é—® localFunctionOuter() å†…éƒ¨çš„å˜é‡ï¼Œæˆ‘ä»¬å¯¹å¤–éƒ¨éšè—äº† valueInLocalFunctionOuter è¿™ä¸ªå˜é‡ã€‚ 12345val f = localFunctionOuter()f()// è¾“å‡ºMainActivity: valueInMainActivity = 100 ,valueInLocalFunctionOuter = 10 ,valueInLocalFunctionInner = 1 å¸¦æœ‰æŽ¥å—è€…çš„å‡½æ•°å­—é¢å€¼å¸¦æœ‰æŽ¥å—è€…çš„å‡½æ•°å­—é¢å€¼ï¼ˆFunction Literals with Receiverï¼‰ è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼äºŽæ‰©å±•å‡½æ•°ä¸€æ ·çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å€ŸåŠ©å®˜ç½‘çš„å‡ ä¸ªä¾‹å­ç†è§£ä¸€ä¸‹ä»–çš„ç”¨æ³•ã€‚ 12val sum = fun Int.(other: Int): Int = this + other1.sum(12) è¿™ç§å£°æ˜Žæ–¹å¼å’Œæ™®é€šçš„å‡½æ•°æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä»–åªæ˜¯åœ¨å‚æ•°å‰é¢è¿½åŠ äº† Int ç±»åž‹ï¼Œæ¥è¡¨ç¤ºè¿™ä¸ªå‡½æ•°æ˜¯ Int ç±»åž‹å¯ä»¥ç›´æŽ¥è°ƒç”¨çš„ã€‚ 12val sum = fun Int.(other: Int): Int = otherval sum2 = fun (other: Int): Int = other å†æ¥çœ‹ä¸€ä¸‹å®˜ç½‘çš„å¦ä¸€ä¸ªä¾‹å­ï¼Œç¬¬ä¸€çœ¼çœ‹ä¸ŠåŽ»æ˜¯æœ‰äº›æ‡µé€¼çš„ï¼Œåˆ†æžä¸€ä¸‹ 123456789101112131415// ä¸€ä¸ªæ™®é€šçš„ç±»class HTML &#123; // ä¸€ä¸ªæ™®é€šçš„å‡½æ•° fun body() &#123; &#125;&#125;// è¿˜æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œè¿”å›žå€¼ä¸º HTML å¯¹è±¡// init å‚æ•°æ˜¯ä¸€ä¸ªæ— å‚æ— è¿”å›žå€¼çš„å‡½æ•°ï¼Œ// ç”±äºŽä½¿ç”¨äº† (HTML.) è¯´æ˜Žè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªå¯ä»¥è¢« HTML å¯¹è±¡ç›´æŽ¥è°ƒç”¨çš„å‡½æ•°fun html(init: HTML.() -&gt; Unit): HTML &#123; val html = HTML() html.init() // ä½¿ç”¨åˆ›å»ºçš„ HTML å¯¹è±¡è°ƒç”¨è¯¥å‡½æ•° return html&#125; è°ƒç”¨ï¼ŒæŽ¥å—çš„å‚æ•°æ˜¯ HTML ç±»çš„ä¸€ä¸ªæ— å‚æ— è¿”å›žå€¼çš„å‡½æ•°ã€‚ 123456789html &#123; body() &#125;ç›¸å½“äºŽhtml(&#123; body()&#125;) å†…è”å‡½æ•°(inline)ä½¿ç”¨é«˜é˜¶å‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”å®ƒè¿˜è¦æ•èŽ·ä¸€ä¸ªé—­åŒ…ï¼Œè¿™äº›éƒ½ä¼šé€ æˆå†…å­˜çš„æŸè€—å’Œè¿è¡Œæ•ˆçŽ‡çš„ä¸‹é™ã€‚ä½¿ç”¨å†…è”å‡½æ•°å¯ä»¥å°†å‡½æ•°å†…è”åœ¨å‡½æ•°è°ƒç”¨å¤„ï¼Œè€Œä¸ç”¨ç”Ÿæˆå¤šä½™çš„å¯¹è±¡å†åŽ»è°ƒç”¨ä»–ã€‚ ä½¿ç”¨å†…è”å‡½æ•°éœ€è¦ä½¿ç”¨ inline å…³é”®å­—å£°æ˜Žï¼Œinline å…³é”®å­—ä¼šå½±å“å‡½æ•°æœ¬èº«ï¼Œä¹Ÿä¼šå½±å“ä¼ é€’ç»™ä»–çš„è¡¨è¾¾å¼ï¼Œè¿™ä¸¤è€…éƒ½ä¼šè¢«å†…è”åˆ°è°ƒç”¨å¤„ã€‚ 123inline fun testInline(str:String,f: (String) -&gt; Int): Int &#123; return f(str)&#125; å¦‚æžœå‡½æ•°æœ‰å¤šä¸ªå‡½æ•°å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ noinline å…³é”®å­—å£°æ˜Žé‚£äº›ä¸éœ€è¦å†…è”çš„å‡½æ•° 1234inline fun testInline(str: String, f1: (String) -&gt; Int, noinline f2: () -&gt; Unit): Int &#123; f2() return f1(str)&#125; å†…è”å‡½æ•°ä¸èƒ½ä½œä¸ºé€’å½’å‚æ•°ä½¿ç”¨ï¼Œå¯¹äºŽå†…è”å‡½æ•°ä¸­æ²¡æœ‰å£°æ˜Žä¸º noinline å‡½æ•°å‚æ•°(å®ƒä»¬éƒ½æ˜¯å†…è”çš„)ï¼Œå…·æœ‰ä¸€äº›é™åˆ¶ï¼Œè¿™äº›å‚æ•° ä¸èƒ½ä¿å­˜åœ¨åŸŸä¸­ï¼Œä¸èƒ½ä½œä¸ºå‡½æ•°è¿”å›žå€¼è¿”å›žï¼Œåªèƒ½åœ¨å†…è”å‡½æ•°å†…éƒ¨è°ƒç”¨ï¼Œåªèƒ½ä½œä¸ºå¯ä»¥å†…è”çš„å‡½æ•°å‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­è¯´æ˜Žï¼š 12345678910111213141516171819202122232425// ä¸€ä¸ªå†…è”å‡½æ•°inline fun testInline2(f1: (String) -&gt; Int)&#123;&#125;// ä¸€ä¸ªéžå†…è”å‡½æ•°fun testInline3(f1: (String) -&gt; Int)&#123;&#125;inline fun testInline(str: String, f1: (String) -&gt; Int, noinline f2: () -&gt; Unit): (String) -&gt; Int &#123; // error. inline ä¸å¯ä»¥ä¿å­˜åœ¨åŸŸå†… // val localFun = f1 // error. ä¸èƒ½æ˜¯é€’å½’çš„ // testInline(str,f1,f2) // yes. å†…è”çš„ lambda è¡¨è¾¾å¼å‚æ•°ï¼Œå¯ä»¥ä½œä¸ºå…¶ä»–å†…è”å‡½æ•°çš„å‚æ•° testInline2(f1) // error. å†…è”çš„ lambda è¡¨è¾¾å¼å‚æ•°ï¼Œä¸èƒ½ä½œä¸ºéžå†…è”å‡½æ•°çš„å‚æ•° // testInline(f1) // error. inline ä¸å¯ä»¥ä½œä¸ºè¿”å›žå€¼ // return f1&#125; éžå±€éƒ¨è¿”å›ž(Non-local return)éžå±€éƒ¨è¿”å›žï¼ˆNon-local returnï¼‰ åœ¨ Kotlin ä¸­ï¼Œä½¿ç”¨ä¸å¸¦æ ‡ç­¾çš„ return è¯­å¥åªèƒ½è¿”å›žä½¿ç”¨ fun å…³é”®å­—å£°æ˜Žçš„å‡½æ•°ï¼Œå³æ™®é€šçš„å‡½æ•°å’ŒåŒ¿åå‡½æ•°ï¼Œåœ¨ Lambda è¡¨è¾¾å¼æ˜¯ä¸å…è®¸ä½¿ç”¨ä¸å¸¦æ ‡ç­¾çš„ return è¯­å¥çš„ã€‚ 123456789fun testNonReturn(f: (String) -&gt; Int) &#123; log(f("test")) log("testNonReturn")&#125;testNonReturn &#123; // ä¸å…è®¸ return it.length&#125; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¦æœ‰æŒ‡å®šæ ‡ç­¾çš„ return è¯­å¥ï¼Œç”¨æ¥è¿”å›žä¸åŒæ¡ä»¶ä¸‹çš„ç»“æžœï¼Œå› ä¸º Lambda è¡¨è¾¾å¼æ€»æ˜¯å°†æœ€åŽä¸€å¥çš„ç»“æžœä½œä¸ºè¿”å›žå€¼ï¼Œå¸¦æœ‰æ ‡ç­¾çš„ return è¯­å¥åªä¼šä»Žå¯¹åº” Lambda è¡¨è¾¾å¼è¿”å›žï¼ŒåŽé¢ä»£ç ä»ä¼šæ‰§è¡Œã€‚ 12345678testNonReturn &#123; if (it.length &gt; 2) return@testNonReturn 100 else return@testNonReturn 1&#125;MainActivity: 100MainActivity: testNonReturn å¯¹äºŽå†…è”å‡½æ•°ï¼ŒLambda è¡¨è¾¾å¼ä¼šè¢«å†…è”åœ¨è°ƒç”¨å¤„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ return è¯­å¥ï¼Œæ­¤æ—¶ return çš„ä½œç”¨æ˜¯ç»“æŸ Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°çš„å‡½æ•°æ‰€åœ¨çš„é‚£ä¸ªå‡½æ•°ï¼Œæœ‰ç‚¹ç»•ï¼Œå€ŸåŠ©ä¸‹é¢çš„ä¾‹å­ï¼ŒtestNonLocalReturn() å‡½æ•°æŽ¥å—çš„ Lambda å‚æ•°å°†ä¼šç»“æŸ testNonLocalReturn() å‡½æ•°æ‰€åœ¨çš„ foo() å‡½æ•°ï¼Œè¿™ç§è¿”å›žæ–¹å¼è¢«ç§°ä¸º éžå±€éƒ¨è¿”å›žï¼ˆNon-local returnï¼‰ï¼› 1234567891011121314inline fun testNonReturn(f: (String) -&gt; Int)&#123; f("test")&#125;fun foo():Boolean &#123; log("before testNonLocalReturn") testNonLocalReturn &#123; // è¿”å›žå€¼ä¸º booleanï¼Œå°†ç›´æŽ¥é€€å‡º foo å‡½æ•° log("invoke testNonLocalReturn") return true &#125; log("after testNonLocalReturn") return false&#125; è¾“å‡º 12MainActivity: before testNonLocalReturnMainActivity: invoke testNonLocalReturn æœ‰äº›æ—¶å€™ Lambda è¡¨è¾¾å¼å‚æ•°å¹¶ä¸ä¸€å®šåœ¨å‡½æ•°å†…éƒ¨æ‰§è¡Œï¼Œä»–å¯èƒ½é€šè¿‡ä¸€ä¸ªå±€éƒ¨å¯¹è±¡æˆ–ä¸€ä¸ªåµŒå¥—å‡½æ•°ä¼ é€’ç»™å…¶ä»–æ‰§è¡ŒçŽ¯å¢ƒè°ƒç”¨ï¼Œæ­¤æ—¶éžå±€éƒ¨è¿”å›žä¹Ÿæ˜¯è¢«ç¦æ­¢çš„ï¼Œä¸ºäº†æ˜Žç¡®è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬ä½¿ç”¨ crossinline å…³é”®å­—å£°æ˜Žã€‚ 12345678910111213// å› ä¸ºå°†ä¼šåœ¨å¦ä¸€ä¸ªçŽ¯å¢ƒæ‰§è¡Œï¼Œä½¿ç”¨ crossinline æ ‡è®°inline fun testNonLocalReturnV2(crossinline f: () -&gt; Unit): Runnable &#123; val r = Runnable &#123; f() &#125; return r&#125;fun fooV2() &#123; testNonLocalReturnV2&#123; // error ä½¿ç”¨ crossinline æ ‡è®°ï¼Œä¸èƒ½éžå±€éƒ¨è¿”å›ž // return &#125; log("invoke fooV2")&#125; å®žä½“åŒ–çš„ç±»åž‹å‚æ•°(reified)å®žä½“åŒ–çš„ç±»åž‹å‚æ•°(Reified type parameter) ä¸»è¦ç”¨æ¥è§£å†³èŒƒåž‹å‚æ•°æ— æ³•åƒæ™®é€šçš„ç±»é‚£æ ·è®¿é—®çš„é—®é¢˜ã€‚å†™ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯å±žäºŽæŸç§ç±»åž‹ã€‚ 123456fun &lt;T&gt; testReifiedType(p: Any, cls: Class&lt;T&gt;): Boolean &#123; return cls.isInstance(p)&#125;// æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒtestReifiedType("test", String::class.java) è¿™è®©æˆ‘æƒ³èµ·äº† Gson çš„ä½¿ç”¨æ–¹æ³•ï¼Œé™¤äº†çº¦å®šä¸€ä¸ªèŒƒåž‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¼ é€’å¯¹åº”çš„ class è¿›åŽ»æ‰èƒ½è§£æžï¼Œkotlin ä¸­å†…è”å‡½æ•°æ”¯æŒ Reified type parameterï¼Œä½¿ç”¨ reifeid å…³é”®å­—æ³¨è§£èŒƒåž‹ï¼Œå°±å¯ä»¥åƒä¸€ä¸ªæ™®é€šçš„ç±»é‚£æ ·æ¥è®¿é—®èŒƒåž‹ç±»åž‹äº†ã€‚ 123456inline fun &lt;reified T&gt; testReifiedType(p: Any): Boolean &#123; return p is T&#125;// è°ƒç”¨testReifiedType&lt;String&gt;("") éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‡½æ•°å¿…é¡»æ˜¯ inline ç±»åž‹æ‰å¯ä»¥ä½¿ç”¨ reifeid å…³é”®å­—æ³¨è§£ã€‚]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-10-ä»£ç†]]></title>
    <url>%2Farticle%2Fcc5968a9%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦å­¦ä¹  Kotlin ä¸­çš„ä»£ç†æ¨¡å¼çš„å®žçŽ°ä»¥åŠå±žæ€§ä»£ç†çš„ä½¿ç”¨ã€‚ ä»£ç†æ¨¡å¼å·²è¢«å®žè·µè¯æ˜Žä¸ºç±»ç»§æ‰¿æ¨¡å¼ä¹‹å¤–çš„å¦ä¸€ç§å¾ˆå¥½çš„æ›¿ä»£æ–¹æ¡ˆï¼ŒKotlin å¯¹ä»£ç†æ¨¡å¼åšäº†å¾ˆå¥½çš„æ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥éžå¸¸ç®€å•çš„å®žçŽ°ä»£ç†æ¨¡å¼ã€‚ å±žæ€§ä»£ç†ä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†å…·æœ‰å…±åŒæ€§è´¨çš„å±žæ€§çš„åˆå§‹åŒ–é€šè¿‡å±žæ€§ä»£ç†æ¥å®žçŽ°ï¼Œç®€åŒ–äº†æ•°æ®çš„è¯»å–å’Œå­˜å‚¨ï¼ŒåŒæ—¶åœ¨ Kotlin ä¸­è¿˜å†…ç½®äº†å¾ˆå¤šæ ‡å‡†ä»£ç†ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–å¼€å‘è¿‡ç¨‹ã€‚ æœ€åŽæˆ‘ä»¬ä½¿ç”¨å±žæ€§ä»£ç†æ¥å®žçŽ°ä¸€ä¸ªå®Œå…¨çš„å°é—­çš„è®¿é—® SharePreference è¿›è¡Œæ•°æ®å­˜å–çš„ä¾‹å­ã€‚ ä»£ç†æ¨¡å¼ä»£ç† (Delegate) æ¨¡å¼æ˜¯ä¸€ç§å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ï¼ŒKotlin å¯¹æ­¤ä½œäº†å¾ˆå¥½çš„æ”¯æŒã€‚ ä»£ç†æ¨¡å¼å·²è¢«å®žè·µè¯æ˜Žä¸ºç±»ç»§æ‰¿æ¨¡å¼ä¹‹å¤–çš„å¦ä¸€ç§å¾ˆå¥½çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå½“æˆ‘ä»¬å·²ç»æŠ½è±¡äº†éƒ¨åˆ†åŠŸèƒ½å‡ºæ¥ï¼Œåˆæƒ³å½“å‰çš„å¯¹è±¡å…·å¤‡è¿™äº›åŠŸèƒ½ï¼Œé™¤äº†ç»§æ‰¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œå°†å½“å‰å¯¹è±¡éœ€è¦çš„æ“ä½œä»£ç†ç»™åˆ«äººåšï¼Œå®žçŽ°å¤ç”¨ã€‚ ä½¿ç”¨å®˜ç½‘çš„ä¸€ä¸ªä¾‹å­ï¼Œå¹¶ä¸”è¿›è¡Œäº†éƒ¨åˆ†æ‰©å±•ï¼Œæ¥ç†è§£ä»£ç†æ¨¡å¼çš„æ„ä¹‰ã€‚ å‡è®¾ BaseA å£°æ˜Žäº† A ç±»é€»è¾‘ï¼ŒBaseAImpl å®žçŽ°äº†è¿™éƒ¨åˆ†é€»è¾‘ï¼ŒBaseB å£°æ˜Žäº† B ç±»é€»è¾‘ï¼ŒBaseBImpl å®žçŽ°äº†è¿™éƒ¨åˆ†é€»è¾‘ã€‚æ­¤æ—¶æˆ‘ä»¬çš„ Derived éœ€è¦åŒæ—¶å…·å¤‡ BaseA å’Œ BaseB çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Derived å†æ¬¡å®žçŽ° BaseA å’Œ BaseB çš„ç›¸å…³åŠŸèƒ½ä½†æˆ‘ä»¬å°†æ— æ³•å¤ç”¨åœ¨ BaseAImpl å’Œ BaseBImpl ä¸­å·²ç»å®žçŽ°çš„é€»è¾‘ä»£ç ã€‚ ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼Œæˆ‘ä»¬å°† Derived éœ€è¦å®žçŽ°çš„åŠŸèƒ½åˆ†åˆ«ä»£ç†ç»™ BaseA å’Œ BaseB çš„å®žçŽ°ç±»ï¼ŒDerived è‡ªå·±ä¸åšä»»ä½•å¤„ç†ï¼Œä½¿ç”¨ä»£ç†åŽ»æŽ¥æ”¶å¤„ç†ã€‚äº‹å®žä¸Šï¼Œæˆ‘ä»¬ä¼šåœ¨ Derived ç±»ä¸­æŒæœ‰ä»£ç†çš„å¯¹è±¡ï¼Œç„¶åŽåœ¨å¯¹è±¡çš„æŽ¥å£æ–¹æ³•é€»è¾‘å®žçŽ°æ—¶è½¬å‘ç»™ä»£ç†çš„ç›¸å…³æ–¹æ³•ï¼Œå®žçŽ°ä»£ç†æ¨¡å¼éœ€è¦è®¾è®¡å¾ˆå¤šç›¸å…³çš„æŽ¥å£ä»£ç ï¼Œå¥½åœ¨ Kotlin å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ä»£ç†æ¨¡å¼çš„æ”¯æŒï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ by å…³é”®å­—å°†åŠŸèƒ½çš„å®žçŽ°ä»£ç†ç»™æŒ‡å®šå¯¹è±¡å³å¯ã€‚ 12345678910111213141516171819202122interface BaseA &#123; fun printA()&#125;interface BaseB &#123; fun printB()&#125;class BaseAImpl(var x: Int) : BaseA &#123; override fun printA() &#123; log("BaseAImpl $x") &#125;&#125;class BaseBImpl(var x: Int) : BaseB &#123; override fun printB() &#123; log("BaseBImpl $x") &#125;&#125;// å°† BaseA çš„é€»è¾‘ä»£ç†ç»™ ba, å°† BaseB çš„é€»è¾‘ä»£ç†ç»™ bbclass Derived(ba: BaseA, bb: BaseB) : User(), BaseA by ba, BaseB by bb 1234567val derived = Derived(BaseAImpl(10), BaseBImpl(100))derived.printA()derived.printB()# è¾“å‡ºcom.march.ktexample E/BaseAImpl: BaseAImpl 10com.march.ktexample E/BaseBImpl: BaseBImpl 100 å±žæ€§ä»£ç†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç†å±žæ€§çš„åŠŸèƒ½æ¥åˆå§‹åŒ–é‚£äº›å…·æœ‰å…±æ€§çš„å±žæ€§ï¼Œæ¯”å¦‚ä»Ž SharePerenferce æˆ–è€…æ•°æ®åº“ä¸­è¯»å–å’Œå­˜å‚¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå±žæ€§ä»£ç†ä½¿ç”¨å®ƒæ¥åˆå§‹åŒ–è¿™äº›å…·æœ‰å…±æ€§çš„å±žæ€§å°†ä¼šç®€å•å¾ˆå¤šã€‚ ä¸€ä¸ªç®€å•çš„ä»£ç†å®žçŽ°ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ä»£ç†æ¥åˆå§‹åŒ– value å±žæ€§ 1234567891011121314151617var value: String by MyDelegate()class MyDelegate &#123; var temp = "test" operator fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String &#123; log(thisRef.toString()) log(property.toString()) log("invoke getValue") return temp &#125; operator fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String) &#123; log("invoke setValue value is $value") temp = value &#125;&#125; å½“æˆ‘ä»¬è¯»æˆ–å†™ value å±žæ€§æ—¶å°†ä¼šè§¦å‘å¯¹åº”çš„ä»£ç†æ–¹æ³• 123log(value)value = "123"log(value) 12345678910// thisRef çš„å€¼MyDelegate: com.march.ktexample.MainActivity@445adf9// property çš„å€¼ï¼Œæ“ä½œçš„æ˜¯ value å±žæ€§MyDelegate: property value (Kotlin reflection is not available)MyDelegate: invoke getValueMainActivity: testMyDelegate: invoke setValue value is 123MyDelegate: invoke getValueMainActivity: 123 ä»£ç†å±žæ€§çš„è¯­æ³•å¦‚ä¸‹ï¼š by å…³é”®å­—åŽé¢çš„è¡¨è¾¾å¼å°±æ˜¯ä»£ç†ï¼Œä»–éœ€è¦å…·æœ‰ getValue() æ–¹æ³•ï¼Œ å¦‚æžœå±žæ€§æ˜¯ var ç±»åž‹ï¼Œé‚£ä¹ˆè¿˜å¿…é¡»æœ‰ setValue() æ–¹æ³•ã€‚ 1val/var &lt;propertyName&gt;:&lt;propertyType&gt; by &lt;expression&gt; getValue() å’Œ setValue()ä»£ç†ä¸­çš„ getValue() å’Œ setValue() æ–¹æ³•æ²¡æœ‰ç±»ä¼¼æŽ¥å£çš„é‚£ç§å¼ºåˆ¶æ¨¡æ¿çš„å®žçŽ°ï¼Œå¯èƒ½æ²¡æœ‰åŠžæ³•åƒæŽ¥å£é‚£æ ·å£°æ˜Žç»Ÿä¸€çš„æŽ¥å£æ–¹æ³•ã€‚ getValue() å’Œ setValue() å‡½æ•°éœ€è¦ä½¿ç”¨ operator å…³é”®å­—æ ‡è®°ï¼Œå®ƒä»¬å¯ä»¥æ˜¯å§”æ‰˜ç±»çš„æˆå‘˜å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å®ƒçš„æ‰©å±•å‡½æ•°ã€‚å¦‚æžœä½ éœ€è¦å°†å±žæ€§å§”æ‰˜ç»™ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œè¿™ä¸ªå¯¹è±¡æœ¬æ¥æ²¡æœ‰æä¾›è¿™äº›å‡½æ•°ï¼Œè¿™æ—¶ä½¿ç”¨æ‰©å±•å‡½æ•°ä¼šæ›´ä¾¿åˆ©ä¸€äº›ã€‚ å‚æ•°åˆ—è¡¨å’Œè¿”å›žç±»åž‹ï¼š å‚æ•° thisRef:Any? çš„ç±»åž‹å¿…é¡»ä¸Ž å±žæ€§æ‰€å±žçš„ç±» ç›¸åŒæˆ–è€…æ˜¯å®ƒçš„åŸºç±»(å¯¹äºŽæ‰©å±•å±žæ€§ â€” è¿™ä¸ªå‚æ•°çš„ç±»åž‹å¿…é¡»ä¸Žè¢«æ‰©å±•çš„ç±»åž‹ç›¸åŒæˆ–è€…æ˜¯å®ƒçš„åŸºç±»)ã€‚ å‚æ•° property: KProperty&lt;*&gt; æ˜¯è¢«ä»£ç†çš„å±žæ€§ï¼Œå¯ä»¥ä½¿ç”¨ property.name æŸ¥çœ‹å±žæ€§åï¼Œè¿™ä¸ªå‚æ•°çš„ç±»åž‹å¿…é¡»æ˜¯ KProperty&lt;*&gt; æˆ–è€…æ˜¯å®ƒçš„åŸºç±»ã€‚ å¯¹äºŽ getValue() å‡½æ•°æ¥è¯´è¿”å›žå€¼å¿…é¡»ä¸Žè¢«ä»£ç†çš„å±žæ€§çš„ç±»åž‹ç›¸åŒã€‚ å¯¹äºŽ setValue() å‡½æ•°æ¥è¯´å‚æ•° value: Type æ˜¯å±žæ€§çš„æ–°å€¼ï¼Œä»–å¿…é¡»ä¸Žå±žæ€§çš„ç±»åž‹ç›¸åŒã€‚å¦å¤–éœ€è¦å°†å€¼è¿›è¡Œå­˜å‚¨ï¼Œåœ¨ getValue() å‡½æ•°ä¸­è¿”å›žï¼Œå¦åˆ™å°†æ— æ³•æ”¹å˜å±žæ€§çš„å€¼ã€‚ 123456operator fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): String &#123; return temp&#125;operator fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: String) &#123; temp = value&#125; Standard DelegatesKotlin å†…ç½®äº†ä¸€äº›æ ‡å‡†ä»£ç†ã€‚ Lazyby lazy æ˜¯å±žæ€§ä»£ç†åœ¨ kotlin ä¸­çš„ä¸€ä¸ªç®€åŒ–å®žçŽ°ï¼Œä½¿ç”¨ by lazy å¯ä»¥å»¶è¿Ÿå±žæ€§çš„åŠ è½½ï¼Œä»–æŽ¥å—ä¸€ä¸ª Lambda è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ï¼Œè¿”å›žä¸€ä¸ª Lazy&lt;T&gt; ç±»åž‹çš„å®žä¾‹ã€‚ åªæœ‰ val å±žæ€§æ‰èƒ½ä½¿ç”¨ by lazy å»¶è¿Ÿåˆå§‹åŒ–ï¼Œå› ä¸º by lazy åªæä¾› getValue() æ–¹æ³•ã€‚ 123@kotlin.jvm.JvmVersionpublic fun &lt;T&gt; lazy(initializer: () -&gt; T): Lazy&lt;T&gt; = SynchronizedLazyImpl(initializer) ä½¿ç”¨ by lazy åªæœ‰åœ¨ç¬¬ä¸€æ¬¡èŽ·å–å€¼çš„æ—¶å€™å›žåŽ»è®¡ç®— Lambda è¡¨è¾¾å¼çš„å€¼ï¼ŒåŽé¢å†æ¬¡è®¿é—®ï¼Œåªä¼šè¿”å›žä¹‹å‰çš„å€¼ï¼Œä¸ä¼šå†åšè®¡ç®—ã€‚ 12345678910111213val lazyValue: Int by lazy &#123; log("invoke by lazy") 100&#125;// æµ‹è¯•log(lazyValue)log(lazyValue)// ç»“æžœcom.march.ktexample E/MainActivity: invoke by lazycom.march.ktexample E/MainActivity: 100com.march.ktexample E/MainActivity: 100 é»˜è®¤æƒ…å†µä¸‹ï¼Œby lazy çš„è®¡ç®—æ˜¯ åŒæ­¥çš„(synchronized): å±žæ€§å€¼åªä¼šåœ¨å”¯ä¸€ä¸€ä¸ªçº¿ç¨‹å†…è®¡ç®—ï¼Œç„¶åŽæ‰€æœ‰çº¿ç¨‹éƒ½å°†å¾—åˆ°åŒæ ·çš„å±žæ€§å€¼ã€‚å¦‚æžœå§”æ‰˜çš„åˆå§‹åŒ–è®¡ç®—ä¸éœ€è¦åŒæ­¥ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œåˆå§‹åŒ–è®¡ç®—ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨LazyThreadSafetyMode.PUBLICATION å‚æ•°ã€‚ç›¸åï¼Œå¦‚æžœä½ ç¡®ä¿¡åˆæœŸåŒ–è®¡ç®—åªå¯èƒ½å‘ç”Ÿåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ LazyThreadSafetyMode.NONE æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼ä¸ä¼šä¿æŒçº¿ç¨‹åŒæ­¥ï¼Œå› æ­¤ä¸ä¼šå¸¦æ¥è¿™æ–¹é¢çš„æ€§èƒ½æŸå¤±ã€‚ Observable &amp; Vetoableå¯è§‚å¯Ÿå±žæ€§ï¼ŒDelegates.observable() å‡½æ•°æŽ¥å—ä¸€ä¸ªåˆå§‹åŒ–å€¼å’Œä¸€ä¸ªå±žæ€§å€¼å˜åŒ–çš„å“åº”å™¨ä½œä¸ºå‚æ•°ï¼Œå¯ä»¥ç”¨æ¥è§‚å¯Ÿå±žæ€§çš„å˜åŒ–ï¼Œå½“å±žæ€§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ä¼šè§¦å‘å“åº”å™¨ã€‚ 123456789101112var observableValue: Int by Delegates.observable(1) &#123; property, oldValue, newValue -&gt; log("Delegates.observable - $&#123;property.name&#125; $oldValue $newValue")&#125;// æµ‹è¯•observableValue = 100observableValue = 200// ç»“æžœMainActivity: Delegates.observable - observableValue 1 100MainActivity: Delegates.observable - observableValue 100 200 å¦‚æžœæƒ³è¦åœ¨æ£€æµ‹åˆ°å±žæ€§å˜åŒ–æ—¶ï¼Œæˆªæ–­èµ‹å€¼æ“ä½œï¼Œéœ€è¦ä½¿ç”¨ Delegates.vetoable()ï¼Œå¦‚ä¸‹ï¼Œå€¼ç­‰äºŽ 200 æ—¶ï¼Œä¸åšèµ‹å€¼æ“ä½œã€‚ 1234567891011121314151617var vetoableValue: Int by Delegates.vetoable(1) &#123; property, oldValue, newValue -&gt; log("Delegates.vetoable - $&#123;property.name&#125; $oldValue $newValue") newValue != 200&#125;// æµ‹è¯•vetoableValue = 100log("(after set 100) $vetoableValue")vetoableValue = 200log("(after set 200) $vetoableValue")// ç»“æžœMainActivity: Delegates.vetoable - vetoableValue 1 100MainActivity: (after set 100) value is 100MainActivity: Delegates.vetoable - vetoableValue 100 200MainActivity: (after set 200) value is 100 NotNullä½¿ç”¨éžç©ºä»£ç† Delegates.notNull()ï¼Œå±žæ€§åœ¨å£°æ˜Žæ—¶å¿…é¡»è¿›è¡Œåˆå§‹åŒ–ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„å‡ºçŽ°ï¼ŒDelegates.notNull() ç±»ä¼¼äºŽ lateinit å…³é”®å­—ï¼Œä½¿ä½ å¯ä»¥åœ¨åŽé¢åˆå§‹åŒ–å±žæ€§çš„å€¼ï¼Œåœ¨æ²¡æœ‰åˆå§‹åŒ–ä¹‹å‰å¦‚æžœä½¿ç”¨äº†è¯¥å±žæ€§ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ java.lang.IllegalStateException: Property notNullValue should be initialized before get. 1var notNullValue: String by Delegates.notNull&lt;String&gt;() Mapä½¿ç”¨ Map å­˜å‚¨å±žæ€§çš„å€¼ï¼Œå°±å¯ä»¥ä»Ž Map ä¸­èŽ·å–å¯¹åº”å±žæ€§çš„åç§°ä¸º key çš„å€¼ã€‚ 1234class MapUser(propertyMap: Map&lt;String, Any?&gt;) &#123; val name by propertyMap val age by propertyMap&#125; ä½¿ç”¨ Map åˆå§‹åŒ–ä¸€ä¸ªå¯¹è±¡ 12345678val mapUser = MapUser(mapOf( "name" to "myName", "age" to 25))log("name = $&#123;mapUser.name&#125; ,age = $&#123;mapUser.age&#125;")// ç»“æžœä¸ºMainActivity: name = myName ,age = 25 SharedPreferences è¯»å†™ä»£ç†ä¸€ä¸ªä»£ç†å±žæ€§çš„ä¾‹å­ã€‚ ä»¥å±žæ€§åä¸º key ä»Ž SharedPreferences è¯»å–æ•°æ®ï¼Œç”¨æ¥åˆå§‹åŒ–å±žæ€§çš„å€¼ï¼Œå­˜å‚¨æ•°æ®æ—¶åŒæ—¶å†™å…¥ SharedPreferencesï¼› 123456789101112131415161718192021222324252627282930313233343536373839404142// è‡ªå®šä¹‰ SharedPreferences å±žæ€§è¯»å†™class SpDelegate&lt;T&gt;(val context: Context, val readName: String?, val defValue: T) : ReadWriteProperty&lt;Any?, T&gt; &#123; constructor(context: Context, defValue: T) : this(context, null, defValue) val KEY = "SharePreference" val mSharePreference: SharedPreferences by lazy &#123; context.getSharedPreferences(KEY, Context.MODE_PRIVATE) &#125; @Suppress("UNCHECKED_CAST") override fun getValue(thisRef: Any?, property: KProperty&lt;*&gt;): T &#123; val name = readName ?: property.name val result: Any = when (defValue) &#123; is Boolean -&gt; mSharePreference.getBoolean(name, defValue) is Int -&gt; mSharePreference.getInt(name, defValue) is Long -&gt; mSharePreference.getLong(name, defValue) is Float -&gt; mSharePreference.getFloat(name, defValue) is String -&gt; mSharePreference.getString(name, defValue) else -&gt; throw IllegalArgumentException("un support") &#125; log("getValue : result = " + result) return result as T &#125; override fun setValue(thisRef: Any?, property: KProperty&lt;*&gt;, value: T) &#123; val editor = mSharePreference.edit() val name = readName ?: property.name when (value) &#123; is Boolean -&gt; editor.putBoolean(name, value) is Int -&gt; editor.putInt(name, value) is Long -&gt; editor.putLong(name, value) is Float -&gt; editor.putFloat(name, value) is String -&gt; editor.putString(name, value) else -&gt; throw IllegalArgumentException("un support") &#125; log("setValue : newValue = " + value) editor.apply() &#125;&#125; æµ‹è¯•å±žæ€§çš„è¯»å–å’Œå†™å…¥ 123456789var shareIntVar1: Int by SpDelegate(this, 1)var shareStringVar1: String by SpDelegate(this, "def String value")log(shareIntVar1)shareIntVar1 = 1000log(shareIntVar1)log(shareStringVar1)shareStringVar1 = "new String value"log(shareStringVar1) ç»“æžœ 12345678910SpDelegate: getValue : result = 1MainActivity: 1SpDelegate: setValue : newValue = 1000SpDelegate: getValue : result = 1000MainActivity: 1000SpDelegate: getValue : result = def String valueMainActivity: def String valueSpDelegate: setValue : newValue = new String valueSpDelegate: getValue : result = new String valueMainActivity: new String value]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-9-objectå…³é”®å­—]]></title>
    <url>%2Farticle%2F40486d0b%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡å­¦ä¹  Kotlin ä¸­ object å…³é”®å­—çš„ä½¿ç”¨ã€‚ ä½¿ç”¨ object å…³é”®å­—çš„å¯¹è±¡è¡¨è¾¾å¼å¯ä»¥åˆ›å»ºåŒ¿åå¯¹è±¡ï¼Œé€‚åˆé‚£äº›åªéœ€è¦ä½¿ç”¨ä¸€æ¬¡çš„ç±»å®žçŽ°ï¼Œä½¿ç”¨åŒ¿åå¯¹è±¡æˆ‘ä»¬ä¸éœ€è¦ç»™è¿™äº›åªç”¨ä¸€æ¬¡çš„ç±»å¯¹è±¡å£°æ˜Ž class è€Œæ˜¯åœ¨è¿è¡Œæ—¶ç›´æŽ¥åˆ›å»ºå³å¯ã€‚ ä½¿ç”¨ object å…³é”®å­—è¿›è¡Œå¯¹è±¡å£°æ˜Žï¼Œå€ŸåŠ©è¿™ç§æ–¹æ³•å¯ä»¥ç®€å•çš„å®žçŽ°å•ä¾‹å’ŒåŒä¼´å¯¹è±¡ã€‚ å¯¹è±¡è¡¨è¾¾å¼å¯¹è±¡è¡¨è¾¾å¼ï¼ˆObject expressionï¼‰ å¯¹è±¡è¡¨è¾¾å¼åˆ™ä¼šåœ¨ä½¿ç”¨å¤„ ç«‹å³ æ‰§è¡Œ(å¹¶ä¸”åˆå§‹åŒ–) ä½¿ç”¨ object å¯ä»¥åˆ›å»ºåŒ¿åå†…éƒ¨ç±»ï¼Œä»¥ç‚¹å‡»äº‹ä»¶ä¸ºä¾‹ 12345678910mMyMsgTv.setOnClickListener(object: View.OnClickListener&#123; override fun onClick(v: View?) &#123; // click &#125;&#125;)// ä½¿ç”¨ Lambda è¡¨è¾¾å¼ç®€åŒ–ã€‚mMyMsgTv.setOnClickListener &#123; log("click")&#125; è‡ªå·±å®šä¹‰ä¸¤ä¸ªæŽ¥å£ 12345678interface OneFunInterface&#123; fun test(param:String)&#125;interface TwoFunInterface&#123; fun test1(param:String) fun test2(param:String)&#125; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»åˆ›å»ºå¯¹è±¡ 12345678910val o1 = object : OneFunInterface &#123; override fun test(param: String) &#123; &#125;&#125;val o2 = object : TwoFunInterface &#123; override fun test1(param: String) &#123; &#125; override fun test2(param: String) &#123; &#125;&#125; å®žçŽ°åŒ¿åå†…éƒ¨ç±»æ—¶å¯ä»¥ç»§æ‰¿å¤šä¸ªåŸºç±»ï¼Œå¦‚æžœåŸºç±»æœ‰æž„é€ å™¨ï¼Œé‚£ä¹ˆå¿…é¡»ä¼ é€’åˆé€‚çš„å‚æ•° 12345val o3 = object:User("zhang",22),OneFunInterface&#123; override fun test(param: String) &#123; &#125;&#125; ä¹Ÿå¯ä»¥ä¸ç»§æ‰¿ä»»ä½•åŸºç±»ç›´æŽ¥åˆ›å»ºå¯¹è±¡ï¼ŒðŸ‘ 12345val o4 = object&#123; val x = 10 val y = 20&#125;log(o4.x) å¯¹è±¡è¡¨è¾¾å¼çš„å†…éƒ¨å¯ä»¥è®¿é—®åˆ›å»ºå¯¹è±¡è¡¨è¾¾å¼çš„åŸŸå†…çš„å˜é‡ï¼Œè¿™ç‚¹å’Œ Java çš„åŒ¿åå†…éƒ¨ç±»æ˜¯ä¸€æ ·çš„ï¼Œ ä½†æ˜¯ Kotlin ä¸­ä¸éœ€è¦å°†å˜é‡å¼ºåˆ¶å£°æ˜Žä¸º final ï¼ŒðŸ‘ 12345678fun test()&#123; var t = 100 // ä¸å¿…å£°æ˜Žä¸º final val o1 = object : OneFunInterface &#123; override fun test(param: String) &#123; t = 10 &#125; &#125;&#125; å¯¹è±¡å£°æ˜Žå¯¹è±¡å£°æ˜Žï¼ˆObject declarationï¼‰ä¸å¯ä»¥æ˜¯å±€éƒ¨çš„(ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ç›´æŽ¥åµŒå¥—åœ¨å‡½æ•°ä¹‹å†…)ï¼Œ ä½†å¯ä»¥åµŒå¥—åœ¨å¦ä¸€ä¸ªå¯¹è±¡å£°æ˜Žä¹‹å†…ï¼Œæˆ–è€…åµŒå¥—åœ¨å¦ä¸€ä¸ªéžå†…éƒ¨ç±»ä¹‹å†…ã€‚ å¯¹è±¡å£°æ˜Žæ˜¯ å»¶è¿Ÿ(lazily) åˆå§‹åŒ–çš„ï¼Œ åªä¼šåœ¨é¦–æ¬¡è®¿é—®æ—¶æ‰ä¼šåˆå§‹åŒ– ä½¿ç”¨ object å…³é”®å­—åˆ›å»ºå•ä¾‹ï¼Œä¸èƒ½å…·æœ‰æž„é€ å™¨ï¼Œå¯ä»¥æŒ‡å®šåŸºç±»ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ç±»åå¼•ç”¨ã€‚ 12345678910object Singleton : User(name = "test", age = 12) &#123; fun testFun() &#123; Log.e(javaClass.simpleName, "name = $name") &#125; val testVal = age&#125;// usageSingleton.testFun()Singleton.testVal åŒä¼´å¯¹è±¡ï¼Œä¸€ä¸ªç±»å†…éƒ¨å¯¹è±¡å£°æ˜Žå¯ä»¥ä½¿ç”¨ companion å…³é”®å­—æ ‡è®°ä¸ºåŒä¼´å¯¹è±¡(Companion Object)ã€‚Companion Object å¯ä»¥å…·æœ‰è‡ªå·±çš„ç±»åï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨é»˜è®¤ç±»å Companionã€‚Companion Object å¯ä»¥ç»§æ‰¿åŸºç±»å’Œå®žçŽ°æŽ¥å£ã€‚ åŒä¼´å¯¹è±¡ä¼šåœ¨å¯¹åº”çš„ç±»è¢«è£…è½½(è§£æž)æ—¶åˆå§‹åŒ– è™½ç„¶åŒä¼´å¯¹è±¡çš„æˆå‘˜çœ‹èµ·æ¥å¾ˆåƒå…¶ä»–è¯­è¨€ä¸­çš„ç±»çš„é™æ€æˆå‘˜ï¼Œä½†åœ¨è¿è¡Œæ—¶æœŸï¼Œè¿™äº›æˆå‘˜ä»ç„¶æ˜¯çœŸå®žå¯¹è±¡çš„å®žä¾‹çš„æˆå‘˜ï¼Œå®ƒä»¬ä¸Žé™æ€æˆå‘˜æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ï¼Œå¦‚æžœä½¿ç”¨@JvmStatic æ³¨è§£ï¼Œ ä½ å¯ä»¥è®©åŒä¼´å¯¹è±¡çš„æˆå‘˜åœ¨ JVM ä¸Šè¢«ç¼–è¯‘ä¸ºçœŸæ­£çš„é™æ€æ–¹æ³•(static method)å’Œé™æ€åŸŸ(static field)ã€‚ 1234567891011121314151617181920212223242526// é»˜è®¤ç±»å Companionclass MyClass &#123; companion object &#123; fun testFun() &#123;&#125; val testVal = 10 &#125;&#125;// è‡ªå·±çš„ç±»åclass MyClass1 &#123; companion object MyCompanion &#123; fun testFun() &#123;&#125; val testVal = 10 &#125;&#125;// ç»§æ‰¿åŸºç±» å®žçŽ°æŽ¥å£class MyClass2 &#123; companion object : User(), OneFunInterface &#123; override fun test(param: String) &#123; &#125; fun testFun() &#123;&#125; val testVal = 10 &#125;&#125; æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨å¤–éƒ¨ç±»çš„ç±»åè°ƒç”¨å…¶åŒä¼´å¯¹è±¡çš„æ–¹æ³•å’Œå±žæ€§ 1234MyClass.CompanionMyClass1.MyCompanionMyClass.testValMyClass.testFun()]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-8-èŒƒåž‹]]></title>
    <url>%2Farticle%2F9e4433d5%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Kotlin èŒƒåž‹çš„ç›¸å…³ç”¨æ³•ã€‚ æ³›åž‹çš„æœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»åž‹ï¼Œæ“ä½œçš„æ•°æ®ç±»åž‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚ä½¿ç”¨èŒƒåž‹çº¦æŸï¼š å¢žåŠ ä»£ç çš„å¤ç”¨æ€§ï¼Œæœ‰æ—¶æˆ‘ä»¬ä½¿ç”¨ä¸€äº›å…¬ç”¨çš„æ•°æ®ç»“æž„ï¼Œæ–¹æ³•ï¼Œç±»ç­‰ï¼Œåªæ˜¯æ“ä½œçš„å¯¹è±¡ç±»åž‹ä¸ä¸€æ ·ï¼Œä½†æ˜¯ä»£ç é€»è¾‘ä¸€æ ·ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨èŒƒåž‹å¤ç”¨ä»£ç ï¼Œæ¯”å¦‚ List&lt;T&gt;ï¼Œå°±å¯ä»¥ç”¨æ¥å­˜å‚¨ä»»ä½•ä¸€ç§å¯¹è±¡ã€‚ ä¿è¯ä»£ç ä¸­ç±»åž‹è½¬æ¢çš„å®‰å…¨æ€§ï¼Œä½¿ç”¨èŒƒåž‹è¿›è¡Œçº¦æŸï¼Œèƒ½å¤Ÿä¿è¯åœ¨ç¼–è¯‘æœŸå¯¹ç±»åž‹çš„åŒ¹é…è¿›è¡Œæ£€æµ‹å’Œè½¬æ¢ï¼Œé¿å…è¿è¡ŒæœŸå‡ºçŽ°ç±»åž‹è½¬æ¢å¼‚å¸¸ï¼Œè€Œä¸”è¿™äº›è½¬æ¢éƒ½æ˜¯è‡ªåŠ¨å’Œéšå¼çš„ã€‚ æŽ¨èé˜…è¯» - Kotlin æ³›åž‹è¯¦è§£ - 10æ¡ ç®€å•å®žçŽ°ä¸‹é¢åœ¨ Java å’Œ Kotlin ä¸­å®žçŽ°äº†æœ€ç®€å•çš„èŒƒåž‹çš„ç”¨æ³•ï¼Œç”¨æ³•ç›¸ä¼¼ï¼Œä½†æ˜¯ Kotlin å°±æ›´åŠ ç®€å•ã€‚å½“ç±»åž‹å¯ä»¥é€šè¿‡æŽ¨æ–­å¾—åˆ°æ—¶ï¼Œä¸å¿…æ˜¾å¼å£°æ˜Žç±»åž‹ã€‚ 123456789101112131415// javaclass Box&lt;T&gt; &#123; private T t; public Box(T t) &#123; this.t = t; &#125; public T get() &#123; return t; &#125; public void set(T t) &#123; this.t = t; &#125;&#125;Box box = new Box&lt;&gt;(1); 1234// kotlinclass Box&lt;T&gt;(var t: T)val box = Box(1) Java ä¸­çš„èŒƒåž‹èŒƒåž‹ç±»åž‹æ˜¯ä¸å¯å˜çš„ï¼Œå› æ­¤ List&lt;Child&gt; å¹¶ä¸æ˜¯ List&lt;Parent&gt; çš„å­ç±»åž‹ 123456// List&lt;String&gt; ä¸æ˜¯ List&lt;Object&gt; çš„å­ç±»åž‹List&lt;Object&gt; objects = new ArrayList&lt;&gt;();List&lt;String&gt; strings = new ArrayList&lt;&gt;();objects = strings; // error. ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€æ®µä¼ªä»£ç ï¼Œå‡å¦‚ç±»åž‹æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆ List&lt;String&gt; å°±æ˜¯ List&lt;Object&gt; çš„å­ç±»ã€‚ 12345List&lt;Object&gt; objects = new ArrayList&lt;&gt;();List&lt;String&gt; strings = new ArrayList&lt;&gt;();objects = strings; objects.add(100);String s = strings.get(0); // ClassCastException ç”±äºŽèŒƒåž‹ç±»åž‹çš„ä¸å¯å˜ï¼Œå°½ç®¡ String æ˜¯ CharSequence çš„å­ç±»åž‹ï¼Œä½†æ˜¯æˆ‘ä»¬ç”šè‡³ä¸èƒ½ç®€å•çš„åšåˆ°å¦‚ä¸‹æ“ä½œï¼š 12345678910class Box&lt;T&gt; &#123; private T t; public void resetBox(Box&lt;T&gt; box) &#123; this.t = box.t; &#125;&#125;Box&lt;CharSequence&gt; charSequenceBox = new Box&lt;&gt;();Box&lt;String&gt; stringBox = new Box&lt;&gt;();charSequenceBox.resetBox(stringBox); // error,åœ¨ç¼–è¯‘æœŸç¦æ­¢æ­¤æ“ä½œ æ­£å› ä¸ºå¦‚æ­¤ï¼Œæ‰æœ‰äº† é€šé…ç¬¦ç±»åž‹å‚æ•° ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä¸‹å£°æ˜Ž resetBox() çš„æ–¹æ³• 123456class Box&lt;T&gt; &#123; private T t; public void resetBox(Box&lt;? extends T&gt; box) &#123; this.t = box.t; &#125;&#125; é€šé…ç¬¦ç±»åž‹å‚æ•°æˆ‘ä»¬å‚ç…§ List ç±»ï¼Œæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ 12345List&lt;? extends String&gt; extendsTStringList = new ArrayList&lt;&gt;();// error ä¸èƒ½å†™å…¥extendsTStringList.add("");// å¯ä»¥è¯»å–String s = extendsTStringList.get(0); è¿™é‡Œçš„ é€šé…ç¬¦ç±»åž‹å‚æ•° ? extends T è¡¨ç¤ºï¼Œé›†åˆå…ƒç´ çš„ç±»åž‹æ˜¯ T çš„æŸç§å­ç±»åž‹, è€Œä¸é™äºŽ T æœ¬èº«ï¼Œè¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ä»Žé›†åˆå…ƒç´ ä¸­ è¯»å– T (å› ä¸ºé›†åˆçš„å…ƒç´ æ˜¯ T çš„æŸä¸ªå­ç±»åž‹çš„å®žä¾‹)ï¼Œä½† ä¸èƒ½å†™å…¥ åˆ°é›†åˆä¸­åŽ»ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“ä»€ä¹ˆæ ·çš„å¯¹è±¡å®žä¾‹æ‰èƒ½ä¸Žè¿™ä¸ª T çš„æœªçŸ¥å­ç±»åž‹åŒ¹é…ã€‚æŒ‡å®šäº† extends è¾¹ç•Œ (ä¸Šè¾¹ç•Œ)çš„é€šé…ç¬¦ç±»åž‹, ä½¿å¾—æˆ‘ä»¬çš„ç±»åž‹æˆä¸ºä¸€ç§ åå˜(covariant) ç±»åž‹ã€‚ åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šç±»åž‹çš„ä¸‹è¾¹ç•Œ: 12345List&lt;? super String&gt; superTStringList = new ArrayList&lt;&gt;();// å¯ä»¥å†™å…¥superTStringList.add("");// ä¸èƒ½è¯»å–æˆ–åªèƒ½è¯»å–ä¸º object ç±»åž‹Object o = superTStringList.get(0); é€šé…ç¬¦ç±»åž‹å‚æ•° ? super T è¡¨ç¤ºï¼Œé›†åˆå…ƒç´ çš„ç±»åž‹æ˜¯ T çš„çˆ¶ç±»åž‹ï¼Œè€Œä¸é™äºŽ T æœ¬èº«ï¼Œæˆ‘ä»¬å¯ä»¥å‘é›†åˆä¸­æ·»åŠ å…ƒç´ ï¼Œå› ä¸ºé›†åˆä¸­çš„å…ƒç´ ä¸€å®šæ˜¯ T çš„çˆ¶ç±»åž‹ï¼Œä½†æˆ‘ä»¬ä¸èƒ½ä»Žé›†åˆä¸­è¯»å–å…ƒç´ ï¼Œæˆ–è€…è¯´åªèƒ½è¯»å–ä¸º object ç±»åž‹çš„å…ƒç´ ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“ä»€ä¹ˆæ ·çš„å¯¹è±¡æ‰èƒ½ä¸Ž T çš„æœªçŸ¥çˆ¶ç±»åž‹åŒ¹é…ã€‚æŒ‡å®šäº† super è¾¹ç•Œ (ä¸‹è¾¹ç•Œ)çš„é€šé…ç¬¦ç±»åž‹, ä½¿å¾—æˆ‘ä»¬çš„ç±»åž‹æˆä¸ºä¸€ç§ é€†å˜(contravariance)ã€‚ åå˜ï¼›å­ç±»å–ä»£çˆ¶ç±»çš„ä½ç½®æ˜¯è¢«å…è®¸çš„ï¼Œä¹Ÿå°±æ˜¯éœ€è¦çˆ¶ç±»åž‹æ—¶å¯ä»¥ä½¿ç”¨å­ç±»åž‹ä»£æ›¿é€†å˜ï¼›çˆ¶ç±»å–ä»£å­ç±»çš„ä½ç½®æ˜¯è¢«å…è®¸çš„ï¼Œä¹Ÿå°±æ˜¯éœ€è¦å­ç±»åž‹æ—¶å¯ä»¥ä½¿ç”¨çˆ¶ç±»åž‹ä»£æ›¿ä¸å˜ï¼›ä¸å…è®¸æ”¹å˜ç±»åž‹ã€‚ å¯¹äºŽåªèƒ½è¯»å–çš„å¯¹è±¡ï¼Œç§°ä¸º ç”Ÿäº§è€…ï¼Œå› ä¸ºå®ƒå¯ä»¥äº§å‡ºå¯¹è±¡ï¼Œå¯¹äºŽåªèƒ½å†™å…¥çš„å¯¹è±¡ç§°ä¸º æ¶ˆè´¹è€…ï¼Œå› ä¸ºå®ƒå¯ä»¥æ¶ˆè´¹å¯¹è±¡ï¼Œç”Ÿäº§è€…å¯¹åº” extendsï¼Œæ¶ˆè´¹è€…å¯¹åº” superã€‚ å£°æ˜Žå¤„ç±»åž‹å˜å¼‚æˆ‘ä»¬æœ‰å¦‚ä¸‹ Box ç±»ï¼Œå®ƒåªæœ‰è¯»å–æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åªèƒ½ç”Ÿäº§ T ç±»åž‹å¯¹è±¡ï¼Œä¸å­˜åœ¨æ¶ˆè´¹è€…æ–¹æ³•çš„è°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ Box&lt;Parent&gt; å­˜å‚¨ Box&lt;Child&gt; çš„æ•°æ®ï¼Œè¿™æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯åœ¨ java ä¸­ä¸èƒ½ç†è§£è¿™ä¸€ç‚¹ã€‚ 123456789class Box&lt;T&gt; &#123; public T find()&#123; return null; &#125;&#125;public void test(Box&lt;String&gt; stringBox) &#123; Box&lt;CharSequence&gt; objectBox = stringBox; // error&#125; ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»è¿›è¡Œå¦‚ä¸‹å£°æ˜Žæ‰èƒ½æ¶ˆé™¤é”™è¯¯ï¼Œä½†æ˜¯ä½¿ç”¨äº†æ›´åŠ å¤æ‚çš„å£°æ˜Žä¸Žä¸Šé¢æ‰€èƒ½è°ƒç”¨çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å¹¶ä¸èƒ½ç†è§£è¿™ä¸€ç‚¹ã€‚ 123public static void test(Box&lt;String&gt; stringBox) &#123; Box&lt;? extends CharSequence&gt; objectBox = stringBox;&#125; åœ¨ Kotlin ä¸­æˆ‘ä»¬ä½¿ç”¨åœ¨èŒƒåž‹å£°æ˜Žå¤„ä½¿ç”¨æ³¨è§£æ ‡æ³¨çš„æ–¹å¼å°†è¿™ç§æƒ…å†µå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œç”±äºŽè¿™ç§æ³¨è§£å‡ºçŽ°åœ¨å£°æ˜Žå¤„ï¼Œå› æ­¤ç§°ä¸º å£°æ˜Žå¤„ç±»åž‹å˜å¼‚(declaration-site variance) ï¼Œè¿™ç§æ–¹æ¡ˆä¸Ž Java ä¸­çš„ ä½¿ç”¨å¤„ç±»åž‹å˜å¼‚(use-site variance) åˆšå¥½ç›¸å, åœ¨ Java ä¸­, æ˜¯ç±»åž‹ä½¿ç”¨å¤„çš„é€šé…ç¬¦äº§ç”Ÿäº†ç±»åž‹çš„åå˜ã€‚æœ‰ä¸¤ç§æ³¨è§£ä¿®é¥°ç¬¦ï¼š out è¢«ç§°ä¸º åå˜æ³¨è§£(variance annotation)ï¼Œä»–è¡¨ç¤ºæ­¤ç±»åž‹åªèƒ½è¢«ç”Ÿäº§ï¼Œä¸èƒ½è¢«æ¶ˆè´¹ï¼Œä¹Ÿå°±æ˜¯åªèƒ½å‡ºçŽ°åœ¨è¿”å›žç±»åž‹ä¸­ï¼Œæ­¤æ—¶ Box&lt;Parent&gt; å¯ä»¥å®‰å…¨çš„ç”¨ä½œ Box&lt;Child&gt; çš„çˆ¶ç±»åž‹ã€‚ in è¢«ç§°ä¸º é€†å˜æ³¨è§£(contravariant annotation)ï¼Œä»–è¡¨ç¤ºæ­¤ç±»åž‹åªèƒ½è¢«æ¶ˆè´¹ï¼Œä¸èƒ½è¢«ç”Ÿäº§ï¼Œä¹Ÿå°±æ˜¯åªèƒ½å‡ºçŽ°åœ¨å‚æ•°ç±»åž‹ä¸­ï¼Œæ­¤æ—¶å¯ä»¥ç”¨ Box&lt;Child&gt; å®‰å…¨çš„æŽ¥å— Box&lt;Parent&gt; 12345678910111213interface Box1&lt;out T&gt;&#123; // errorï¼Œä¸èƒ½ä½œä¸ºå‚æ•°ç±»åž‹ fun testIn(t:T) // yes fun testOut(): T&#125;interface Box2&lt;in T&gt;&#123; // yes fun testIn(t:T) // errorï¼Œä¸èƒ½ä½œä¸ºè¿”å›žç±»åž‹ fun testOut(): T&#125; é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥è§£å†³ä¸Šé¢çš„å¤æ‚å£°æ˜Žçš„é—®é¢˜ 1234567fun test(box:Box1&lt;String&gt;)&#123; val box1:Box1&lt;CharSequence&gt; = box&#125;fun test(box:Box2&lt;CharSequence&gt;)&#123; val box2:Box2&lt;String&gt; = box&#125; åŒæ—¶çœ‹ä¸€ä¸‹å®˜ç½‘ Comparable ä½¿ç”¨é€†å˜æ³¨è§£çš„ä¾‹å­ 123456789abstract class Comparable&lt;in T&gt; &#123; abstract fun compareTo(other: T): Int&#125;fun demo(x: Comparable&lt;Number&gt;) &#123; x.compareTo(1.0) // 1.0 ç±»åž‹ä¸º Double, æ˜¯ Number çš„å­ç±»åž‹ // å› æ­¤, æˆ‘ä»¬å¯ä»¥å°† x èµ‹å€¼ç»™ Comparable&lt;Double&gt; ç±»åž‹çš„å˜é‡ val y: Comparable&lt;Double&gt; = x // OK!&#125; ç±»åž‹æŠ•å°„æˆ‘ä»¬æœ‰æ—¶å¹¶ä¸èƒ½ä¿è¯èŒƒåž‹ç±»åž‹åªä½œä¸ºè¿”å›žå€¼å‡ºçŽ°ï¼Œæˆ–åªä½œä¸ºå‚æ•°å‡ºçŽ°ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæœ‰æ›´å¤æ‚çš„éœ€æ±‚: 12345678class Box3&lt;T&gt; &#123; fun get(): T?&#123; return null &#125; fun set(t: T)&#123; &#125;&#125; å¦‚æžœæˆ‘ä»¬å†™ä¸€ä¸ª copy å‡½æ•° 123fun copyBox(to: Box3&lt;Any&gt;, from: Box3&lt;Any&gt;) &#123; to.set(from)&#125; ç”±äºŽèŒƒåž‹å‚æ•°ç±»åž‹çš„ä¸å˜æ€§ï¼Œå°±æ˜¯æˆ‘ä»¬æœ€åˆåœ¨ Java ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä¸‹é¢çš„è°ƒç”¨å°†æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œå› ä¸º Box&lt;String&gt; å¹¶ä¸æ˜¯ Box&lt;Any&gt; çš„å­ç±»ï¼Œè¿™ç§æ“ä½œæ˜¯ä¸ºäº†é¿å…å‘ from ä¸­è¿›è¡Œå†™å…¥æ“ä½œï¼Œæ¯”å¦‚ Int ç±»åž‹ï¼Œå¯¼è‡´ ClassCastExceptionã€‚ 123val from = Box3&lt;String&gt;()val to = Box3&lt;Any&gt;()copyBox(to,from) // error,required:Box3&lt;Any&gt; found:Box3&lt;String&gt; æˆ‘ä»¬éœ€è¦ä½¿ç”¨ out æ³¨è§£ï¼Œè¯´æ˜Žæˆ‘ä»¬åœ¨ copy å‡½æ•°ä¸­å¯¹ from ä¸ä¼šè¿›è¡Œå†™å…¥æ“ä½œã€‚ 1234567fun copyBox(to: Box3&lt;Any&gt;, from: Box3&lt;out Any&gt;) &#123; to.set(from)&#125;val from = Box3&lt;String&gt;()val to = Box3&lt;Any&gt;()copyBox(to,from) // ok åŒç†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ in æ³¨è§£æ¥å£°æ˜Žæˆ‘ä»¬ä¸ä¼šå¯¹å¯¹è±¡è¿›è¡Œè¯»å–æ“ä½œï¼Œå¦‚ä¸‹ 1234567891011121314fun fill(dest: Box3&lt;String&gt;, value: String) &#123; // ...&#125;val dest = Box3&lt;CharSequence&gt;()fill(dest,"") // errorfun fill(dest: Box3&lt;in String&gt;, value: String) &#123; // ...&#125;val dest = Box3&lt;CharSequence&gt;()fill(dest,"") // ok è¿™ç§å£°æ˜Žåœ¨ Kotlin ä¸­ç§°ä¸º ç±»åž‹æŠ•å°„(type projection)ï¼Œä»–ç”¨æ¥å£°æ˜Žè¯¥ç±»åž‹ä¸æ˜¯ä¸€ä¸ªç®€å•çš„ç±»åž‹ï¼Œè€Œæ˜¯ä¸€ä¸ªè¢«é™åˆ¶çš„ç±»åž‹ï¼Œæˆ‘ä»¬åªèƒ½å¯¹è¯¥ç±»åž‹è¿›è¡Œè¯»å–æˆ–å†™å…¥æ“ä½œï¼Œä»Žè€Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œè¿™æ˜¯ Kotlin ä½¿ç”¨å¤„ç±»åž‹å˜å¼‚ çš„å®žçŽ°æ–¹å¼ï¼Œä¸Ž Java ä¸­çš„é€šé…ç¬¦ç›¸ä¼¼ï¼Œä½†æ˜¯æ›´ç®€å•ã€‚ æ˜Ÿå·æŠ•å°„æ˜Ÿå·æŠ•å°„ï¼ˆStar-projectionï¼‰ æœ‰æ—¶å¯èƒ½æƒ³è¡¨ç¤ºä½ å¹¶ä¸çŸ¥é“ç±»åž‹å‚æ•°çš„ä»»ä½•ä¿¡æ¯ï¼Œä½†æ˜¯ä»ç„¶å¸Œæœ›èƒ½å¤Ÿå®‰å…¨åœ°ä½¿ç”¨å®ƒã€‚è¿™é‡Œæ‰€è°“â€å®‰å…¨åœ°ä½¿ç”¨â€æ˜¯æŒ‡ï¼Œå¯¹æ³›åž‹ç±»åž‹å®šä¹‰ä¸€ä¸ªç±»åž‹æŠ•å°„ï¼Œè¦æ±‚è¿™ä¸ªæ³›åž‹ç±»åž‹çš„æ‰€æœ‰çš„å®žä½“å®žä¾‹ï¼Œéƒ½æ˜¯è¿™ä¸ªæŠ•å°„çš„å­ç±»åž‹ã€‚ æ˜Ÿå·æŠ•å°„ä¸Ž Java çš„åŽŸç”Ÿç±»åž‹(raw type)éžå¸¸ç±»ä¼¼ï¼Œä½†å¯ä»¥å®‰å…¨ä½¿ç”¨ã€‚ ä¸‹é¢æ˜¯å®˜æ–¹çš„è¯´æ³•ï¼š 12345å¯¹äºŽ Foo&lt;out T&gt;ï¼Œå…¶ä¸­ T æ˜¯ä¸€ä¸ªå…·æœ‰ä¸Šç•Œ TUpper çš„åå˜ç±»åž‹å‚æ•°ï¼ŒFoo&lt;*&gt; ç­‰ä»·äºŽ Foo&lt;out TUpper&gt;ã€‚ è¿™æ„å‘³ç€å½“ T æœªçŸ¥æ—¶ï¼Œä½ å¯ä»¥å®‰å…¨åœ°ä»Ž Foo&lt;*&gt; è¯»å– TUpper çš„å€¼ã€‚å¯¹äºŽ Foo&lt;in T&gt;ï¼Œå…¶ä¸­ T æ˜¯ä¸€ä¸ªé€†å˜ç±»åž‹å‚æ•°ï¼ŒFoo&lt;*&gt; ç­‰ä»·äºŽ Foo&lt;in Nothing&gt;ã€‚ è¿™æ„å‘³ç€å½“ T æœªçŸ¥æ—¶ï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥ä»¥å®‰å…¨çš„æ–¹å¼å†™å…¥ Foo&lt;*&gt;ã€‚å¯¹äºŽ Foo&lt;T&gt;ï¼Œå…¶ä¸­ T æ˜¯ä¸€ä¸ªå…·æœ‰ä¸Šç•Œ TUpper çš„ä¸åž‹å˜ç±»åž‹å‚æ•°ï¼ŒFoo&lt;*&gt; å¯¹äºŽè¯»å–å€¼æ—¶ç­‰ä»·äºŽ Foo&lt;out TUpper&gt; è€Œå¯¹äºŽå†™å€¼æ—¶ç­‰ä»·äºŽ Foo&lt;in Nothing&gt;ã€‚ åœ¨ä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨ æ˜Ÿå·æŠ•å°„ï¼Œä»€ä¹ˆæ—¶å€™ä¸å¯ä»¥ 12345678910111213141516171819// error ä¸å…è®¸ä½œä¸ºå˜é‡çš„çš„èŒƒåž‹å‚æ•°val list = ArrayList&lt;*&gt;()// error ä¸å…è®¸ä½œä¸ºå‡½æ•°çš„èŒƒåž‹å‚æ•°fun &lt;T&gt; hello(args: Array&lt;T&gt;)&#123;&#125; hello&lt;*&gt;(args)// error ä¸å…è®¸ä½œä¸ºçˆ¶ç±»çš„èŒƒåž‹å‚æ•°interface Foo&lt;T&gt; class Bar : Foo&lt;*&gt;// yes å°½ç®¡ * ä¸èƒ½ç›´æŽ¥ä½œä¸ºç±»çš„æ³›åž‹å‚æ•°ï¼ŒFoo&lt;*&gt; å´å¯ä»¥ï¼ŒæŒ‰ç…§å‰é¢å®˜æ–¹ç»™å‡ºçš„è¯´æ³•ï¼Œå®ƒåœ¨è¯»æ—¶ç­‰ä»·äºŽFoo&lt;out Any&gt; å†™æ—¶ç­‰ä»·äºŽ Foo&lt;in Nothing&gt;interface Foo&lt;T&gt; class Bar : Foo&lt;Foo&lt;*&gt;&gt; // yes è¿™è¡¨ç¤ºæŽ¥å—çš„å‚æ•°çš„ç±»åž‹åœ¨è¯»å†™æ—¶åˆ†åˆ«ç­‰ä»·äºŽArray&lt;out Any&gt; å’Œ Array&lt;in Nothing&gt; fun hello(args: Array&lt;*&gt;)&#123; ... &#125; Raw ç±»åž‹å°±æ˜¯å¯¹äºŽå®šä¹‰æ—¶æœ‰æ³›åž‹å‚æ•°è¦æ±‚ï¼Œä½†åœ¨ä½¿ç”¨æ—¶æŒ‡å®šæ³›åž‹å‚æ•°çš„æƒ…å†µï¼Œè¿™ä¸ªåªåœ¨ Java ä¸­æœ‰ï¼Œæ˜¾ç„¶ä¹Ÿæ˜¯ä¸ºäº†å‰å‘å…¼å®¹ã€‚åœ¨ Java ä¸­æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹å£°æ˜Ž 1List list = new ArrayList(); è¿™æ ·çš„å£°æ˜Žåœ¨ Kotlin ä¸­æ˜¯ä¸å…è®¸çš„ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ 1val list = ArrayList&lt;Any?&gt;() åœ¨ Java ä¸­å¯ä»¥æœ‰è¿™æ ·çš„å†™æ³•ï¼Œä¼šå¼•å‘å¼‚å¸¸ 123List&lt;Integer&gt; integers = new ArrayList&lt;&gt;(); List list = new ArrayList(); list = integers; åœ¨ Kotlin ä¸­è¿™æ ·çš„å†™æ³•æ˜¯é”™è¯¯çš„ 123var list = ArrayList&lt;Any?&gt;() val integers = ArrayList&lt;Int&gt;() list = integers // ERROR! èŒƒåž‹å‡½æ•°å‡½æ•°ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨èŒƒåž‹å‚æ•°ç±»åž‹ 123456789fun &lt;T&gt; test(t:T):List&lt;T&gt;&#123; return mutableListOf(t)&#125;fun &lt;T&gt; Context.test(t:T):List&lt;T&gt;&#123; return mutableListOf(t)&#125;var testGenericFun = testGenericFun(1)var testGenericFunInContext = testGenericFunInContext(1) èŒƒåž‹çº¦æŸçº¦æŸèŒƒåž‹çš„ä¸Šç•Œ å¦‚ä¸‹èŒƒåž‹å‚æ•° T å¿…é¡»æ˜¯ Box&lt;T&gt; çš„å­ç±» å¦‚æžœæœ‰å¤šä¸ªä¸Šé™ï¼Œåˆ™éœ€è¦ä½¿ç”¨ where å­—å¥ å¦‚æžœä¸Šé™çš„å¯¹è±¡å¸¦æœ‰èŒƒåž‹å‚æ•°çš„å£°æ˜Žå¤„ç±»åž‹ç¼–è¯‘æ³¨è§£ï¼Œåˆ™å½“å‰å£°æ˜Žä¹Ÿéœ€è¦åŒæ­¥ 1234567891011class Box4&lt;T : Box&lt;T&gt;&gt; &#123;&#125;class Box5&lt;T&gt; where T : Box&lt;T&gt;, T : Cloneable &#123;&#125;class Box6&lt;out T&gt; where T : Box1&lt;T&gt;, T : Cloneable &#123;&#125; åœ¨å‡½æ•°ä¸­çº¦æŸèŒƒåž‹ä¸Šç•Œ 1234567fun &lt;T : Box&lt;T&gt;&gt;test1(t:T)&#123;&#125;fun &lt;T&gt; test2(t:T) where T : Box&lt;T&gt;, T : Cloneable&#123;&#125;]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-7-ç‰¹æ®Šç±»]]></title>
    <url>%2Farticle%2Faa2c40d4%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦å…³äºŽ Kotlin ä¸­çš„ç‰¹æ®Šç±»ï¼ŒåŒ…æ‹¬ï¼š æ•°æ®ç±»ï¼šæ•°æ®ç±»çš„ä½¿ç”¨æœ‰è¯¸å¤šé™åˆ¶ï¼Œå®ƒå£°æ˜Žäº†ä¸€ç§æ•°æ®ç»“æž„ï¼Œè¿›è¡Œæ•°æ®çš„å­˜å‚¨ã€‚ åµŒå¥—ç±»ï¼šç›¸å½“äºŽ java ä¸­çš„é™æ€å†…éƒ¨ç±»ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨å¤–éƒ¨ç±»ååˆ›å»ºã€‚ å†…éƒ¨ç±»ï¼šç›¸å½“äºŽ java ä¸­çš„å†…éƒ¨ç±»ï¼Œéœ€è¦ä½¿ç”¨å¤–éƒ¨ç±»å®žä¾‹æ‰èƒ½åˆ›å»ºã€‚ åŒ¿åå†…éƒ¨ç±»ï¼šä½¿ç”¨ object å…³é”®å­—åˆ›å»ºçš„åªç”¨ä¸€æ¬¡çš„ç±»å®žçŽ°ã€‚ æžšä¸¾ç±»ï¼šæ¯” java æ›´å¼ºå¤§çš„æžšä¸¾å®žçŽ°ã€‚ æ•°æ®ç±»æ•°æ®ç±»æ˜¯ä¸€ç§ç‰¹åˆ«çš„ç±»ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç”¨æ¥ç»“æž„åŒ–çš„å­˜æ”¾æ•°æ®çš„ç±»ï¼Œåœ¨ Kotlin ä¸­å¯ä»¥ä½¿ç”¨å…³é”®å­— data æ¥å¾ˆç®€å•çš„å£°æ˜Žä¸€ä¸ªæ•°æ®ç±»ã€‚ 123data class Person(val name: String = "123", val age: Int = 123)data class User(val name: String, val age: Int) å¦‚æžœåœ¨æ•°æ®ç±»ä¸­å¯¹ä»¥ä¸‹å‡½æ•°æ²¡æœ‰æ˜Žç¡®çš„å®šä¹‰ï¼Œä¹Ÿæ²¡æœ‰ä»Žçˆ¶ç±»ä¸­ç»§æ‰¿å¾—åˆ°ï¼Œé‚£ä¹ˆæ•°æ®ç±»ä¼šè‡ªåŠ¨ç”Ÿæˆè¿™äº›å‡½æ•°ï¼Œå¦‚ hashCode() å’Œ equals() å‡½æ•°å¯¹ã€Person(name=c, age=3) å½¢å¼çš„ toString() æ–¹æ³•ã€ç”¨æ¥è®¿é—®å±žæ€§å€çš„ componentN() å‡½æ•°ç¾¤ã€ç”¨æ¥å¤åˆ¶å¯¹è±¡ copy() æ–¹æ³•ã€‚ 123456789101112// åˆ›å»ºæ•°æ®ç±»å¯¹è±¡val p: Person = Person("a", 1)val p1 = Person("b", 2)// equals() &amp; hasoCode()log(p.equals(p1))// toString()log(p.toString())// componentNlog(p.component1() + " " + p.component2())// copy()ï¼Œcopy çš„å¯¹è±¡å°†ä¼šæ˜¯ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡val p2 = p.copy("c", 3)log( "$&#123;p2.hashCode()&#125; $&#123;p.hashCode()&#125; $p2") è¾“å‡º 1234MainActivity: falseMainActivity: Person(name=a, age=1)MainActivity: a 1MainActivity: 3072 3008 Person(name=c, age=3) æ•°æ®ç±»åº”è¯¥æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š ä¸»æž„é€ å™¨è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¦‚æžœéœ€è¦æ— å‚æž„é€ æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æŒ‡å®šé»˜è®¤å€¼çš„æ–¹å¼å®žçŽ°ã€‚ ä¸»æž„é€ å™¨çš„æ‰€æœ‰å‚æ•°éƒ½å¿…é¡»æ ‡è®°ä¸º var æˆ– valï¼Œåƒ data class Use2(name: String, age: Int) è¿™æ ·æ˜¯ä¸å…è®¸çš„ã€‚ æ•°æ®ç±»ä¸èƒ½æ˜¯ æŠ½è±¡ç±»ï¼Œopen ç±» ï¼Œå°é—­(sealed)ç±» æˆ– å†…éƒ¨ç±» æ•°æ®ç±»ä¸èƒ½ç»§æ‰¿è‡ªå…¶ä»–ç±»ï¼Œä½†æ˜¯å¯ä»¥å®žçŽ°æŽ¥å£ã€‚ copy å‡½æ•°è‡ªåŠ¨ç”Ÿæˆçš„ copy() å‡½æ•°ç”¨æ¥å®žçŽ°æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶ä¿®æ”¹éƒ¨åˆ†å±žæ€§ï¼Œä½†æ˜¯ä¿ç•™å…¶ä»–å±žæ€§çš„å€¼çš„åŠŸèƒ½ã€‚ è‡ªåŠ¨ç”Ÿæˆçš„ copy() å‡½æ•°å°†ä¼šæ˜¯è¿™æ ·çš„ 1fun copy(name: String = this.name, age: Int = this.age) = User(name, age) è§£æž„æ•°æ®ç±»é»˜è®¤ç”Ÿæˆäº† componentN() ç»„ä»¶å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•å¿«é€ŸèŽ·å–æ•°æ®ç±»ä¸­å±žæ€§çš„å€¼ 123val p: Person = Person("a", 1)val (myName,myAge) = plog("name = $myName,age = $myAge") åµŒå¥—ç±»ç±»å¯ä»¥åµŒå¥—åœ¨å¦ä¸€ä¸ªç±»ä¸­ï¼Œç§°ä¸º åµŒå¥—ç±»ï¼ˆNested Classï¼‰ï¼Œå…¶å®žç›¸å½“äºŽ Java ä¸­çš„é™æ€å†…éƒ¨ç±»ï¼Œä¸è¿‡åœ¨ Java ä¸­è¿™æ ·ä»€ä¹ˆå…³é”®å­—éƒ½ä¸åŠ çš„æƒ…å†µé»˜è®¤å£°æ˜Žçš„æ˜¯å†…éƒ¨ç±»ï¼Œè€Œ Kotlin é»˜è®¤æ˜¯åµŒå¥—ç±»ï¼Œä¹Ÿå°±æ˜¯é™æ€å†…éƒ¨ç±»ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ å¤–éƒ¨ç±»ç±»å.åµŒå¥—ç±»å æ¥è®¿é—®åˆ›å»ºåµŒå¥—ç±»å¯¹è±¡ã€‚ 123456class OuterClass &#123; class NestedClass(val name: String)&#125;// å¯ä»¥ç›´æŽ¥åˆ›å»ºï¼Œä¸ä¾èµ–å¤–éƒ¨ç±»å¯¹è±¡val nested = OuterClass.NestedClass("nest") å†…éƒ¨ç±»Kotlin ä¸­çš„å†…éƒ¨ç±»å’Œ Java ä¸­çš„å†…éƒ¨ç±»ä¸€æ ·ï¼Œä½†æ˜¯ kotlin ä¸­è¦ç”¨ inner å…³é”®å­—å£°æ˜Žæ˜¯å†…éƒ¨ç±»ï¼Œå¦åˆ™é»˜è®¤æ˜¯åµŒå¥—ç±»ã€‚ ä½¿ç”¨ inner å…³é”®å­—å£°æ˜Žçš„å†…éƒ¨ç±»ï¼Œå¯ä»¥è‡ªç”±è®¿é—®å¤–éƒ¨ç±»æˆå‘˜å±žæ€§ï¼Œå†…éƒ¨ç±»ä¼šæŒæœ‰ä¸€ä¸ªå¤–éƒ¨ç±»çš„å¼•ç”¨ï¼ŒæŒ‡å‘å¤–éƒ¨ç±»å¯¹è±¡å®žä¾‹ã€‚ å½“å±žæ€§å†²çªæ—¶ï¼Œå°†ä¼˜å…ˆä½¿ç”¨å†…éƒ¨ç±»æˆå‘˜ï¼Œå¦‚æžœæƒ³è®¿é—®å¤–éƒ¨ç±»æˆå‘˜å¯ä»¥ä½¿ç”¨å¸¦é™å®šç¬¦çš„ this è¡¨è¾¾å¼ã€‚ å†…éƒ¨ç±»æ˜¯ä¸èƒ½ç›´æŽ¥åˆ›å»ºçš„ï¼Œéœ€è¦ä½¿ç”¨å¤–éƒ¨ç±»å¯¹è±¡æ‰èƒ½åˆ›å»ºã€‚ 12345678910111213141516171819202122232425262728293031class OuterClass &#123; class NestedClass(val name: String) val myVal = 100 val myVal1 = 100 inner class InnerClass()&#123; val myVal = 10 fun test():String&#123; // å½“å±žæ€§å†²çªæ—¶ï¼Œå°†ä¼˜å…ˆä½¿ç”¨å†…éƒ¨ç±»æˆå‘˜ // å¦‚æžœæƒ³è®¿é—®å¤–éƒ¨ç±»æˆå‘˜å¯ä»¥ä½¿ç”¨å¸¦é™å®šç¬¦çš„thisè¡¨è¾¾å¼ return "$myVal $myVal1 $&#123;this@OuterClass.myVal&#125;" &#125; &#125;// å¿…é¡»ä¾èµ–å¤–éƒ¨ç±»å¯¹è±¡æ‰èƒ½åˆ›å»ºval inner = OuterClass().InnerClass()``` ## åŒ¿åå†…éƒ¨ç±»åŒ¿åå†…éƒ¨ç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„ç”¨æ³•ï¼Œé€‚ç”¨äºŽåªéœ€è¦åˆ›å»ºä¸€æ¬¡ä½¿ç”¨ä¸€æ¬¡çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸ºæŽ§ä»¶è®¾ç½®ç›‘å¬ã€‚åŒ¿åå†…éƒ¨ç±»ä½¿ç”¨ `object` å…³é”®å­—çš„å¯¹è±¡è¡¨è¾¾å¼å£°æ˜Žï¼Œå…¶å®žä¸‹é¢ä¸­ç›‘å¬çš„è®¾ç½®ä¸å¿…è¿™ä¹ˆå¤æ‚ï¼Œè¿™æ˜¯æœ€åŽŸå§‹çš„ç‰ˆæœ¬ã€‚```kotlinmMyMsgTv.setOnClickListener(object : View.OnClickListener&#123; override fun onClick(v: View?) &#123; log("click") &#125;&#125;) å¦‚æžœåŒ¿åå†…éƒ¨ç±»å¯¹è±¡æ˜¯åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æŽ¥å£ï¼Œå¯ä»¥ä½¿ç”¨å¸¦æœ‰æŽ¥å£åç§°å‰ç¼€çš„ lambda è¡¨è¾¾å¼ç®€åŒ–åˆ›å»ºè¿™ä¸ªå¯¹è±¡ï¼Œç®€åŒ–ç‰ˆæœ¬ï¼š 123mMyMsgTv.setOnClickListener &#123; log("click")&#125; æžšä¸¾ç±»åˆ›å»ºä¸€ä¸ªç®€å•çš„æžšä¸¾ç±» 123enum class EnumClass&#123; ONE,TOW,THREE&#125; æ¯ä¸ªæžšä¸¾å€¼éƒ½æ˜¯æžšä¸¾ç±»çš„ä¸€ä¸ªå®žä¾‹ï¼Œå› æ­¤å¯ä»¥è¢«åˆå§‹åŒ–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ name å’Œ ordinal æ˜¯çˆ¶ç±»ä¸­å·²ç»å­˜åœ¨çš„ä¸å…è®¸è¢«é‡å†™çš„å±žæ€§ï¼Œå› æ­¤è‡ªå®šä¹‰çš„å±žæ€§ä¸èƒ½ä½¿ç”¨è¿™äº›ã€‚ 123enum class EnumClass2(val desc:String)&#123; ONE("one"),TOW("two"),THREE("three")&#125; æžšä¸¾å¯ä»¥å…·æœ‰è‡ªå·±çš„å±žæ€§å’Œå‡½æ•°ï¼Œä¹Ÿå¯ä»¥é‡å†™çˆ¶ç±»ä¸­çš„æ–¹æ³• 12345678910111213141516171819202122enum class EnumClass3(val desc: String) &#123; ONE("one") &#123; override fun log(): String &#123; return "one" &#125; &#125;, TOW("two") &#123; override fun log(): String &#123; return "two" &#125; &#125;, THREE("three") &#123; override fun log(): String &#123; return "three" &#125; &#125;; // å±žæ€§ val myVal = 100 // å‡½æ•° fun test() &#123;&#125; abstract fun log(): String&#125; æ¯ä¸ªæžšä¸¾éƒ½å…·æœ‰ name å’Œ ordinal å±žæ€§ï¼Œå¹¶ä¸”å®žçŽ°äº† Compaable æŽ¥å£ 1234567EnumClass1.ONE.nameEnumClass1.ONE.ordinal// è½¬åŒ–ä¸ºä¸€ä¸ªæžšä¸¾ç±»å¯¹è±¡var enumClass1:EnumClass1 = EnumClass1.valueOf("one")// æžšä¸¾ç±»å¯¹è±¡åˆ—è¡¨var values:Array&lt;EnumClass1&gt; = EnumClass1.values()]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-6-æ‰©å±•]]></title>
    <url>%2Farticle%2Fd0378250%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Kotlin æ‰©å±• ( Extension )çš„ç›¸å…³å†…å®¹ã€‚ ä»¥ä¸‹ç¿»è¯‘è‡ªå®˜æ–¹æ–‡æ¡£ï¼š ä¸Ž C# å’Œ Gosu ç±»ä¼¼ï¼Œ Kotlin æä¾›äº†å‘ä¸€ä¸ªç±»æ‰©å±•æ–°åŠŸèƒ½çš„èƒ½åŠ›ï¼Œ è€Œä¸”ä¸å¿…ä»Žè¿™ä¸ªç±»ç»§æ‰¿ï¼Œä¹Ÿä¸å¿…ä½¿ç”¨ä»»ä½•è®¾è®¡æ¨¡å¼ï¼Œ æ¯”å¦‚ Decorator æ¨¡å¼ä¹‹ç±»ã€‚ è¿™ç§åŠŸèƒ½æ˜¯é€šè¿‡ä¸€ç§ç‰¹æ®Šçš„å£°æ˜Žæ¥å®žçŽ°çš„ï¼Œ Kotlin ä¸­ç§°ä¸º æ‰©å±•(extension)ã€‚Kotlin æ”¯æŒ æ‰©å±•å‡½æ•°(extension function) å’Œ æ‰©å±•å±žæ€§(extension property)ã€‚ æ‰©å±• æ˜¯å¾ˆå¤šé«˜çº§è¯­è¨€éƒ½å…·å¤‡çš„ç‰¹æ€§ï¼Œä½¿ç”¨æ‰©å±•å¯ä»¥åœ¨ä¸ä¾µå…¥åŽŸæ¥ç±»çš„åŸºç¡€ä¸Šæ‰©å±•æ–°çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ Utils æ–¹æ³•ï¼Œå°±å¯ä»¥å®Œå…¨ä½¿ç”¨æ‰©å±•æ–¹æ³•æ¥æ›¿ä»£ã€‚ æ‰©å±•å‡½æ•°æ‰©å±•å‡½æ•°éœ€è¦å£°æ˜Žåœ¨top-level çº§åˆ«ä¸‹ï¼Œå¦‚æžœå£°æ˜Žåœ¨ä¸€ä¸ªç±»é‡Œé¢ï¼Œé‚£ä¹ˆåªèƒ½åœ¨è¿™ä¸ªç±»å†…ä½¿ç”¨ï¼Œä¹Ÿå°±å¤±åŽ»äº†æ‰©å±•çš„æ„ä¹‰ã€‚æˆ‘å¼€å§‹å†™çš„æ—¶å€™å› ä¸ºå†™ java çš„æƒ¯æ€§ï¼Œå°±å£°æ˜Žåœ¨ç±»é‡Œé¢ï¼Œç»“æžœåˆ«çš„åœ°æ–¹æ ¹æœ¬ç”¨ä¸äº†ï¼Œä¸€åº¦ååˆ†æ€€ç–‘æ‰©å±•å­˜åœ¨çš„æ„ä¹‰ã€‚ã€‚ã€‚ å£°æ˜Žçš„æ–¹å¼ä¸Žæ™®é€šå‡½æ•°ç¨æœ‰ä¸åŒï¼Œåœ¨å‡½æ•°åå‰é¢è¦ä½¿ç”¨æ‰©å±•çš„æŽ¥æ”¶è€…ï¼Œæ‰©å±•çš„æŽ¥æ”¶è€…å°±æ˜¯æˆ‘ä»¬è¦æ‰©å±•çš„å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š 123fun æ‰©å±•æŽ¥æ”¶è€….å‡½æ•°å:è¿”å›žç±»åž‹(å‚æ•°åˆ—è¡¨)&#123; å‡½æ•°ä½“&#125; å…ˆæ¥å£°æ˜Žä¸¤ä¸ªæ‰©å±•å‡½æ•°çœ‹çœ‹æ•ˆæžœ 1234567891011// ExtensionTest.ktfun Context.extensionLog(msg: String) &#123; Log.e(this.javaClass.simpleName, msg)&#125;fun &lt;E&gt;MutableList&lt;E&gt;.swap(index1:Int,index2:Int)&#123; val temp = this[index1] this[index1] = this[index2] this[index2] = temp&#125; åœ¨ MainActivity.kt ä¸­ä½¿ç”¨å®ƒä»¬ 123456extensionLog("æµ‹è¯•æ‰©å±•å‡½æ•°")val list = mutableListOf("str1","str2")extensionLog(list.toString())list.swap(0,1)extensionLog(list.toString()) è¾“å‡ºç»“æžœï¼š 123com.march.ktexample E/MainActivity: æµ‹è¯•æ‰©å±•å‡½æ•°com.march.ktexample E/MainActivity: [str1, str2]com.march.ktexample E/MainActivity: [str2, str1] æ€»ç»“ä¸€ä¸‹ï¼š æ‰©å±•å‡½æ•°çš„å£°æ˜Žå¯¹å­ç±»æ˜¯æœ‰æ•ˆçš„ï¼Œ æ¯”å¦‚æˆ‘ä»¬ç»™ Context ç±»æ‰©å±•ï¼Œé‚£ä¹ˆ Context æ‰€æœ‰å­ç±»éƒ½å¯ä»¥ä½¿ç”¨æ‰©å±•å‡½æ•°ï¼Œæ‰©å±•è™½ç„¶ä¸æ˜¯ç»§æ‰¿ï¼Œä½†æ˜¯å´å…·æœ‰å’Œç»§æ‰¿ç±»ä¼¼çš„æ•ˆæžœã€‚ åœ¨æ‰©å±•å‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨ this å…³é”®å­—ï¼Œè®¿é—®å½“å‰æ‰©å±•æŽ¥æ”¶è€…å¯¹è±¡ã€‚ æ‰©å±•å‡½æ•°çš„é™æ€è§£æžæ‰©å±•å‡½æ•°å¹¶ä¸æ˜¯çœŸçš„ç»™æ‰©å±•æŽ¥æ”¶è€…çš„ç±»å¢žåŠ äº†æ–°çš„æ–¹æ³•ï¼Œä»–åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥è®©æ‰©å±•æŽ¥æ”¶è€…çš„ç±»ä½¿ç”¨ç‚¹å·çš„å½¢å¼åŽ»è°ƒç”¨è€Œå·²ï¼Œå¯¹åŽŸæ¥çš„ç±»æœ¬èº«æ²¡æœ‰ä»»ä½•å½±å“ã€‚ æ‰©å±•å‡½æ•°çš„è°ƒç”¨æ´¾å‘è¿‡ç¨‹æ˜¯é™æ€çš„ï¼Œè¿™å°±æ„å‘³ç€ï¼Œè°ƒç”¨æ‰©å±•å‡½æ•°æ—¶ï¼Œå…·ä½“è¢«è°ƒç”¨çš„å‡½æ•°æ˜¯å“ªä¸€ä¸ªï¼Œæ˜¯é€šè¿‡è°ƒç”¨å‡½æ•°çš„å¯¹è±¡è¡¨è¾¾å¼çš„ç±»åž‹æ¥å†³å®šçš„ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶åˆ»è¡¨è¾¾å¼åŠ¨æ€è®¡ç®—çš„æœ€ç»ˆç»“æžœç±»åž‹å†³å®šçš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æžœæœ‰å¤šä¸ªæ‰©å±•è°ƒç”¨ï¼Œé‚£ä¹ˆè°ƒç”¨å“ªä¸€ä¸ªå–å†³äºŽä½ ä½¿ç”¨å“ªç§ç±»åž‹åŽ»è°ƒç”¨ã€‚ 12345678910111213141516171819202122232425open class Aclass B : A()fun A.extension(): String &#123; return "açš„æ‰©å±•"&#125;fun B.extension(): String &#123; return "bçš„æ‰©å±•"&#125;// ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œæ‰©å±•å‡½æ•°çš„å®žé™…è°ƒç”¨ç”±è°ƒç”¨ä»–çš„ç±»å†³å®š// å› æ­¤è¿™é‡Œä¸ç®¡ä¼ ä»€ä¹ˆç±»åž‹çš„å€¼ï¼Œéƒ½ä¼šæ˜¯è°ƒç”¨ A çš„æ‰©å±•å‡½æ•°fun printExtension(a:A)&#123; extensionLog(a.extension())&#125;// è°ƒç”¨ A çš„æ‰©å±•extensionLog(A().extension())// è°ƒç”¨ B çš„æ‰©å±•extensionLog(B().extension())// è°ƒç”¨ A çš„æ‰©å±•printExtension(A())// è°ƒç”¨ A çš„æ‰©å±•printExtension(B()) è¾“å‡ºç»“æžœ 1234com.march.ktexample E/MainActivity: açš„æ‰©å±•com.march.ktexample E/MainActivity: bçš„æ‰©å±•com.march.ktexample E/MainActivity: açš„æ‰©å±•com.march.ktexample E/MainActivity: açš„æ‰©å±• æˆå‘˜å‡½æ•°ä¼˜å…ˆå½“æ‰©å±•å‡½æ•°å’Œæˆå‘˜å‡½æ•°éƒ½å­˜åœ¨æ—¶ï¼Œç›¸åŒçš„å‡½æ•°æ˜¯è¯´å‡½æ•°åä¸Žå‚æ•°åˆ—è¡¨éƒ½ç›¸åŒï¼Œä¼˜å…ˆä½¿ç”¨æˆå‘˜å‡½æ•°ã€‚ 123456789101112131415161718192021// B æœ‰æˆå‘˜å‡½æ•°class B &#123; fun extension(): String &#123; return "bçš„æˆå‘˜" &#125;&#125;// B æœ‰æ‰©å±•å‡½æ•°fun B.extension(): String &#123; return "bçš„æ‰©å±•"&#125;// å°†ä¼˜å…ˆä½¿ç”¨æˆå‘˜å‡½æ•°fun printExtension(b:B)&#123; extensionLog(b.extension())&#125;printExtension(B())ç»“æžœï¼šcom.march.ktexample E/MainActivity: bçš„æˆå‘˜ å¯ä¸ºç©ºçš„æŽ¥æ”¶è€…ä½¿ç”¨å¯ä¸ºç©ºçš„ç±»åž‹ä½œä¸ºæ‰©å±•æŽ¥æ”¶è€…æ—¶ï¼Œå³ä½¿è°ƒç”¨çš„å¯¹è±¡ä¸ºç©ºä»ç„¶å¯ä»¥è°ƒç”¨ï¼Œä¸ä¼šç©ºæŒ‡é’ˆï¼Œå¯ä»¥åœ¨æ‰©å±•æ–¹æ³•å†…æ£€æµ‹æŽ¥å—è€…æ˜¯ä¸æ˜¯ä¸ºç©ºã€‚ 12345// å¯ä¸ºç©ºçš„æŽ¥æ”¶è€…fun String?.testNullableReceiver():String&#123; if(this == null) return "I am null" return "I am not null $&#123;toString()&#125;"&#125; å†çœ‹ä¸€ä¸‹ï¼Œå¯ç©ºç±»åž‹çš„ toString() æ–¹æ³• 123456fun Any?.toString(): String &#123; if (this == null) return "null" // è¿›è¡Œè¿‡ null æ£€æŸ¥åŽ, 'this' ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºéž null ç±»åž‹, å› æ­¤ä¸‹é¢çš„ toString() æ–¹æ³• // ä¼šè¢«è§£æžä¸º Any ç±»çš„æˆå‘˜å‡½æ•° return toString()&#125; æµ‹è¯• 1234567891011val strNull1:String? = nullval strNull2:String? = "strNull2 "val strNoNull:String = "strNoNull "extensionLog(strNull1.testNullableReceiver())extensionLog(strNull2.testNullableReceiver())extensionLog(strNoNull.testNullableReceiver())// ç»“æžœcom.march.ktexample E/MainActivity: I am nullcom.march.ktexample E/MainActivity: I am not null strNull2 com.march.ktexample E/MainActivity: I am not null strNoNull æ‰©å±•å±žæ€§æ‰©å±•å±žæ€§å¹¶ä¸çœŸçš„æ˜¯ç±»çš„æˆå‘˜ï¼Œä»–ä¸èƒ½æ›´æ”¹ç±»çš„å†…å®¹ï¼Œå› æ­¤æ‰©å±•å±žæ€§ä¸æ”¯æŒ backing-fieldï¼Œå› æ­¤æ²¡åŠžæ³•ä½¿ç”¨ set() ä¸ºå±žæ€§èµ‹å€¼ã€‚ æ‰©å±•å±žæ€§ä¸èƒ½ä½¿ç”¨ åˆå§‹åŒ–å™¨ ä¸ºå±žæ€§èµ‹å€¼ 123456789101112131415var Context.extensionProperty: String get() &#123; return "$&#123;javaClass.simpleName&#125; properties = " &#125; // âš ï¸ è¿™æ ·æ˜¯é”™è¯¯çš„ï¼Œæ²¡æœ‰backing-fieldæ”¯æŒï¼Œè¿™é‡Œå°†ä¼šStackOverflow set(value) &#123; extensionProperty = value &#125;// é”™è¯¯ï¼Œä¸å…è®¸åˆå§‹åŒ–å™¨val Context.testValue1:Int = 100// ä¸€ä¸ªæ­£ç¡®çš„ç¤ºèŒƒval &lt;T&gt; List&lt;T&gt;.lastIndex: Int get() = size - 1 æ‰©å±•åŒä¼´å¯¹è±¡12345678910111213141516171819class MainActivity : Activity() &#123; companion object MyCompanion &#123; &#125;&#125;// æ‰©å±•å‡½æ•°fun MainActivity.MyCompanion.testCompanionFunc(): String &#123; return "testCompanionFunc"&#125;// æ‰©å±•å±žæ€§val MainActivity.MyCompanion.testCompanionProperty get() = "testCompanionProperty" extensionLog(MainActivity.MyCompanion.testCompanionFunc())extensionLog(MainActivity.MyCompanion.testCompanionProperty) å£°æ˜Žæ‰©å±•ä¸ºæˆå‘˜ä»¥ä¸‹ç¿»è¯‘è‡ªå®˜æ–¹æ–‡æ¡£ï¼šåœ¨ç±»çš„å†…éƒ¨ï¼Œä½ å¯ä»¥ä¸ºå¦ä¸€ä¸ªç±»å®šä¹‰æ‰©å±•ã€‚åœ¨è¿™ç±»æ‰©å±•ä¸­ï¼Œå­˜åœ¨å¤šä¸ª éšå«æŽ¥å—è€…(implicit receiver) - è¿™äº›éšå«æŽ¥æ”¶è€…çš„æˆå‘˜å¯ä»¥ä¸ä½¿ç”¨é™å®šç¬¦ç›´æŽ¥è®¿é—®ã€‚æ‰©å±•æ–¹æ³•çš„å®šä¹‰æ‰€åœ¨çš„ç±»çš„å®žä¾‹ï¼Œç§°ä¸º æ´¾å‘æŽ¥å—è€…(dispatch receiver)ï¼Œ æ‰©å±•æ–¹æ³•çš„ç›®æ ‡ç±»åž‹çš„å®žä¾‹ï¼Œç§°ä¸º æ‰©å±•æŽ¥å—è€…(extension receiver)ã€‚ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªç±» BB å†…éƒ¨å£°æ˜Žå¦ä¸€ä¸ªç±» AA çš„æ‰©å±•ï¼ŒAA æ˜¯æ‰©å±•æŽ¥å—è€…ï¼ŒBB æ˜¯æ´¾å‘æŽ¥å—è€…ï¼Œæ­¤æ—¶å­˜åœ¨å¤šä¸ªæŽ¥å—è€…ï¼Œåœ¨ AA çš„æ‰©å±•æ–¹æ³•ä¸­ï¼Œå¯ä»¥è‡ªç”±çš„ä¸ä½¿ç”¨é™å®šç¬¦çš„è®¿é—® AA å’Œ BB çš„æˆå‘˜ã€‚ 1234567891011121314151617class AA &#123; fun funcInAA(): String &#123; return "func in AA" &#125;&#125;class BB &#123; fun funcInBB(): String &#123; return "func in BB" &#125; fun AA.extendAAFuncInBB(): String &#123; return "extendAAFuncInBB" + funcInBB() + funcInAA() &#125; fun testFunc(aa: AA): String &#123; return aa.extendAAFuncInBB() &#125;&#125; å½“æ´¾å‘æŽ¥å—è€…ä¸Žæ‰©å±•æŽ¥å—è€…çš„æˆå‘˜åç§°å‘ç”Ÿå†²çªæ—¶ï¼Œæ‰©å±•æŽ¥å—è€…çš„æˆå‘˜å°†ä¼šè¢«ä¼˜å…ˆä½¿ç”¨ã€‚ å¦‚æžœæƒ³è¦ä½¿ç”¨æ´¾å‘æŽ¥å—è€…çš„æˆå‘˜ï¼Œéœ€è¦ä½¿ç”¨ this å…³é”®å­— 123456789class BB &#123; fun AA.testToString()&#123; // é»˜è®¤ä½¿ç”¨ AA.toString() toString() // ä½¿ç”¨ BB.toString() this@BB.toString() &#125;&#125; æ‰©å±•å‡½æ•°å¯ä»¥åœ¨å­ç±»ä¸­è¢«è¦†ç›–ï¼Œè¿™ç±»æ‰©å±•å‡½æ•°åœ¨æ´¾å‘è¿‡ç¨‹ä¸­é’ˆå¯¹æ´¾å‘æŽ¥å—è€…æ˜¯è™šæ‹Ÿçš„ï¼Œé’ˆå¯¹æ‰©å±•æŽ¥å—è€…æ˜¯é™æ€çš„ã€‚ å‰é¢è¯´è¿‡ï¼Œæ‰©å±•çš„è§£æžæ˜¯é™æ€çš„ï¼Œä½¿ç”¨å“ªä¸ªæ‰©å±•å–å†³äºŽè°ƒç”¨ä»–çš„æ˜¯å“ªä¸ªç±»åž‹çš„ç±»å¯¹è±¡ï¼Œä½†æ˜¯æ´¾å‘æŽ¥å—è€…æ˜¯è™šæ‹Ÿçš„æ˜¯è¯´ï¼Œä»–å°†ä½¿ç”¨å­ç±»ä¸­æ›´å…·ä½“çš„å®žçŽ°ã€‚ çœ‹ä¸€ä¸ªå®˜ç½‘çš„ä¾‹å­ï¼Œä¸‹é¢çš„ caller(d:D) æ–¹æ³•æŽ¥æ”¶çš„æ˜¯ D ç±»åž‹çš„å¯¹è±¡ï¼Œæ­¤æ—¶è°ƒç”¨æ‰©å±•å‡½æ•°æ—¶ï¼Œä¸ç®¡ä½ ä¼ é€’ä»€ä¹ˆç±»åž‹çš„å€¼(D æˆ– D çš„å­ç±»å¯¹è±¡)ï¼Œéƒ½ä¼šè°ƒç”¨ D çš„æ‰©å±•å‡½æ•°ï¼Œå› ä¸ºæ‰©å±•æŽ¥å—è€…çš„è§£æžæ˜¯é™æ€çš„ï¼Œ æ‰€ä»¥æ‰€æœ‰çš„æ‰“å°ç»“æžœéƒ½æ˜¯ D.foo ï¼›ä½†æ˜¯æ´¾å‘æŽ¥å—è€…çš„è§£æžæ˜¯è™šæ‹Ÿçš„ï¼Œæ‰€ä»¥ C1().caller() å°†ä½¿ç”¨å­ç±»ä¸­æ›´å…·ä½“çš„å®žçŽ°ï¼ŒC1 å¯¹æ‰©å±•å‡½æ•°è¿›è¡Œäº†é‡è½½ï¼Œå› æ­¤ä¼šä½¿ç”¨ C1 é‡è½½åŽçš„ caller() æ‰“å°å‡º in C1ã€‚ 123456789101112131415161718192021222324252627282930313233open class D &#123;&#125;class D1 : D() &#123;&#125;open class C &#123; open fun D.foo() &#123; println("D.foo in C") &#125; open fun D1.foo() &#123; println("D1.foo in C") &#125; fun caller(d: D) &#123; d.foo() // è°ƒç”¨æ‰©å±•å‡½æ•° &#125;&#125;class C1 : C() &#123; override fun D.foo() &#123; println("D.foo in C1") &#125; override fun D1.foo() &#123; println("D1.foo in C1") &#125;&#125;C().caller(D()) // æ‰“å°ç»“æžœä¸º "D.foo in C"C1().caller(D()) // æ‰“å°ç»“æžœä¸º "D.foo in C1" - æ´¾å‘æŽ¥å—è€…çš„è§£æžè¿‡ç¨‹æ˜¯è™šæ‹Ÿçš„C().caller(D1()) // æ‰“å°ç»“æžœä¸º "D.foo in C" - æ‰©å±•æŽ¥å—è€…çš„è§£æžè¿‡ç¨‹æ˜¯é™æ€çš„ æ€»ç»“æ‰©å±•å£°æ˜Žåœ¨ top-level æ‰èƒ½åœ¨æ‰€æœ‰åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ã€‚ æ‰©å±•å‡½æ•°çš„å£°æ˜Žå¯¹å­ç±»æ˜¯æœ‰æ•ˆçš„ï¼Œæˆ‘ä»¬æ‰©å±•çˆ¶ç±»ï¼Œå­ç±»ä¹Ÿä¼šæœ‰è¿™äº›æ‰©å±•ã€‚ åœ¨æ‰©å±•å‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨ this å…³é”®å­—ï¼Œè®¿é—®å½“å‰æ‰©å±•æŽ¥æ”¶è€…å¯¹è±¡ã€‚ æ‰©å±•çš„çš„æŽ¥å—è€…å¯ä»¥ä¸ºç©ºï¼Œä¸ä¼š NPEã€‚ æˆå‘˜å‡½æ•°å’Œæ‰©å±•å‡½æ•°å†²çªæ—¶ï¼Œæˆå‘˜å‡½æ•°ä¼˜å…ˆã€‚ æ‰©å±•æŽ¥å—è€…çš„è§£æžæ˜¯é™æ€çš„ï¼Œå°†ä¼šä½¿ç”¨å“ªä¸ªæ‰©å±•å–å†³äºŽè°ƒç”¨çš„ç±»çš„ç±»åž‹ï¼Œä¹Ÿå°±æ˜¯è¯´ç±»åž‹ç¡®å®šäº†ï¼Œä½¿ç”¨çš„æ–¹æ³•å°±ç¡®å®šäº†ï¼Œå¹¶ä¸åœ¨ä¹Žå®žé™…ä¸Šæ˜¯ä»€ä¹ˆç±»åž‹ï¼Œæ¯”å¦‚æˆ‘å‚æ•°æ˜¯ d:Dï¼Œå°±å†³å®šäº†æ˜¯ D ç±»åž‹çš„æ‰©å±•æ–¹æ³•ï¼Œä¼ å®ƒçš„å­ç±» D1:D ç±»åž‹ä¹Ÿä¸ä¼šæ”¹å˜ã€‚ æ´¾å‘æŽ¥å—è€…çš„è§£æžæ˜¯è™šæ‹Ÿçš„ï¼Œå°†ä¼šä½¿ç”¨å“ªä¸ªæ‰©å±•å–å†³äºŽè°ƒç”¨çš„ç±»çš„å®žé™…çš„ç±»åž‹ï¼Œå°†ä¼šä½¿ç”¨å½“å‰å®žé™…ç±»åž‹é‡è½½çš„æ–¹æ³•ï¼Œæ¯”å¦‚æˆ‘å‚æ•°æ˜¯ d:Dï¼Œä½†æˆ‘ä¼ å®ƒçš„å­ç±» D1:D ç±»åž‹åˆ™ä¼šä½¿ç”¨ D1 ä¸­å¯¹æ‰©å±•çš„é‡è½½ã€‚]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidä½¿ç”¨CMAKEç¼–è¯‘libjpeg-turbo]]></title>
    <url>%2Farticle%2Ffc67caea%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç»ä½¿ç”¨ CMAKE ç¼–è¯‘ libjpeg-turbo ç±»åº“ï¼Œæœ¬æ–‡ç›¸å…³ä»£ç è¯·åœ¨GitHub-TurboJpegSample æŸ¥çœ‹ã€‚ libjpeg-turbo é™„ GitHub åœ°å€ï¼Œlibjpeg-turbo æ˜¯ä¸ªè¿ç”¨æžå…¶å¹¿æ³›çš„åº“ï¼Œå¯ä»¥è¯´ï¼ŒåŸºæœ¬ä¸Šç”µè„‘ä¸Šæ‰‹æœºä¸Šèƒ½è§åˆ°çš„ JPEG åŽ‹ç¼©çš„åœ°æ–¹ç”¨çš„ä¸€èˆ¬éƒ½æ˜¯ libjpeg-turboï¼Œæœ¬æ–‡åªä»‹ç»ä½¿ç”¨äº†å›¾ç‰‡åŽ‹ç¼©çš„åŠŸèƒ½ã€‚ ä½¿ç”¨ Android ä¿å­˜å›¾ç‰‡æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨çš„æ˜¯ Bitmap.compress() æ–¹æ³•ï¼Œä½†æ˜¯ä½¿ç”¨è¯¥æ–¹æ³•æ—¶ï¼Œå°±ç®— quality è®¾ç½®ä¸º 100ï¼Œå›¾ç‰‡è´¨é‡è¿˜æ˜¯ä¼šè¶Šæ¥è¶Šæ¨¡ç³Šï¼Œé¢œè‰²ä¹Ÿä¼šè¶Šæ¥è¶Šç»¿ï½žï¼Œè‡³äºŽä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œè¯·çœ‹ çŸ¥ä¹Žå›žç­”ã€‚ è¿™ä¸ªé—®é¢˜åœ¨è´´å§ä¸Šä½“çŽ°å°¤ä¸ºæ˜Žæ˜¾ï¼Œè´´å§é‡Œé¢ç»å¸¸å¾ˆå¤šç»¿ç»¿çš„å›¾ç‰‡å°±æ˜¯å› ä¸ºå¤§å®¶ä¿å­˜ä¸‹æ¥ä¸Šä¼ ä¸ŠåŽ»ï¼Œä¿å­˜ä¸‹æ¥ä¸Šä¼ ä¸ŠåŽ» â€¦ å¯¼è‡´è´¨é‡è¶Šæ‹‰è¶Šä½Žï¼Œæˆ‘è§£åŽ‹äº† ç¾Žå›¾ç§€ç§€ å’Œ in çš„ apk å‘çŽ°é‡Œé¢éƒ½å¼•ç”¨äº† libjpeg.soï¼Œæ‰€ä»¥è¿™ä¸ªåº”è¯¥æ˜¯ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚ æˆ‘ä»¬å¯¹å›¾ç‰‡ä½¿ç”¨è´¨é‡åŽ‹ç¼©æ—¶å®ƒçš„åº•å±‚å°±æ˜¯ç”¨ skia å¼•æ“Žè¿›è¡Œå¤„ç†ï¼Œå¦‚æˆ‘ä»¬è°ƒç”¨bitmap.compress(Bitmap.CompressFormat.JPEG...) ä»–å®žé™…ä¼š ä½¿ç”¨ä¸€ä¸ªlibjpeg.so çš„åŠ¨æ€åº“è¿›è¡Œç¼–ç åŽ‹ç¼©ã€‚android åœ¨è¿›è¡Œ jpeg åŽ‹ç¼©ç¼–ç çš„æ—¶å€™ï¼Œè€ƒè™‘åˆ°äº†æ•ˆçŽ‡é—®é¢˜ä½¿ç”¨äº†å®šé•¿ç¼–ç æ–¹å¼è¿›è¡Œç¼–ç ï¼ˆå› ä¸ºå½“æ—¶çš„æ‰‹æœºæ€§èƒ½éƒ½æ¯”è¾ƒä½Žï¼‰ï¼Œè€Œ ios ä½¿ç”¨äº†å˜é•¿ç¼–ç çš„ç®—æ³•â€”â€”å“ˆå¤«æ›¼ç®—æ³•ã€‚è€Œä¸” IOS å¯¹ skia å¼•æ“Žä¹Ÿåšäº†ä¼˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°åŒæ ·çš„å›¾ç‰‡åœ¨ ios ä¸ŠåŽ‹ç¼©ä¼šå¥½ä¸€ç‚¹ã€‚ æ–‡æ¡£å°±æ•´ç†åˆ°è¿™é‡Œå§ï¼Œå…¶å®žä¸Šé¢è¯´çš„éƒ½æ˜¯çœ‹äº†ä¸€äº›åšå®¢çš„ä»‹ç»ç„¶åŽè¿›è¡Œäº†æ•´ç†å’Œè®°å½•ï¼Œæ¥æ¸…æ¥šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦è‡ªå·±æ¥ç¼–è¯‘ so å®žçŽ°å›¾ç‰‡åŽ‹ç¼©ã€‚ èµ„æºå‡†å¤‡æˆ‘ä»¬éœ€è¦ä¸‹è½½æºç ç¼–è¯‘å‡º libjpeg.so æ¥ä½¿ç”¨ï¼Œclone æºä»£ç ã€‚ 1git clone git://git.linaro.org/people/tomgall/libjpeg-turbo/libjpeg-turbo.git -b linaro-android é‡å‘½åæ ¹ç›®å½• libjpeg-turbo ä¸º jniï¼Œè¿›å…¥ jni ç›®å½•ï¼Œé¦–å…ˆä½ åº”è¯¥é…ç½®å¥½ ndkï¼Œ ä½¿ç”¨ ndk-build å‘½ä»¤è¿›è¡Œç¼–è¯‘ã€‚ 1234mv libjpeg-turbo jnindk-build APP_ABI=armeabi-v7a,armeabi ç¼–è¯‘å®Œæˆä¹‹åŽæˆ‘ä»¬å°±å¯ä»¥èŽ·å–åˆ° libjpeg.soï¼Œç›®å½•å¦‚ä¸‹ï¼š 12345678910jnilibs - armeabi - libjpeg.so - armeabi-v7a - libjpeg.soobj - local - armeabi - armeabi-v7a æ­¤æ—¶å¦‚æžœå‡ºçŽ°äº†ä»¥ä¸‹å¼‚å¸¸ï¼š 12Users/march/AndroidRes/sdk/ndk-bundle/build/core/build-binary.mk:702: *** Android NDK: Aborting (set APP_ALLOW_MISSING_DEPS=true to allow missing dependencies) . Stop. æ‰“å¼€ build-binary.mk æ·»åŠ  APP_ALLOW_MISSING_DEPS=true 123456789101112131415161718ifdef undefined_libs $(call __ndk_warning,Module $(LOCAL_MODULE) depends on undefined modules: $(undefined_libs)) # https://github.com/android-ndk/ndk/issues/208 # ndk-build didn't used to fail the build for a missing dependency. This # seems to have always been the behavior, so there's a good chance that # there are builds out there that depend on this behavior (as of right now, # anything using libc++ on ARM has this problem because of libunwind). # # By default we will abort in this situation because this is so completely # broken. A user may define APP_ALLOW_MISSING_DEPS to "true" in their # Application.mk or on the command line to revert to the old, broken # behavior. APP_ALLOW_MISSING_DEPS=true # here ifneq ($(APP_ALLOW_MISSING_DEPS),true) $(call __ndk_error,Aborting (set APP_ALLOW_MISSING_DEPS=true to allow missing dependencies)) endifendif åˆ›å»ºå·¥ç¨‹ä½¿ç”¨ AndroidStudio æ–°å»ºå·¥ç¨‹ï¼Œå‹¾é€‰ support c++ï¼Œç”Ÿæˆçš„å·¥ç¨‹ä¸­ä¼šåŒ…å« CMakeLists.txt æ–‡ä»¶ï¼Œåœ¨ä¸‹é¢çš„ä»‹ç»ä¸­æ²¡æœ‰æˆªå›¾ï¼Œå¯¹ç›®å½•çš„è¯´æ˜Žå¦‚æžœä¸å¤Ÿæ¸…æ™°ï¼Œè¯·è‡³ GitHub-TurboJpegSample æŸ¥çœ‹å·¥ç¨‹ä»£ç ã€‚ åœ¨ app ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ libjpegï¼Œç”¨æ¥å­˜æ”¾ so æ–‡ä»¶å’Œå¤´æ–‡ä»¶ï¼Œç›®å½•å¦‚ä¸‹ï¼š 123456789101112app - libjpeg - prebuilt - armeabi - libjpeg.so - include - å¤´æ–‡ä»¶ - src - main - cpp - java - res ç¼–å†™ compress.h å’Œ compress.cï¼Œè¿™ä¸ªå°±æ˜¯åŽ‹ç¼©çš„æ ¸å¿ƒä»£ç äº†ï¼Œç¯‡å¹…è¾ƒé•¿ï¼Œä½†æ˜¯è¿™é‡Œå°±ä¸è´´äº†ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹ é¡¹ç›®çš„ cpp ç›®å½•ï¼Œä½¿ç”¨çš„ç®—æ³•æ˜¯ç½‘ä¸ŠæŸ¥æ‰¾çš„ï¼Œçœ‹èµ·æ¥èµ„æ–™ä»‹ç»çš„éƒ½æ˜¯è¿™ä¸€ç§ã€‚ CMakeLists.txt12345678910111213141516171819202122232425262728293031# æœ€ä½Žç‰ˆæœ¬cmake_minimum_required(VERSION 3.4.1)#è®¾ç½®ç”Ÿæˆçš„ so åŠ¨æ€åº“æœ€åŽè¾“å‡ºçš„è·¯å¾„set(CMAKE_LIBRARY_OUTPUT_DIRECTORY $&#123;PROJECT_SOURCE_DIR&#125;/../jniLibs/$&#123;ANDROID_ABI&#125;)# åˆå§‹åŒ–ç›®å½•å˜é‡set(libjpeg_dir $&#123;CMAKE_SOURCE_DIR&#125;/libjpeg)set(INC_DIR $&#123;libjpeg_dir&#125;/include)set(libjpeg_lib_dir $&#123;libjpeg_dir&#125;/prebuilt)# æ·»åŠ å¤´æ–‡ä»¶ç›®å½•include_directories($&#123;INC_DIR&#125;)# è®¾ç½®èµ„æºè·¯å¾„set(SOURCE_FILES src/main/cpp/compress.c)# add_library(compress SHARED $&#123;SOURCE_FILES&#125;)find_library(log-lib log)find_library(graphics jnigraphics)add_library(libjpeg SHARED IMPORTED)set_target_properties(libjpeg PROPERTIES IMPORTED_LOCATION $&#123;libjpeg_lib_dir&#125;/$&#123;ANDROID_ABI&#125;/libjpeg.so)target_link_libraries(compress libjpeg $&#123;log-lib&#125; $&#123;graphics&#125;) build.gradleç›¸æ¯”æ™®é€šçš„ Android å·¥ç¨‹ï¼Œapp/build.gradle æ–‡ä»¶ä¹Ÿæœ‰äº›è®¸ä¸åŒï¼Œæˆ‘åªç¼–è¯‘äº† armeabi ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839android &#123; compileSdkVersion 25 buildToolsVersion "25.0.3" defaultConfig &#123; ... externalNativeBuild &#123; cmake &#123; abiFilters 'armeabi' &#125; &#125; ndk &#123; //æ‰“åŒ…è¿›APKçš„ABIç±»åž‹ abiFilters 'armeabi' &#125; &#125; externalNativeBuild &#123; cmake &#123; path "CMakeLists.txt" &#125; &#125; sourceSets &#123; main &#123; java.srcDirs 'src/java' jniLibs.srcDirs 'libs'// jniLibs.srcDirs '../libjpeg/prebuilt', 'libs' // è¿™é‡Œæ²¡æœ‰æ·»åŠ libjpeg.soè¿™ä¸ªåŠ¨æ€åº“ï¼Œä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œçš„ã€‚ // åŽŸå› åœ¨äºŽandroidæœ¬èº«ä½¿ç”¨äº† libjpeg.soè¿™ä¸ªåŠ¨æ€åº“ï¼Œ // è¿™ä¸ªåº“å­˜æ”¾åœ¨/system/libä¸‹ï¼Œå¦‚æžœæˆ‘ä»¬æ²¡æœ‰åŠ å…¥ // libjpeg.soçš„è¯ï¼Œä»–ä¼šåŽ»/system/libä¸‹åŠ è½½è¿™ä¸ªåŠ¨æ€åº“ // å¦‚æžœandroidæ‰‹æœºä¸Šæ²¡æœ‰ libjpeg.soè¿™ä¸ªåŠ¨æ€åº“çš„è¯ï¼Œ // ä¹Ÿå¯ä»¥ä½¿ç”¨: jniLibs.srcDirs '../libjpeg/prebuilt' 'libcd // å°†libjpeg.soåŠ å…¥åˆ°apkä¸­ &#125; &#125;&#125; ç¼–å†™ java è°ƒç”¨123456789101112131415161718public class TurboJpegUtils &#123; static &#123; System.loadLibrary("compress"); &#125; /** * ä½¿ç”¨nativeæ–¹æ³•è¿›è¡Œå›¾ç‰‡åŽ‹ç¼©ã€‚ * Bitmapçš„æ ¼å¼å¿…é¡»æ˜¯ARGB_8888 &#123;@link android.graphics.Bitmap.Config&#125;ã€‚ * * @param bitmap å›¾ç‰‡æ•°æ® * @param quality åŽ‹ç¼©è´¨é‡ * @param dstFile åŽ‹ç¼©åŽå­˜æ”¾çš„è·¯å¾„ * @param optimize æ˜¯å¦ä½¿ç”¨å“ˆå¤«æ›¼ç®—æ³• * @return ç»“æžœ */ public static native int compress(Bitmap bitmap, int quality, String dstFile, boolean optimize);&#125; è¿è¡Œä¹‹åŽå°±å¯ä»¥æµ‹è¯•ç»“æžœï¼ŒåŒæ—¶åœ¨ é…ç½®çš„ jniLibs ç›®å½•ä¸­ä¹Ÿä¼šç”Ÿæˆ so æ–‡ä»¶ï¼Œåœ¨åˆ«çš„åœ°æ–¹ä½¿ç”¨åŒåŒ…åä¸‹çš„ TurboJpegUtils ç±»ä¹Ÿå¯ä»¥è°ƒç”¨äº†ã€‚ æ€»ç»“æµ‹è¯•å¯¹æ¯”ç»“æžœï¼Œç¡®å®žæ¯” Andorid åŽŸç”Ÿçš„ç®—æ³•åŽ‹ç¼©å›¾ç‰‡çš„æ•ˆæžœå¥½å¾ˆå¤šï¼Œä½†æ˜¯åŽ‹ç¼©æ¬¡æ•°å¤šäº†ä»¥åŽä¹Ÿä¼šæœ‰æ˜Žæ˜¾çš„æ¨¡ç³ŠçŽ°è±¡ã€‚]]></content>
      <categories>
        <category>Android</category>
        <category>Ndk</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Ndk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android è¶…è½»é‡çº§è·¯ç”±æ–¹æ¡ˆ]]></title>
    <url>%2Farticle%2F327200%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Android è½»é‡çº§è·¯ç”±æ–¹æ¡ˆ çš„å®žçŽ°è¿‡ç¨‹ï¼› ä»€ä¹ˆæ˜¯è·¯ç”±åè®®ï¼Ÿè·¯ç”±åè®®å°±æ˜¯çº¦å®šä¸€å¥—è·¯å¾„è§£æžçš„è§„åˆ™ï¼Œç„¶åŽå¤§å®¶éƒ½éµå¾ªè¿™ä¸ªè§„åˆ™æ¥è¿›è¡Œé¡µé¢è·³è½¬ï¼Œä»Žè€Œè¾¾åˆ°åŠ¨æ€å’Œè§£è€¦çš„ç›®çš„ã€‚ è·¯ç”±çš„å­˜åœ¨æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Ÿ å¤šæ¨¡å—ï¼Œç»„ä»¶åŒ–ï¼Œæ’ä»¶åŒ–å¼€å‘æ—¶ï¼Œä½¿ç”¨è·¯ç”±è¿›è¡Œè§£è€¦ï¼Œç»„ä»¶ä¹‹é—´éµå¾ªçº¦å®šå¥½çš„è·¯ç”±åè®®è¿›è¡Œè·³è½¬ï¼Œä¸å†éœ€è¦äº’ç›¸ä¾èµ–ã€‚ æ··åˆå¼€å‘æ—¶ï¼ŒWeb ç«¯ä½¿ç”¨çº¦å®šå¥½çš„è·¯ç”±è·¯å¾„ï¼Œå¯ä»¥æ–¹ä¾¿è·³è½¬ app å†…å„ä¸ªé¡µé¢å¹¶è¿›è¡Œå‚æ•°ä¼ é€’ã€‚ åœ¨ GitHub ä¸Šå·²ç»æœ‰å¾ˆå¤šç›¸å½“æˆç†Ÿçš„è·¯ç”±æ¡†æž¶ï¼Œä»–ä»¬æ”¯æŒç¼–è¯‘æ—¶æ³¨è§£è·¯å¾„ï¼Œæ”¯æŒéšå¼è·³è½¬ï¼Œæ”¯æŒè·³è½¬åˆ° Fragmentï¼Œæ”¯æŒè‡ªå®šä¹‰è§£æžç­‰ç­‰â€¦ å¯ä»¥è¯´éžå¸¸å¼ºå¤§äº†ã€‚ã€‚ é‚£æˆ‘ä¸ºå•¥è¿˜è¦è‡ªå·±å†™ï¼Ÿä¸»è¦è¿˜æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬è¦çŸ¥å…¶ç„¶(çŸ¥é“è½®å­æ€Žä¹ˆç”¨)ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶(çŸ¥é“è½®å­æ€Žä¹ˆé€ )ã€‚å¦å¤–è™½ç„¶æˆ‘å†™çš„åŠŸèƒ½ä¸å¦‚é‚£äº›æ¡†æž¶å¼ºå¤§ï¼Œä½†æ˜¯ä¹Ÿæ›´è½»é‡ï¼Œå®Œæˆè·¯ç”±çš„ç”Ÿæˆã€è§£æžå’Œè·³è½¬ï¼Œå¤§çº¦åªæœ‰ 300 è¡Œä»£ç ï¼Œç”¨æ¥å®Œæˆç®€å•çš„è·¯ç”±éœ€æ±‚ä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©ã€‚ æˆ‘å¹¶æ²¡æœ‰ç»™è¿™ä¸ªåŠŸèƒ½å•ç‹¬åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œå› ä¸ºä»–å¤ªè½»é‡äº†ï¼Œæˆ‘æŠŠä»–é›†æˆåœ¨äº†æˆ‘å¸¸ç”¨å¼€å‘åº“ä¸­ï¼Œæœ¬æ–‡ç›¸å…³çš„æºä»£ç å¯ä»¥åœ¨ GitHub-DevKitSample ä¸­æŸ¥çœ‹ã€‚ æ€»çš„æ¥è¯´è¿™ä¸ªè·¯ç”±æ–¹æ¡ˆçš„æ ¸å¿ƒçš„åŽŸç†å°±æ˜¯å¯¹è·¯å¾„è¿›è¡Œè§£æžï¼Œç„¶åŽç”Ÿæˆ intentï¼Œè®¾ç½®å‚æ•°ï¼Œè¿›è¡Œé¡µé¢è·³è½¬ï¼ŒåŒæ—¶åˆè¦æ”¯æŒä½¿ç”¨å‚æ•°ï¼Œé…ç½®ç”Ÿæˆè·³è½¬çš„è·¯ç”±è·¯å¾„ï¼Œæ„Ÿè°¢å¼ºå¤§çš„ Uriï¼Œç®€åŒ–äº†æˆ‘å¾ˆå¤šè§£æžçš„è¿‡ç¨‹ã€‚ è·¯ç”±åè®®ä¸€ä¸ªè·¯ç”±è·¯å¾„åº”è¯¥æœ‰ Schemeã€Authorityã€Pathã€QueryParam å‡ éƒ¨åˆ†ç»„æˆï¼Œä»–ä»¬ä»¥ä¸‹é¢çš„å½¢å¼ç»„è£…ã€‚ 1Scheme://Authority/Path?QueryParam æ¯”å¦‚ä¸‹é¢çš„ https åè®®çš„è·¯å¾„ï¼ŒScheme å°±æ˜¯ httpsï¼ŒAuthority å°±æ˜¯ www.baidu.comï¼ŒPath å°±æ˜¯ test/listï¼ŒQueryParam ä»¥ key=value çš„å½¢å¼è¡¨çŽ°ï¼Œå¦‚ id=100ã€‚ 1https://www.baidu.com/test/list?id=100&amp;key=value å› æ­¤æˆ‘ä»¬å¯ä»¥å®šåˆ¶è‡ªå·±çš„åè®®ï¼Œä½œä¸ºåº”ç”¨å†…è·³è½¬çš„è§£æžæ–¹å¼ï¼Œæ¯”å¦‚å®šä¹‰ä¸‹é¢çš„åè®®ï¼š 1chendong://test.march.com/page/1?id=100 å®šåˆ¶åè®®æˆ‘ä»¬åœ¨ Android ä¸­è¿›è¡Œæ•°æ®ä¼ é€’æ—¶éœ€è¦çŸ¥é“å‚æ•°çš„ç±»åž‹ï¼Œè€Œè¿™äº›ä»…ä»…é å­—ç¬¦ä¸²çš„è·¯å¾„æ˜¯æ— æ³•è¡¨è¾¾çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹ QueryParam çš„å£°æ˜Žå½¢å¼è¿›è¡Œå¦‚ä¸‹çº¦å®šï¼Œåœ¨ QueryParam çš„ key ä¸­éœ€è¦è¡¨è¾¾æ•°æ®çš„ç±»åž‹ã€‚ int long boolean float double String Object i-key l-key b-key f-key d-key s-key o-key é‚£ä¹ˆæˆ‘ä»¬å°±ä¼šæœ‰å¦‚ä¸‹çš„ä¸€ä¸ªè·¯å¾„ï¼Œå‚æ•°ä»ç„¶æ˜¯ key-value çš„å½¢å¼ï¼Œåªä¸è¿‡ key çš„å†™æ³•æˆ‘ä»¬æ˜¯æœ‰çº¦å®šè¦æ±‚çš„ã€‚ 1chendong://testJs.march.com/page/1?i-iKey=10&amp;f-fKey=1.25&amp;l-lKey=10000000000&amp;d-dKey=1.23456789&amp;b-bKey=true&amp;s-sKey=test å½“è·¯å¾„ä¸º /page/pageId è¿™ç§è·¯å¾„æ—¶è¡¨ç¤ºæ˜¯ä¸€ä¸ªé¡µé¢è·³è½¬ï¼Œå…¶ä¸­ pageId ä¸ºé¡µé¢çš„å”¯ä¸€æ ‡ç¤ºï¼Œè‡³äºŽ pageId å’Œé¡µé¢çš„å”¯ä¸€æ˜ å°„ï¼Œéœ€è¦æå‰é…ç½®èµ·æ¥ï¼Œæˆ‘ä»¬ä¼šå­˜å‚¨ä»¥ä¸‹ä¸¤ä¸ªæ˜ å°„ mapã€‚ 1234// å­˜å‚¨ pageId - Activity.class çš„æ˜ å°„private Map&lt;Integer,Class&gt; pageMap = new HashMap&lt;&gt;();// å­˜å‚¨ Activity.class - pageId çš„æ˜ å°„private Map&lt;Class, Integer&gt; classMap = new HashMap&lt;&gt;(); è§£æž pageIdé¦–å…ˆå°†è·¯å¾„è½¬æ¢ä¸º Uri 1Uri uri = Uri.parse(url); æŽ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è¿›è¡Œ pageId çš„è§£æžï¼Œæˆ‘ä»¬åªæœ‰èŽ·å–åˆ° pageId æ‰èƒ½ç¡®è®¤è·³è½¬çš„æ˜¯å“ªä¸ªé¡µé¢ï¼Œä½¿ç”¨æ­£åˆ™æ¥è¿›è¡Œè§£æžã€‚ 12345678910111213141516// è§£æž pageIdprivate static int parsePageId(Uri uri) &#123; int pageId = -1; String path = uri.getPath(); if (path.startsWith(PATH_PAGE)) &#123; Pattern compile = Pattern.compile("/page/([0-9]*$)"); Matcher matcher = compile.matcher(path); if (matcher.find()) &#123; pageId = Integer.parseInt(matcher.group(1)); &#125; &#125; return pageId;&#125;// æ ¹æ®æ˜ å°„æ‹¿åˆ°è·³è½¬ç•Œé¢çš„ classClass pageCls = sRouterConfig.pageMap.get(parsePageId(uri)); è§£æžä¼ é€’çš„å‚æ•°å£°æ˜Žä»¥ä¸‹å‡ ç§æ•°æ®ç±»åž‹çš„æ ‡ç¤º 123456private static final String TYPE_I = "i";private static final String TYPE_L = "l";private static final String TYPE_B = "b";private static final String TYPE_F = "f";private static final String TYPE_D = "d";private static final String TYPE_S = "s"; å®šä¹‰ä¸€ä¸ªæ•°æ®ç±»åž‹ï¼Œé™¤äº†å­˜å‚¨ key-valueï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†æ•°æ®çš„ç±»åž‹åˆ†ç¦»å‡ºæ¥å­˜å‚¨ 12345678910private static class Param &#123; String type; // ç±»åž‹ï¼Œi,l,b,f,d,s String key; String value; Param(String type, String key, String value) &#123; this.type = type; this.key = key; this.value = value; &#125;&#125; è§£æžå‚æ•°ï¼Œä½¿ç”¨ Uri çš„å‡ ä¸ª api å’Œç®€å•çš„æ­£åˆ™ï¼Œå°† typeï¼Œkeyï¼Œvalue ä¸‰éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥å­˜å‚¨èµ·æ¥ï¼Œso easy ~ 1234567891011121314151617181920// è§£æžå‚æ•°private static List&lt;Param&gt; parseParams(Uri uri) &#123; Set&lt;String&gt; keySets = uri.getQueryParameterNames(); List&lt;Param&gt; params = new ArrayList&lt;&gt;(); Param param; Pattern compile = Pattern.compile("(\\b[ilbfds])-(.*)"); for (String queryKey : keySets) &#123; String queryValue = uri.getQueryParameter(queryKey); Matcher matcher = compile.matcher(queryKey); if (matcher.find()) &#123; String type = matcher.group(1); String key = matcher.group(2); if (!TextUtils.isEmpty(type) &amp;&amp; !TextUtils.isEmpty(key)) &#123; param = new Param(type, key, queryValue); params.add(param); &#125; &#125; &#125; return params;&#125; æž„å»ºè·³è½¬çš„ intentæˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†æƒ³è¦è·³è½¬çš„ç•Œé¢ï¼Œç›´æŽ¥åˆ›å»ºè·³è½¬çš„ intent 123// find classClass pageCls = sRouterConfig.pageMap.get(parsePageId(uri));Intent intent = new Intent(context, pageCls); å‘ intent ä¸­æ·»åŠ ä¼ é€’çš„å‚æ•° 1234567891011121314151617181920212223242526272829// parse paramsList&lt;Param&gt; params = parseParams(uri);for (Param param : params) &#123; putExtra(intent, param);&#125;// å‘ intent æ ¹æ®ç±»åž‹è¾“å…¥å‚æ•°private static void putExtra(Intent intent, Param param) &#123; switch (param.type) &#123; case TYPE_I: intent.putExtra(param.key, Integer.parseInt(param.value)); break; case TYPE_L: intent.putExtra(param.key, Long.parseLong(param.value)); break; case TYPE_B: intent.putExtra(param.key, Boolean.parseBoolean(param.value)); break; case TYPE_F: intent.putExtra(param.key, Float.parseFloat(param.value)); break; case TYPE_D: intent.putExtra(param.key, Double.parseDouble(param.value)); break; case TYPE_S: intent.putExtra(param.key, param.value); break; &#125;&#125; è¿›è¡Œé¡µé¢è·³è½¬ï¼Œå…¼å®¹äº†ä¸€ä¸‹ startActivityForResult() çš„æƒ…å†µã€‚ 1234567891011121314// å¯åŠ¨ activityprivate static void startActivity(Context context, int reqCode, Class pageCls, List&lt;Param&gt; params) Intent intent = new Intent(context, pageCls); for (Param param : params) &#123; putExtra(intent, param); &#125; if (reqCode == -1) &#123; context.startActivity(intent); &#125; else if (context instanceof Activity) &#123; ((Activity) context).startActivityForResult(intent, reqCode); &#125; else &#123; context.startActivity(intent); &#125;&#125; å±•ç¤ºä¸€ä¸‹å®Œæ•´çš„æµç¨‹ 12345678910111213141516171819public static boolean goFrom(Context context, String url, int reqCode) &#123; try &#123; Uri uri = Uri.parse(url); if (checkSchemeAuthority(uri)) return false; // find class Class pageCls = sRouterConfig.pageMap.get(parsePageId(uri)); if (pageCls == null) &#123; return false; &#125; // parse params List&lt;Param&gt; params = parseParams(uri); startActivity(context, reqCode, pageCls, params); &#125; catch (Exception e) &#123; e.printStackTrace(); return false; &#125; return true;&#125; ç”Ÿæˆè·³è½¬çš„è·¯ç”±è·¯å¾„æˆ‘ä»¬æ”¯æŒä½¿ç”¨è·¯ç”±è·¯å¾„è·³è½¬çš„åŒæ—¶ï¼Œä¹Ÿè¦æ”¯æŒé…ç½®å‚æ•°ç”Ÿæˆè·³è½¬çš„è·¯ç”±è·¯å¾„ã€‚åŒæ ·å€ŸåŠ© Uri çš„ç›¸å…³ apiï¼Œè¿™ä¸ªæ“ä½œå¹¶ä¸å›°éš¾ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// url æž„å»ºå™¨public static class RouterUrlBuilder &#123; private final Uri.Builder uriBuilder; RouterUrlBuilder(String scheme, String authority, int pageId) &#123; uriBuilder = new Uri.Builder() .scheme(scheme) .authority(authority) .path(PATH_PAGE + pageId); &#125; public RouterUrlBuilder put(String key, int value) &#123; uriBuilder.appendQueryParameter(TYPE_I + SEPARATOR + key, String.valueOf(value)); return this; &#125; public RouterUrlBuilder put(String key, long value) &#123; uriBuilder.appendQueryParameter(TYPE_L + SEPARATOR + key, String.valueOf(value)); return this; &#125; public RouterUrlBuilder put(String key, boolean value) &#123; uriBuilder.appendQueryParameter(TYPE_B + SEPARATOR + key, String.valueOf(value)); return this; &#125; public RouterUrlBuilder put(String key, float value) &#123; uriBuilder.appendQueryParameter(TYPE_F + SEPARATOR + key, String.valueOf(value)); return this; &#125; public RouterUrlBuilder put(String key, double value) &#123; uriBuilder.appendQueryParameter(TYPE_D + SEPARATOR + key, String.valueOf(value)); return this; &#125; public RouterUrlBuilder put(String key, String value) &#123; uriBuilder.appendQueryParameter(TYPE_S + SEPARATOR + key, value); return this; &#125; public String build() &#123; return uriBuilder.build().toString(); &#125;&#125; æˆ‘ä»¬éœ€è¦ä½¿ç”¨ Router ä¸­é…ç½®çš„ Schemeã€Authority å’Œé¡µé¢æ˜ å°„ã€‚ 1234567public static RouterUrlBuilder newRouterUrlBuilder(Class targetActivity) &#123; if (sRouterConfig == null || !sRouterConfig.isSchemeAndAuthoritySet()) &#123; throw new IllegalArgumentException("set scheme and authority first"); &#125; return new RouterUrlBuilder(sRouterConfig.scheme, sRouterConfig.authority, sRouterConfig.classMap.get(targetActivity));&#125; ç„¶åŽæˆ‘ä»¬å¯ä»¥è¿™æ ·é…ç½®ä¼ é€’çš„å‚æ•° 123456String url = Router.newRouterUrlBuilder(HomeActivity.class) .put("iKey", 10) .put("sKey1", "ss=ss") .put("sKey2", "ss=s&amp;s") .put("sKey3", "ss&amp;ss") .build(); Usageé…ç½® Schemeã€Authority å’Œé¡µé¢æ˜ å°„ 1234new Router.RouterConfig("chendong", "testJs.march.com") .add(1, JBTestActivity.class) .add(2, HomeActivity.class) .apply(); æ ¹æ®è·¯å¾„è·³è½¬ 12String url = "chendong://testJs.march.com/page/1?i-iKey=10&amp;f-fKey=1.25&amp;l-lKey=10000000000&amp;d-dKey=1.23456789&amp;b-bKey=true&amp;s-sKey=test";Router.goFrom(mActivity, url); ç”Ÿæˆè·¯ç”±è·¯å¾„ 123456String jumpUrl = Router.newRouterUrlBuilder(HomeActivity.class)s .put("iKey", 10) .put("sKey1", "ss=ss") .put("sKey2", "ss=s&amp;s") .put("sKey3", "ss&amp;ss") .build(); æˆ‘ä»¬å¯ä»¥åœ¨ html é¡µé¢ä¸­ä½¿ç”¨è·¯ç”±è·¯å¾„è¿›è¡Œ app å†…é¡µé¢è·³è½¬ 1&lt;a href="chendong://testJs.march.com/page/2?i-id=10&amp;s-name"&gt; æ‰“å¼€é¦–é¡µ &lt;/a&gt; æˆªæ–­è·¯å¾„è¿›è¡Œè·³è½¬ 123456789mWebView.setWebViewClient(new WebViewClient() &#123; @Override public boolean shouldOverrideUrlLoading(WebView view, String url) &#123; if (!Router.goFrom(mContext, url)) &#123; mWebView.loadUrl(url); &#125; return true; &#125;&#125;); todoçŽ°åœ¨åªæ˜¯ç®€åŒ–çš„ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºæœ¬çš„åŠŸèƒ½ï¼Œéœ€è¦å®Œå–„å’ŒéªŒè¯çš„åœ°æ–¹è¿˜æœ‰å¾ˆå¤šã€‚ æˆ‘æŠŠä»–é›†æˆåœ¨äº†æˆ‘å¸¸ç”¨å¼€å‘åº“ä¸­ï¼Œæœ¬æ–‡ç›¸å…³çš„æºä»£ç å¯ä»¥åœ¨ GitHub-DevKitSample ä¸­æŸ¥çœ‹ã€‚]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Contribute</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Rxjava2.xå¼€å‘-5-æ“ä½œç¬¦-å˜æ¢]]></title>
    <url>%2Farticle%2Fcc39cbd0%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä»¥ Observable ä¸ºä¾‹ï¼Œä¸»è¦æ€»ç»“ RxJava2.x å…³äºŽ å˜æ¢ æ“ä½œç›¸å…³æ“ä½œç¬¦çš„ç”¨æ³•ã€‚ Bufferæ”¶é›† Observable çš„æ•°æ®æ”¾è¿›ä¸€ä¸ªæ•°æ®åŒ…è£¹ï¼Œç„¶åŽå‘å°„è¿™äº›æ•°æ®åŒ…è£¹ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡å‘å°„ä¸€ä¸ªå€¼ã€‚Buffer æ“ä½œç¬¦å°†ä¸€ä¸ª Observable å˜æ¢ä¸ºå¦ä¸€ä¸ªï¼ŒåŽŸæ¥çš„Observable æ­£å¸¸å‘å°„æ•°æ®ï¼Œå˜æ¢äº§ç”Ÿçš„ Observable å‘å°„è¿™äº›æ•°æ®çš„ç¼“å­˜é›†åˆã€‚ æ³¨æ„ï¼šå¦‚æžœåŽŸæ¥çš„ Observable å‘å°„äº†ä¸€ä¸ª onError é€šçŸ¥ï¼ŒBuffer ä¼šç«‹å³ä¼ é€’è¿™ä¸ªé€šçŸ¥ï¼Œè€Œä¸æ˜¯é¦–å…ˆå‘å°„ç¼“å­˜çš„æ•°æ®ï¼Œå³ä½¿åœ¨è¿™ä¹‹å‰ç¼“å­˜ä¸­åŒ…å«äº†åŽŸå§‹Observable å‘å°„çš„æ•°æ®ã€‚ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Observable ç”¨æ¥å‘é€ 0 ï½ž 49 çš„50ä¸ªæ•´æ•°å€¼ï¼Œå¦‚ä¸‹ï¼š 12345List&lt;Integer&gt; integers = new ArrayList&lt;&gt;();for (int i = 0; i &lt; 50; i++) &#123; integers.add(i);&#125;Observable&lt;Integer&gt; observable = Observable.fromIterable(integers); buffer(count[,skip][,bufferSupplier])123observable .buffer(10) .subscribe(new MyObserver&lt;List&lt;Integer&gt;&gt;("buffer1"));]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>RxJava2.x</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Rxjava2.xå¼€å‘-4-æ“ä½œç¬¦-åˆ›å»º]]></title>
    <url>%2Farticle%2F6cad82c9%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä»¥ Observable ä¸ºä¾‹ï¼Œæœ¬æ–‡ä¸»è¦æ€»ç»“ RxJava2.x å…³äºŽ åˆ›å»º æ“ä½œç›¸å…³æ“ä½œç¬¦çš„ç”¨æ³•ã€‚ CreateCreate æ˜¯æœ€åŸºæœ¬çš„åˆ›å»ºæ“ä½œç¬¦ï¼Œä»–ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ ‡å‡†çš„è¢«è§‚å¯Ÿè€…ï¼Œç„¶åŽæ°å½“çš„è°ƒç”¨è§‚å¯Ÿè€…çš„ onNextï¼ŒonError å’Œ onCompleted æ–¹æ³•ã€‚ ä¸€ä¸ªå½¢å¼æ­£ç¡®çš„æœ‰é™ Observable å¿…é¡»å°è¯•è°ƒç”¨è§‚å¯Ÿè€…çš„ onCompleted æ­£å¥½ä¸€æ¬¡æˆ–è€…å®ƒçš„ onError æ­£å¥½ä¸€æ¬¡ï¼Œè€Œä¸”æ­¤åŽä¸èƒ½å†è°ƒç”¨è§‚å¯Ÿè€…çš„ä»»ä½•å…¶å®ƒæ–¹æ³•ã€‚ å¥½çš„åšæ³•æ˜¯åœ¨æ•°æ®å‘å°„ä¹‹å‰åˆ¤æ–­è§‚å¯Ÿè€…çš„çŠ¶æ€ï¼Œåœ¨æ²¡æœ‰è§‚å¯Ÿè€…æ—¶ä¸è¿›è¡Œäº‹ä»¶å‘é€å’Œè®¡ç®—æ“ä½œã€‚Create æ“ä½œç¬¦ä¸åœ¨ä»»ä½•çº¿ç¨‹è°ƒåº¦å™¨ä¸Šæ‰§è¡Œã€‚ 123456789Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; if(!e.isDisposed()) &#123; e.onNext(1); e.onComplete(); &#125; &#125;&#125;); JustJust ç±»ä¼¼äºŽ Fromï¼Œä½†æ˜¯ From ä¼šå°†æ•°ç»„æˆ– Iterable çš„æ•°æ®å–å‡ºç„¶åŽé€ä¸ªå‘å°„ï¼Œè€Œ Just åªæ˜¯ç®€å•çš„åŽŸæ ·å‘å°„ï¼Œå°†æ•°ç»„æˆ– Iterable å½“åšå•ä¸ªæ•°æ®ï¼Œå¦‚ä¸‹æƒ…å†µï¼Œå°†ä¼šç›´æŽ¥å‘é€ä¸€ä¸ª List å‡ºåŽ»ï¼Œè€Œä¸æ˜¯é‡Œé¢çš„æ•°å­— 0; 123List&lt;Integer&gt; integers = new ArrayList&lt;&gt;();integers.add(0);Observable.just(integers); Just å®ƒæœ€å¤šæŽ¥å— 10 ä¸ªå‚æ•°ï¼Œè¿”å›žä¸€ä¸ªæŒ‰å‚æ•°åˆ—è¡¨é¡ºåºå‘å°„è¿™äº›æ•°æ®çš„ Observableã€‚ä»Ž RxJava2.x å¼€å§‹ï¼Œä½¿ç”¨ just ä¸å…è®¸ä¼ é€’ nullï¼Œå¦åˆ™ä¼šå‡ºçŽ°å¼‚å¸¸(NPE) 12345678Observable.just(0);Observable.just(0, 1);Observable.just(0, 1, 2, 3, 4, 5, 6, 7, 8, 9) .subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer o) throws Exception &#123; &#125; &#125;); Fromåœ¨ RxJava1.x æ—¶ï¼Œåªæœ‰ä¸€ä¸ª From æ“ä½œç¬¦ï¼ŒæŽ¥å—ä¸åŒç±»åž‹çš„å‚æ•°ï¼Œä½†æ˜¯åœ¨ RxJava2.x å¯¹è¿™ä¸ªæ“ä½œç¬¦è¿›è¡Œäº†ç»†åˆ†ã€‚ fromIterable å’Œ fromArrayfrom æ“ä½œç¬¦å¯ä»¥è½¬æ¢ æ•°ç»„ å’Œ Iterableï¼Œäº§ç”Ÿçš„ Observable ä¼šå‘å°„ æ•°ç»„ å’Œ Iterable çš„æ¯ä¸€é¡¹æ•°æ®ã€‚ 123List&lt;Integer&gt; integers = new ArrayList&lt;&gt;();integers.add(0);Observable.fromIterable(integers); 123int[] array = new int[]&#123;1,2,3&#125;;Observable.fromArray(array);Observable.fromArray(1,2,3); fromCallable å’Œ fromFuturetodoâ€¦ Callable å’Œ Future éƒ½æ˜¯ java.util.concurrent åŒ…é‡Œé¢çš„ç±»ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•æš‚æ—¶ä¸æ¸…æ¥šï¼ŒåŽé¢è¡¥å……ã€‚ fromCallable() è¿”å›žçš„æ˜¯ onNext ä¼ é€’çš„æ•°æ®ï¼ŒfromCallable() èŽ·å–è¦å‘é€çš„æ•°æ®çš„ä»£ç åªä¼šåœ¨æœ‰ Observer è®¢é˜…ä¹‹åŽæ‰§è¡Œï¼Œä¸”èŽ·å–æ•°æ®çš„ä»£ç å¯ä»¥åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œã€‚ 123456Observable.fromCallable(new Callable&lt;Integer&gt;() &#123; @Override public Integer call() throws Exception &#123; return 100 + 2; &#125;&#125;); 1234public static &lt;T&gt; Observable&lt;T&gt; fromFuture(Future&lt;? extends T&gt; future)public static &lt;T&gt; Observable&lt;T&gt; fromFuture(Future&lt;? extends T&gt; future, long timeout, TimeUnit unit)public static &lt;T&gt; Observable&lt;T&gt; fromFuture(Future&lt;? extends T&gt; future, long timeout, TimeUnit unit)public static &lt;T&gt; Observable&lt;T&gt; fromFuture(Future&lt;? extends T&gt; future, long timeout, TimeUnit unit, Scheduler scheduler) fromPublishertodoâ€¦æš‚æ—¶ä¸æ˜¯å¾ˆæ¸…æ¥šå®ƒçš„ç”¨æ³•ï¼Œ ä½†æ˜¯ Flowable å®žçŽ°äº† Publisher æŽ¥å£ï¼Œå¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•å°† Flowable è½¬æ¢ä¸º Observable 123456Flowable&lt;Integer&gt; integerFlowable = Flowable.create(new FlowableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull FlowableEmitter&lt;Integer&gt; e) throws Exception &#123; &#125;&#125;, BackpressureStrategy.BUFFER);Observable.fromPublisher(integerFlowable); Deferç›´åˆ°æœ‰è§‚å¯Ÿè€…è®¢é˜…æ—¶æ‰åˆ›å»º Observableï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªè§‚å¯Ÿè€…åˆ›å»ºä¸€ä¸ªæ–°çš„Observableã€‚ Defer æ“ä½œç¬¦ä¼šä¸€ç›´ç­‰å¾…ç›´åˆ°æœ‰è§‚å¯Ÿè€…è®¢é˜…å®ƒï¼Œç„¶åŽå®ƒä½¿ç”¨ Observable å·¥åŽ‚æ–¹æ³•ç”Ÿæˆä¸€ä¸ª Observableã€‚å®ƒå¯¹æ¯ä¸ªè§‚å¯Ÿè€…éƒ½è¿™æ ·åšï¼Œå› æ­¤å°½ç®¡æ¯ä¸ªè®¢é˜…è€…éƒ½ä»¥ä¸ºè‡ªå·±è®¢é˜…çš„æ˜¯åŒä¸€ä¸ª Observableï¼Œäº‹å®žä¸Šæ¯ä¸ªè®¢é˜…è€…èŽ·å–çš„æ˜¯å®ƒä»¬è‡ªå·±çš„å•ç‹¬çš„æ•°æ®åºåˆ—ã€‚ 123456789101112131415Observable&lt;Object&gt; defer = Observable.defer(new Callable&lt;ObservableSource&lt;?&gt;&gt;() &#123; @Override public ObservableSource&lt;?&gt; call() throws Exception &#123; return Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exceptio RxHelper.log("å‘å°„æ•°æ® --&gt; " + hashCode()); e.onNext(1); e.onComplete(); &#125; &#125;); &#125;&#125;);defer.subscribe(new MyObserver&lt;&gt;());defer.subscribe(new MyObserver&lt;&gt;()); Empty/Never/Throwempty åˆ›å»ºä¸€ä¸ªä¸å‘å°„ä»»ä½•æ•°æ®ä½†æ˜¯æ­£å¸¸ç»ˆæ­¢çš„ Observable; never åˆ›å»ºä¸€ä¸ªä¸å‘å°„æ•°æ®ä¹Ÿä¸ç»ˆæ­¢çš„ Observable; throw åˆ›å»ºä¸€ä¸ªä¸å‘å°„æ•°æ®ä»¥ä¸€ä¸ªé”™è¯¯ç»ˆæ­¢çš„ Observable; 1234567891011Observable.empty();Observable.never();Observable.error(new Callable&lt;Throwable&gt;() &#123; @Override public Throwable call() throws Exception &#123; return new RuntimeException("test"); &#125;&#125;);Observable.error(new RuntimeException("test")); Interval å’Œ Rangeé»˜è®¤åœ¨ computation è°ƒåº¦å™¨ä¸Šæ‰§è¡Œï¼Œä½ ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå¯é€‰çš„Scheduler å‚æ•°æ¥æŒ‡å®šè°ƒåº¦å™¨ã€‚ intervalinterval è¿”å›žä¸€ä¸ªä»¥å›ºå®šæ—¶é—´é—´éš”å‘é€æ— é™é€’å¢žçš„ Long åž‹æ•°åˆ—çš„ Observableã€‚ 12345678public static Observable&lt;Long&gt; interval(long period, TimeUnit unit)public static Observable&lt;Long&gt; interval(long initialDelay, long period, TimeUnit unit)public static Observable&lt;Long&gt; interval(long period, TimeUnit unit, Scheduler scheduler)public static Observable&lt;Long&gt; interval(long initialDelay, long period, TimeUnit unit, Scheduler scheduler)// å»¶è¿Ÿ 1sï¼Œé—´éš” 100msï¼Œå‘é€æ— é™å¢žé•¿çš„ Long åž‹æ•°åˆ—Observable.interval(1, 100, TimeUnit.MILLISECONDS) .subscribe(new MyObserver&lt;Long&gt;("interval")); intervalRangeintervalRange ç±»ä¼¼äºŽ intervalï¼Œä½†æ˜¯å®ƒå¯ä»¥æŒ‡å®šèµ·å§‹æ•°å€¼ï¼Œè€Œä¸”ä¸å†æ˜¯ä¸€ä¸ªæ— é™æ•°åˆ—ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‡è®¾èµ·å§‹å€¼ä¸º start = aï¼Œcount = bï¼Œå³ä¸ºä»Ž start å¼€å§‹ï¼Œå‘é€ count ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆå‘é€çš„åŒºé—´æ˜¯ [a,a+b)ï¼Œå·¦é—­å³å¼€ï¼Œä¾‹å¦‚ start = 100ï¼Œcount = 120ï¼ŒåŒºé—´æ˜¯ [100,220)ï¼Œå³ 100 ï½ž 219ï¼Œå¦å¤– count ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œå¦åˆ™ä¼šå¼‚å¸¸ã€‚ 123456public static Observable&lt;Long&gt; intervalRange(long start, long count, long initialDelay, long period, TimeUnit unit)public static Observable&lt;Long&gt; intervalRange(long start, long count, long initialDelay, long period, TimeUnit unit, Scheduler scheduler)// å»¶è¿Ÿ 1sï¼Œé—´éš” 100msï¼Œå‘é€ä»Ž100 å¼€å§‹çš„é€’å¢žæ•°åˆ—ï¼Œå‘é€çš„åŒºé—´æ˜¯ [100,100+120)Observable.intervalRange(100, 120, 1, 100, TimeUnit.MILLISECONDS) .subscribe(new MyObserver&lt;Long&gt;("intervalRange")); range å’Œ rangeLongä»Ž start å¼€å§‹å‘é€ count ä¸ªæ•°æ®ï¼ŒåŒºé—´ä¸º [start,start+count) 123Observable.range(100,50).subscribe(new MyObserver&lt;Integer&gt;("range"));Observable.rangeLong(100,50).subscribe(new MyObserver&lt;Long&gt;("rangeLong")); Repeatrepeat é»˜è®¤åœ¨ trampoline è°ƒåº¦å™¨æ‰§è¡Œã€‚ repeaté‡å¤å‘é€ Observable çš„æ•°æ®ï¼Œå¦‚æžœä¸æŒ‡å®šæ•°ç›®ï¼Œå°†ä¼šæ— é™å‘é€ã€‚ 12345Observable.just(1).repeat(10) .subscribe(new MyObserver&lt;Integer&gt;("repeat1")); Observable.just(1).repeat() .subscribe(new MyObserver&lt;Integer&gt;("repeat2")); repeatWhentodoâ€¦å¯¹è¿™ä¸ªè¿ç®—ç¬¦ä¸æ˜¯å¾ˆæ¸…æ¥šå®ƒçš„ä½œç”¨ å®ƒä¸æ˜¯ç¼“å­˜å’Œé‡æ”¾åŽŸå§‹ Observable çš„æ•°æ®åºåˆ—ï¼Œè€Œæ˜¯æœ‰æ¡ä»¶çš„é‡æ–°è®¢é˜…å’Œå‘å°„åŽŸæ¥çš„ Observableã€‚ å°†åŽŸå§‹ Observable çš„ç»ˆæ­¢é€šçŸ¥ï¼ˆå®Œæˆæˆ–é”™è¯¯ï¼‰å½“åšä¸€ä¸ª void æ•°æ®ä¼ é€’ç»™ä¸€ä¸ªé€šçŸ¥å¤„ç†å™¨ï¼Œå®ƒä»¥æ­¤æ¥å†³å®šæ˜¯å¦è¦é‡æ–°è®¢é˜…å’Œå‘å°„åŽŸæ¥çš„ Observableã€‚è¿™ä¸ªé€šçŸ¥å¤„ç†å™¨å°±åƒä¸€ä¸ª Observable æ“ä½œç¬¦ï¼ŒæŽ¥å—ä¸€ä¸ªå‘å°„ void é€šçŸ¥çš„ Observable ä¸ºè¾“å…¥ï¼Œè¿”å›žä¸€ä¸ªå‘å°„ void æ•°æ®ï¼ˆæ„æ€æ˜¯ï¼Œé‡æ–°è®¢é˜…å’Œå‘å°„åŽŸå§‹ Observableï¼‰æˆ–è€…ç›´æŽ¥ç»ˆæ­¢ï¼ˆæ„æ€æ˜¯ï¼Œä½¿ç”¨ repeatWhen ç»ˆæ­¢å‘å°„æ•°æ®ï¼‰çš„Observableã€‚ 123456789Observable.just(1,2,4).repeatWhen(new Function&lt;Observable&lt;Object&gt;, ObservableSource&lt;?&gt;&gt;() &#123; @Override public ObservableSource&lt;?&gt; apply(@NonNull Observable&lt;Object&gt; objectObservable) throws Exception &#123; RxHelper.log("apply"); return objectObservable; &#125;&#125;) .subscribeOn(Schedulers.computation()) .subscribe(new MyObserver&lt;Integer&gt;("repeatWhen")); Startå‘é€äº‹ä»¶ä¹‹å‰å…ˆå‘é€æŸäº›äº‹ä»¶ã€‚ 12345678910111213141516171819202122// æŽ¥æ”¶å•ä¸ªå€¼Observable.just(1, 2, 4).startWith(100) .subscribe(new MyObserver&lt;Integer&gt;("startWith1"));// æŽ¥æ”¶ iterableList&lt;Integer&gt; ints = new ArrayList&lt;&gt;();ints.add(100);ints.add(200);Observable.just(1, 2, 4).startWith(ints) .subscribe(new MyObserver&lt;Integer&gt;("startWith2"));// æŽ¥æ”¶ arrayObservable.just(1, 2, 4).startWithArray(100, 200) .subscribe(new MyObserver&lt;Integer&gt;("startWith3"));// æŽ¥æ”¶ arrayInteger[] intArray = new Integer[]&#123;100, 200&#125;;Observable.just(1, 2, 4).startWithArray(intArray) .subscribe(new MyObserver&lt;Integer&gt;("startWith4"));// æŽ¥æ”¶ observableObservable.just(1, 2, 4).startWith(Observable.just(100, 200)) .subscribe(new MyObserver&lt;Integer&gt;("startWith5")); Timeråœ¨ä¸€å®šæ—¶é—´ä¹‹åŽå‘é€ä¸€ä¸ªç‰¹æ®Šå€¼ 0ï¼Œtimer æ“ä½œç¬¦é»˜è®¤åœ¨ computation çº¿ç¨‹æ‰§è¡Œã€‚ 1234public static Observable&lt;Long&gt; timer(long delay, TimeUnit unit)public static Observable&lt;Long&gt; timer(long delay, TimeUnit unit, Scheduler scheduler)Observable.timer(10, TimeUnit.MILLISECONDS).subscribe(new MyObserver&lt;Long&gt;("timer"));]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>RxJava2.x</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS é€‰æ‹©å™¨]]></title>
    <url>%2Farticle%2Fd318b1f4%2F</url>
    <content type="text"><![CDATA[é€‰æ‹©å™¨æ˜¯å£°æ˜Žè¿™ä¸ªæ ·å¼è¢«åº”ç”¨åœ¨å“ªä¸ªæ ‡ç­¾ä¸Šé¢çš„è§„åˆ™ã€‚ åŸºæœ¬é€‰æ‹©å™¨ æ ‡è®° æè¿° å«ä¹‰ * é€šç”¨é€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰å…ƒç´  E æ ‡ç­¾é€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰ä½¿ç”¨Eæ ‡ç­¾çš„å…ƒç´  .info classé€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰classå±žæ€§ä¸­åŒ…å«infoçš„å…ƒç´  #footer idé€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰idå±žæ€§ç­‰äºŽfooterçš„å…ƒç´  å®žä¾‹ 1234567* &#123; margin:0; padding:0; &#125;p &#123; font-size:2em; &#125;.info &#123; background:#ff0; &#125;p.info &#123; background:#ff0; &#125;p.info.error &#123; color:#900; font-weight:bold; &#125;#info &#123; background:#ff0; &#125;p#info &#123; background:#ff0; &#125; å¤šå…ƒç´ é€‰æ‹©å™¨ æ ‡è®° æè¿° å«ä¹‰ E,F å¤šå…ƒç´ é€‰æ‹©å™¨ åŒæ—¶åŒ¹é…æ‰€æœ‰Eå…ƒç´ æˆ–Få…ƒç´ ï¼ŒEå’ŒFä¹‹é—´ç”¨é€—å·åˆ†éš” E F åŽä»£å…ƒç´ é€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰å±žäºŽEå…ƒç´ åŽä»£çš„Få…ƒç´ ï¼ŒEå’ŒFä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš” E &gt; F å­å…ƒç´ é€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰Eå…ƒç´ çš„å­å…ƒç´ F E + F æ¯—é‚»å…ƒç´ é€‰æ‹©å™¨ åŒ¹é…æ‰€æœ‰ç´§éšEå…ƒç´ ä¹‹åŽçš„åŒçº§å…ƒç´ F ç¤ºä¾‹ 12345div p &#123; color:#f00; &#125;#nav li &#123; display:inline; &#125;#nav a &#123; font-weight:bold; &#125;div &gt; strong &#123; color:#f00; &#125;p + p &#123; color:#f00; &#125; å±žæ€§é€‰æ‹©å™¨ (css2.1) æ ‡è®° æè¿° E[attr] åŒ¹é…æ‰€æœ‰å…·æœ‰attrå±žæ€§çš„Eå…ƒç´ ï¼Œä¸è€ƒè™‘å®ƒçš„å€¼ã€‚(æ³¨æ„ï¼šEåœ¨æ­¤å¤„å¯ä»¥çœç•¥ï¼Œæ¯”å¦‚â€[title]â€ï¼Œä»¥ä¸‹åŒã€‚) E[attr=val] åŒ¹é…æ‰€æœ‰attrå±žæ€§ç­‰äºŽâ€valâ€çš„Eå…ƒç´  E[attr~=val] åŒ¹é…æ‰€æœ‰attrå±žæ€§å…·æœ‰å¤šä¸ªç©ºæ ¼åˆ†éš”çš„å€¼ã€å…¶ä¸­ä¸€ä¸ªå€¼ç­‰äºŽâ€valâ€çš„Eå…ƒç´  E[attr&vert;=val] åŒ¹é…æ‰€æœ‰attå±žæ€§å…·æœ‰å¤šä¸ªè¿žå­—å·åˆ†éš”çš„å€¼ã€å…¶ä¸­ä¸€ä¸ªå€¼ä»¥â€valâ€å¼€å¤´çš„Eå…ƒç´ ï¼Œä¸»è¦ç”¨äºŽlangå±žæ€§ï¼Œæ¯”å¦‚â€enâ€ã€â€en-usâ€ã€â€en-gbâ€ç­‰ç­‰ ç¤ºä¾‹ 12345p[title] &#123; color:#f00; &#125;div[class=error] &#123; color:#f00; &#125;td[headers~=col1] &#123; color:#f00; &#125;p[lang|=en] &#123; color:#f00; &#125;blockquote[class=quote][cite] &#123; color:#f00; &#125; ä¼ªç±»(css2.1) æ ‡è®° æè¿° E:first-child åŒ¹é…çˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´  E:link åŒ¹é…æ‰€æœ‰æœªè¢«ç‚¹å‡»çš„é“¾æŽ¥ E:visited åŒ¹é…æ‰€æœ‰å·²è¢«ç‚¹å‡»çš„é“¾æŽ¥ E:active åŒ¹é…é¼ æ ‡å·²ç»å…¶ä¸ŠæŒ‰ä¸‹ã€è¿˜æ²¡æœ‰é‡Šæ”¾çš„Eå…ƒç´  E:hover åŒ¹é…é¼ æ ‡æ‚¬åœå…¶ä¸Šçš„Eå…ƒç´  E:focus åŒ¹é…èŽ·å¾—å½“å‰ç„¦ç‚¹çš„Eå…ƒç´  E:lang(c) åŒ¹é…langå±žæ€§ç­‰äºŽcçš„Eå…ƒç´  ç¤ºä¾‹ 1234p:first-child &#123; font-style:italic; &#125;input[type=text]:focus &#123; color:#000; background:#ffe; &#125;input[type=text]:focus:hover &#123; background:#fff; &#125;q:lang(sv) &#123; quotes: "\201D" "\201D" "\2019" "\2019"; &#125; ä¼ªå…ƒç´ (css2.1) æ ‡è®° æè¿° E:first-line åŒ¹é…Eå…ƒç´ çš„ç¬¬ä¸€è¡Œ E:first-letter åŒ¹é…Eå…ƒç´ çš„ç¬¬ä¸€ä¸ªå­—æ¯ E:before åœ¨Eå…ƒç´ ä¹‹å‰æ’å…¥ç”Ÿæˆçš„å†…å®¹ E:after åœ¨Eå…ƒç´ ä¹‹åŽæ’å…¥ç”Ÿæˆçš„å†…å®¹ ç¤ºä¾‹ 1234p:first-line &#123; font-weight:bold; color;#600; &#125;.preamble:first-letter &#123; font-size:1.5em; font-weight:bold; &#125;.cbb:before &#123; content:""; display:block; height:17px; width:18px; background:url(top.png) no-repeat 0 0; margin:0 0 0 -18px; &#125;a:link:after &#123; content: " (" attr(href) ") "; &#125; åŒçº§å…ƒç´ é€šç”¨é€‰æ‹©å™¨(css3) æ ‡è®° æè¿° E ~ F åŒ¹é…ä»»ä½•åœ¨Eå…ƒç´ ä¹‹åŽçš„åŒçº§Få…ƒç´  ç¤ºä¾‹ 1p ~ ul &#123; background:#ff0; &#125; å±žæ€§é€‰æ‹©å™¨(css3) æ ‡è®° æè¿° E[attr\^=â€valâ€] å±žæ€§attrçš„å€¼ä»¥â€valâ€å¼€å¤´çš„å…ƒç´  E[attr$=â€valâ€] å±žæ€§attrçš„å€¼ä»¥â€valâ€ç»“å°¾çš„å…ƒç´  E[attr*=â€valâ€] å±žæ€§attrçš„å€¼åŒ…å«â€valâ€å­—ç¬¦ä¸²çš„å…ƒç´  ç¤ºä¾‹ 1div[id^="nav"] &#123; background:#ff0; &#125; ä¸Žç”¨æˆ·ç•Œé¢æœ‰å…³çš„ä¼ªç±»(css3) æ ‡è®° æè¿° E:enabled åŒ¹é…è¡¨å•ä¸­æ¿€æ´»çš„å…ƒç´  E:disabled åŒ¹é…è¡¨å•ä¸­ç¦ç”¨çš„å…ƒç´  E:checked åŒ¹é…è¡¨å•ä¸­è¢«é€‰ä¸­çš„radio æˆ–checkbox å…ƒç´  E:selection åŒ¹é…ç”¨æˆ·å½“å‰é€‰ä¸­çš„å…ƒç´  ç¤ºä¾‹ 1input[type="text"]:disabled &#123; background:#ddd; &#125; ç»“æž„æ€§ä¼ªç±»(css3) æ ‡è®° æè¿° E:root åŒ¹é…æ–‡æ¡£çš„æ ¹å…ƒç´ ï¼Œå¯¹äºŽHTMLæ–‡æ¡£ï¼Œå°±æ˜¯HTMLå…ƒç´  E:nth-child(n) åŒ¹é…å…¶çˆ¶å…ƒç´ çš„ç¬¬nä¸ªå­å…ƒç´ ï¼Œç¬¬ä¸€ä¸ªç¼–å·ä¸º1 E:nth-last-child(n) åŒ¹é…å…¶çˆ¶å…ƒç´ çš„å€’æ•°ç¬¬nä¸ªå­å…ƒç´ ï¼Œç¬¬ä¸€ä¸ªç¼–å·ä¸º1 E:nth-of-type(n) ä¸Ž:nth-child()ä½œç”¨ç±»ä¼¼ï¼Œä½†æ˜¯ä»…åŒ¹é…ä½¿ç”¨åŒç§æ ‡ç­¾çš„å…ƒç´  E:nth-last-of-type(n) ä¸Ž:nth-last-child() ä½œç”¨ç±»ä¼¼ï¼Œä½†æ˜¯ä»…åŒ¹é…ä½¿ç”¨åŒç§æ ‡ç­¾çš„å…ƒç´  E:last-child åŒ¹é…çˆ¶å…ƒç´ çš„æœ€åŽä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ:nth-last-child(1) E:first-of-type åŒ¹é…çˆ¶å…ƒç´ ä¸‹ä½¿ç”¨åŒç§æ ‡ç­¾çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ:nth-of-type(1) E:last-of-type åŒ¹é…çˆ¶å…ƒç´ ä¸‹ä½¿ç”¨åŒç§æ ‡ç­¾çš„æœ€åŽä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ:nth-last-of-type(1) E:only-child åŒ¹é…çˆ¶å…ƒç´ ä¸‹ä»…æœ‰çš„ä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ:first-child:last-childæˆ– :nth-child(1):nth-last-child(1) E:only-of-type åŒ¹é…çˆ¶å…ƒç´ ä¸‹ä½¿ç”¨åŒç§æ ‡ç­¾çš„å”¯ä¸€ä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ:first-of-type:last-of-typeæˆ– :nth-of-type(1):nth-last-of-type(1) E:empty åŒ¹é…ä¸€ä¸ªä¸åŒ…å«ä»»ä½•å­å…ƒç´ çš„å…ƒç´ ï¼Œæ³¨æ„ï¼Œæ–‡æœ¬èŠ‚ç‚¹ä¹Ÿè¢«çœ‹ä½œå­å…ƒç´  ç¤ºä¾‹ 12345678910p:nth-child(3) &#123; color:#f00; &#125;p:nth-child(odd) &#123; color:#f00; &#125;p:nth-child(even) &#123; color:#f00; &#125;p:nth-child(3n+0) &#123; color:#f00; &#125;p:nth-child(3n) &#123; color:#f00; &#125;tr:nth-child(2n+11) &#123; background:#ff0; &#125;tr:nth-last-child(2) &#123; background:#ff0; &#125;p:last-child &#123; background:#ff0; &#125;p:only-child &#123; background:#ff0; &#125;p:empty &#123; background:#ff0; &#125; åé€‰ä¼ªç±»(css3) æ ‡è®° æè¿° E:not(s) åŒ¹é…ä¸ç¬¦åˆå½“å‰é€‰æ‹©å™¨çš„ä»»ä½•å…ƒç´  ç¤ºä¾‹ 1:not(p) &#123; border:1px solid #ccc; &#125; :target ä¼ªç±»(css3) æ ‡è®° æè¿° E:target åŒ¹é…æ–‡æ¡£ä¸­ç‰¹å®šâ€idâ€ç‚¹å‡»åŽçš„æ•ˆæžœ]]></content>
      <categories>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¿«é€ŸæŽ¥å…¥å¾®ä¿¡å¾®åšQQåŽŸç”Ÿç™»å½•åˆ†äº«]]></title>
    <url>%2Farticle%2F3067853428%2F</url>
    <content type="text"><![CDATA[SocialSdk SocialSdk æä¾›å¾®åšã€å¾®ä¿¡ã€QQçš„ç™»é™†åˆ†äº«åŠŸèƒ½æ”¯æŒï¼Œä½¿ç”¨ å¾®åšã€QQã€å¾®ä¿¡ åŽŸç”Ÿ SDK æŽ¥å…¥ï¼ŒæŒç»­ä¼˜åŒ–ä¸­â€¦ ç”±äºŽé¡¹ç›®ä¸­æƒ³è¦æŽ¥å…¥çš„å¹³å°å› äººè€Œå¼‚ï¼Œç¬¬ä¸‰æ–¹ SDK æ›´æ–°ä¹Ÿæ¯”è¾ƒé¢‘ç¹ï¼Œå› æ­¤æ²¡æœ‰å¯¹ç±»åº“è¿›è¡Œå‘å¸ƒæ“ä½œï¼Œä¸‹è½½ä¹‹åŽç›´æŽ¥ä¾èµ– module å³å¯ï¼Œå¼€æ”¾æºç ï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿é—®é¢˜ä¿®å¤ã€‚ SocialSdk ä¸»è¦å¯¹å¤–å¼€æ”¾ä¸‰ä¸ªç±»æ–‡ä»¶ SocialSdkï¼ŒShareManagerï¼ŒLoginManagerã€‚SocialSdk ç”¨æ¥å®ŒæˆåŸºæœ¬é…ç½®çš„åˆå§‹åŒ–æ“ä½œï¼ŒShareManager ç”¨æ¥è¿›è¡Œåˆ†äº«æ“ä½œï¼ŒLoginManager ç”¨æ¥è¿›è¡Œç™»å½•æ“ä½œã€‚ 123LoginManager.login(mActivity, LoginManager.TARGET_QQ, mOnLoginListener); ShareManager.share(mActivity, ShareManager.TARGET_QQ_FRIENDS, imageObj, mOnShareListener); SocialSdk GitHub åœ°å€ GitHub ä¸Šé¢åªæ˜¯æä¾›äº†ä¸€ä¸ª moduleï¼Œæˆ‘æ˜¯åœ¨å¦å¤–ä¸€ä¸ªå·¥ç¨‹ä¸­è¿›è¡Œæµ‹è¯•ï¼Œå› ä¸ºç™»å½•åŠŸèƒ½éœ€è¦æˆä¸ºå¾®ä¿¡å¼€å‘è€…ï¼Œéœ€è¦äº¤é’±ï¼Œæ‰€ä»¥å½“å‰å·¥ç¨‹å¹¶æ²¡æœ‰æµ‹è¯•ä»£ç ï¼ŒåŽé¢ä¼šè¡¥å……ï¼Œå»ºè®®ä¸‹è½½ module ä¾èµ–åˆ°è‡ªå·±å·¥ç¨‹ä¸­ä½¿ç”¨ã€‚ ä½¿ç”¨è¯¦ç»†è¯´æ˜Žçš„åšå®¢åœ°å€ åˆå§‹åŒ–ä½ éœ€è¦åœ¨ä½¿ç”¨ SDK ä¹‹å‰è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œå»ºè®®æ”¾åœ¨ Applicaton ä¸­è¿›è¡Œã€‚ 1234567891011121314151617String qqAppId = getString(R.string.QQ_APPID);String wxAppId = getString(R.string.WEICHAT_APPID);String wxSecretKey = getString(R.string.WEICHAT_APPKEY);String sinaAppId = getString(R.string.SINA_APPKEY);SocialSdkConfig config = new SocialSdkConfig(this) // é…ç½®qq .qq(qqAppId) // é…ç½®wx .wechat(wxAppId, wxSecretKey) // é…ç½®sina .sina(sinaAppId) // é…ç½®Sinaçš„RedirectUrlï¼Œæœ‰é»˜è®¤å€¼ï¼Œå¦‚æžœæ˜¯å®˜ç½‘é»˜è®¤çš„ä¸éœ€è¦è®¾ç½® .sinaRedirectUrl("http://open.manfenmm.cxxxxxxx") // é…ç½®SinaæŽˆæƒscope,æœ‰é»˜è®¤å€¼ï¼Œé»˜è®¤å€¼ all .sinaScope(SocialConstants.SCOPE);SocialSdk.init(config); ç™»å½•åŠŸèƒ½ å¿«é€Ÿå”¤é†’ç™»å½• LoginManager.login(mActivity, LoginManager.TARGET_QQ, mOnLoginListener); ç™»é™†åŠŸèƒ½æ”¯æŒä¸‰ä¸ªå¹³å°ï¼Œqqï¼Œå¾®ä¿¡ï¼Œå¾®åšï¼›åˆ†åˆ«å¯¹åº” ç±»åž‹ æ˜¯ï¼š 1234// 3ä¸ªå¹³å°LoginManager.TARGET_QQ;LoginManager.TARGET_WECHAT;LoginManager.TARGET_SINA; ä½¿ç”¨ OnLoginListener ç›‘å¬ç™»å½•è¿”å›žç»“æžœï¼Œè¿”å›žçš„ LoginResult ä¸­ä¸»è¦åŒ…æ‹¬ç™»å½•ç±»åž‹ï¼ŒåŸºæœ¬ç”¨æˆ·ä¿¡æ¯ï¼Œä»¤ç‰Œä¿¡æ¯ 3 éƒ¨åˆ†ã€‚ 123456789101112131415161718192021222324252627282930313233public class LoginResult &#123; // ç™»é™†çš„ç±»åž‹ï¼Œå¯¹åº” LoginManager.TARGET_QQ ç­‰ã€‚ã€‚ã€‚ private int type; // è¿”å›žçš„åŸºæœ¬ç”¨æˆ·ä¿¡æ¯ // é’ˆå¯¹ç™»å½•ç±»åž‹å¯å¼ºè½¬ä¸º WbUser,WxUser,QQUser æ¥èŽ·å–æ›´åŠ ä¸°å¯Œçš„ä¿¡æ¯ private BaseUser mBaseUser; // æœ¬æ¬¡ç™»é™†çš„ token ä¿¡æ¯ï¼Œopenid,unionid,token,expires_in private BaseAccessToken mBaseToken;&#125;// ç™»é™†ç»“æžœç›‘å¬mOnLoginListener = new OnLoginListener() &#123; @Override public void onLoginSucceed(LoginResult loginResult) &#123; Log.e(TAG, loginResult.toString()); &#125; @Override public void onCancel() &#123; toast("ç™»å½•å–æ¶ˆ"); &#125; @Override public void onException(PlatformException e) &#123; toast("ç™»å½•å¤±è´¥ " + e.toString()); &#125;&#125;;// 3ä¸ªå¹³å°LoginManager.TARGET_QQ;LoginManager.TARGET_WECHAT;LoginManager.TARGET_SINA;// å”¤é†’ç™»é™†LoginManager.login(mActivity, LoginManager.TARGET_QQ, mOnLoginListener); åˆ†äº«åŠŸèƒ½ å¿«é€Ÿä½¿ç”¨åˆ†äº«åŠŸèƒ½ ShareManager.share(mActivity, ShareManager.TARGET_QQ_FRIENDS, imageObj, mOnShareListener); åˆ†äº«æ”¯æŒ 8 ç§ç±»åž‹çš„æ•°æ®ï¼›å¦‚æžœæŸä¸ªå¹³å°ä¸å…¼å®¹æŸç§ç±»åž‹çš„åˆ†äº«ï¼Œå°†ä¼šä½¿ç”¨ web åˆ†äº«çš„æ–¹å¼ä»£æ›¿ï¼›æ¯”å¦‚å¾®ä¿¡ä¸æ”¯æŒ app åˆ†äº«ï¼Œåˆ†äº«å‡ºåŽ»ä¹‹åŽæ—¶ web åˆ†äº«çš„æ¨¡å¼ã€‚æ”¯æŒçš„ 8 ç§ç±»åž‹åˆ†åˆ«æ˜¯ï¼š å¼€å¯æ¸ é“å¯¹ç”¨çš„ appã€‚ åˆ†äº«æ–‡å­—ã€‚ åˆ†äº«å›¾ç‰‡( jpg , png , gif )ã€‚ åˆ†äº« appã€‚ åˆ†äº« webã€‚ åˆ†äº« musicã€‚ åˆ†äº« videoã€‚ åˆ†äº« voiceï¼Œ(sina ä¸“æœ‰ï¼Œå…¶ä»–å¹³å°ä½¿ç”¨ web åˆ†äº«) åˆ†äº«æ¸ é“12345678// æ”¯æŒçš„åˆ†äº«æ¸ é“ShareManager.TARGET_QQ_FRIENDS ; // qqå¥½å‹ShareManager.TARGET_QQ_ZONE ; // qqç©ºé—´ShareManager.TARGET_WECHAT_FRIENDS ; // å¾®ä¿¡å¥½å‹ShareManager.TARGET_WECHAT_ZONE ; // å¾®ä¿¡æœ‹å‹åœˆShareManager.TARGET_WECHAT_FAVORITE; // å¾®ä¿¡æ”¶è—ShareManager.TARGET_SINA ; // æ–°æµªå¾®åšShareManager.TARGET_SINA_OPENAPI ; // æ–°æµªå¾®åšopenApiåˆ†äº«ï¼Œä½¿ç”¨è¯¥æ–¹æ³•åˆ†äº«å›¾ç‰‡æ—¶å¾®åšåŽé¢ä¼šå¸¦ä¸€ä¸ªå°å°¾å·´ï¼Œå¯ä»¥ç‚¹å‡»è¿›å…¥å®˜å¾® åˆ›å»ºåˆ†äº«æ•°æ®åˆ†äº«æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æž„é€ åˆ†äº«ç”¨çš„æ•°æ®ï¼ŒShareMediaObj å¯¹è±¡æä¾›äº†å¤šç§é™æ€æ–¹æ³•ç”¨æ¥å¿«é€Ÿåˆ›å»ºå¯¹åº”åˆ†äº«çš„ç±»åž‹çš„å¯¹è±¡ã€‚ 1234567891011121314151617181920212223242526272829// æµ‹è¯•ç”¨çš„è·¯å¾„localImagePath = new File(Environment.getExternalStorageDirectory(), "1.jpg").getAbsolutePath();localVideoPath = new File(Environment.getExternalStorageDirectory(), "video.mp4").getAbsolutePath();localGifPath = new File(Environment.getExternalStorageDirectory(), "3.gif").getAbsolutePath();netVideoPath = "http://7xtjec.com1.z0.glb.clouddn.com/export.mp4";netImagePath = "http://7xtjec.com1.z0.glb.clouddn.com/token.png";netMusicPath = "http://7xtjec.com1.z0.glb.clouddn.com/test_music.mp3";netMusicPath = "http://mp3.haoduoge.com/sSocialSdkConfig/2017-05-19/1495207225.mp3";targetUrl = "http://bbs.csdn.net/topics/391545021";// æ‰“å¼€æ¸ é“å¯¹åº”appShareMediaObj shareMediaObj = ShareMediaObj.buildOpenAppObj();// åˆ†äº«æ–‡å­—ShareMediaObj textObj = ShareMediaObj.buildTextObj("åˆ†äº«æ–‡å­—", "summary");// åˆ†äº«å›¾ç‰‡ShareMediaObj imageObj = ShareMediaObj.buildImageObj("åˆ†äº«å›¾ç‰‡", "summary", localImagePath);// åˆ†äº«gifShareMediaObj imageGifObj = ShareMediaObj.buildImageObj("åˆ†äº«å›¾ç‰‡", "summary", localGifPath);// åˆ†äº«appShareMediaObj appObj = ShareMediaObj.buildAppObj("åˆ†äº«app", "summary", localImagePath, targetUrl);// åˆ†äº«webShareMediaObj webObj = ShareMediaObj.buildWebObj("åˆ†äº«web", "summary", localImagePath, targetUrl);// åˆ†äº«è§†é¢‘ShareMediaObj videoObj = ShareMediaObj.buildVideoObj("åˆ†äº«è§†é¢‘", "summary", localImagePath, targetUrl, localVideoPath, 10);// åˆ†äº«éŸ³ä¹ShareMediaObj musicObj = ShareMediaObj.buildMusicObj("åˆ†äº«éŸ³ä¹", "summary", localImagePath, targetUrl, netMusicPath, 10);// åˆ†äº«å£°éŸ³ï¼Œå¾®åšç‰¹æœ‰ï¼Œå…¶ä»–å¹³å°ä»¥webæ–¹å¼åˆ†äº«ShareMediaObj voiceObj = ShareMediaObj.buildVoiceObj("åˆ†äº«å£°éŸ³", "summary", localImagePath, targetUrl, netMusicPath, 10); åˆ†äº«ç›‘å¬åˆ†äº«ç»“æžœï¼Œä½¿ç”¨ OnShareListener è¿›è¡Œæ£€æµ‹ã€‚OnShareListener æä¾›äº†ä¸°å¯Œçš„æ–¹æ³•æ¥æ”¯æŒåˆ†äº«çš„å„ä¸ªé˜¶æ®µï¼Œå…³äºŽåˆ†äº«å¯¹è±¡é‡æž„çš„æ“ä½œï¼Œåœ¨ä¸‹ä¸€éƒ¨åˆ†è¯´æ˜Žã€‚ 1234567891011121314151617181920212223public class SimpleShareListener implements OnShareListener&#123; @Override public void onStart(int shareTarget, ShareMediaObj obj) &#123; // åˆ†äº«å¼€å§‹ &#125; @Override public ShareMediaObj onPrepareInBackground(int shareTarget, ShareMediaObj obj) &#123; // é‡æž„åˆ†äº«å¯¹è±¡ï¼Œä¸éœ€è¦æ—¶è¿”å›ž null å³å¯ return null; &#125; @Override public void onSuccess() &#123; // åˆ†äº«æˆåŠŸ &#125; @Override public void onFailure(SocialException e) &#123; // åˆ†äº«å¤±è´¥ &#125; @Override public void onCancel() &#123; // åˆ†äº«å–æ¶ˆ &#125;&#125; å‘èµ·åˆ†äº«1234567891011// æ”¯æŒçš„åˆ†äº«æ¸ é“ShareManager.TARGET_QQ_FRIENDS ; // qqå¥½å‹ShareManager.TARGET_QQ_ZONE ; // qqç©ºé—´ShareManager.TARGET_WECHAT_FRIENDS ; // å¾®ä¿¡å¥½å‹ShareManager.TARGET_WECHAT_ZONE ; // å¾®ä¿¡æœ‹å‹åœˆShareManager.TARGET_WECHAT_FAVORITE; // å¾®ä¿¡æ”¶è—ShareManager.TARGET_SINA ; // æ–°æµªå¾®åšShareManager.TARGET_SINA_OPENAPI ; // æ–°æµªå¾®åšopenApiåˆ†äº«ï¼Œä½¿ç”¨è¯¥æ–¹æ³•åˆ†äº«å›¾ç‰‡æ—¶å¾®åšåŽé¢ä¼šå¸¦ä¸€ä¸ªå°å°¾å·´ï¼Œå¯ä»¥ç‚¹å‡»è¿›å…¥å®˜å¾®// å”¤é†’åˆ†äº«ShareManager.share(mActivity, ShareManager.TARGET_QQ_FRIENDS, imageObj, mOnShareListener); é‡å†™åˆ†äº«å¯¹è±¡å…³äºŽé‡å†™åˆ†äº«å¯¹è±¡ï¼Œå…¶å®žæ˜¯åœ¨åˆ†äº«ä¹‹å‰å¯¹éœ€è¦åˆ†äº«çš„ ShareMediaObj è¿›è¡Œå¤„ç†è¿”å›žæ–°çš„ ShareMediaObj çš„æ“ä½œï¼Œæ¯”å¦‚å¯ä»¥ç”¨æ¥è§£å†³ç½‘ç»œå›¾ç‰‡æ— æ³•åˆ†äº«ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä¸‹è½½åˆ°æœ¬åœ°ï¼Œåœ¨è¿›è¡Œåˆ†äº«ï¼Œåˆæ¯”å¦‚å›¾ç‰‡åˆ†äº«å‡ºåŽ»ä¹‹å‰åŠ ä¸Š app æ°´å°ç­‰æ“ä½œã€‚ ä¸»è¦æ˜¯é‡å†™ OnShareListener çš„ onPrepareInBackground æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨åˆ†äº«ä¹‹å‰é¦–å…ˆæ‰§è¡Œï¼Œå¦‚æžœè¿”å›žä¸æ˜¯ nullï¼Œå°†ä¼šä½¿ç”¨æ–°åˆ›å»ºçš„ ShareMediaObj è¿›è¡Œåˆ†äº«ï¼Œå¦å¤–ç”±äºŽè€ƒè™‘åˆ°å¯èƒ½è¿›è¡Œè€—æ—¶æ“ä½œï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨å­çº¿ç¨‹æ‰§è¡Œçš„ã€‚ 12345@Overridepublic ShareMediaObj onPrepareInBackground(int shareTarget,ShareMediaObj obj) &#123; // é‡æž„åˆ†äº«å¯¹è±¡ï¼Œä¸éœ€è¦æ—¶è¿”å›ž null å³å¯ return null;&#125; çœ‹ä¸€ä¸ªåŸºæœ¬çš„å®žä¾‹ï¼Œå…¶ä¸­ ShareObjHelper.prepareThumbImagePath(obj); æ˜¯ SDK å†…éƒ¨ä¸‹è½½æ–‡ä»¶çš„ä¸€ä¸ªæ–¹æ³•çš„å°è£…ï¼Œç”¨æ¥å°†ç½‘ç»œå›¾ä¸‹è½½åˆ°æœ¬åœ°ç„¶åŽæ›´æ–° ShareMediaObj æŒ‡å‘çš„å›¾ç‰‡åœ°å€ï¼Œä½ å¯ä»¥ç›´æŽ¥ä½¿ç”¨å®ƒã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public class MyShareListener extends SimpleShareListener &#123; public static final String TAG = MyShareListener.class.getSimpleName(); private Context mContext; private LoadingDialog mLoadingDialog; public MyShareListener(Context context) &#123; mContext = context; mLoadingDialog = new LoadingDialog(mContext); &#125; @Override public void onStart(int shareTarget, ShareMediaObj obj) &#123; if (mLoadingDialog != null) mLoadingDialog.show(); &#125; @Override public ShareMediaObj onPrepareInBackground(int shareTarget, ShareMediaObj obj) throws Exception&#123; // ç½‘ç»œè·¯å¾„ï¼Œå…ˆè¿›è¡Œæ–‡ä»¶ä¸‹è½½è¿›è¡Œæ–‡ä»¶ä¸‹è½½ ShareObjHelper.prepareThumbImagePath(obj); // åˆ†äº«ç…§ç‰‡ä¸”ä¸æ˜¯gifæ—¶åŠ æ°´å° if (obj.getShareObjType() == ShareMediaObj.SHARE_TYPE_IMAGE &amp;&amp; !FileHelper.isGifFile(obj.getThumbImagePath())) &#123; File thumbImageFile = new File(obj.getThumbImagePath()); File saveFile = new File(Constants.THUMB_IMAGE_PATH, thumbImageFile.getName()); if (!FileUtil.fileIsExist(saveFile.getAbsolutePath())) &#123; ImageUtils.drawWaterMarkSync(mContext, obj.getThumbImagePath(), saveFile.getAbsolutePath(), false, false); &#125; obj.setThumbImagePath(saveFile.getAbsolutePath()); &#125; return obj; &#125; @Override public void onSuccess() &#123; ToastUtil.show("åˆ†äº«æˆåŠŸ"); &#125; @Override public void onFailure(SocialException e) &#123; switch (e.getErrorCode()) &#123; case SocialException.CODE_NOT_INSTALL: ToastUtil.show("åº”ç”¨æœªå®‰è£…"); break; &#125; L.e(TAG, "åˆ†äº«å¤±è´¥" + e.toString()); &#125; @Override public void onCancel() &#123; ToastUtil.show("åˆ†äº«å–æ¶ˆ"); &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Contribute</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS]]></title>
    <url>%2Farticle%2F5b70625a%2F</url>
    <content type="text"><![CDATA[CSS æŒ‡å±‚å æ ·å¼è¡¨ (Cascading Style Sheets) è§£å†³å†…å®¹ä¸Žè¡¨çŽ°åˆ†ç¦»çš„é—®é¢˜ã€‚ å¼€å§‹12345678910111213141516171819202122232425262728293031323334body&#123; background-color:#d0e4fe;&#125;h1&#123; color:orange; text-align:center;&#125;p&#123; font-family:"Times New Roman"; font-size:20px;&#125;å››ä¸ªå€¼: ç¬¬ä¸€ä¸ªå€¼ä¸ºå·¦ä¸Šè§’ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºå³ä¸Šè§’ï¼Œç¬¬ä¸‰ä¸ªå€¼ä¸ºå³ä¸‹è§’ï¼Œç¬¬å››ä¸ªå€¼ä¸ºå·¦ä¸‹è§’ã€‚ä¸‰ä¸ªå€¼: ç¬¬ä¸€ä¸ªå€¼ä¸ºå·¦ä¸Šè§’, ç¬¬äºŒä¸ªå€¼ä¸ºå³ä¸Šè§’å’Œå·¦ä¸‹è§’ï¼Œç¬¬ä¸‰ä¸ªå€¼ä¸ºå³ä¸‹è§’ä¸¤ä¸ªå€¼: ç¬¬ä¸€ä¸ªå€¼ä¸ºå·¦ä¸Šè§’ä¸Žå³ä¸‹è§’ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºå³ä¸Šè§’ä¸Žå·¦ä¸‹è§’ä¸€ä¸ªå€¼: å››ä¸ªåœ†è§’å€¼ç›¸åŒ``` ## æ’å…¥æ ·å¼è¡¨å‘ `html` æ–‡æ¡£ä¸­æ’å…¥æ ·å¼è¡¨ï¼Œæ ·å¼è¡¨ä¸­ä¸èƒ½åŒ…å«ä»»ä½•çš„ `html` æ ‡ç­¾ã€‚å¦‚æžœæŸäº›å±žæ€§åœ¨ä¸åŒçš„æ ·å¼è¡¨ä¸­è¢«åŒæ ·çš„é€‰æ‹©å™¨å®šä¹‰ï¼Œé‚£ä¹ˆå±žæ€§å€¼å°†ä»Žæ›´å…·ä½“çš„æ ·å¼è¡¨ä¸­è¢«ç»§æ‰¿è¿‡æ¥ã€‚å¤šé‡æ ·å¼å±‚å ä¼˜å…ˆçº§å¦‚ä¸‹ï¼ŒåŒä¸€ä¼˜å…ˆçº§å†…åŒæ ·çš„æ ·å¼åŽé¢å®šä¹‰çš„å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§&gt; å†…è”æ ·å¼ &gt; å†…éƒ¨æ ·å¼è¡¨ &gt; å¤–éƒ¨æ ·å¼è¡¨ &gt; æµè§ˆå™¨ç¼ºçœè®¾ç½®### å¤–éƒ¨æ ·å¼è¡¨æµè§ˆå™¨ä¼šä»Žæ–‡ä»¶ `mystyle.css` ä¸­è¯»åˆ°æ ·å¼å£°æ˜Žï¼Œå¹¶æ ¹æ®å®ƒæ¥æ ¼å¼æ–‡æ¡£ï¼Œå¤–éƒ¨æ ·å¼è¡¨å¯ä»¥åœ¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨ä¸­è¿›è¡Œç¼–è¾‘ï¼Œå¤–éƒ¨æ ·å¼è¡¨åº”è¯¥ä»¥ `.css` æ‰©å±•åè¿›è¡Œä¿å­˜ã€‚```html&lt;head&gt;&lt;link rel="stylesheet" type="text/css" href="mystyle.css"&gt;&lt;/head&gt; å†…éƒ¨æ ·å¼è¡¨å½“å•ä¸ªæ–‡æ¡£éœ€è¦ç‰¹æ®Šçš„æ ·å¼æ—¶ï¼Œå°±åº”è¯¥ä½¿ç”¨å†…éƒ¨æ ·å¼è¡¨ã€‚ 123456&lt;head&gt;&lt;style&gt; hr &#123;color:red;&#125; p &#123;margin-left:20px;&#125; body &#123;background-image:url("images/back40.gif");&#125;&lt;/style&gt; å†…è”æ ·å¼ç”±äºŽè¦å°†è¡¨çŽ°å’Œå†…å®¹æ··æ‚åœ¨ä¸€èµ·ï¼Œå†…è”æ ·å¼ä¼šæŸå¤±æŽ‰æ ·å¼è¡¨çš„è®¸å¤šä¼˜åŠ¿ã€‚ä¾‹å¦‚å½“æ ·å¼ä»…éœ€è¦åœ¨ä¸€ä¸ªå…ƒç´ ä¸Šåº”ç”¨ä¸€æ¬¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å†…è”æ ·å¼ã€‚è¦ä½¿ç”¨å†…è”æ ·å¼ï¼Œä½ éœ€è¦åœ¨ç›¸å…³çš„æ ‡ç­¾å†…ä½¿ç”¨æ ·å¼style å±žæ€§ã€‚style å±žæ€§å¯ä»¥åŒ…å«ä»»ä½• CSS å±žæ€§ã€‚ 1&lt;p style="color:red;margin-left:20px"&gt;This is a paragraph.&lt;/p&gt; CSS èƒŒæ™¯ Property æè¿° background ç®€å†™å±žæ€§ï¼Œä½œç”¨æ˜¯å°†èƒŒæ™¯å±žæ€§è®¾ç½®åœ¨ä¸€ä¸ªå£°æ˜Žä¸­ã€‚ background-attachment èƒŒæ™¯å›¾åƒæ˜¯å¦å›ºå®šæˆ–è€…éšç€é¡µé¢çš„å…¶ä½™éƒ¨åˆ†æ»šåŠ¨ã€‚ background-color è®¾ç½®å…ƒç´ çš„èƒŒæ™¯é¢œè‰²ã€‚ background-image æŠŠå›¾åƒè®¾ç½®ä¸ºèƒŒæ™¯ã€‚ background-position è®¾ç½®èƒŒæ™¯å›¾åƒçš„èµ·å§‹ä½ç½®ã€‚ background-repeat è®¾ç½®èƒŒæ™¯å›¾åƒæ˜¯å¦åŠå¦‚ä½•é‡å¤ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758591. èƒŒæ™¯é¢œè‰²(background-color)å®šä¹‰é¢œè‰²çš„ä¸‰ç§æ–¹å¼- åå…­è¿›åˆ¶ï¼š"#123456"- RGBé¢œè‰²ï¼šrgb(255,0,0)- é¢œè‰²åç§°ï¼šred,greenbody &#123;background-color:#b0c4de;&#125;---2. èƒŒæ™¯å›¾åƒ(background-image)é»˜è®¤æƒ…å†µä¸‹ï¼ŒèƒŒæ™¯å›¾åƒè¿›è¡Œå¹³é“ºé‡å¤æ˜¾ç¤ºï¼Œä»¥è¦†ç›–æ•´ä¸ªå…ƒç´ å®žä½“.body &#123;background-image:url('paper.gif');&#125;---3. èƒŒæ™¯å›¾åƒå¹³é“ºæ–¹å¼(background-repeat)é»˜è®¤æƒ…å†µä¸‹ï¼Œå›¾åƒä¼šæ°´å¹³å’Œåž‚ç›´å¹³é“ºï¼Œä½¿ç”¨background-repeatæŒ‡å®šå¹³é“ºæ–¹å¼æ°´å¹³æ–¹å‘å¹³é“º background-repeat:repeat-x; åž‚ç›´æ–¹å‘å¹³é“º background-repeat:repeat-y; ä¸å¹³é“º background-repeat:no-repeat; body&#123;background-image:url('img_tree.png');background-repeat:no-repeat;&#125;---4. èƒŒæ™¯å›¾åƒæ»‘åŠ¨æ–¹å¼(background-attachment)scroll é»˜è®¤å€¼ã€‚èƒŒæ™¯å›¾åƒä¼šéšç€é¡µé¢å…¶ä½™éƒ¨åˆ†çš„æ»šåŠ¨è€Œç§»åŠ¨ã€‚fixed å½“é¡µé¢çš„å…¶ä½™éƒ¨åˆ†æ»šåŠ¨æ—¶ï¼ŒèƒŒæ™¯å›¾åƒä¸ä¼šç§»åŠ¨ã€‚inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ background-attachment å±žæ€§çš„è®¾ç½®body &#123; background-image: url(bgimage.gif);background-attachment: fixed;&#125;---5. èƒŒæ™¯å›¾åƒçš„ä½ç½®(background-position)æŒ‡å®šèƒŒæ™¯å›¾åƒçš„ä½ç½®right top left bottombody&#123;background-image:url('img_tree.png');background-repeat:no-repeat;background-position:right top;&#125;---6. ç®€å†™å±žæ€§(backgound)ç®€å†™å±žæ€§çš„é¡ºåºä¸º 1. background-color 2. background-image 3. background-repeat 4. background-attachment 5. background-positionbody &#123; background:#ffffff url('img_tree.png') no-repeat right top;&#125; CSS æ–‡æœ¬ Property æè¿° color è®¾ç½®æ–‡æœ¬é¢œè‰² body {color:blue;} direction è®¾ç½®æ–‡æœ¬æ–¹å‘ã€‚ letter-spacing è®¾ç½®å­—ç¬¦é—´è· line-height è®¾ç½®è¡Œé«˜ text-align å¯¹é½å…ƒç´ ä¸­çš„æ–‡æœ¬ text-decoration å‘æ–‡æœ¬æ·»åŠ ä¿®é¥° text-indent ç¼©è¿›å…ƒç´ ä¸­æ–‡æœ¬çš„é¦–è¡Œ text-shadow è®¾ç½®æ–‡æœ¬é˜´å½± text-transform æŽ§åˆ¶å…ƒç´ ä¸­çš„å­—æ¯ unicode-bidi è®¾ç½®æˆ–è¿”å›žæ–‡æœ¬æ˜¯å¦è¢«é‡å†™ vertical-align è®¾ç½®å…ƒç´ çš„åž‚ç›´å¯¹é½ white-space è®¾ç½®å…ƒç´ ä¸­ç©ºç™½çš„å¤„ç†æ–¹å¼ word-spacing è®¾ç½®å­—é—´è· 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001. æ–‡æœ¬é¢œè‰²(color)å¯¹äºŽW3Cæ ‡å‡†çš„CSSï¼šå¦‚æžœä½ å®šä¹‰äº†é¢œè‰²å±žæ€§ï¼Œä½ è¿˜å¿…é¡»å®šä¹‰èƒŒæ™¯è‰²å±žæ€§ã€‚body &#123;color:blue;&#125;h1 &#123;color:#00ff00;&#125;h2 &#123;color:rgb(255,0,0);&#125;---2. æ–‡æœ¬å¯¹é½æ–¹å¼(text-align)å››ç§å–å€¼ï¼šright left center justify(è‡ªé€‚åº”çª—å£å¯¹é½å¯¹)p.date &#123;text-align:justify;&#125;---3. æ–‡æœ¬ä¿®é¥°(text-decoration)ä¸‰ç§å–å€¼ï¼šoverline(ä¸Šåˆ’çº¿) line-through(åˆ é™¤çº¿) underline(ä¸‹åˆ’çº¿)h1 &#123;text-decoration:overline;&#125;---4. æ–‡æœ¬è½¬æ¢(text-transform)ä¸‰ç§å–å€¼ï¼šuppercase(å…¨éƒ¨å¤§å†™) lowercase(å…¨éƒ¨å°å†™) capitalize(é¦–å­—æ¯å¤§å†™)p.uppercase &#123;text-transform:uppercase;&#125;---5. æ–‡æœ¬ç¼©è¿›(text-indent)é¦–è¡Œæ–‡æœ¬ç¼©è¿›p &#123;text-indent:50px;&#125;---6. æ–‡å­—é—´è·(letter-spacing)ä¸‰ä¸ªå–å€¼normal é»˜è®¤ã€‚è§„å®šå­—ç¬¦é—´æ²¡æœ‰é¢å¤–çš„ç©ºé—´ã€‚length å®šä¹‰å­—ç¬¦é—´çš„å›ºå®šç©ºé—´ï¼ˆå…è®¸ä½¿ç”¨è´Ÿå€¼ï¼‰ã€‚inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ letter-spacing å±žæ€§çš„å€¼ã€‚h2 &#123;letter-spacing:-3px&#125;---7. æ–‡å­—é«˜åº¦(line-height)normal é»˜è®¤ã€‚è®¾ç½®åˆç†çš„è¡Œé—´è·ã€‚number è®¾ç½®æ•°å­—ï¼Œæ­¤æ•°å­—ä¼šä¸Žå½“å‰çš„å­—ä½“å°ºå¯¸ç›¸ä¹˜æ¥è®¾ç½®è¡Œé—´è·ã€‚length è®¾ç½®å›ºå®šçš„è¡Œé—´è·ã€‚10px% åŸºäºŽå½“å‰å­—ä½“å°ºå¯¸çš„ç™¾åˆ†æ¯”è¡Œé—´è·ã€‚inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ line-height å±žæ€§çš„å€¼ã€‚p.big &#123;line-height:200%;&#125;p.test &#123;line-height:10px;&#125;---8. æ–‡å­—é˜´å½±(text-shadow)h-shadow å¿…éœ€ã€‚æ°´å¹³é˜´å½±çš„ä½ç½®ã€‚å…è®¸è´Ÿå€¼ã€‚v-shadow å¿…éœ€ã€‚åž‚ç›´é˜´å½±çš„ä½ç½®ã€‚å…è®¸è´Ÿå€¼ã€‚blur å¯é€‰ã€‚æ¨¡ç³Šçš„è·ç¦»ã€‚color å¯é€‰ã€‚é˜´å½±çš„é¢œè‰²ã€‚å‚é˜… CSS é¢œè‰²å€¼ã€‚h1 &#123;color:white;text-shadow:2px -2px 3px #000;&#125;--- 9. æ–‡æœ¬ä¹¦å†™æ–¹å‘å¤šè¯­è¨€æ”¯æŒ(unicode-bidi)unicode-bidi å±žæ€§ä¸Ž direction å±žæ€§ä¸€èµ·ä½¿ç”¨ï¼Œæ¥è®¾ç½®æˆ–è¿”å›žæ–‡æœ¬æ˜¯å¦è¢«é‡å†™ï¼Œä»¥ä¾¿åœ¨åŒä¸€æ–‡æ¡£ä¸­æ”¯æŒå¤šç§è¯­è¨€ã€‚å¦‚é˜¿æ‹‰ä¼¯è¯­è¨€æ˜¯ä»Žå·¦åˆ°å³ä¹¦å†™çš„ã€‚ä½¿ç”¨è¯¥å±žæ€§å¯ä»¥æ”¹å˜åŒºåŸŸå†…æ–‡å­—ä¹¦å†™æ–¹å‘normal é»˜è®¤ã€‚ä¸ä½¿ç”¨é™„åŠ çš„åµŒå…¥å±‚é¢ã€‚ embed åˆ›å»ºä¸€ä¸ªé™„åŠ çš„åµŒå…¥å±‚é¢ã€‚ bidi-override åˆ›å»ºä¸€ä¸ªé™„åŠ çš„åµŒå…¥å±‚é¢ã€‚é‡æ–°æŽ’åºå–å†³äºŽ direction å±žæ€§ã€‚ initial è®¾ç½®è¯¥å±žæ€§ä¸ºå®ƒçš„é»˜è®¤å€¼ã€‚è¯·å‚é˜… initialinherit ä»Žçˆ¶å…ƒç´ ç»§æ‰¿è¯¥å±žæ€§ã€‚è¯·å‚é˜… inheritã€‚div.ex1&#123; direction:rtl; unicode-bidi:bidi-override;&#125;---10. æ–‡å­—åž‚ç›´å¯¹é½(vertical-align)baseline é»˜è®¤ã€‚å…ƒç´ æ”¾ç½®åœ¨çˆ¶å…ƒç´ çš„åŸºçº¿ä¸Šã€‚sub åž‚ç›´å¯¹é½æ–‡æœ¬çš„ä¸‹æ ‡ã€‚super åž‚ç›´å¯¹é½æ–‡æœ¬çš„ä¸Šæ ‡top æŠŠå…ƒç´ çš„é¡¶ç«¯ä¸Žè¡Œä¸­æœ€é«˜å…ƒç´ çš„é¡¶ç«¯å¯¹é½text-top æŠŠå…ƒç´ çš„é¡¶ç«¯ä¸Žçˆ¶å…ƒç´ å­—ä½“çš„é¡¶ç«¯å¯¹é½middle æŠŠæ­¤å…ƒç´ æ”¾ç½®åœ¨çˆ¶å…ƒç´ çš„ä¸­éƒ¨ã€‚bottom æŠŠå…ƒç´ çš„é¡¶ç«¯ä¸Žè¡Œä¸­æœ€ä½Žçš„å…ƒç´ çš„é¡¶ç«¯å¯¹é½ã€‚text-bottom æŠŠå…ƒç´ çš„åº•ç«¯ä¸Žçˆ¶å…ƒç´ å­—ä½“çš„åº•ç«¯å¯¹é½ã€‚length ç™¾åˆ†æ¯”% ä½¿ç”¨ "line-height" å±žæ€§çš„ç™¾åˆ†æ¯”å€¼æ¥æŽ’åˆ—æ­¤å…ƒç´ ã€‚å…è®¸ä½¿ç”¨è´Ÿå€¼ã€‚inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ vertical-align å±žæ€§çš„å€¼ã€‚--- 11. æ–‡å­—ç©ºç™½å¤„ç†(white-space)normal é»˜è®¤ã€‚ç©ºç™½ä¼šè¢«æµè§ˆå™¨å¿½ç•¥ã€‚pre ç©ºç™½ä¼šè¢«æµè§ˆå™¨ä¿ç•™ã€‚å…¶è¡Œä¸ºæ–¹å¼ç±»ä¼¼ HTML ä¸­çš„ &lt;pre&gt; æ ‡ç­¾ã€‚nowrap æ–‡æœ¬ä¸ä¼šæ¢è¡Œï¼Œæ–‡æœ¬ä¼šåœ¨åœ¨åŒä¸€è¡Œä¸Šç»§ç»­ï¼Œç›´åˆ°é‡åˆ° &lt;br&gt; æ ‡ç­¾ä¸ºæ­¢ã€‚pre-wrap ä¿ç•™ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯æ­£å¸¸åœ°è¿›è¡Œæ¢è¡Œã€‚pre-line åˆå¹¶ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯ä¿ç•™æ¢è¡Œç¬¦ã€‚inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ white-space å±žæ€§çš„å€¼---12. å•è¯é—´è·(word-spacing)å•è¯ä¹‹é—´çš„é—´è·ï¼Œä¸åŒäºŽletter-spacing(å­—æ¯å­—ç¬¦é—´è·)normal é»˜è®¤ã€‚å®šä¹‰å•è¯é—´çš„æ ‡å‡†ç©ºé—´ã€‚length å®šä¹‰å•è¯é—´çš„å›ºå®šç©ºé—´ã€‚inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ word-spacing å±žæ€§çš„å€¼ã€‚ CSS å­—ä½“ Property æè¿° font åœ¨ä¸€ä¸ªå£°æ˜Žä¸­è®¾ç½®æ‰€æœ‰çš„å­—ä½“å±žæ€§ font-family æŒ‡å®šæ–‡æœ¬çš„å­—ä½“ç³»åˆ— font-size æŒ‡å®šæ–‡æœ¬çš„å­—ä½“å¤§å° font-style æŒ‡å®šæ–‡æœ¬çš„å­—ä½“æ ·å¼ font-variant ä»¥å°åž‹å¤§å†™å­—ä½“æˆ–è€…æ­£å¸¸å­—ä½“æ˜¾ç¤ºæ–‡æœ¬ã€‚ font-weight æŒ‡å®šå­—ä½“çš„ç²—ç»†ã€‚ 1234567891011121. å­—ä½“ç³»åˆ—(font-family) font-family å±žæ€§åº”è¯¥è®¾ç½®å‡ ä¸ªå­—ä½“åç§°ä½œä¸ºä¸€ç§"åŽå¤‡"æœºåˆ¶ï¼Œå¦‚æžœæµè§ˆå™¨ä¸æ”¯æŒç¬¬ä¸€ç§å­—ä½“ï¼Œä»–å°†å°è¯•ä¸‹ä¸€ç§å­—ä½“ã€‚æ³¨æ„: å¦‚æžœå­—ä½“ç³»åˆ—çš„åç§°è¶…è¿‡ä¸€ä¸ªå­—,å¤šä¸ªæ±‰å­—æˆ–å¤šä¸ªå•è¯ï¼Œå®ƒå¿…é¡»ç”¨å¼•å·p.serif&#123;font-family:"Times New Roman",Times,serif;&#125;---2. å­—ä½“æ ·å¼(font-style)normal italicæ–œä½“ obliqueæ–œä½“p.oblique &#123;font-style:oblique;&#125;---3]]></content>
      <categories>
        <category>CSS</category>
      </categories>
      <tags>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java åŒé‡æ£€æŸ¥åŠ é”åˆ›å»ºå•ä¾‹]]></title>
    <url>%2Farticle%2F65563eb2%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä»‹ç» Java å•ä¾‹æ¨¡å¼ï¼Œä¸»è¦åŒ…æ‹¬ï¼š é¥¿æ±‰å¼å•ä¾‹å®žçŽ° æ‡’æ±‰å¼å•ä¾‹å®žçŽ° çº¿ç¨‹å®‰å…¨åŠ é”å•ä¾‹å®žçŽ° åŒé‡æ£€æŸ¥åŠ é”å•ä¾‹å®žçŽ°ã€‚ ä½¿ç”¨æžšä¸¾å®žçŽ°å•ä¾‹ é¥¿æ±‰å¼é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆé¥¿äº†ï¼Œå¿…é¡»ç«‹åˆ»åˆ›å»ºã€‚ é¥¿æ±‰å¼çš„ç‰¹ç‚¹å°±æ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Œåœ¨å¼€å§‹æ—¶å°±åˆ›å»ºï¼Œè€Œä¸”åªåˆ›å»ºä¸€æ¬¡ï¼ŒèŠ‚çº¦äº†è¿è¡Œæ—¶é—´ï¼Œä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œç¼ºç‚¹å°±æ˜¯å½“ä½ ä¸éœ€è¦ç”¨çš„æ—¶å€™ä¹ŸåŒæ ·å ç”¨å†…å­˜ç©ºé—´ã€‚ 123public class TokenProvider &#123; private static TokenProvider sInst = new TokenProvider();&#125; æ‡’æ±‰å¼ä½“çŽ°äº†ä¸€ç§æ‡’åŠ è½½çš„æ€æƒ³ï¼Œä¸éœ€è¦æ—¶ä¸åˆ›å»ºï¼Œéœ€è¦æ—¶æ‰åˆ›å»ºã€‚ æ‡’æ±‰å¼çš„ç‰¹ç‚¹å°±æ˜¯æ—¶é—´æ¢ç©ºé—´ï¼Œä¸éœ€è¦æ—¶ä¸åˆ›å»ºï¼Œéœ€è¦æ—¶æ‰åˆ›å»ºï¼ŒèŠ‚çº¦äº†å†…å­˜ç©ºé—´ï¼Œç¼ºç‚¹å°±æ˜¯æ¯æ¬¡èŽ·å–éƒ½éœ€è¦åˆ¤æ–­ï¼Œå¢žåŠ äº†è¿è¡Œæ—¶é—´ï¼Œè€Œä¸”ä¸åŠ é”çš„æ‡’æ±‰å¼æ— æ³•ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå¤šçº¿ç¨‹è®¿é—®æ—¶ï¼Œå‡è®¾ A çº¿ç¨‹æ­£åœ¨åˆ›å»ºå®žä½“ï¼Œæ­¤æ—¶ B çº¿ç¨‹å·²ç»å¼€å§‹è¿›è¡Œ sInst == null çš„åˆ¤ç©ºæ“ä½œï¼Œæ­¤æ—¶ B çº¿ç¨‹ä¾¿ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®žä½“ã€‚ å¦‚ä½•è§£å†³ï¼Ÿè¯·çœ‹ä¸‹é¢çº¿ç¨‹å®‰å…¨åŠ é” 1234567891011public class TokenProvider &#123; private static TokenProvider sInst; public static TokenProvider getInst() &#123; if (sInst == null) &#123; sInst = new TokenProvider(); &#125; return sInst; &#125;&#125; çº¿ç¨‹å®‰å…¨åŠ é”å½“ä½¿ç”¨æ‡’æ±‰å¼æ—¶ï¼Œå¦‚æžœå¤šçº¿ç¨‹åŒæ—¶åˆ›å»ºå•ä¾‹ï¼Œä¸åŠ é”çš„è¯å°±ä¼šåˆ›å»ºå¤šä¸ªå®žä½“ï¼Œæ— æ³•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ­¤æ—¶åº”åœ¨åˆ¤ç©ºæ“ä½œä¹‹å‰åŠ é”ï¼Œè®©å…¶ä»–çº¿ç¨‹åœ¨å¤–é¢ç­‰å¾…å·²ç»è¿›å…¥çš„çº¿ç¨‹å®Œæˆæ“ä½œï¼Œåˆ›å»ºå®Œæˆå®žä½“ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªçº¿ç¨‹è¿›å…¥æ—¶ï¼ŒsInst å·²ç»ä¸ä¸ºç©ºå¯ä»¥ç›´æŽ¥è¿”å›žï¼Œä»Žè€Œä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ ç¼ºç‚¹ä¹Ÿå¾ˆæ˜Žæ˜¾ï¼Œéœ€è¦ä½¿ç”¨è¯¥å•ä¾‹æ—¶ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½ä¼šé¦–å…ˆè¿›å…¥åŒæ­¥ä»£ç å—ï¼Œåœ¨çº¿ç¨‹åŒæ­¥æ—¶ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´ï¼Œæˆ‘ä»¬éœ€è¦é¿å…è¿™ç§æƒ…å†µï¼Œè¯·çœ‹ä¸‹èŠ‚åŒé‡æ£€æŸ¥åŠ é” 12345678910111213public class TokenProvider &#123; private static TokenProvider sInst; public static TokenProvider getInst() &#123; synchronized (TokenProvider.class) &#123; if (sInst == null) &#123; sInst = new TokenProvider(); &#125; &#125; return sInst; &#125;&#125; åŒé‡æ£€æŸ¥åŠ é”ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦é¿å…æ¯æ¬¡éƒ½è¿›è¡ŒåŒæ­¥åŠ é”ï¼Œåœ¨æœ€å¤–å±‚å…ˆè¿›è¡Œåˆ¤ç©ºæ“ä½œï¼Œå½“å®žä½“å·²ç»åˆ›å»ºæ—¶ï¼ŒåŽé¢çš„çº¿ç¨‹åˆ™ä¸éœ€è¦è¿›å…¥åŒæ­¥ä»£ç å—ç­‰å¾…ï¼ŒèŠ‚çº¦äº†æ—¶é—´ã€‚ volatile: è¢« volatile ä¿®é¥°çš„å˜é‡çš„å€¼ï¼Œå°†ä¸ä¼šè¢«æœ¬åœ°çº¿ç¨‹ç¼“å­˜ï¼Œæ‰€æœ‰å¯¹è¯¥å˜é‡çš„è¯»å†™éƒ½æ˜¯ç›´æŽ¥æ“ä½œå…±äº«å†…å­˜,ä»Žè€Œç¡®ä¿å¤šä¸ªçº¿ç¨‹èƒ½æ­£ç¡®çš„å¤„ç†è¯¥å˜é‡ã€‚ 123456789101112131415public class TokenProvider &#123; private volatile static TokenProvider sInst; public static TokenProvider getInst() &#123; if (sInst == null) &#123; synchronized (TokenProvider.class) &#123; if (sInst == null) &#123; sInst = new TokenProvider(); &#125; &#125; &#125; return sInst; &#125;&#125; ä½¿ç”¨æžšä¸¾å®žçŽ°å•ä¾‹ç®€å•è¯´ä¸€ä¸‹æžšä¸¾ï¼Œæžšä¸¾ç±»ä¼¼ç±»ï¼Œä¸€ä¸ªæžšä¸¾å¯ä»¥æ‹¥æœ‰æˆå‘˜å˜é‡ï¼Œæˆå‘˜æ–¹æ³•ï¼Œæž„é€ æ–¹æ³•ã€‚åˆ›å»ºenum æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªç»§æ‰¿è‡ª Java.lang.Enum çš„ç±»ï¼Œæž„å»ºå®žä¾‹çš„è¿‡ç¨‹ä¸æ˜¯æˆ‘ä»¬åšçš„ï¼Œä¸€ä¸ª enum çš„æž„é€ æ–¹æ³•é™åˆ¶æ˜¯ private çš„ï¼Œä¹Ÿå°±æ˜¯ä¸å…è®¸æˆ‘ä»¬è°ƒç”¨ã€‚å•ä¾‹ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ˜¯ static final ç±»åž‹ï¼Œä¸‹é¢ä»£ç çš„å¯¹æ¯”åº”è¯¥æ›´æ¸…æ¥šä¸€äº› 123enum Type&#123; A,B,C,D;&#125; ç­‰åŒäºŽ 123456class Type extends Enum&#123; public static final Type A; public static final Type B; public static final Type C; public static final Type D;&#125; åœ¨æžšä¸¾ä¸­æˆ‘ä»¬æ˜Žç¡®äº†æž„é€ æ–¹æ³•é™åˆ¶ä¸ºç§æœ‰ï¼Œåœ¨æˆ‘ä»¬è®¿é—®æžšä¸¾å®žä¾‹æ—¶ä¼šæ‰§è¡Œæž„é€ æ–¹æ³•ï¼ŒåŒæ—¶æ¯ä¸ªæžšä¸¾å®žä¾‹éƒ½æ˜¯ static final ç±»åž‹çš„ï¼Œä¹Ÿå°±è¡¨æ˜Žåªèƒ½è¢«å®žä¾‹åŒ–ä¸€æ¬¡ã€‚åœ¨è°ƒç”¨æž„é€ æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬çš„å•ä¾‹è¢«å®žä¾‹åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå› ä¸º enum ä¸­çš„å®žä¾‹è¢«ä¿è¯åªä¼šè¢«å®žä¾‹åŒ–ä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ INSTANCE ä¹Ÿè¢«ä¿è¯å®žä¾‹åŒ–ä¸€æ¬¡ã€‚ 12345678910111213public enum TokenProviderSingleton &#123; INSTANCE; private TokenProvider mInst; TokenProviderSingleton() &#123; mInst = new TokenProvider(); &#125; public TokenProvider getInst() &#123; return mInst; &#125;&#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Js å¼€å‘-1(åŸºç¡€)]]></title>
    <url>%2Farticle%2F22324dc8%2F</url>
    <content type="text"><![CDATA[Js æ˜¯å¼±ç±»åž‹åŠ¨æ€è¯­è¨€ å†…å»ºæ•°æ®ç±»åž‹object (Func,Array,Dateâ€¦)numberstringbooleannullundefined + : åªè¦æœ‰å­—ç¬¦ä¸²å°±æ˜¯å­—ç¬¦ä¸²æ‹¼æŽ¥- : å¦‚æžœæœ‰å­—ç¬¦ä¸²ï¼Œè½¬æ¢ä¸ºæ•°å­—è®¡ç®— == : ç­‰äºŽï¼Œç±»åž‹ç›¸åŒï¼ŒåŒ ===ï¼Œç±»åž‹ä¸åŒï¼Œè¿›è¡Œè½¬æ¢ï¼Œnull == undefined, number == string(è½¬æ¢ä¸ºæ•°å­—æ¯”è¾ƒ)ï¼Œboolean == number(booleanè½¬æ¢ä¸ºnumber),object == number/string(å°è¯•å°†objè½¬ä¸ºåŸºæœ¬ç±»åž‹)=== : ä¸¥æ ¼ç­‰äºŽï¼Œç±»åž‹ä¸åŒï¼Œè¿”å›ž falseï¼Œç±»åž‹ç›¸åŒ null === null,undefined === undefind,NaN != NaN,new Object != new Object]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Retrofitå¼€å‘-2-ç»“åˆRxJava]]></title>
    <url>%2Farticle%2F36f21fa4%2F</url>
    <content type="text"><![CDATA[è¯·å…ˆé˜…è¯» Retrofit å¼€å‘-1(OkHttp+RetrofitåŸºæœ¬ä½¿ç”¨) æœ¬æ–‡å»ºç«‹åœ¨å¯¹ RxJava2.x å’Œ Retrofit åŸºæœ¬ç†Ÿæ‚‰çš„åŸºç¡€ä¸Šï¼Œä¸»è¦æ˜¯åœ¨ Android å¹³å°ä¸‹å¯¹ RxJava + Retrifit å‘é€è¯·æ±‚è¿›è¡Œå°è£…æ–¹æ³•çš„æŽ¢ç´¢ã€‚ å‡†å¤‡é¦–å…ˆä½ è¦ç¡®ä¿åœ¨åˆ›å»º Retrofit æ—¶ä½¿ç”¨äº† RcJava çš„æ•°æ®è½¬æ¢é€‚é…å™¨ã€‚ ä¾èµ– 1adapter_rxjava2 : 'com.jakewharton.retrofit:retrofit2-rxjava2-adapter:1.0.0', é…ç½® 12final Retrofit.Builder retrofitBuilder = new Retrofit.Builder();retrofitBuilder.addCallAdapterFactory(RxJava2CallAdapterFactory.createWithScheduler(Schedulers.io())); å°†æ•°æ®ä¸­è¿”å›žçš„å…¨éƒ¨ç±»åž‹æ”¹æˆ Observable ç±»åž‹ 12345@GET(GET_USER_INFO)Observable&lt;UserInfoDTOResponse&gt; getUser();@GET(GET_BABY_RELATION_LIST)Observable&lt;UserBabyRelationResp&gt; getBabyRelationList(@Query("babyId") Long babyId, @Query("limit") int limit, @Query("offset") Long offset); è¯·æ±‚æ•°æ®è¿™è¾¹ç†Ÿæ‚‰äº† RxJava çš„ç›¸å…³ä½¿ç”¨å’Œæ“ä½œç¬¦ä¹‹åŽç”¨èµ·æ¥è¿˜ç®—å¾—å¿ƒåº”æ‰‹ï¼Œå°±ä¸åšè¿‡å¤šè§£é‡Šï¼Œè´´ä¸¤æ®µä»£ç æ„Ÿå—ä¸€ä¸‹ã€‚ å°è£…çš„ Observer 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class ObserverWrap&lt;T&gt; implements Observer&lt;T&gt; &#123; Context mContext; public ObserverWrap(Context context) &#123; mContext = context; &#125; public ObserverWrap() &#123; &#125; @Override public void onSubscribe(@NonNull Disposable d) &#123; L.eWithTread("Rx", "onSubscribe"); &#125; @Override public void onNext(@NonNull T t) &#123; L.eWithTread("Rx", "onNext -&gt; " + t.toString()); &#125; @Override public void onError(@NonNull Throwable e) &#123; L.eWithTread("Rx", "onError"); e.printStackTrace(); ToastUtil.show("è¯·æ±‚å¤±è´¥"); if (e instanceof UnknownHostException) &#123; ToastUtil.show("ç½‘ç»œä¸å¥½"); &#125; onFinish(); &#125; @Override public void onComplete() &#123; L.eWithTread("Rx", "onComplete"); onFinish(); &#125; public void onFinish() &#123; if (mContext != null) &#123; ((BaoBaoBaseActivity) mContext).dismissLoadingDialog(); &#125; &#125;&#125; èŽ·å–ç”¨æˆ·ä¿¡æ¯ 123456789101112131415// è°ƒç”¨RequestTest.getUserInfo() .subscribe(new ObserverWrap&lt;UserInfoDTOResponse.UserInfoDTO&gt;()); // æ–¹æ³•public static Observable&lt;UserInfoDTOResponse.UserInfoDTO&gt; getUserInfo() &#123; return ApiRequest.getService().getUser() .map(new Function&lt;UserInfoDTOResponse, UserInfoDTOResponse.UserInfoDTO&gt;() &#123; @Override public UserInfoDTOResponse.UserInfoDTO apply(@io.reactivex.annotations.NonNull UserInfoDTOResponse userInfoDTOResponse) throws Exception &#123; return userInfoDTOResponse.getData(); &#125; &#125;) .observeOn(AndroidSchedulers.mainThread());&#125; æ¥ä¸€ä¸ªå¤æ‚ç‚¹çš„ï¼ŒèŽ·å–ä¸€ä¸ªåˆ—è¡¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// è°ƒç”¨RequestTest.getUserBabyRelationList(mActivity,baby) .subscribe(new ObserverWrap&lt;UserBabyRelation&gt;(mActivity)); // æ–¹æ³•public static Observable&lt;UserBabyRelation&gt; getUserBabyRelationList(final Context context, Baby baby) &#123; return ApiRequest.getService() .getBabyRelationList(baby.getBabyId(), 100, null) .subscribeOn(Schedulers.newThread()) .doOnSubscribe(new Consumer&lt;Disposable&gt;() &#123; @Override public void accept(@io.reactivex.annotations.NonNull Disposable disposable) throws Exception &#123; if(context instanceof BaoBaoBaseActivity)&#123; ((BaoBaoBaseActivity) context).showLoadingDialog(); &#125; &#125; &#125;) .subscribeOn(AndroidSchedulers.mainThread()) .filter(new Predicate&lt;UserBabyRelationResp&gt;() &#123; @Override public boolean test(@io.reactivex.annotations.NonNull UserBabyRelationResp userBabyRelationResp) throws Exception &#123; if (userBabyRelationResp.getStatus() == 200 &amp;&amp; isRespNotNull(userBabyRelationResp)) &#123; return true; &#125; else if (userBabyRelationResp.getStatus() != 200) &#123; if (userBabyRelationResp.getMessage() != null) &#123; ToastUtil.show(userBabyRelationResp.getMessage()); &#125; return false; &#125; return false; &#125; &#125;) .map(new Function&lt;UserBabyRelationResp, List&lt;UserBabyRelation&gt;&gt;() &#123; @Override public List&lt;UserBabyRelation&gt; apply(@io.reactivex.annotations.NonNull UserBabyRelationResp userBabyRelationResp) throws Exception &#123; return userBabyRelationResp.getData().getList(); &#125; &#125;) .flatMap(new Function&lt;List&lt;UserBabyRelation&gt;, ObservableSource&lt;UserBabyRelation&gt;&gt;() &#123; @Override public ObservableSource&lt;UserBabyRelation&gt; apply(@io.reactivex.annotations.NonNull List&lt;UserBabyRelation&gt; userBabyRelations) throws Exception &#123; return Observable.fromIterable(userBabyRelations); &#125; &#125;) .observeOn(AndroidSchedulers.mainThread());&#125; å°è£…åœ¨ Android å¹³å°ä¸‹æˆ‘ä»¬è¿›è¡Œç½‘ç»œè¯·æ±‚æ—¶ï¼Œå¾€å¾€æœ‰äº›ç‰¹æ®Šçš„è¦æ±‚ï¼Œæ€»ç»“å¦‚ä¸‹ï¼Œä¸æ–­å®Œå–„å®žçŽ°ä¸‹åˆ—éœ€æ±‚çš„æ–¹æ³•ï¼Œå¯»æ‰¾ä¸€ç§æ›´åˆé€‚æ›´ç®€å•çš„ Retrofit + RxJava çš„ç½‘ç»œè¯·æ±‚æž¶æž„ã€‚ è¯·æ±‚å¼€å§‹æ—¶ï¼Œæ˜¾ç¤º Dialog æç¤ºç”¨æˆ·ç­‰å¾…ï¼Œè¯·æ±‚ç»“æŸæ—¶æ¶ˆæŽ‰ Dialog å½“ Activity é”€æ¯æ—¶å–æ¶ˆå½“å‰ç•Œé¢çš„è¯·æ±‚ã€‚ å½“ Dialog è¢«è®¤ä¸º cancel æ—¶ï¼Œå–æ¶ˆå½“å‰é¡µé¢çš„è¯·æ±‚ã€‚]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Retrofit</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxJava2.xå¼€å‘-3-æºç åˆ†æž]]></title>
    <url>%2Farticle%2F7ae7177b%2F</url>
    <content type="text"><![CDATA[çŸ¥å…¶ç„¶(çŸ¥é“è½®å­æ˜¯æ€Žä¹ˆç”¨çš„)ï¼ŒçŸ¥å…¶æ‰€ä»¥ç„¶(ä¹Ÿè¦çŸ¥é“è½®å­æ˜¯æ€Žä¹ˆé€ çš„)ã€‚ æœ¬æ–‡ä¸»è¦ä»‹ç» RxJava2.x æ˜¯å¦‚ä½•é€šè¿‡æµå¼APIå®Œæˆäº‹ä»¶çš„ä¼ é€’å’Œå˜æ¢çš„ï¼Œæˆ‘ä»¬ä¸æ˜¯è¦å…¨éƒ¨æŠŠå®ƒå¼„çš„æ¸…æ¸…æ¥šæ¥šï¼Œé‚£éœ€è¦å¤§é‡çš„æ—¶é—´å’Œä¸æ–­æ·±å…¥æ‰å¯ä»¥ï¼Œåªæ˜¯é€šè¿‡ç®€å•çš„ä¾‹å­æ¥ç†è§£ä»–çš„åŸºæœ¬å·¥ä½œåŽŸç†å’Œä¸»è¦åŠŸèƒ½ã€‚ çœ‹äº†å¾ˆå¤šæ–‡ç« ï¼Œæ–‡ç« ä¸­ä¼šè®²ä»£ç†æ¨¡å¼ä»€ä¹ˆçš„ï¼Œä½†æˆ‘è§‰å¾—æ›´åƒæ˜¯åŒ…è£…è€…æ¨¡å¼ï¼Œå¯èƒ½æˆ‘ç†è§£æœ‰åå·®ðŸ˜­ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™æ ·æ›´å¥½ç†è§£ä¸€äº›ï¼Œæˆ‘å°±å…ˆæŒ‰ç…§æˆ‘çš„ç†è§£æ¥å†™ï¼ŒåŽé¢ä¸å¯¹å†ä¿®æ­£å¥½äº†ã€‚ æ–‡ä¸­æºç æˆ‘ä¼šåŽ»æŽ‰é”™è¯¯æ£€æŸ¥å’Œæ³¨è§£çš„éƒ¨åˆ†ä»£ç ï¼Œåªä¿ç•™æ ¸å¿ƒä»£ç ï¼Œçœ‹èµ·æ¥æ›´æ¸…æ™°ã€‚ ç®€å•çš„è®¢é˜…çœ‹ä¸€ä¸ªæœ€æœ€ç®€å•çš„ä¾‹å­ 1234567891011121314151617181920212223Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; e.onNext(1); &#125;&#125;).subscribe(new Observer&lt;Integer&gt;() &#123; @Override public void onSubscribe(@NonNull Disposable d) &#123; log("onSubscribe"); &#125; @Override public void onNext(@NonNull Integer integer) &#123; log("onNext - &gt; " + integer); &#125; @Override public void onError(@NonNull Throwable e) &#123; log("onError"); &#125; @Override public void onComplete() &#123; log("onComplete"); &#125;&#125;); è¿™å¯èƒ½æ˜¯æœ€æœ€åŸºæœ¬çš„ç”¨æ³•äº†ï¼Œç„¶åŽçœ‹ä¸€ä¸‹æºç ï¼Œè¢«è§‚å¯Ÿè€…æ˜¯å¦‚ä½•å‘è§‚å¯Ÿè€…å‘é€æ•°æ®çš„ï¼Œé¦–å…ˆæ˜¯åˆ›å»ºè¢«è§‚å¯Ÿè€…çš„è¿‡ç¨‹ã€‚ 123456// Observable.javapublic static &lt;T&gt; Observable&lt;T&gt; create(ObservableOnSubscribe&lt;T&gt; source) &#123; ObjectHelper.requireNonNull(source, "source is null"); return RxJavaPlugins.onAssembly(new ObservableCreate&lt;T&gt;(source));&#125; ObservableOnSubscribe æ˜¯ä¸ªæŽ¥å£ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ª subscribe() æ–¹æ³•ï¼Œè€Œæˆ‘ä»¬å°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­è¿›è¡Œäº‹ä»¶çš„å‘é€çš„ã€‚æºç ä¸­å¯ä»¥çœ‹è§å®žé™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ª ObservableCreate è¿”å›žäº†ï¼Œè¿™ä¸ª ObservableCreate å…¶å®žæ˜¯Observable çš„å­ç±»ï¼Œä»–æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…çš„å…·ä½“å®žçŽ°ï¼Œå› ä¸ºæ˜¯å†…éƒ¨è‡ªå·±åˆ›å»ºçš„æ‰€ä»¥å« ObservableCreateï¼Œæˆ‘çŒœçš„ã€‚æ•´ä¸ªè¿‡ç¨‹å°±åˆ›å»ºäº†ä¸€ä¸ª ObservableCreate å¹¶è¿”å›žäº†å›žæ¥ï¼Œç„¶åŽæ€Žä¹ˆå°±å¯ä»¥ç»§ç»­é“¾å¼è°ƒç”¨äº†ï¼Œæ¯”å¦‚åœ¨ä¸Šé¢çš„ç®€å•ä¾‹å­ä¸­ï¼Œè°ƒç”¨äº† subscirbe() æ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯æœ€åŽå°†è°ƒç”¨çš„æ–¹æ³•ã€‚ æˆ‘ä»¬å°±ä¸Šé¢çš„ç®€å•ä¾‹å­æ¥ç»§ç»­çœ‹ subscribe() å‘ç”Ÿçš„ä¸€åˆ»å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘åŽ»æŽ‰äº†å„ç§æ£€æŸ¥é”™è¯¯çš„ä»£ç ï¼Œåªä¿ç•™æ ¸å¿ƒä»£ç ã€‚ 12345// Observable.javapublic final void subscribe(Observer&lt;? super T&gt; observer) &#123; subscribeActual(observer);&#125; æ²¡é”™ï¼Œå°±å‰©äº†ä¸€å¥äº†ï¼ŒsubscribeActual() æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜è¦åŽ»çœ‹ä¸€ä¸‹å­ç±»çš„å…·ä½“å®žçŽ°ï¼Œä¸Šé¢æˆ‘ä»¬å‘çŽ°åˆ›å»ºçš„ Observable çš„å­ç±»æ˜¯ ObservableCreateï¼Œé‚£æˆ‘ä»¬è‚¯å®šæ˜¯è¦åŽ»çœ‹è¿™ä¸ªå­ç±»äº†ã€‚ 1234567891011121314151617// ObservableCreate.javapublic final class ObservableCreate&lt;T&gt; extends Observable&lt;T&gt; &#123; final ObservableOnSubscribe&lt;T&gt; source; public ObservableCreate(ObservableOnSubscribe&lt;T&gt; source) &#123; this.source = source; &#125; @Override protected void subscribeActual(Observer&lt;? super T&gt; observer) &#123; CreateEmitter&lt;T&gt; parent = new CreateEmitter&lt;T&gt;(observer); observer.onSubscribe(parent); source.subscribe(parent); &#125;&#125; è¿˜æ˜¯åªçœ‹é‡ç‚¹çš„ï¼Œfinal ObservableOnSubscribe&lt;T&gt; source; å°±æ˜¯æˆ‘ä»¬åˆ›å»º Observable æ—¶ä¼ è¿›åŽ»çš„æŽ¥å£ç±»ï¼Œä»–åªæœ‰ä¸€ä¸ª subscribe() æ–¹æ³•ï¼Œå†æ¥ä»”ç»†çœ‹ä¸€ä¸‹ subscribeActual() çš„å®žçŽ°ï¼Œå‚æ•°è‡ªç„¶æ˜¯è¦è®¢é˜…è¿‡æ¥çš„è§‚å¯Ÿè€… Observerï¼Œç„¶åŽå¯ä»¥çœ‹åˆ° Observer è¢«åŒ…è£…æˆäº†ä¸€ä¸ª CreateEmitter å‘å°„å™¨ï¼Œæˆ‘ä»¬çŸ¥é“ä»–æ˜¯ç”¨æ¥å‘å°„äº‹ä»¶çš„ï¼Œé‚£æˆ‘ä»¬å†çœ‹ä¸€çœ¼å‘å°„å™¨ï¼Œä¸ç»†çœ‹ï¼Œä»–æ˜¯ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œçœ‹ä¸€ä¸‹ç±»å£°æ˜Žå³å¯ 123static final class CreateEmitter&lt;T&gt; extends AtomicReference&lt;Disposable&gt; implements ObservableEmitter&lt;T&gt;, Disposable&#123;&#125; æŽ¥ç€ä¸Šé¢çš„è¯´ï¼Œç„¶åŽå°†å‘å°„å™¨ä½œä¸ºå‚æ•°æ‰§è¡Œäº† ObservableOnSubscribe çš„ subscribe() æ–¹æ³•ï¼Œç„¶åŽä¼šæ€Žä¹ˆæ ·ï¼Ÿè‡ªç„¶æ˜¯æ‰§è¡Œæˆ‘ä»¬è‡ªå·±å®žçŽ°çš„ ObservableOnSubscribe çš„ subscribe() æ–¹æ³•ï¼Œå¼€å§‹ä½¿ç”¨å‘å°„å™¨å‘é€äº‹ä»¶ã€‚å…¶å®žæˆ‘ä»¬æ˜¯è°ƒç”¨å‘å°„å™¨ï¼Œå‘å°„å™¨è°ƒç”¨ä»–åŒ…è£…çš„ Observer ä¸­å¯¹åº”çš„æ–¹æ³•è€Œå·²ã€‚ æ’ä¸€å¥ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å½“è®¢é˜…å‘ç”Ÿæ—¶ï¼Œé¦–å…ˆæ‰§è¡Œäº† observer.onSubscribe(parent); æ–¹æ³•ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºå•¥è§‚å¯Ÿè€…ä¸­çš„æ–¹æ³•ä¸ºä»€ä¹ˆä¼šé¦–å…ˆè¢«è°ƒç”¨ï¼Œè€Œ CreateEmitter æ˜¯å®žçŽ°äº† Disposable æŽ¥å£çš„ï¼Œå®ƒå¯ç”¨æ¥åˆ‡æ–­äº‹ä»¶æµã€‚ æ€»ç»“ï¼Œå½“è§‚å¯Ÿè€…è¢«è®¢é˜…åˆ°è¢«è§‚å¯Ÿè€…æ—¶ï¼Œè¢«è§‚å¯Ÿè€…è¢«åŒ…è£…æˆä¸€ä¸ªå‘å°„å™¨ï¼Œè°ƒç”¨ subscribe() æ–¹æ³•ï¼Œä½¿ç”¨å‘å°„å™¨å‘å°„äº‹ä»¶ï¼Œè¢«è§‚å¯Ÿè€…æ”¶åˆ°äº‹ä»¶ã€‚ æ“ä½œç¬¦åœ¨å®žé™…åº”ç”¨è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯èƒ½ç»åŽ†æ— æ•°æ¬¡æ“ä½œç¬¦çš„å˜åŒ–ï¼Œä½†æ˜¯ä¸ºäº†ç®€åŒ–åˆ†æžçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬åªçœ‹ä½¿ç”¨äº†ä¸€ä¸ªæ“ä½œç¬¦çš„ä¾‹å­ï¼Œç„¶åŽç±»æŽ¨ä¸€ä¸‹ï¼Œå…¶å®žå¤šä¸ªå˜åŒ–ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ çœ‹ä¸€ä¸ªä½¿ç”¨æ“ä½œç¬¦çš„åœºæ™¯ 12345678910111213141516Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; e.onNext(1); &#125;&#125;).map(new Function&lt;Integer, String&gt;() &#123; @Override public String apply(@NonNull Integer integer) throws Exception &#123; return String.valueOf(integer); &#125;&#125;).subscribe(new Consumer&lt;String&gt;() &#123; @Override public void accept(@NonNull String s) throws Exception &#123; log("accept -&gt; " + s); &#125;&#125;); åœ¨ä¸Šä¸ªé—®é¢˜çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä»¥ map æ“ä½œç¬¦ä¸ºä¾‹çœ‹ä¸€ä¸‹ï¼Œä½¿ç”¨æ“ä½œç¬¦çš„åœºæ™¯æ˜¯å¦‚ä½•å»ºç«‹è¿žæŽ¥ï¼Œå‘é€äº‹ä»¶çš„ï¼Œç›´æŽ¥æ¥çœ‹ map æ–¹æ³•ï¼Œåœ¨ map æ–¹æ³•ä¸­åˆ›å»ºäº†ä¸€ä¸ª ObservableMap è¿”å›žã€‚ 123456// Observable.javapublic final &lt;R&gt; Observable&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper) &#123; ObjectHelper.requireNonNull(mapper, "mapper is null"); return RxJavaPlugins.onAssembly(new ObservableMap&lt;T, R&gt;(this, mapper));&#125; è¿™ä¸ª ObservableMap ä¹Ÿæ˜¯ Observer çš„å­ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¹Ÿæ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œå‚æ•°æ˜¯å½“å‰çš„è¢«è§‚å¯Ÿè€…å’Œä¸€ä¸ª Functionï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ ObservableMapã€‚ 1234567891011121314151617181920212223242526272829public final class ObservableMap&lt;T, U&gt; extends AbstractObservableWithUpstream&lt;T, U&gt; &#123; final Function&lt;? super T, ? extends U&gt; function; public ObservableMap(ObservableSource&lt;T&gt; source, Function&lt;? super T, ? extends U&gt; function) &#123; super(source); this.function = function; &#125; @Override public void subscribeActual(Observer&lt;? super U&gt; t) &#123; source.subscribe(new MapObserver&lt;T, U&gt;(t, function)); &#125; static final class MapObserver&lt;T, U&gt; extends BasicFuseableObserver&lt;T, U&gt; &#123; final Function&lt;? super T, ? extends U&gt; mapper; MapObserver(Observer&lt;? super U&gt; actual, Function&lt;? super T, ? extends U&gt; mapper) &#123; super(actual); this.mapper = mapper; &#125; @Override public void onNext(T t) &#123; U v = mapper.apply(t) actual.onNext(v); &#125; &#125;&#125; ObservableMap åŒ…è£…äº†åŽŸæ¥çš„ SourceObservableï¼Œä¹ŸæŽ¥å—äº†æˆ‘ä»¬è¿›è¡Œ map æ“ä½œçš„ Functionã€‚å½“è®¢é˜…å‘ç”Ÿæ—¶ï¼Œä»æ—§ä¼šè°ƒç”¨ subscribeActual() æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æŠŠæœ€ç»ˆçš„è§‚å¯Ÿè€…åŒ…è£…æˆäº†ä¸€ä¸ª MapObserverï¼Œç„¶åŽæŠŠè¿™ä¸ª MapObserver è®¢é˜…åˆ°äº† SourceObservableã€‚ç»“åˆä¸Šé¢ç®€å•è®¢é˜…æ—¶çš„åˆ†æžï¼Œæ­¤æ—¶ï¼ŒSourceObservable ä¾¿ä¼šå°† MapObserver åŒ…è£…æˆä¸€ä¸ªå‘å°„å™¨ï¼Œå¼€å§‹å‘å°„äº‹ä»¶äº†ã€‚å†å…³æ³¨ä¸€ä¸‹ onNext() æ–¹æ³•ï¼Œè¿™é‡Œä¼šå…ˆè°ƒç”¨ Function è¿›è¡Œ map æ“ä½œã€‚ æ€»ç»“ï¼šæˆ‘ä»¬ç§°æœ€å¼€å§‹åˆ›å»ºçš„è¢«è§‚å¯Ÿè€…ä¸º SourceObservableï¼Œå¦‚æžœä¸­é—´å¢žåŠ ä¸€ä¸ª map æ“ä½œç¬¦ï¼Œæ­¤æ—¶åˆ›å»ºå¹¶ä¸”è¿”å›žäº†ä¸€ä¸ª ObservableMap åŒ…è£… SourceObservable ä½œä¸ºæ–°çš„è¢«è§‚å¯Ÿè€…ï¼Œæ­¤æ—¶é“¾å¼è°ƒç”¨çš„å¯¹å¤–å¼€æ”¾çš„å°±æ˜¯ ObservableMap äº†ï¼Œ å½“æœ€ç»ˆçš„è§‚å¯Ÿè€…ï¼Œæˆ‘ä»¬å«ä»– finalObserverï¼Œè¢«è®¢é˜…åˆ° ObservableMap æ—¶ï¼Œä¼šå°†finalObserver åŒ…è£…æˆä¸€ä¸ª MapObserver (è¿™ä¸ª MapObserver åœ¨è°ƒç”¨ onNext() æ—¶ä¼šç»§ç»­è°ƒç”¨ä»–åŒ…è£…çš„ finalObserver çš„ onNext() æ–¹æ³•å’Œå¯¹åº”çš„ Function æ–¹æ³•) è®¢é˜…åˆ° SourceObservableã€‚ç„¶åŽå¼€å§‹ç¬¬ä¸€èŠ‚ä¸­çš„æµç¨‹ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ª MapOserver å°†ä¼šè¢«åŒ…è£…æˆä¸€ä¸ªå‘å°„å™¨ï¼Œå¼€å§‹å‘å°„äº‹ä»¶ï¼Œç›¸æ¯”ä¹‹å‰ï¼Œæ­¤æ—¶è°ƒç”¨ OnNext() å‘é€äº‹ä»¶æ—¶ï¼Œä¼šé¦–å…ˆè°ƒç”¨ MapObserver çš„ onNext(),ç„¶åŽç»§ç»­è°ƒç”¨å®ƒåŒ…è£…çš„ finalObserver çš„ onNext(),ä¸è¿‡åœ¨è¿™ä¹‹é—´ä¼šä½¿ç”¨ Function æŒ‡å®šçš„æ“ä½œå¯¹æ•°æ®è¿›è¡Œå˜æ¢ å†å¢žåŠ ä¸€ä¸ªæ“ä½œç¬¦ä¼šæ€Žä¹ˆæ ·ï¼Œå…¶å®žå°±æ˜¯æ˜¯ä¸€æ ·çš„æµç¨‹äº†ï¼Œåªä¸è¿‡æ­¤æ—¶å¯¹å¤–å¼€æ”¾çš„ ObservalMap æ‰®æ¼”äº† SourceObservable çš„è§’è‰²ã€‚ æˆ‘åœ¨ RxJava2.xå¼€å‘-2 (Schedulers) è¿™ç¯‡æ–‡ç« ä¸­ä»‹ç»äº†å¦‚ä½•åœ¨ RxJava2.x ä¸­å¦‚ä½•ä½¿ç”¨çº¿ç¨‹è°ƒåº¦ï¼Œå’Œå¦‚ä½•åˆ¤æ–­å½“å‰æ–¹æ³•æ˜¯è¿è¡Œåœ¨å“ªä¸ªçº¿ç¨‹ï¼Œå¼ºçƒˆå»ºè®®åŽ»çœ‹ä¸€ä¸‹æ‰èƒ½æ›´æ˜Žç™½ä»–æ˜¯æ€Žä¹ˆæ ·ä½¿ç”¨çš„ï¼Œä¹‹å‰æ€»ç»“äº†æ€Žä¹ˆåšï¼ŒçŽ°åœ¨çœ‹ä¸€ä¸‹ä¸ºä»€ä¹ˆã€‚ subscribeOn()åœ¨ RxJava2.xå¼€å‘-2 (Schedulers) æ€»ç»“äº† subscribeOn() ç”¨æ¥åˆ‡æ¢ä¸Šæ¸¸çº¿ç¨‹ï¼Œè€Œä¸”åªæœ‰ç¬¬ä¸€æ¬¡æœ‰æ•ˆï¼ŒåŽé¢çš„è°ƒç”¨åªå¯¹ doOnSubscribe()/onSubscribe() æ–¹æ³•æœ‰æ•ˆï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·å‘¢ï¼Ÿ çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ 123456789101112Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; e.onNext(1); &#125;&#125;).subscribeOn(Schedulers.io()) .subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer s) throws Exception &#123; log("accept -&gt; " + s); &#125; &#125;); è¢«è§‚å¯Ÿè€…å°†ä¼šåœ¨ io çº¿ç¨‹è¿è¡Œï¼Œä¸ºä»€ä¹ˆï¼Ÿçœ‹æºç ï¼Œä»æ—§æ˜¯è·Ÿä¹‹å‰ä¸€æ ·çš„æ¨¡å¼ï¼Œåˆ›å»ºæ–°çš„è¢«è§‚å¯Ÿè€…åŒ…è£…åŽŸæ¥çš„è§‚å¯Ÿè€…ã€‚ 123456// Observable.javapublic final Observable&lt;T&gt; subscribeOn(Scheduler scheduler) &#123; ObjectHelper.requireNonNull(scheduler, "scheduler is null"); return RxJavaPlugins.onAssembly(new ObservableSubscribeOn&lt;T&gt;(this, scheduler));&#125; æˆ‘ä»¬è¿˜æ˜¯å°†æœ€å¼€å§‹çš„ Observable ç§°ä½œ SourceObservableï¼ŒsubscribeOn() åˆ›å»ºå¹¶è¿”å›žäº† ObservableSubscribeOn å¯¹è±¡ï¼Œæ²¡é”™å®ƒä¹Ÿæ˜¯ Observable çš„å­ç±»ï¼Œæ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ã€‚æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ ObservableSubscribeOn ç±»ï¼Œåˆ›å»ºæ—¶ä½¿ç”¨äº†åŽŸæ¥çš„ SourceObservable å’Œä¸€ä¸ªçº¿ç¨‹è°ƒåº¦å™¨ï¼Œå…ˆè´´ä¸€ä¸‹æºä»£ç ï¼ŒåŽé¢è§£é‡Šã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// ObservableSubscribeOn.javapublic final class ObservableSubscribeOn&lt;T&gt; extends AbstractObservableWithUpstream&lt;T, T&gt; &#123; final Scheduler scheduler; public ObservableSubscribeOn(ObservableSource&lt;T&gt; source, Scheduler scheduler) &#123; super(source); this.scheduler = scheduler; &#125; @Override public void subscribeActual(final Observer&lt;? super T&gt; s) &#123; final SubscribeOnObserver&lt;T&gt; parent = new SubscribeOnObserver&lt;T&gt;(s); s.onSubscribe(parent); parent.setDisposable(scheduler.scheduleDirect(new SubscribeTask(parent))); &#125; static final class SubscribeOnObserver&lt;T&gt; extends AtomicReference&lt;Disposable&gt; implements Observer&lt;T&gt;, Disposable &#123; final Observer&lt;? super T&gt; actual; SubscribeOnObserver(Observer&lt;? super T&gt; actual) &#123; this.actual = actual; &#125; @Override public void onNext(T t) &#123; actual.onNext(t); &#125; &#125; final class SubscribeTask implements Runnable &#123; private final SubscribeOnObserver&lt;T&gt; parent; SubscribeTask(SubscribeOnObserver&lt;T&gt; parent) &#123; this.parent = parent; &#125; @Override public void run() &#123; source.subscribe(parent); &#125; &#125;&#125; é‡ç‚¹å°±åœ¨ subscribeActual() æ–¹æ³•ï¼Œæˆ‘ä»¬çŸ¥é“å½“è®¢é˜…å‘ç”Ÿæ—¶ä¼šè°ƒç”¨ subscribeActual() æ–¹æ³•ï¼Œæ­¤æ—¶ï¼Œåˆ›å»ºäº†ä¸€ä¸ª SubscribeOnObserver åŒ…è£…äº†çœŸæ­£è®¢é˜…çš„è§‚å¯Ÿè€…ï¼Œç„¶åŽè°ƒç”¨è§‚å¯Ÿè€… onSubscribe() æ–¹æ³•ï¼Œè¿™è·Ÿä¹‹å‰çš„ä»‹ç»æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯å°†æ–°åˆ›å»ºçš„ SubscribeOnObserver è®¢é˜…åˆ° SourceObservable è¿™ä¸ªè¿‡ç¨‹ï¼Œåšæˆäº†ä¸€ä¸ª Taskï¼Œå¹¶ä½¿ç”¨äº†çº¿ç¨‹è°ƒåº¦å™¨åŽ»æ‰§è¡Œï¼Œæ­¤æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¿˜æ˜¯ä¹‹å‰è¯´çš„ SubscribeOnObserver ä¼šè¢«åŒ…è£…æˆä¸€ä¸ªå‘å°„å™¨å¼€å§‹å‘å°„äº‹ä»¶ï¼Œè€Œæ­¤æ—¶å› ä¸ºä½¿ç”¨äº†çº¿ç¨‹è°ƒåº¦å™¨æ‰§è¡Œï¼Œå°†ä¼šè¿è¡Œåœ¨æŒ‡å®šçš„çº¿ç¨‹ã€‚ åˆ°çŽ°åœ¨å¤§è‡´æ¸…æ¥šäº† RxJava å¦‚ä½•ä½¿ç”¨ subscribeOn() æ–¹æ³•åˆ‡æ¢äº†è¢«è§‚å¯Ÿè€…æ‰€è¿è¡Œçš„çº¿ç¨‹ï¼Œé‚£ä¸ºä»€ä¹ˆåªæœ‰ç¬¬ä¸€æ¬¡æœ‰æ•ˆæžœï¼ŒåŽé¢ä¸ç”Ÿæ•ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆå¯¹äºŽ doOnSubscribe()/onSubscibe() åˆæ˜¯ç”Ÿæ•ˆçš„å‘¢ï¼Ÿ è™½ç„¶æˆ‘ä»¬å†™ä»£ç æ—¶æ˜¯ä»Žè¢«è§‚å¯Ÿè€…ä¸€è·¯é“¾å¼ç¼–ç¨‹å†™ä¸‹åŽ»çš„ï¼Œä½†æ˜¯å…¶å®žçœŸæ­£å¼€å§‹æ‰§è¡Œçš„æ—¶æœºæ˜¯ï¼Œè®¢é˜…å¼€å§‹çš„æ—¶å€™ï¼Œå³ subscribe() è°ƒç”¨çš„æ—¶å€™ã€‚è€Œä¸”æŒ‰ç…§æˆ‘ä»¬ä¹‹å‰çš„åˆ†æžï¼Œsubscribe() æ–¹æ³•ä¼šå¾€ä¸Šä¸€å±‚ä¸€å±‚çš„è°ƒç”¨ä¸ŠåŽ»ï¼Œä¸€ç›´åˆ°æœ€å¼€å§‹åˆ›å»ºçš„è¢«è§‚å¯Ÿè€…ï¼Œç„¶åŽå°±å¼€å§‹å‘é€äº‹ä»¶ã€‚é‚£æˆ‘ä»¬è°ƒç”¨ä¸¤æ¬¡ subscribeOn() æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šåœ¨é‡Œé¢ç”Ÿæˆæ–°çš„è¢«è§‚å¯Ÿè€…ï¼Œç„¶åŽåœ¨æŒ‡å®šçº¿ç¨‹è°ƒç”¨ subscribe() æ–¹æ³•ï¼Œæ‰€ä»¥å¼€å§‹çš„è¢«è§‚å¯Ÿè€…è¢«è°ƒç”¨çš„çº¿ç¨‹åªå–å†³äº†ç¦»ä»–æœ€è¿‘çš„é‚£ä¸ª subscribeOn() ï¼Œå› ä¸ºåœ¨è¿™é‡Œé¢ä¼šå°†å‘é€æœ€å¼€å§‹çš„è¢«è§‚å¯Ÿè€…çš„ subscribe() æ–¹æ³• åˆ°æŒ‡å®šçº¿ç¨‹è¿è¡Œï¼Œå°±å¥½åƒå‡å¦‚ ObserableA åœ¨ ThreadA çº¿ç¨‹å®Œæˆè®¢é˜…ï¼ŒæŽ¥ç€ä¼šç»§ç»­è°ƒç”¨é‡Œé¢åŒ…è£…çš„ ObserableB åœ¨ ThreadB çº¿ç¨‹å®Œæˆè®¢é˜…ï¼Œå…¶å®žæœ€ç»ˆçš„ ObserableB è¿˜æ˜¯åœ¨ ThreadB çº¿ç¨‹å®Œæˆè®¢é˜…å‘é€äº‹ä»¶çš„ã€‚å¦å¤–å¯ä»¥å‘çŽ° doOnSubscribe()/onSubscibe() æ˜¯åœ¨å‘é€åˆ°æŒ‡å®šçº¿ç¨‹æ‰§è¡Œä¹‹å‰å°±æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ä»–ä»æ—§å—åˆ°åŽé¢æŒ‡å®šçº¿ç¨‹çš„å½±å“ï¼ŒdoOnSubscribe() è¿”å›žçš„ä¹Ÿæ˜¯ä¸€ä¸ª Observableï¼Œæœºåˆ¶å¤§è‡´ç›¸åŒã€‚ observarOn()è°ƒç”¨ observarOn() å¯ä»¥åˆ‡æ¢ä¸‹æ¸¸æ‰€åœ¨çº¿ç¨‹ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ‡æ¢çº¿ç¨‹ã€‚ ç±»ä¼¼ä¸Šé¢çš„åŽŸç†ï¼Œä»æ—§ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„è¢«è§‚å¯Ÿè€… ObservableObserveOn 1234567// Observable.javapublic final Observable&lt;T&gt; observeOn(Scheduler scheduler, boolean delayError, int bufferSize) &#123; ObjectHelper.requireNonNull(scheduler, "scheduler is null"); ObjectHelper.verifyPositive(bufferSize, "bufferSize"); return RxJavaPlugins.onAssembly(new ObservableObserveOn&lt;T&gt;(this, scheduler, delayError, bufferSize));&#125; è®¢é˜…æ—¶ï¼Œå¦‚æžœä½¿ç”¨äº† Schedulers.trampoline() é‚£ä¹ˆåœ¨å½“å‰çº¿ç¨‹ï¼Œä¸éœ€è¦åœ¨åˆ›å»ºæ–°çš„åŒ…è£…è§‚å¯Ÿè€…ï¼Œå¦åˆ™åˆ›å»º ObserveOnObserver åŒ…è£…åŽŸæ¥çš„è§‚å¯Ÿè€…ã€‚ 1234567891011// ObserveOnObserver.java@Overrideprotected void subscribeActual(Observer&lt;? super T&gt; observer) &#123; if (scheduler instanceof TrampolineScheduler) &#123; source.subscribe(observer); &#125; else &#123; Scheduler.Worker w = scheduler.createWorker(); source.subscribe(new ObserveOnObserver&lt;T&gt;(observer, w, delayError, bufferSize)); &#125;&#125; çœ‹ä¸€ä¸‹ ObserveOnObserver å®ƒå®žçŽ°äº† Runnable æŽ¥å£ï¼Œåœ¨ run æ–¹æ³•ä¸­æ ¹æ®å½“å‰çŠ¶æ€ï¼Œåˆ†åˆ«è°ƒç”¨å®ƒåŒ…è£…çš„è§‚å¯Ÿè€…çš„å¯¹åº”æ–¹æ³•ã€‚ç„¶åŽåœ¨ç›¸åº”çš„æ–¹æ³•çš„æœ€åŽéƒ½ä¼šè°ƒç”¨ schedule(); å‘é€åˆ°æŒ‡å®šçº¿ç¨‹æ“ä½œï¼Œè¾¾åˆ°åˆ‡æ¢çº¿ç¨‹çš„ç›®çš„ï¼Œå¯¹åº”æ–¹æ³•æŒ‡çš„æ˜¯ onNext/onComplete/onError 1234567891011121314151617181920212223242526272829303132333435363738394041static final class ObserveOnObserver&lt;T&gt; extends BasicIntQueueDisposable&lt;T&gt;implements Observer&lt;T&gt;, Runnable &#123; @Override public void onNext(T t) &#123; schedule(); &#125; @Override public void onError(Throwable t) &#123; if (done) &#123; RxJavaPlugins.onError(t); return; &#125; error = t; done = true; schedule(); &#125; @Override public void onComplete() &#123; if (done) &#123; return; &#125; done = true; schedule(); &#125; // åŽ»æŒ‡å®šçº¿ç¨‹æ‰§è¡Œ void schedule() &#123; if (getAndIncrement() == 0) &#123; worker.schedule(this); &#125; &#125; @Override public void run() &#123; // ä¼šæ ¹æ®å½“å‰çš„çŠ¶æ€é˜Ÿå½¢æ‰§è¡Œè¢«åŒ…è£…çš„è§‚å¯Ÿè€…çš„ç›¸å…³æ–¹æ³•ã€‚ if (outputFused) &#123; drainFused(); &#125; else &#123; drainNormal(); &#125; &#125;&#125; æ€»ç»“è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘è‡ªå·±éƒ½æ„Ÿè§‰æœ‰ç‚¹ä¹±ï¼Œå¿ƒé‡Œæ˜Žç™½ä½†æ˜¯å†™ä¸å‡ºæ¥çš„æ„Ÿè§‰çœŸéš¾å—ï¼Œè¿˜æ˜¯æ–‡ç¬”ä¸è¡Œï¼Œæƒ³ç”»ä¸ªå›¾è¡¨ç¤ºä¸€ä¸‹ï¼Œä½†ç”»å®Œæ„Ÿè§‰æ›´å¤æ‚äº†ã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œæ¯æ¬¡å¢žåŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œæ¯”å¦‚æ“ä½œç¬¦ï¼Œæˆ–è€…çº¿ç¨‹åˆ‡æ¢ï¼Œéƒ½ä¼šè¿”å›žä¸€ä¸ªæ–°çš„è¢«è§‚å¯Ÿè€…åŒ…è£…åŽŸæ¥çš„è¢«è§‚å¯Ÿè€…ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„è§‚å¯Ÿè€…ï¼ŒåŽŸæ¥çš„è§‚å¯Ÿè€…ä¹Ÿä¼šè¢«åŒ…è£…è¿›è¿™ä¸ªæ–°çš„è§‚å¯Ÿè€…ï¼Œæ“ä½œç¬¦ä¼šå½¢æˆè¿›è¡Œæ•°æ®å˜æ¢çš„è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ï¼Œçº¿ç¨‹è°ƒåº¦ä¼šå½¢æˆçº¿ç¨‹åˆ‡æ¢çš„è¢«è§‚å¯Ÿè€…ä½•è§‚å¯Ÿè€…ï¼Œå½¢æˆä¸€ä¸ªä¸€å±‚ä¸€å±‚åŒ…è£…çš„å…³ç³»ã€‚ çœŸæ­£è§¦å‘ä»£ç æ‰§è¡Œçš„æ˜¯ subscribe() æ–¹æ³•ï¼Œæ­¤æ—¶å°±ä¼šä¸€å±‚ä¸€å±‚çš„è°ƒç”¨æ›´é‡Œé¢åŒ…è£…çš„è¢«è§‚å¯Ÿè€…çš„ subscribe() æ–¹æ³•ï¼Œå½“æœ€åŽä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æœ€å¼€å§‹åˆ›å»ºçš„é‚£ä¸ªçš„ subscribe() æ–¹æ³•è¢«è§¦å‘æ—¶ï¼Œäº‹ä»¶ä¾¿å¼€å§‹å‘é€ï¼Œäº‹ä»¶ä¼šä¸€å±‚ä¸€å±‚å¾€è§‚å¯Ÿè€…é‡Œé¢ä¼ é€’ï¼Œè§‚å¯Ÿè€…åˆä¼šè°ƒç”¨å®ƒé‡Œé¢åŒ…è£…çš„è§‚å¯Ÿè€…åŽ»å¤„ç†ä¼ é€’è¿™äº›äº‹ä»¶ï¼Œè¿™è¿‡ç¨‹ä¸­åŒ…å«äº†äº‹ä»¶çš„å¤„ç†ï¼Œå˜æ¢ï¼Œçº¿ç¨‹è°ƒåº¦ç­‰ã€‚ æ„Ÿè§‰è‡ªå·±åŸ‹äº†ä¸ªå‘ï¼Œè¯´äº†è¿™ä¹ˆå¤šï¼Œè¯´çš„ä¹Ÿä¸æ˜¯å¾ˆæ˜Žç™½ï¼Œæºç è¿˜æ˜¯è¦è‡ªå·±çœ‹ä¸€ä¸‹æ‰æ›´æ¸…æ¥šä¸€äº›ã€‚]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>RxJava2.x</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxJava2.xå¼€å‘-2-Schedulers]]></title>
    <url>%2Farticle%2F8de84f35%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» RxJava2.x å¼ºå¤§çš„çº¿ç¨‹è°ƒåº¦ã€‚ åœ¨ Android å¼€å‘ä¸­å› ä¸ºä¸å…è®¸é˜»å¡žä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥æ‰€æœ‰çš„è€—æ—¶è¯·æ±‚éƒ½å¿…é¡»å…¨éƒ¨æ”¾åœ¨å­çº¿ç¨‹æ¥åšï¼Œç„¶åŽå†åŽ»ä¸»çº¿ç¨‹æ›´æ–°UIï¼Œå…³äºŽä¸»çº¿ç¨‹å’Œå­çº¿ç¨‹çš„é€šä¿¡å…¶å®žå¼‚å¸¸å¤æ‚ï¼Œå¥½åœ¨Android ç»™æˆ‘ä»¬æä¾›äº† AsyncTaskï¼ŒHandler ç­‰æ–¹å¼æ¥ç®€åŒ–è¿™ä¸€è¿‡ç¨‹ã€‚ä½¿ç”¨ RxJava ä¼šè®©åˆ‡æ¢çº¿ç¨‹å˜å¾—æ›´ç®€å•ã€‚ æ–‡ä¸­éƒ¨åˆ†æè¿°å¯èƒ½æœ‰äº›æ··ä¹±ï¼Œä¸ºäº†æ›´å¥½çš„çœ‹å‡ºåœ¨å“ªä¸ªçº¿ç¨‹è°ƒç”¨ï¼Œæˆ‘ä¼šåœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œæˆ‘çš„ä»£ç ï¼Œæˆ‘å°±ç§°å®ƒä¸º MyThreadï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨ä»£ç æ‰€åœ¨çš„çº¿ç¨‹ã€‚ioçº¿ç¨‹ï¼Œè®¡ç®—çº¿ç¨‹ï¼ŒnewThreadçº¿ç¨‹å°±æ˜¯æˆ‘å¯¹ RxJava å‡ ç§å†…ç½®çº¿ç¨‹çš„ç®€ç§°ã€‚ä¸Šæ¸¸çº¿ç¨‹å°±æ˜¯è¢«è§‚å¯Ÿè€…æ‰€åœ¨çš„çº¿ç¨‹ï¼Œä¸‹æ¸¸çº¿ç¨‹æ˜¯è§‚å¯Ÿè€…æ‰€åœ¨çº¿ç¨‹ï¼Œè°ƒç”¨çº¿ç¨‹å°±æ˜¯æˆ‘è°ƒç”¨ä»£ç çš„çº¿ç¨‹ MyThreadã€‚è¿™é‡Œç®€å•ç†ä¸€ä¸‹ï¼Œè™½ç„¶è¿˜æ˜¯æœ‰ç‚¹ä¹±ã€‚ Schedulers ç§ç±»RxJava æ ¹æ®ä¸åŒåº”ç”¨åœºæ™¯å†…ç½®äº†å¤šç§çº¿ç¨‹è°ƒåº¦å™¨ï¼Œå¯ä»¥å¤§å¤šæ•°åœºæ™¯çš„åŽå°æ“ä½œéœ€æ±‚ã€‚ Schedulers Desc Schedulers.computation() ç”¨äºŽè®¡ç®—ä»»åŠ¡ï¼Œå¦‚äº‹ä»¶å¾ªçŽ¯æˆ–å’Œå›žè°ƒå¤„ç†ï¼Œä¸è¦ç”¨äºŽIOæ“ä½œï¼Œé»˜è®¤çº¿ç¨‹æ•°ç­‰äºŽå¤„ç†å™¨çš„æ•°é‡ Schedulers.io() ç”¨äºŽIOå¯†é›†åž‹ä»»åŠ¡ï¼Œå¦‚å¼‚æ­¥é˜»å¡žIOæ“ä½œï¼Œè¿™ä¸ªè°ƒåº¦å™¨çš„çº¿ç¨‹æ± ä¼šæ ¹æ®éœ€è¦å¢žé•¿ï¼›å¯¹äºŽæ™®é€šçš„è®¡ç®—ä»»åŠ¡ï¼Œè¯·ä½¿ç”¨Schedulers.computation() Schedulers.newThread() ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ Schedulers.trampoline() å½“å…¶å®ƒæŽ’é˜Ÿçš„ä»»åŠ¡å®ŒæˆåŽï¼Œåœ¨å½“å‰çº¿ç¨‹æŽ’é˜Ÿå¼€å§‹æ‰§è¡Œ Schedulers.from(executor) ä½¿ç”¨æŒ‡å®šçš„ Executor ä½œä¸ºè°ƒåº¦å™¨ AndroidSchedulers.mainThread() Android ä¸»çº¿ç¨‹ AndroidSchedulers.from(looper) ä»Ž Looper åˆ›å»º çº¿ç¨‹è°ƒåº¦æœ€ä¸ºå…³é”®çš„å°±æ˜¯ä¸¤ä¸ªæ–¹æ³• subscribeOn() å’Œ observeOn()ï¼Œä»Žä»£ç çš„é“¾å¼è°ƒç”¨å¯ä»¥ç®€å•çš„æ€»ç»“ä¸ºï¼š ä¸Šæ¸¸ Observable æ€»æ˜¯é»˜è®¤è¿è¡Œåœ¨è¢«è°ƒç”¨çš„çº¿ç¨‹å½“ä¸­ï¼Œå³ä½ åœ¨å“ªä¸ªçº¿ç¨‹è°ƒç”¨å°±ä¼šè¿è¡Œåœ¨å“ªä¸ªçº¿ç¨‹ã€‚ ä¸‹æ¸¸ Onserver æ€»æ˜¯é»˜è®¤è¿è¡Œåœ¨ä¸Šæ¸¸æ‰€åœ¨çº¿ç¨‹ä¸­(å½“ç„¶å¦‚æžœä½ æ²¡æœ‰åˆ‡æ¢ä¸Šæ¸¸çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆä¸‹æ¸¸ä¹Ÿä¼šè¿è¡Œåœ¨è°ƒç”¨çš„çº¿ç¨‹ä¸­)ï¼Œé™¤éžä½¿ç”¨ observeOn() è¿›è¡Œçº¿ç¨‹çš„åˆ‡æ¢ã€‚ subscribeOn() ç”¨æ¥å£°æ˜Žä¸Šæ¸¸äº‹ä»¶å‘é€æ—¶çš„æ‰€åœ¨çº¿ç¨‹ï¼Œå½“è°ƒç”¨å¤šæ¬¡ subscribeOn() æ—¶ï¼Œä¸Šæ¸¸ä¼šè¿è¡Œåœ¨æœ€æ—©çš„ä¸€æ¬¡è°ƒç”¨å£°æ˜Žçš„çº¿ç¨‹ä¸­ã€‚å½“ç„¶ä¹Ÿä¸æ˜¯è¯´å¤šæ¬¡çš„è°ƒç”¨æ˜¯å®Œå…¨æ²¡æ•ˆæžœçš„ï¼ŒåŽé¢ä¼šç»†è¯´ã€‚ observeOn() ç”¨æ¥å£°æ˜Žä¸‹æ¸¸è§‚å¯Ÿè€…æ‰€åœ¨çº¿ç¨‹ï¼Œæ¯æ¬¡è°ƒç”¨ observeOn() éƒ½ä¼šå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œæ­¤æ¬¡è°ƒç”¨ç›´åˆ°ä¸‹æ¬¡åˆ‡æ¢çº¿ç¨‹ä¸­é—´çš„è¿‡ç¨‹ä¸­çš„æ“ä½œè¿è¡Œåœ¨æ­¤æ¬¡è°ƒç”¨æŒ‡å®šçš„çº¿ç¨‹ä¸­ã€‚ 12345678910111213141516171819202122232425262728293031323334353637log("start");Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exceptio log("Observable"); e.onNext(10); &#125;&#125;) // ç¬¬1æ¬¡è°ƒç”¨subscribeOnï¼Œ Observable å°†è¿è¡Œåœ¨ioçº¿ç¨‹ .subscribeOn(Schedulers.io()) // io çº¿ç¨‹ï¼Œä¸‹æ¸¸æ€»æ˜¯ä¼šé»˜è®¤è¿è¡Œåœ¨ä¸Šæ¸¸æ‰€åœ¨çº¿ç¨‹ä¸­ .filter(new Predicate&lt;Integer&gt;() &#123; @Override public boolean test(@NonNull Integer integer) throws Exception &#123; log("filter1"); return true; &#125; &#125;) // ç¬¬2æ¬¡è°ƒç”¨subscribeOnï¼Œä¸ä¼šç”Ÿæ•ˆ .subscribeOn(Schedulers.newThread()) // ç¬¬1æ¬¡è°ƒç”¨observeOnï¼Œåˆ‡æ¢çº¿ç¨‹ï¼Œfilteræ“ä½œè¿è¡Œåœ¨ä¸»çº¿ç¨‹ .observeOn(AndroidSchedulers.mainThread()) .filter(new Predicate&lt;Integer&gt;() &#123; @Override public boolean test(@NonNull Integer integer) throws Exception &#123; log("filter2"); return true; &#125; &#125;) // ç¬¬2æ¬¡è°ƒç”¨observeOnï¼Œåˆ‡æ¢çº¿ç¨‹åˆ°å­çº¿ç¨‹ .observeOn(Schedulers.newThread()) .subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer integer) throws Exception &#123; log("subscribe = " + integer); &#125; &#125;); è¾“å‡ºç»“æžœ,æˆ‘æ•´ä¸ªä»£ç è¿è¡Œåœ¨ä¸€ä¸ªæˆ‘è‡ªå·±çš„å­çº¿ç¨‹ä¸­ï¼Œæˆ‘å°±å«ä»– MyThread å¥½äº†ï¼Œæ–¹ä¾¿æè¿° 12345[ThreadName:pool-13-thread-1] start // å› ä¸ºåœ¨ MyThread å­çº¿ç¨‹è°ƒç”¨[ThreadName:RxCachedThreadScheduler-1] Observable // io[ThreadName:RxCachedThreadScheduler-1] filter1 // io.ç”±äºŽæ²¡æœ‰åˆ‡æ¢çº¿ç¨‹ï¼Œé»˜è®¤è¿è¡Œåœ¨ä¸Šæ¸¸çº¿ç¨‹ä¸­ã€‚[ThreadName:main] filter2 // åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹[ThreadName:RxNewThreadScheduler-2] subscribe = 10 // åˆ‡æ¢åˆ° newThread çº¿ç¨‹ doOnSubscribe()å½“è°ƒç”¨å¤šæ¬¡ subscribeOn() æ–¹æ³•æ—¶ï¼Œä¸Šæ¸¸å°†è¿è¡Œåœ¨æœ€æ—©è°ƒç”¨æŒ‡å®šçš„çº¿ç¨‹ä¸­ï¼Œè¿™ä¸ªæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¯¹äºŽä¸‹æ¸¸çš„ doOnNext()ï¼ŒdoOnComplete() æ¥è¯´ï¼Œéµå¾ªä¸Šé¢è¯´çš„è§„åˆ™ï¼Œé™¤éžä½ ä½¿ç”¨ observerOn() åˆ‡æ¢çº¿ç¨‹ï¼Œä¸ç„¶è¿è¡Œåœ¨ä¸Šæ¸¸çº¿ç¨‹ä¸­ã€‚ ä½†æ˜¯ doOnSubscribe() æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œé™¤éžä»–åŽé¢æœ‰è°ƒç”¨ subscribeOn() åˆ‡æ¢çº¿ç¨‹ï¼Œå¦åˆ™ä»–é»˜è®¤è¿è¡Œåœ¨æ‰§è¡Œ Observable.subcribe() è¯­å¥çš„çº¿ç¨‹ä¸­ã€‚ å…¶å®žè¿™é‡Œçš„ doXXX() æ–¹æ³•å’Œä¸Šä¸€ç¯‡æ–‡ç« ä¸­è§‚å¯Ÿè€…ä¸­çš„å‡ ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œåœ¨è§‚å¯Ÿè€…çš„ä¸­ onSubscribe() æ–¹æ³•ä¹Ÿæœ‰åŒæ ·çš„å±žæ€§ï¼Œä»–åœ¨è®¢é˜…å‘ç”Ÿçš„ä¸€çž¬é—´é¦–å…ˆæ‰§è¡Œï¼Œå¹¶ä¸”å®ƒè¿è¡Œåœ¨è®¢é˜…å‘ç”Ÿçš„çº¿ç¨‹ã€‚å…¶ä»–å‡ ä¸ªæ–¹æ³•ä¹Ÿæ˜¯ä¸€æ ·ï¼Œé™¤éžä½ ä½¿ç”¨ observerOn() åˆ‡æ¢çº¿ç¨‹ï¼Œä¸ç„¶è¿è¡Œåœ¨ä¸Šæ¸¸çº¿ç¨‹ä¸­ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940log("start");Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; log("Observable"); e.onNext(10); e.onComplete(); &#125;&#125;) // è®¡ç®—çº¿ç¨‹ï¼Œå› æ­¤ Observable å°†ä¼šè¿è¡Œåœ¨è®¡ç®—çº¿ç¨‹ .subscribeOn(Schedulers.computation()) .observeOn(Schedulers.newThread()) .doOnNext(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer integer) throws Exception &#123; log("doOnNext"); &#125; &#125;) .doOnSubscribe(new Consumer&lt;Disposable&gt;() &#123; @Override public void accept(@NonNull Disposable disposable) throws Exception &#123; // åŽé¢æ²¡æœ‰è°ƒç”¨ subscribeOn() å› æ­¤å°†è¿è¡Œåœ¨ Observable.subscribe() æ‰§è¡Œçš„çº¿ç¨‹ log("doOnSubscribe"); &#125; &#125;) .doOnComplete(new Action() &#123; @Override public void run() throws Exception &#123; log("doOnComplete"); &#125; &#125;) .observeOn(Schedulers.newThread()) // doOnSubscribe() è¿è¡Œçš„çº¿ç¨‹å–å†³äºŽåœ¨å“ªé‡Œæ‰§è¡Œè®¢é˜… // é™¤éžåŽé¢æœ‰è°ƒç”¨ subscribeOn() è¿›è¡Œçº¿ç¨‹çš„åˆ‡æ¢ .subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer integer) throws Exception &#123; log("subscribe = " + integer); &#125; &#125;); è¾“å‡ºç»“æžœï¼Œæˆ‘æ•´ä¸ªä»£ç è¿è¡Œåœ¨ä¸€ä¸ªæˆ‘è‡ªå·±çš„å­çº¿ç¨‹ä¸­ï¼Œæˆ‘å°±å«ä»– MyThread å¥½äº†ï¼Œæ–¹ä¾¿æè¿° 1234567891011// MyThread å­çº¿ç¨‹è¿è¡Œ[ThreadName:pool-16-thread-1] start // å› ä¸º subscribe() æ–¹æ³•ä¹ŸåŒæ ·è¿è¡Œåœ¨ MyThread å­çº¿ç¨‹ï¼Œæ‰€ä»¥ doSunscribe() é¡µè¿è¡Œåœ¨ MyThread å­çº¿ç¨‹[ThreadName:pool-16-thread-1] doOnSubscribe // ç”±äºŽè°ƒç”¨ subscribeOn(Schedulers.computation()) æ‰€ä»¥ä¸Šæ¸¸è¿è¡Œåœ¨è®¡ç®—çº¿ç¨‹[ThreadName:RxComputationThreadPool-1] Observable // éµå¾ªä¸Šé¢è¯´çš„è§„åˆ™ï¼Œè¿è¡Œåœ¨ observerOn() æŒ‡å®šçš„ newThread ä¸­ã€‚[ThreadName:RxNewThreadScheduler-1] doOnNext// åŒä¸Š [ThreadName:RxNewThreadScheduler-1] doOnComplete [ThreadName:RxNewThreadScheduler-2] subscribe = 10 åˆ‡æ¢ doOnSubscribe() æ‰€åœ¨çº¿ç¨‹å†æ¢ä¸€ä¸ªæ›´æ”¹ doOnSubscribe() è¿è¡Œçº¿ç¨‹çš„ä¾‹å­ï¼Œè·Ÿä¸Šé¢ä¸åŒçš„æ˜¯åœ¨ doOnSubscribe() ä¹‹åŽæˆ‘ä»¬ä½¿ç”¨ subscribeOn(Schedulers.io()) åˆ‡æ¢äº†çº¿ç¨‹ï¼Œå› æ­¤ doOnSubscribe() å°†è¿è¡Œåœ¨ io çº¿ç¨‹ã€‚ 123456789101112131415161718192021222324252627282930log("start");Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; log("Observable"); e.onNext(10); e.onComplete(); &#125;&#125;) // è®¡ç®—çº¿ç¨‹ï¼Œå› æ­¤ Observable å°†ä¼šè¿è¡Œåœ¨è®¡ç®—çº¿ç¨‹ .subscribeOn(Schedulers.computation()) .observeOn(Schedulers.newThread()) .doOnSubscribe(new Consumer&lt;Disposable&gt;() &#123; @Override public void accept(@NonNull Disposable disposable) throws Exception &#123; // doOnSubscribe ä¹‹åŽç¬¬ä¸€æ¬¡è°ƒç”¨ subscribeOn(Schedulers.io()) åˆ‡æ¢åˆ°äº†ioçº¿ç¨‹ // å› æ­¤ doOnSubscribe è¿è¡Œåœ¨ io çº¿ç¨‹ã€‚ log("doOnSubscribe"); &#125; &#125;) .subscribeOn(Schedulers.io()) .observeOn(Schedulers.newThread()) // doOnSubscribe() è¿è¡Œçš„çº¿ç¨‹å–å†³äºŽåœ¨å“ªé‡Œæ‰§è¡Œè®¢é˜… // é™¤éžåŽé¢æœ‰è°ƒç”¨ subscribeOn() è¿›è¡Œçº¿ç¨‹çš„åˆ‡æ¢ .subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer integer) throws Exception &#123; log("subscribe = " + integer); &#125; &#125;); è¿è¡Œç»“æžœ 12345678// MyThread[ThreadName:pool-16-thread-1] start// ç”±äºŽåŽé¢è°ƒç”¨äº† subscribeOn(io) å› æ­¤è¿è¡Œåœ¨ io çº¿ç¨‹[ThreadName:RxCachedThreadScheduler-1] doOnSubscribe// è¿è¡Œåœ¨ä¸Šæ¸¸çº¿ç¨‹ä¸­[ThreadName:RxComputationThreadPool-1] Observable// ä½¿ç”¨ observeOn(Schedulers.newThread()) åˆ‡æ¢åˆ°äº† newThread[ThreadName:RxNewThreadScheduler-2] subscribe = 10 ä¸¾ä¸ªðŸŒ°æœ‰å•¥ç”¨å‘¢ï¼Ÿæ¨¡æ‹Ÿä¸€ä¸ªåœºæ™¯ï¼Œ1âƒ£ï¸ä¸Šæ¸¸å‘é€ç½‘ç»œè¯·æ±‚ï¼Œè¦æ±‚åœ¨å­çº¿ç¨‹æ‰§è¡Œï¼Œ2âƒ£ï¸ ä½†æ˜¯è¯·æ±‚åˆšå¼€å§‹çš„æ—¶å€™æˆ‘ä»¬è¦æ˜¾ç¤º dialog æç¤ºç”¨æˆ·ç­‰å¾…ï¼Œéœ€è¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œ3âƒ£ï¸ å®Œæˆä¹‹åŽåˆè¦åœ¨å­çº¿ç¨‹å¤„ç†æ•°æ®ï¼Œ4âƒ£ï¸ ç„¶åŽåŽ»ä¸»çº¿ç¨‹æ›´æ–°UIã€‚ 123456789101112131415161718192021222324252627282930313233343536log("å¼€å§‹æ“ä½œï¼Œä¸ºäº†æžå¤æ‚ç‚¹ï¼Œæˆ‘åœ¨æˆ‘è‡ªå·±åˆ›å»ºå­çº¿ç¨‹æ“ä½œ");Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; log("å­çº¿ç¨‹å‘èµ·ç½‘ç»œè¯·æ±‚"); e.onNext(10); e.onComplete(); &#125;&#125;) // åœ¨å­çº¿ç¨‹å‘èµ·è¯·æ±‚ .subscribeOn(Schedulers.newThread()) .doOnSubscribe(new Consumer&lt;Disposable&gt;() &#123; @Override public void accept(@NonNull Disposable disposable) throws Exception &#123; log("è¯·æ±‚ä¹‹å‰ï¼Œä¸»çº¿ç¨‹å¼¹èµ·dialog"); &#125; &#125;) // åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹å¼¹ dialog .subscribeOn(AndroidSchedulers.mainThread()) // åˆ‡æ¢åˆ°è®¡ç®—çº¿ç¨‹ å¤„ç†æ•°æ® .observeOn(Schedulers.computation()) .filter(new Predicate&lt;Integer&gt;() &#123; @Override public boolean test(@NonNull Integer integer) throws Exception &#123; log("è®¡ç®—çº¿ç¨‹å¤„ç†æ•°æ®"); return true; &#125; &#125;) // åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹æ›´æ–°UI .observeOn(AndroidSchedulers.mainThread()) .subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer integer) throws Exception &#123; log("ä¸»çº¿ç¨‹æ›´æ–°UI"); &#125; &#125;); è¾“å‡ºç»“æžœ 12345[ThreadName:pool-13-thread-1] å¼€å§‹æ“ä½œï¼Œä¸ºäº†æžå¤æ‚ç‚¹ï¼Œæˆ‘åœ¨æˆ‘è‡ªå·±åˆ›å»ºå­çº¿ç¨‹æ“ä½œ[ThreadName:main] è¯·æ±‚ä¹‹å‰ï¼Œä¸»çº¿ç¨‹å¼¹èµ·dialog[ThreadName:RxNewThreadScheduler-1] å­çº¿ç¨‹å‘èµ·ç½‘ç»œè¯·æ±‚[ThreadName:RxComputationThreadPool-1] è®¡ç®—çº¿ç¨‹å¤„ç†æ•°æ®[ThreadName:main] ä¸»çº¿ç¨‹æ›´æ–°UI æ€»ä¹‹ï¼Œå¦‚ä½•åˆ¤æ–­åˆ°åº•åœ¨ä»€ä¹ˆçº¿ç¨‹è¿è¡Œç»¼ä¸Šæ‰€è¿°ï¼Œæ€»ç»“å‡ æ¡å…¬å¼ï¼Œå…¶å®žå°±æ˜¯æŠŠä¸Šé¢è¯´çš„å†è¯´ä¸€éï¼š å‡ ä¸ªæ¦‚å¿µ ï¼š ä¸Šæ¸¸ï¼Œä¸Šæ¸¸æŒ‡çš„æ˜¯ æ•°æ®å‘å°„æºï¼ŒObservable ä¸­çš„ä»£ç ã€‚ ä¸‹æ¸¸ï¼Œä¸‹æ¸¸æŒ‡çš„æ˜¯ æ“ä½œç¬¦æ–¹æ³•ï¼ŒObservable è°ƒç”¨æ–¹æ³•ï¼Œè§‚å¯Ÿè€…ä¸­çš„æ–¹æ³• è°ƒç”¨çº¿ç¨‹ï¼Œæˆ‘åœ¨å“ªä¸ªçº¿ç¨‹è¿è¡Œè¯¥ä»£ç ï¼Œè¿™ä¸ªçº¿ç¨‹å°±æ˜¯è°ƒç”¨çº¿ç¨‹ã€‚ 1âƒ£ï¸ã€ä¸Šæ¸¸æ€»æ˜¯é»˜è®¤è¿è¡Œåœ¨è¢« è°ƒç”¨çº¿ç¨‹ å½“ä¸­ï¼Œå³ä½ åœ¨å“ªä¸ªçº¿ç¨‹è°ƒç”¨å°±ä¼šè¿è¡Œåœ¨å“ªä¸ªçº¿ç¨‹ã€‚ 2âƒ£ï¸ã€ ä¸‹æ¸¸æ€»æ˜¯é»˜è®¤è¿è¡Œåœ¨ä¸Šæ¸¸æ‰€åœ¨çº¿ç¨‹ä¸­ (å½“ç„¶å¦‚æžœä½ æ²¡æœ‰åˆ‡æ¢ä¸Šæ¸¸çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆä¸‹æ¸¸ä¹Ÿä¼šè¿è¡Œåœ¨ è°ƒç”¨çº¿ç¨‹ ä¸­) ï¼Œé™¤éžä½¿ç”¨ observeOn() è¿›è¡Œçº¿ç¨‹çš„åˆ‡æ¢ã€‚ 3âƒ£ï¸ã€ subscribeOn() ç”¨æ¥å£°æ˜Žä¸Šæ¸¸äº‹ä»¶å‘é€æ—¶çš„æ‰€åœ¨çº¿ç¨‹ï¼Œå½“è°ƒç”¨å¤šæ¬¡ subscribeOn() æ—¶ï¼Œä¸Šæ¸¸ä¼šè¿è¡Œåœ¨ æœ€æ—© çš„ä¸€æ¬¡è°ƒç”¨å£°æ˜Žçš„çº¿ç¨‹ä¸­ã€‚ 4âƒ£ï¸ã€ observeOn() ç”¨æ¥å£°æ˜Žä¸‹æ¸¸è§‚å¯Ÿè€…æ‰€åœ¨çº¿ç¨‹ï¼Œæ¯æ¬¡è°ƒç”¨ observeOn() éƒ½ä¼šå‘ç”Ÿçº¿ç¨‹åˆ‡æ¢ï¼Œæ­¤æ¬¡åˆ‡æ¢ åˆ° ä¸‹æ¬¡åˆ‡æ¢ ä¹‹é—´è¿è¡Œåœ¨ æ­¤æ¬¡åˆ‡æ¢ çš„çº¿ç¨‹ä¸­ã€‚ 5âƒ£ï¸ã€ å¯¹äºŽ doOnNext()/onNext()ï¼ŒdoOnComplete()/onComplete()ï¼ŒdoOnError()/onError() å‡ ä¸ªæ–¹æ³• (å‰è€…æ˜¯ è¢«è§‚å¯Ÿè€… è°ƒç”¨çš„æ–¹æ³•ï¼ŒåŽè€…æ˜¯ è§‚å¯Ÿè€… æŽ¥å£é‡Œé¢çš„å¯¹åº”æ–¹æ³•) ï¼Œä»–ä»¬éƒ½å’Œæ“ä½œç¬¦ä¸€æ ·ï¼Œéµå¾ª 2âƒ£ï¸ ä¸­çš„è§„åˆ™ã€‚ 6âƒ£ï¸ã€å¯¹äºŽ doOnSubscribe()/onSubscribe() æ–¹æ³• (å‰è€…æ˜¯ è¢«è§‚å¯Ÿè€… è°ƒç”¨çš„æ–¹æ³•ï¼ŒåŽè€…æ˜¯ è§‚å¯Ÿè€… æŽ¥å£é‡Œé¢çš„å¯¹åº”æ–¹æ³•) æ¥è¯´ï¼Œå¦‚æžœä»–åŽé¢æœ‰è°ƒç”¨ subscribeOn() åˆ‡æ¢çº¿ç¨‹ï¼Œé‚£ä¹ˆå®ƒè¿è¡Œåœ¨åˆ‡æ¢çš„çº¿ç¨‹ï¼Œå¦åˆ™ä»–é»˜è®¤è¿è¡Œåœ¨æ‰§è¡Œ Observable.subcribe() è¯­å¥çš„çº¿ç¨‹ä¸­ã€‚ ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ä¸Šé¢åªæ˜¯æ€»ç»“ä¸€äº›è§„åˆ™ï¼Œä¸€ä¸ªæ–¹æ³•æ˜¯è¿è¡Œåœ¨ä»€ä¹ˆçº¿ç¨‹ï¼Œä½¿ç”¨ä¸Šé¢çš„è§„åˆ™å¯ä»¥æ›´ç®€å•åˆ¤æ–­å‡ºæ¥ï¼Œæˆ‘ä»¬å…¶å®žæ˜¯åœ¨é€šè¿‡ä¸€äº›è¡¨è±¡æ¥æ€»ç»“å¦‚ä½•åˆ¤æ–­ï¼Œé‚£ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·çš„è§„åˆ™å‘¢ï¼Ÿæˆ‘çŽ°åœ¨ä¹Ÿè¿˜æ²¡ç ”ç©¶æ˜Žç™½ï¼Œï¼Œï¼Œï¼Œï¼Œï¼Œæ‰€ä»¥ï¼Œå¾…åŠž ï½ž okäº†ï½žå…³äºŽ RxJava2.x çš„ä¸€äº›æºç åˆ†æžè§RxJava2.xå¼€å‘ (æºç è§£æž)]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>RxJava2.x</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åšæŒ]]></title>
    <url>%2Farticle%2Fnull%2F</url>
    <content type="text"><![CDATA[2017å¹´7æœˆ2æ—¥ï¼Œæ—©9ç‚¹10åˆ†ï¼Œå‘¨æ—¥ï¼Œå¤©æ°”ä¸é”™ï¼Œç¨å¾®æœ‰ç‚¹çƒ­ã€‚ ä»Šå¤©å‘¨æ—¥ï¼Œè½¬çœ¼ä¸€å‘¨è¿‡æ¥äº†ï¼Œè¿™å‘¨éƒ½å°½é‡èƒ½åœ¨æ—©ä¸Š7ç‚¹åˆ°8ç‚¹èµ·åºŠåˆ°å…¬å¸ï¼Œç®—æ˜¯åšæŒä¸‹æ¥äº†ï¼Œä»¥åŽç»§ç»­ï¼Œç„¶åŽæŠŠæ—¶é—´æŽ§åˆ¶åœ¨7ç‚¹å¤šï¼ŒçŽ°åœ¨èµ·åºŠä¹‹åŽå¢¨è¿¹çš„æ—¶é—´å¤ªå¤šäº†ï¼Œ7ç‚¹å¤šççœ¼ï¼Œéƒ½è¦å¿«9ç‚¹é’Ÿæ‰æœ‰çŠ¶æ€ã€‚ è¿™å‘¨ä¸»è¦çœ‹äº†ä¸€ä¸‹ Kotlin çš„ä¸€ç‚¹å†…å®¹ï¼Œç„¶åŽ Retrofit ç½‘ç»œè¯·æ±‚ï¼Œç®€å•çš„å¼€å§‹äº†è§£äº†ä¸€ä¸‹ï¼ŒåŽé¢ä¼šç»§ç»­æ·±å…¥ï¼Œä»Šå¤©é‡ç‚¹çœ‹ RxJavaï¼ŒåŠ æ²¹ ï¼ TODO LIST : Kotlin å‰©ä½™éƒ¨åˆ†ç»§ç»­æŽ¨è¿›ã€‚ OkHttp + Retrofit + RxJava è¿˜æ˜¯è¦ç»§ç»­äº†è§£ã€‚ çœ‹äº†å‡ ç¯‡é¢ç»ï¼ŒEventBusï¼ŒGlideï¼ŒOkHttpï¼ŒRetrofit æºç çœ‹ä¸€ä¸‹åŽŸç†ã€‚ åšå®¢ç»§ç»­æ•´ç†ã€‚ æ›´å¤šâ€¦]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>Diary</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RxJava2.xå¼€å‘-1-åŸºç¡€]]></title>
    <url>%2Farticle%2F3251baff%2F</url>
    <content type="text"><![CDATA[å¼€å§‹æ€»ç»“è®°å½• RxJava çš„ç›¸å…³å†…å®¹ï¼Œæœ¬æ–‡ä¸­æ‰€æœ‰æ¶‰åŠ RxJava çš„åœ°æ–¹å‡æŒ‡ Rxjava2.0ã€‚ æœ¬æ–‡ä¸»è¦ä»¥ Observable å’Œ Flowable ä¸ºä¾‹ä»‹ç»å¦‚ä½•åˆ›å»ºè¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ï¼Œå¹¶è¿žæŽ¥ä»–ä»¬ã€‚ RxJava https://github.com/ReactiveX/RxJava RxJava https://github.com/ReactiveX/RxAndroid æŽ¨èæ–‡ç« è®°å½•ä¸€ä¸‹çœ‹è¿‡çš„å‡ ç¯‡è¿˜ä¸é”™çš„å…³äºŽ RxJava çš„æ–‡ç« ï¼Œæ„Ÿè°¢ä»–ä»¬çš„æ€»ç»“å’Œåˆ†äº«ã€‚ RxJava1 - ã€Š ç»™ Android å¼€å‘è€…çš„ RxJava è¯¦è§£ ã€‹- æ‰”ç‰©çº¿)ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯å¯¹ RxJava1 çš„è®²è§£ï¼Œå¾ˆä¸é”™ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼Œçœ‹äº†ä¸€éä¹‹åŽä»æ—§æœ‰äº›ç–‘æƒ‘ï¼Œå»ºè®®å¤šçœ‹å‡ éï¼Œå¾ˆå¤šå…³äºŽåŽŸç†çš„ä»‹ç»å¯ä»¥åŠ å¼ºå¯¹ Rx çš„ç†è§£ã€‚ RxJava2 - ã€Š ç»™åˆå­¦è€…çš„RxJava2.0æ•™ç¨‹(ä¸€) ã€‹- æŽ˜é‡‘ ä»¥åŠ RxJava2 - ã€Š ç»™åˆå­¦è€…çš„RxJava2.0æ•™ç¨‹(äºŒ) ã€‹- æŽ˜é‡‘ï¼Œç‰¹ç‚¹å°±æ˜¯ä½œè€…ä½¿ç”¨æ°´ç®¡ä¸Šæ¸¸ä¸‹æ¸¸çš„æè¿°æ–¹å¼ï¼Œç®€åŒ–äº†å¯¹è§‚å¯Ÿè€…æ¨¡å¼å’Œäº‹ä»¶å‘é€çš„ç†è§£ï¼Œæµ…æ˜¾æ˜“æ‡‚ï¼Œä¹Ÿå¾ˆå…¨é¢ï¼Œé€‚åˆå…¥é—¨ã€‚ ã€Š RxJava2.0 ä½ ä¸çŸ¥é“çš„äº‹ã€‹- ç®€ä¹¦ æ˜¯å¯¹ RxJava1.x å’Œ RxJava2.x çš„å¯¹æ¯”ï¼Œæ–‡ç« ä¸­å¯¹ 2.x çš„éƒ¨åˆ† apiï¼Œè¿›è¡Œäº†åˆ—ä¸¾ï¼Œå¯¹æ¯”èµ·æ¥çœ‹å°±æ¸…æ™°å¤šäº†ï¼Œå¦å¤–å¾ˆå¥½çš„è§£é‡Šäº†èƒŒåŽ‹çš„é—®é¢˜ï¼Œå—ç›ŠåŒªæµ…ã€‚ ã€Šå…³äºŽRxJavaæœ€å‹å¥½çš„æ–‡ç« ã€‹- çŸ¥ä¹Ž RxJava2.x APi æ–‡æ¡£ æˆ‘çš„ç†è§£ä¸Šé¢æŽ¨èçš„æ–‡ç« ä¸­å¯¹ RxJava çš„ç›¸å…³åŽŸç†éƒ½åšäº†éƒ¨åˆ†è¯´æ˜Žï¼Œæˆ‘å°±ä¸åšè¿‡å¤šæè¿°ï¼Œè¯´ä¸€ä¸‹æˆ‘çš„ä¸€äº›ç†è§£å§ã€‚ RxJava æœ€å…³é”®çš„ä¸¤ä¸ªç‚¹å°±æ˜¯ è§‚å¯Ÿè€…æ¨¡å¼ å’Œ å¼‚æ­¥ã€‚åœ¨ RxJava ä¸­è¢«è§‚å¯Ÿè€…ä½œä¸ºäº‹ä»¶çš„äº§ç”Ÿæ–¹ï¼Œæ˜¯ ä¸»åŠ¨ çš„ï¼Œæ˜¯æ•´ä¸ªäº‹ä»¶æµç¨‹çš„èµ·ç‚¹ã€‚è§‚å¯Ÿè€…ä½œä¸ºäº‹ä»¶çš„å¤„ç†æ–¹ï¼Œæ˜¯ è¢«åŠ¨ çš„ï¼Œæ˜¯æ•´ä¸ªäº‹ä»¶æµç¨‹çš„ç»ˆç‚¹ã€‚åœ¨èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´ï¼Œå³äº‹ä»¶ä¼ é€’çš„è¿‡ç¨‹ä¸­æ˜¯å¯ä»¥è¢«åŠ å·¥ï¼Œè¿‡æ»¤ï¼Œè½¬æ¢ï¼Œåˆå¹¶ç­‰ç­‰æ–¹å¼å¤„ç†çš„ã€‚ Observableï¼Œè¢«è§‚å¯Ÿè€…ï¼Œè¢«è®¢é˜…è€…ï¼Œå¯è¢«è§‚å¯Ÿçš„ï¼Œä»–æ˜¯æ•°æ®å’Œäº‹ä»¶å‘å°„çš„æºï¼Œä»–åœ¨ RxJava ä¸­æ˜¯æœ‰å¤šç§å®žçŽ°æ–¹å¼ï¼Œè¿™é‡Œä¸æ˜¯è¯´çš„å“ªä¸ªç±»ï¼Œè€Œæ˜¯ä¸€ç§æ³›æŒ‡ã€‚ Observerï¼Subscriberï¼Œè§‚å¯Ÿè€…ï¼Œè®¢é˜…è€…ï¼Œä»–æ˜¯äº‹ä»¶æŽ¥å—è€…ã€‚ æ•´ä½“æ¥çœ‹ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€æ¡äº‹ä»¶æµï¼Œè¢«è§‚å¯Ÿè€…åœ¨ä¸Šæ¸¸å‘é€äº‹ä»¶ï¼Œè§‚å¯Ÿè€…åœ¨ä¸‹æ¸¸æŽ¥å—äº‹ä»¶ï¼Œä¸­æ¸¸ä¼šæœ‰å¾ˆå¤šé’ˆå¯¹äº‹ä»¶çš„å¤„ç†å’Œå˜æ¢ï¼Œè¿™æ ·ç†è§£æ›´ç®€å•ä¸€äº›ï¼Œä¹Ÿæ›´æœ‰åŠ©äºŽç†è§£èƒŒåŽ‹(Backpressure)çš„å­˜åœ¨ã€‚ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œé¿å…å™è¿°çš„æ··ä¹±ï¼Œæ–‡ç« ä¸­æˆ‘ä¼šç”¨ ä¸Šæ¸¸ å’Œ ä¸‹æ¸¸ è¿™æ ·çš„æè¿°æ¥ä»£æ›¿ è¢«è§‚å¯Ÿè€… å’Œ è§‚å¯Ÿè€…ã€‚ ä½¿ç”¨ Observableåˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„ Observableï¼Œå‘é€ Integer ç±»åž‹çš„æ•°æ®ï¼ŒRxJava æœ‰å¾ˆå¤šåˆ›å»º Observable çš„ç®€å•æ–¹æ³•ï¼Œæˆ‘ä»¬æš‚æ—¶å°±ä½¿ç”¨æœ€åŽŸå§‹çš„é‚£ç§ï¼Œæ–¹ä¾¿ç†è§£ã€‚ ObservableEmitter ç»§æ‰¿ Emitterï¼Œæ˜¯ä¸€ä¸ªæ•°æ®å‘å°„å™¨ï¼Œç”¨æ¥å‘è§‚å¯Ÿè€…å‘é€æ•°æ®ã€‚ 123456789101112// åˆ›å»º ObservableObservable&lt;Integer&gt; observable = Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; // å‘å°„æ•°æ® e.onNext(1); e.onNext(2); // ç»“æŸå‘é€ e.onComplete(); e.onNext(3); &#125;&#125;); åˆ›å»ºä¸€ä¸ª Observerï¼ŒæŽ¥å—æ•°æ®å¹¶æ‰“å°ã€‚ 123456789101112131415161718Observer&lt;Integer&gt; observer = new Observer&lt;Integer&gt;() &#123; @Override public void onSubscribe(@NonNull Disposable d) &#123; log("onSubscribe"); &#125; @Override public void onNext(@NonNull Integer integer) &#123; log("onNext == &gt; " + integer); &#125; @Override public void onError(@NonNull Throwable e) &#123; log("onError"); &#125; @Override public void onComplete() &#123; log("onComplete"); &#125;&#125;; å®žçŽ°è®¢é˜…ï¼ŒæŸ¥çœ‹ç»“æžœã€‚ 123456789observable.subscribe(observer);// ç»“æžœå¦‚ä¸‹ï¼Œ3 ä¸ä¼šè¢«æ‰“å°---------------[ThreadName:pool-13-thread-1] onSubscribe[ThreadName:pool-13-thread-1] onNext == &gt; 1[ThreadName:pool-13-thread-1] onNext == &gt; 2[ThreadName:pool-13-thread-1] onComplete--------------- è¿™æ ·æˆ‘ä»¬å°±å®žçŽ°äº†ä¸€ä¸ªç®€å•çš„è®¢é˜…æµç¨‹ï¼Œå®Œæˆäº†æ•°æ®çš„ä¼ é€’ï¼Œæ€»ç»“ä»¥ä¸‹è¦ç‚¹ï¼š ObservableEmitter ç»§æ‰¿ Emitterï¼Œæ˜¯ä¸€ä¸ªå‘å°„å™¨ï¼Œç”¨æ¥å‘ä¸‹æ¸¸å‘é€äº‹ä»¶ï¼Œå®ƒå¯ä»¥å‘é€å¦‚ä¸‹3ç§äº‹ä»¶ï¼Œä¹Ÿå¯¹åº”ä¸‹æ¸¸è®¢é˜…è€…çš„ç›¸å…³æ–¹æ³•ã€‚ 12345public interface Emitter&lt;T&gt; &#123; void onNext(@NonNull T value); void onError(@NonNull Throwable error); void onComplete();&#125; ä¸Šæ¸¸å’Œä¸‹æ¸¸çš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤è¿è¡Œåœ¨å½“å‰æ‰€åœ¨çº¿ç¨‹å†…ï¼Œå¦‚ä¸Šè¿è¡Œç»“æžœï¼Œæˆ‘åœ¨å­çº¿ç¨‹è¿è¡Œåˆ™æ‰€æœ‰æ–¹æ³•ä¼šåœ¨å­çº¿ç¨‹è°ƒç”¨ã€‚ è®¢é˜…å‘ç”Ÿåœ¨ observable.subscribe(observer); æ—¶ï¼Œæ­¤æ—¶ä¸Šæ¸¸æ‰å¼€å§‹å‘é€äº‹ä»¶ï¼Œå¹¶ä¸” onSubscribe() æ–¹æ³•ä¼šåœ¨å¼€å§‹è®¢é˜…æ—¶é¦–å…ˆæ‰§è¡Œã€‚ ä¸Šæ¸¸å¯ä»¥å‘é€æ— æ•°ä¸ª onNext(T t) äº‹ä»¶ï¼Œä¸‹æ¸¸éƒ½å¯ä»¥æŽ¥å—åˆ°ã€‚ å½“ä¸Šæ¸¸å‘é€ onComplete() äº‹ä»¶ä¹‹åŽï¼Œä¸Šæ¸¸çš„äº‹ä»¶ä¼šç»§ç»­å‘é€ï¼Œä½†æ˜¯ä¸‹æ¸¸åœ¨æŽ¥å—åˆ° onCompelete() äº‹ä»¶ä¹‹åŽå°±ä¼šåˆ‡æ¢äº‹ä»¶æµï¼Œä¸ä¼šåœ¨æŽ¥å—åŽç»­çš„äº‹ä»¶ï¼Œå› æ­¤å‘é€å¤šä¸ª onComplete() è™½ç„¶ä¸ä¼šå¯¼è‡´ç¨‹åº crashï¼Œä½†æ˜¯æ˜¯æ— æ„ä¹‰çš„ã€‚ å½“ä¸Šæ¸¸å‘é€ onError() äº‹ä»¶ä¹‹åŽï¼Œä¸Šæ¸¸çš„äº‹ä»¶ä¼šç»§ç»­å‘é€ï¼Œä½†æ˜¯ä¸‹æ¸¸åœ¨æŽ¥å—åˆ° onError() äº‹ä»¶ä¹‹åŽå°±ä¼šåˆ‡æ¢äº‹ä»¶æµï¼Œä¸ä¼šåœ¨æŽ¥å—åŽç»­çš„äº‹ä»¶ï¼Œå½“ä½ å‘é€ç¬¬äºŒä¸ª onError() äº‹ä»¶æ—¶ä¼šå¯¼è‡´ç¨‹åº crashã€‚ å‘é€ onComplete() å’Œ onError() äº‹ä»¶ä¸æ˜¯å¿…é¡»çš„ã€‚ onComplete() å’Œ onError() æ˜¯å”¯ä¸€ä¸”äº’æ–¥çš„ï¼Œä½ ä¸èƒ½å‘é€å¤šä¸ª onComplete() æˆ–å¤šä¸ª onError()ï¼Œä¹Ÿä¸èƒ½ä¸èƒ½å‘é€ä¸€ä¸ª onCompelete() äº‹ä»¶å†å‘é€ onError()ï¼Œåè¿‡æ¥ä¹Ÿæ˜¯ã€‚ ä¸­æ–­äº‹ä»¶æµDisposable å¯¹è±¡å¯ç”¨ç”¨æ¥åˆ‡æ–­äº‹ä»¶æµï¼Œåœ¨ onSubscribe() è¢«è°ƒç”¨æ—¶ä¼šè¿”å›ž Disposable å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨èŽ·å–åˆ°æ•°å­— 4 æ—¶åˆ‡æ–­äº‹ä»¶æµã€‚å°†ä¸Šé¢çš„ä»£ç ç¨å¾®ç®€åŒ–ä¸€ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637// åˆ›å»º ObservableObservable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; // å‘å°„æ•°æ® e.onNext(1); e.onNext(2); e.onNext(3); e.onNext(4); e.onNext(5); // ç»“æŸå‘é€ e.onComplete(); e.onNext(6); &#125;&#125;).subscribe(new Observer&lt;Integer&gt;() &#123; Disposable mDisposable; @Override public void onSubscribe(@NonNull Disposable d) &#123; mDisposable = d; log("onSubscribe"); &#125; @Override public void onNext(@NonNull Integer integer) &#123; log("onNext == &gt; " + integer); if (integer == 4) &#123; mDisposable.dispose(); &#125; &#125; @Override public void onError(@NonNull Throwable e) &#123; log("onError"); &#125; @Override public void onComplete() &#123; log("onComplete"); &#125;&#125;); ç»“æžœä¸º 12345[ThreadName:pool-13-thread-1] onSubscribe[ThreadName:pool-13-thread-1] onNext == &gt; 1[ThreadName:pool-13-thread-1] onNext == &gt; 2[ThreadName:pool-13-thread-1] onNext == &gt; 3[ThreadName:pool-13-thread-1] onNext == &gt; 4 å…¶ä»–è®¢é˜…æ–¹æ³•åœ¨å®žé™…åº”ç”¨è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯èƒ½å¹¶ä¸å…³æ³¨ä¸‹æ¸¸æ‰€æœ‰çš„æŽ¥å—äº‹ä»¶çš„æ–¹æ³•ï¼Œå› æ­¤ RxJava æä¾›äº†å¤šç§è®¢é˜…æ–¹å¼æ¥ç®€åŒ–è®¢é˜…è¿‡ç¨‹ã€‚ è¿™é‡Œè¯´ä¸€ä¸‹ Action å’Œ Consumerï¼Œä¸Ž RxJava1.x ä¸åŒï¼Œæ²¡æœ‰ä½¿ç”¨ ActionN è¿™ç§å‘½åæ–¹å¼ã€‚ Action æ˜¯æ— å‚æ— è¿”å›žå€¼çš„æŽ¥å£ï¼Œå®ƒå¯ä»¥ç”¨æ¥æ›¿ä»£ç±»ä¼¼ onComplete() è¿™ç§æ— å‚æ— è¿”å›žå€¼å€¼çš„æ–¹æ³•ã€‚ 123public interface Action &#123; void run() throws Exception;&#125; Consumer æ˜¯å•ä¸ªå‚æ•°æ— è¿”å›žå€¼çš„æŽ¥å£ï¼Œå®ƒå¯ä»¥ç”¨æ¥ä»£æ›¿ç±»ä¼¼ onSubscribe(@NonNull Disposable d)ï¼ŒonNext(@NonNull Integer integer)ï¼ŒonError(@NonNull Throwable e) è¿™ç±»å•ä¸ªå‚æ•°æ— è¿”å›žå€¼çš„æ–¹æ³•ã€‚ 123public interface Consumer&lt;T&gt; &#123; void accept(@NonNull T t) throws Exception;&#125; é‡è½½çš„è®¢é˜…æ–¹æ³•ï¼Œé™¤äº†ä»¥ Observer çš„æ–¹å¼è®¢é˜…ä¹‹å¤–ï¼Œå…¶ä»–æ–¹æ³•éƒ½è¿”å›ž Disposable å¯¹è±¡ç”¨æ¥ä¸­æ–­äº‹ä»¶æµã€‚ 1234567891011121314151617// ä¸‹æ¸¸ä¸å…³æ³¨ä¸Šæ¸¸çš„ä»»ä½•äº‹ä»¶public final Disposable subscribe()// è§‚å¯Ÿè€…public final void subscribe(Observer&lt;? super T&gt; observer)// åªå…³æ³¨ onNext() äº‹ä»¶public final Disposable subscribe(Consumer&lt;? super T&gt; onNext) // åªå…³æ³¨ onNext() onError() public final Disposable subscribe(Consumer&lt;? super T&gt; onNext, Consumer&lt;? super Throwable&gt; onError)// åªå…³æ³¨ onNext() onError() onComplete()public final Disposable subscribe(Consumer&lt;? super T&gt; onNext, Consumer&lt;? super Throwable&gt; onError,Action onComplete)// åªå…³æ³¨ onNext() onError() onComplete() onSubscribe()public final Disposable subscribe(Consumer&lt;? super T&gt; onNext, Consumer&lt;? super Throwable&gt; onError, Action onComplete, Consumer&lt;? super Disposable&gt; onSubscribe) ä½¿ç”¨åªå…³æ³¨ onNext() äº‹ä»¶çš„è®¢é˜…æ–¹æ³•å®žçŽ°è®¢é˜…ã€‚ 123456789101112131415Observable.create(new ObservableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull ObservableEmitter&lt;Integer&gt; e) throws Exception &#123; // å‘å°„æ•°æ® e.onNext(1); e.onNext(2); // ç»“æŸå‘é€ e.onComplete(); &#125;&#125;).subscribe(new Consumer&lt;Integer&gt;() &#123; @Override public void accept(@NonNull Integer integer) throws Exception &#123; log("use Consumer onNext = &gt; " + integer); &#125;&#125;); å¯¹ Observable çš„ä»‹ç»ç›¸å¯¹è¯¦ç»†ï¼Œä¸‹é¢çš„ä»‹ç»ä¼šç®€å•ä¸€äº›ï¼Œå› ä¸ºå¾ˆå¤šç›¸ä¼¼çš„åœ°æ–¹ï¼Œå°±ä¸å†èµ˜è¿°äº†ã€‚ ä½¿ç”¨ FlowableFlowable ä¸Ž Observable çš„åŒºåˆ«å°±æ˜¯å®žçŽ°äº† èƒŒåŽ‹(Backpressure) çš„ç®¡ç†ï¼Œè®²çœŸï¼Œæˆ‘å¯¹èƒŒåŽ‹è¿™ä¸ªæ¦‚å¿µä¹Ÿç†è§£çš„ä¸æ˜¯å¾ˆå…¨é¢ï¼Œæ¦‚æ‹¬çš„è®²èƒŒåŽ‹å°±æ˜¯ä¸Šæ¸¸å‘é€çš„äº‹ä»¶å¤ªå¤šï¼Œä¸‹æ¸¸å¤„ç†äº‹ä»¶çš„é€Ÿåº¦å¤ªæ…¢ï¼Œå¯¼è‡´ä¸Šæ¸¸äº‹ä»¶å †ç§¯ï¼Œæ­¤æ—¶å¦‚ä½•å¤„ç†å †ç§¯çš„äº‹ä»¶ï¼Œå°±æ˜¯èƒŒåŽ‹å¤„ç†çš„ç­–ç•¥ã€‚ èƒŒåŽ‹å¤„ç†ç­–ç•¥ï¼Œåœ¨ RxJava2.x ä¸­ Observable ä¸å†æ”¯æŒèƒŒåŽ‹ï¼Œéœ€è¦æ”¯æŒèƒŒåŽ‹æ—¶éœ€è¦ä½¿ç”¨ Flowable åˆ›å»ºè¢«è§‚å¯Ÿè€…ï¼Œå¹¶è¦æ±‚æ˜Žç¡®æŒ‡å®šèƒŒåŽ‹å¤„ç†ç­–ç•¥ã€‚ å…³äºŽ Flowable å’Œ Backpressure çš„å†…å®¹åŽé¢ä½œå•ç‹¬ç ”ç©¶ï¼Œè¿™é‡Œä¸å±•å¼€ã€‚ 123456public enum BackpressureStrategy &#123; ERROR, BUFFER, DROP, LATEST&#125; å®žçŽ°ä¸€ä¸ªè®¢é˜…ï¼Œæ”¯æŒèƒŒåŽ‹æ—¶ï¼Œéœ€è¦åœ¨ä¸‹æ¸¸è°ƒç”¨ request(long n) æ¥å‘ä¸Šæ¸¸è¯·æ±‚ï¼Œè‡ªå·±è¦å¤šå°‘æ•°æ®ï¼Œè¯·æ±‚å¤šå°‘æ•°æ®ä¸Šæ¸¸å°±ä¼šå‘å¤šå°‘æ•°æ®è¿‡æ¥ï¼Œå¦‚ä¸‹å®žä¾‹ä¸­ï¼Œåªä¼šèŽ·å–åˆ°ä¸€æ¬¡äº‹ä»¶ã€‚ 123456789101112131415161718192021222324252627Flowable.create(new FlowableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull FlowableEmitter&lt;Integer&gt; e) throws Exception &#123; for (int i = 0; i &lt; 10; i++) &#123; e.onNext(i); &#125; e.onComplete(); &#125;&#125;, BackpressureStrategy.BUFFER).subscribe(new FlowableSubscriber&lt;Integer&gt;() &#123; @Override public void onSubscribe(Subscription s) &#123; log("onSubscribe"); s.request(1); &#125; @Override public void onNext(Integer integer) &#123; log("onNext == &gt; " + integer); &#125; @Override public void onError(Throwable t) &#123; log("onError"); &#125; @Override public void onComplete() &#123; log("onComplete"); &#125;&#125;); ä¸­æ–­äº‹ä»¶æµSubscription ç±»ä¼¼äºŽ Observable ä¸­çš„ Disposableï¼Œå¯ä»¥ç”¨æ¥ä¸­æ–­äº‹ä»¶æµï¼Œä¸åŒçš„æ˜¯éœ€è¦ä½¿ç”¨ cancel() æ–¹æ³•ï¼Œå¦å¤–æœ‰å¦ä¸€ä¸ª request(long n) æ–¹æ³•ç”¨æ¥å‘ä¸Šæ¸¸è¯·æ±‚æ•°æ®ã€‚ 1234public interface Subscription &#123; public void request(long n); public void cancel();&#125; å¦‚ä¸‹ï¼Œä½¿ç”¨ Subscription ä¸­æ–­äº‹ä»¶ã€‚ 12345678910111213141516171819202122232425262728Flowable.create(new FlowableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull FlowableEmitter&lt;Integer&gt; e) throws Exception &#123; for (int i = 0; i &lt; 10; i++) &#123; e.onNext(i); &#125; e.onComplete(); &#125;&#125;, BackpressureStrategy.BUFFER).subscribe(new FlowableSubscriber&lt;Integer&gt;() &#123; Subscription mSubscription; @Override public void onSubscribe(Subscription s) &#123; log("onSubscribe"); mSubscription = s; s.request(1); &#125; @Override public void onNext(Integer integer) &#123; log("onNext == &gt; " + integer); mSubscription.request(5); if (integer == 5) &#123; mSubscription.cancel(); &#125; &#125; // ... &#125;); å…³äºŽ requestä¸‹æ¸¸è¯·æ±‚å¤šå°‘å°±ä¼šæ”¶åˆ°å¤šå°‘äº‹ä»¶ï¼Œä½†æ˜¯ä¸ä¼šé˜»å¡žä¸Šæ¸¸äº‹ä»¶å‘é€çš„è¿‡ç¨‹ï¼Œä¸Šæ¸¸çš„äº‹ä»¶ä¼šä¸€ç›´å‘ï¼Œä½†æ˜¯ä¸‹æ¸¸æ²¡è¯·æ±‚çš„è¯æŽ¥å—ä¸åˆ°äº‹ä»¶ã€‚ request(long n) ä¸­çš„æ•°é‡æ˜¯ä¼šç´¯åŠ çš„ï¼Œç´¯åŠ çš„æ•°é‡å°±æ˜¯è¯·æ±‚çš„æ€»é‡ï¼Œå¦‚æžœè¯·æ±‚çš„æ€»é‡è¶…è¿‡äº†å‘é€çš„æ€»é‡ï¼Œåˆ™ä¸Šæ¸¸äº‹ä»¶ä¼šè¢«å…¨éƒ¨æŽ¥å—åˆ°ï¼Œä½†æ˜¯ä¸ä¼šå¤šå‡ºæ¥ã€‚ å¦‚ä¸‹å®žä¾‹ä¸­ï¼Œæ€»å…±è¯·æ±‚äº† 1 + 2 + 2 = 5 æ¬¡äº‹ä»¶ï¼Œå› æ­¤åªæ”¶åˆ°äº† 5 æ¬¡äº‹ä»¶ï¼Œä½†æ˜¯ä¸Šæ¸¸çš„äº‹ä»¶å‘é€å¹¶æ²¡æœ‰åœæ­¢ã€‚ 1234567891011121314151617181920212223242526Flowable.create(new FlowableOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull FlowableEmitter&lt;Integer&gt; e) throws Exception &#123; for (int i = 0; i &lt; 10; i++) &#123; log("send next " + i); e.onNext(i); &#125; e.onComplete(); &#125;&#125;, BackpressureStrategy.BUFFER).subscribe(new FlowableSubscriber&lt;Integer&gt;() &#123; Subscription mSubscription; @Override public void onSubscribe(Subscription s) &#123; log("onSubscribe"); mSubscription = s; s.request(1); &#125; @Override public void onNext(Integer integer) &#123; log("onNext == &gt; " + integer); if(integer == 0 || integer == 1) &#123; mSubscription.request(2); &#125; &#125; // ...&#125;); è¾“å‡ºç»“æžœ 12345678910111213141516[ThreadName:pool-13-thread-1] onSubscribe[ThreadName:pool-13-thread-1] send next 0[ThreadName:pool-13-thread-1] onNext == &gt; 0[ThreadName:pool-13-thread-1] send next 1[ThreadName:pool-13-thread-1] onNext == &gt; 1[ThreadName:pool-13-thread-1] send next 2[ThreadName:pool-13-thread-1] onNext == &gt; 2[ThreadName:pool-13-thread-1] send next 3[ThreadName:pool-13-thread-1] onNext == &gt; 3[ThreadName:pool-13-thread-1] send next 4[ThreadName:pool-13-thread-1] onNext == &gt; 4[ThreadName:pool-13-thread-1] send next 5[ThreadName:pool-13-thread-1] send next 6[ThreadName:pool-13-thread-1] send next 7[ThreadName:pool-13-thread-1] send next 8[ThreadName:pool-13-thread-1] send next 9 å…¶ä»–è®¢é˜…æ–¹æ³•Flowable è·Ÿ Observable ä¸€æ ·å¯¹è®¢é˜…æ“ä½œä¹Ÿæœ‰å¾ˆå¤šé‡è½½æ–¹æ³•ï¼Œå¯ä»¥å‚ç…§Obervable#å…¶ä»–è®¢é˜…æ–¹æ³•ã€‚ æ›´å¤šè¢«è§‚å¯Ÿè€…å®žçŽ°æˆ‘çŽ°åœ¨è¿˜ä¸å¤ªæ¸…æ¥šå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå°±å…ˆåˆ—ä¸¾ä¸€ä¸‹ APIï¼ŒåŽé¢æœ‰æœºä¼šå†ä»”ç»†çœ‹çœ‹ Maybe 123456789101112131415161718Maybe.create(new MaybeOnSubscribe&lt;Integer&gt;() &#123; @Override public void subscribe(@NonNull MaybeEmitter&lt;Integer&gt; e) throws Exception &#123; &#125;&#125;).subscribe(new MaybeObserver&lt;Integer&gt;() &#123; @Override public void onSubscribe(@NonNull Disposable d) &#123; &#125; @Override public void onSuccess(@NonNull Integer integer) &#123; &#125; @Override public void onError(@NonNull Throwable e) &#123; &#125; @Override public void onComplete() &#123; &#125;&#125;); Completable 123456789101112131415Completable.create(new CompletableOnSubscribe() &#123; @Override public void subscribe(@NonNull CompletableEmitter e) throws Exception &#123; &#125;&#125;).subscribe(new CompletableObserver() &#123; @Override public void onSubscribe(@NonNull Disposable d) &#123; &#125; @Override public void onComplete() &#123; &#125; @Override public void onError(@NonNull Throwable e) &#123; &#125;&#125;); Single 123456789101112131415Single.create(new SingleOnSubscribe&lt;Object&gt;() &#123; @Override public void subscribe(@NonNull SingleEmitter&lt;Object&gt; e) throws Exception &#123; &#125;&#125;).subscribe(new SingleObserver&lt;Object&gt;() &#123; @Override public void onSubscribe(@NonNull Disposable d) &#123; &#125; @Override public void onSuccess(@NonNull Object o) &#123; &#125; @Override public void onError(@NonNull Throwable e) &#123; &#125;&#125;);]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>RxJava2.x</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Retrofitå¼€å‘-1-åŸºç¡€]]></title>
    <url>%2Farticle%2Fe57450c6%2F</url>
    <content type="text"><![CDATA[Retrofit æœ¬æ–‡ä»‹ç» OkHttp å’Œ Retrofit çš„åŸºæœ¬ä½¿ç”¨ï¼ŒåŒ…æ‹¬ï¼š åˆ›å»ºå’Œé…ç½® OkHttpClient åˆ›å»ºå’Œé…ç½® Retrofit å¦‚ä½•ä½¿ç”¨ Retrofit å®šä¹‰æŽ¥å£å‘èµ·è¯·æ±‚ å…³äºŽ Retrofit ä¸­ methodï¼Œpathï¼Œquery paramï¼Œbodyï¼ŒHeader æ³¨è§£å£°æ˜Žçš„ä»‹ç»ã€‚ æ·»åŠ ä¾èµ–1234567891011121314// ç½‘ç»œè¯·æ±‚okhttp3 : 'com.squareup.okhttp3:okhttp:3.4.2',// å•å…ƒæµ‹è¯•ï¼Œæœªç”¨okhttp3Mockwebserver : 'com.squareup.okhttp3:mockwebserver:3.4.2',// è°ƒè¯•å·¥å…·ç±»åº“stetho : 'com.facebook.stetho:stetho:1.4.2',stetho_okhttp3 : 'com.facebook.stetho:stetho-okhttp3:1.4.2',// jsonè§£æžgson : 'com.google.code.gson:gson:2.6.1',// retrofit 2.0retrofit : 'com.squareup.retrofit2:retrofit:2.3.0',converter_gson : 'com.squareup.retrofit2:converter-gson:2.1.0',// æ—¥å¿—æ‰“å°logging_interceptor : 'com.squareup.okhttp3:logging-interceptor:3.8.0', åˆ›å»º OkHttpRetrofit æ˜¯å¯¹ OkHttp çš„å°è£…ï¼Œæä¾›äº†ä½¿ç”¨æ³¨è§£æ›´ç®€å•çš„æž„å»ºå„ç§è¯·æ±‚ï¼Œé…ç½®å„ç§å‚æ•°çš„æ–¹å¼ã€‚æœ¬è´¨å‘èµ·ç½‘ç»œè¯·æ±‚çš„è¿˜æ˜¯ OkHttpï¼Œä½† Retrofit è®©è¿™ä¸€æ“ä½œæ›´åŠ çš„ç®€å•ä¼˜é›…ã€‚ åˆ›å»ºä¸€ä¸ª OkHttpClent å¹¶è¿›è¡Œç®€å•é…ç½® 12345678910111213141516171819202122232425262728/** * åˆ›å»º OkHttpClient * * @return OkHttpClient */private OkHttpClient buildOkHttpClient() &#123; OkHttpClient.Builder okHttpBuilder = new OkHttpClient.Builder(); // è¿žæŽ¥è¶…æ—¶ okHttpBuilder.connectTimeout(5 * 1000, TimeUnit.MILLISECONDS); // è¯»è¶…æ—¶ okHttpBuilder.readTimeout(5 * 1000, TimeUnit.MILLISECONDS); // å†™è¶…æ—¶ okHttpBuilder.writeTimeout(5 * 1000, TimeUnit.MILLISECONDS); // æ¸…é™¤ interceptors okHttpBuilder.interceptors().clear(); okHttpBuilder.networkInterceptors().clear(); // è‡ªå®šä¹‰ Interceptorï¼Œç”¨æ¥æ·»åŠ å…¨å±€ Header okHttpBuilder.addNetworkInterceptor(new HeaderInterceptor()); // è‡ªå®šä¹‰ Interceptorï¼Œè¿›è¡Œæ—¥å¿—æ‰“å°ï¼Œæ‰©å±•è‡ª HttpLoggingInterceptor okHttpBuilder.addNetworkInterceptor(new LogInterceptor(LogInterceptor.Level.BOTH)); // å¤±è´¥åŽé‡è¯• okHttpBuilder.retryOnConnectionFailure(true); // face book è°ƒè¯•æ¡†æž¶ okHttpBuilder.addNetworkInterceptor(new StethoInterceptor()); // tokenæ ¡éªŒï¼Œè¿”å›ž 403 æ—¶ okHttpBuilder.authenticator(new TokenAuthenticator()); return okHttpBuilder.build();&#125; åˆ›å»º RetrofitOkHttp åªè´Ÿè´£å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œç»´æŠ¤ç½‘ç»œè¿žæŽ¥ç­‰æ“ä½œï¼Œè€Œ Retrofit å¸®æˆ‘ä»¬å°†ç½‘ç»œä¼ è¾“çš„æ•°æ®è½¬æ¢ä¸ºå¯ç”¨çš„ model å¯¹è±¡ï¼Œå¹¶ä¸”æä¾›ç®€å•çš„æ•°æ®å¤„ç†æ–¹å¼ã€‚ é…ç½® CallAdapterFactory ä¸º RxJava2CallAdapterFactory.createWithScheduler(Schedulers.io()) ç”¨æ¥å°†è¿”å›žçš„æ•°æ®è½¬æ¢ä¸º RxJava çš„ Observable å¯¹è±¡ï¼Œä½†æ˜¯æœ¬æ–‡è¿˜æ²¡æ¶‰åŠåˆ° RxJava çš„éƒ¨åˆ†ã€‚ é…ç½® ConverterFactory ä¸º GsonConverterFactory.create(new Gson()) ç”¨æ¥ä½¿ç”¨ GSON å°†ç½‘ç»œæ•°æ®åºåˆ—åŒ–ä¸ºå¯ç”¨å¯¹è±¡ã€‚ psï¼šbaseUrl è¦æ±‚ä»¥ / ç»“å°¾ï¼Œè€Œè¯·æ±‚çš„ path è¦æ±‚ä¸ä»¥ / å¼€å¤´ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦ç±»ä¼¼ https://www.baidu.com/ çš„å½¢å¼ã€‚ 12345678910111213141516171819/** * åˆ›å»º retrofit * * @param okHttpClient client * @return retrofit */private Retrofit buildRetrofit(OkHttpClient okHttpClient) &#123; final Retrofit.Builder retrofitBuilder = new Retrofit.Builder(); // client retrofitBuilder.client(okHttpClient); // baseUrl retrofitBuilder.baseUrl(BASE_URL); // rxJava è°ƒç”¨ adapter retrofitBuilder.addCallAdapterFactory( RxJava2CallAdapterFactory.createWithScheduler(Schedulers.io())); // æ•°æ®è½¬æ¢ adapter retrofitBuilder.addConverterFactory(GsonConverterFactory.create(new Gson())); return retrofitBuilder.build();&#125; åˆ›å»º api æœåŠ¡æŽ¥å£åˆ›å»ºæŽ¥å£ç±»ï¼Œä½¿ç”¨æ³¨è§£å£°æ˜Žç½‘ç»œè¯·æ±‚çš„æ–¹æ³•å’Œç›¸å…³å‚æ•°ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ›´å¤šå‚æ•°å’Œé…ç½®å°†åœ¨åŽé¢è¯´æ˜Žï¼Œå¦‚ï¼š 1234567public interface ApiService &#123; String GET_USER_INFO = "api/v1/user/info"; @GET(GET_USER_INFO) Call&lt;UserInfoDTOResponse&gt; getUser(@Header("Authorization") String auth);&#125; ä½¿ç”¨ Retrofit åˆå§‹åŒ– ApiServiceï¼ŒèŽ·å–åˆ° ApiService çš„å®žä¾‹ä¹‹åŽå°±å¯ä»¥ä½¿ç”¨è¯¥å®žä¾‹å‘èµ·è¯·æ±‚ã€‚ æˆ‘ä½¿ç”¨ ApiRequest æŒæœ‰ ApiService çš„å®žä¾‹ï¼ŒåŒæ—¶ ApiRequest æ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œä½œä¸ºå‘èµ·ç½‘ç»œè¯·æ±‚çš„ç®¡ç†è€…ã€‚ 1234private void createService() &#123; Retrofit retrofit = buildRetrofit(buildOkHttpClient()); mApiService = retrofit.create(ApiService.class);&#125; å‘èµ·è¯·æ±‚ 12345678910111213141516171819public static void getUserInfo() &#123; // ä»Žå•ä¾‹ä¸­èŽ·å– ApiService ApiService service = ApiRequest.getService(); // åˆ›å»ºè¯·æ±‚ Call&lt;UserInfoDTOResponse&gt; userCall = service.getUser(); // å‘èµ·è¯·æ±‚ userCall.enqueue(new Callback&lt;UserInfoDTOResponse&gt;() &#123; @Override public void onResponse(@NonNull Call&lt;UserInfoDTOResponse&gt; call,@NonNull Response&lt;UserInfoDTOResponse&gt; response) &#123; UserInfoDTOResponse body = response.body(); if (body != null &amp;&amp; body.getData() != null) &#123; L.e(TAG, body.getData().toString()); &#125; &#125; @Override public void onFailure(@NonNull Call&lt;UserInfoDTOResponse&gt; call,@NonNull Throwable t) &#123; &#125; &#125;);&#125; ä¸‹é¢å¯¹ Retrofit ä¸­ method,path,qurey,body,headerå‡ ä¸ªéƒ¨åˆ†åˆ†åˆ«è¯´æ˜Žã€‚ MethodRetrofit æ”¯æŒ GETï¼ŒPOSTï¼ŒPUTï¼ŒDELETEï¼ŒHEADï¼ŒOPTION ç­‰è¯·æ±‚æ–¹å¼ï¼Œå¹¶æœ‰å¯¹åº”çš„æ³¨è§£ã€‚ 12345@GET(GET_USER_INFO)Call&lt;UserInfoDTOResponse&gt; getUser();@DELETE(DELETE_RM_BABY)Call&lt;BaseResponse&gt; deleteBaby(@Path(PATH_BABY_ID) Long babyId); PATHè¯·æ±‚è·¯å¾„ï¼Œè¯·æ±‚è·¯å¾„ä¸­å¯ä»¥åŒ…å«å‚æ•°ï¼Œå¹¶åœ¨å‚æ•°ä¸­ä½¿ç”¨ @PATH æ³¨è§£æ¥åŠ¨æ€æ”¹å˜è·¯å¾„ï¼Œæ¯”å¦‚è·¯å¾„ api/v1/user/{id}ï¼Œä½¿ç”¨æ³¨è§£ @PATH(&quot;id&quot;) Long id å³å¯æ”¹å˜è·¯å¾„ä¸­ {id} è¯·æ±‚æ—¶çš„å€¼ã€‚ 12345678910// path ä¸­ä¸åŒ…å«å‚æ•°@GET(GET_USER_INFO)Call&lt;UserInfoDTOResponse&gt; getUser();String PATH_BABY_ID = "babyId";String PUT_EDIT_BABY = "api/v2/baby/doEdit/&#123;" + PATH_BABY_ID + "&#125;";@PUT(PUT_EDIT_BABY)Call&lt;BaseResponse&gt; putEditBaby(@Path(PATH_BABY_ID) Long babyId); Bodyå‘é€ POST ã€PUT è¯·æ±‚æ—¶é€šå¸¸éœ€è¦æºå¸¦ body æ•°æ®ï¼Œä½¿ç”¨ @Body æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š 12@PUT(PUT_EDIT_BABY)Call&lt;BaseResponse&gt; putEditBaby(@Body BabyParam babyParam); Queryé…ç½® UrlQuery å‚æ•°ï¼Œæ¯”å¦‚ api/v1/user/list?limit=100&amp;offset=10 è¿™ç§ç±»åž‹ã€‚æœ‰ä¸¤ç§é…ç½®æ–¹å¼ï¼š ç¬¬ä¸€ç§ä½¿ç”¨ @Query æ³¨è§£ï¼Œå¦‚ @Query(&quot;userId&quot;) Long userId çš„å½¢å¼ã€‚è¿™ç§å½¢å¼å¯ä»¥ä¼ é€’ null å€¼ï¼Œå¦‚æžœæŸä¸ªå‚æ•°ä¸º nullï¼Œå°†ä¸ä¼šæ‹¼æŽ¥åœ¨ url åŽé¢ã€‚ ç¬¬äºŒç§ä½¿ç”¨ @QueryMap æ³¨è§£ï¼Œå¦‚ @QureyMap Map&lt;String,String&gt; params çš„å½¢å¼ã€‚è¿™ç§å½¢å¼ä¼ é€’ä¸€ä¸ª map ä½œä¸ºå‚æ•°ï¼Œä½†æ˜¯ map ä¸­ value ä¸èƒ½ä¸º nullï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ 12345@GET(GET_BABY_RELATION_LIST)Call&lt;UserBabyRelationResp&gt; getBabyRelationList(@Query("babyId") Long babyId, @Query("limit") int limit, @Query("offset") Long offset);@GET(GET_BABY_RELATION_LIST)Call&lt;UserBabyRelationResp&gt; getBabyRelationList(@QueryMap Map&lt;String,String&gt; map); Headeré™æ€ Headerï¼Œä½¿ç”¨ @Headers æ³¨è§£æ·»åŠ åœ¨è¯·æ±‚æŽ¥å£ä¸Šï¼Œç”¨æ³•å¦‚ä¸‹ï¼š 123456789101112@Headers(&#123;"key:value","key:value"&#125;)@Headers("key:value")eg:@Headers(&#123;"Authorization: authValue", "User-Agent: Retrofit-Sample-App"&#125;)@GET(GET_USER_INFO)Call&lt;UserInfoDTOResponse&gt; getUser();@Headers("Authorization: authValue")@GET(GET_USER_INFO)Call&lt;UserInfoDTOResponse&gt; getUser(); å±€éƒ¨åŠ¨æ€ Headerï¼Œä½¿ç”¨ @Header(&quot;key&quot;) å’Œ @HeaderMap æ³¨è§£æ·»åŠ åœ¨è¯·æ±‚å‚æ•°ä¸Šï¼ŒåŠ¨æ€é…ç½®ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š 12345678910@Header("Authorization") String auth// retrofit:2.1.0 æ·»åŠ @HeaderMap Map&lt;String, String&gt; headerseg:@GET(GET_USER_INFO)Call&lt;UserInfoDTOResponse&gt; getUser(@Header("Authorization") String auth);@GET(GET_USER_INFO)Call&lt;UserInfoDTOResponse&gt; getUser(@HeaderMap Map&lt;String, String&gt; headers); å…¨å±€é…ç½® Headerï¼Œä¸º OkHttp æ·»åŠ  Interceptorï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ addNetWorkIntercepror() å’Œ addInterceptor() çš„åŒºåˆ«ã€‚å½“è¿›å…¥ netWorkInterceptor æ—¶å·²ç»æ·»åŠ äº† User-Agent ç­‰ Headerï¼Œæ­¤æ—¶è¦æŠŠè‡ªå·±çš„ Header ä¸€ä¸ªä¸€ä¸ª addHeader() è¿›åŽ»ï¼Œé˜²æ­¢æŠŠåŽŸæ¥çš„å†²æŽ‰ã€‚ 1234567891011121314151617181920212223242526272829public final class HeaderInterceptor implements Interceptor &#123; public static final String TAG = HeaderInterceptor.class.getSimpleName(); // åˆ°è¾¾ netWorkInterceptor æ—¶ï¼Œé»˜è®¤ header å·²ç»æ·»åŠ ï¼Œä¸èƒ½ä½¿ç”¨æ›¿æ¢çš„æ–¹å¼ï¼Œè¦ä½¿ç”¨ addHeader çš„æ–¹å¼ // åˆ°è¾¾ interceptor æ—¶ï¼Œè¿˜æ²¡æœ‰æ·»åŠ é»˜è®¤ header ,å¯ä»¥ç›´æŽ¥æ›¿æ¢åŽŸæ¥çš„ header ï¼ŒåŽé¢ä¼šè¿½åŠ é»˜è®¤ header @Override public Response intercept(@NonNull Chain chain) throws IOException &#123; Request request = chain.request(); L.e(TAG, "æ·»åŠ å…¨å±€ header "); Request.Builder builder = request.newBuilder(); Map&lt;String, String&gt; headersMap = ApiRequest.getHeadersMap(); for (String key : headersMap.keySet()) &#123; builder.addHeader(key, headersMap.get(key)); &#125; Response response; try &#123; response = chain.proceed(builder.build()); &#125; catch (Exception e) &#123; e.printStackTrace(); throw e; &#125; return response; &#125;&#125;OkHttpClient.Builder okHttpBuilder = new OkHttpClient.Builder();okHttpBuilder.addNetworkInterceptor(new HeaderInterceptor()); Todoæ›´å¤šå†…å®¹è¿˜æ²¡æœ‰æ¶‰åŠâ€¦ 1234567891011// è¡¨å•æäº¤@FormUrlEncoded@POST("user/edit")@HEADCall&lt;User&gt; updateUser(@Field("first_name") String first, @Field("last_name") String last);// æ–‡ä»¶ä¸Šä¼ @Multipart@PUT("user/photo")Call&lt;User&gt; updateUser(@Part("photo") RequestBody photo, @Part("description") RequestBody description);]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Library</tag>
        <tag>Retrofit</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ”¹å˜]]></title>
    <url>%2Farticle%2F3443742407%2F</url>
    <content type="text"><![CDATA[2017å¹´6æœˆ29æ—¥æ—©8ç‚¹ å°é›¨ ä¸Šå‘¨å‘¨æœ«çœ‹äº†ã€Šå˜å½¢é‡‘åˆš5ã€‹ï¼Œç„¶åŽç¡äº†æ•´æ•´ä¸¤å¤©ï¼Œå‘¨æ—¥çš„æ™šä¸Šæœ‰ç§å¼ºçƒˆçš„è´Ÿç½ªæ„Ÿï¼Œæ„Ÿè§‰ç®€ç›´å°±æ˜¯åœ¨æµªè´¹ç”Ÿå‘½ï¼ŒäºŽæ˜¯å°±æŠŠä»Šæ—¥å¤´æ¡ã€å¾®åšã€çˆ±å¥‡è‰ºã€å“”å“©å“”å“©ã€åœŸè±†ç­‰è½¯ä»¶å…¨éƒ½å¸è½½äº†ï¼Œç•™ä¸‹äº†è„‰è„‰ã€CSDNã€çŸ¥ä¹Žâ€¦ åˆ°ä»Šå¤©å·²ç»æ˜¯ç¬¬å››å¤©ï¼Œè¿™å‡ å¤©ä¸€ç›´åšæŒæ™šä¸Š11ç‚¹é’Ÿå·¦å³ç¡è§‰ï¼Œæ—©ä¸Š7ç‚¹é’Ÿåˆ°8ç‚¹é’Ÿä¹‹é—´èµ·åºŠï¼Œæœ‰ç‚¹å±æœºæ„Ÿï¼Œè¿™æ ·ä¸‹åŽ»ç»ˆå½’æ˜¯ä¸è¡Œçš„ã€‚ä»Šå¤©æ—©ä¸Š7ç‚¹å¤šççœ¼çœ‹äº†ä¸€ç¯‡æ–‡ç« ï¼Œæ˜¯ä¸€ç¯‡é¢ç»ï¼Œçœ‹äº†ä»–æ€»ç»“çš„é¢è¯•çŸ¥è¯†ç‚¹ï¼Œåä¹‹å…«ä¹éƒ½ç­”ä¸ä¸Šæ¥ã€‚æ„Ÿè§‰ä¸€ç›´åœ¨å·¥ä½œçš„è¿‡ç¨‹ä¸­éƒ½æ˜¯å®žçŽ°ä¸ºä¸»ï¼Œå †ç Œä»£ç ï¼ŒåŽŸç†ã€ç®—æ³•ä»€ä¹ˆçš„å¥½ä¹…æ²¡åŽ»ç®¡è¿‡ï¼Œå¾ˆæ—©ä¹‹å‰è¿˜ä¼šåŽ»çœ‹ä¸€çœ¼æºç ï¼Œåˆ†æžä¸€ä¸‹ï¼ŒçŽ°åœ¨æ ¹æœ¬æ²¡é‚£ä¸ªç§¯æžæ€§ï¼Œæ˜¯æ—¶å€™å¾—æ”¹å˜ä¸€ä¸‹ï¼Œå¤šå­¦ç‚¹ä¸œè¥¿æ‰æœ‰é€‰æ‹©çš„æƒåŠ›ã€‚ æ€»æœ‰ä¸€å¤©æˆ‘ä¹Ÿè¦å˜çš„å¾ˆðŸ‚xã€‚é©å‘½å°šæœªæˆåŠŸï¼ŒåŒå¿—ä»éœ€åŠªåŠ›ã€‚ é™„é¢ç» ä¸€å¹´Androidå·¥ä½œç»éªŒï¼Œä¸€ä¸¾æ‹¿ä¸‹ç™¾åº¦ã€ç½‘æ˜“ã€ç¾Žå›¢ã€å°ç±³ã€å¿«æ‰‹ç­‰Offeré¢ç» æŸ¥åˆ°äº†è¿™ä¸ªðŸ‚äººçš„åšå®¢åœ°å€ï¼Œä¸è¿‡è²Œä¼¼æ‰“ä¸å¼€CSDN]]></content>
      <categories>
        <category>Life</category>
      </categories>
      <tags>
        <tag>Diary</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WebView]]></title>
    <url>%2Farticle%2F3518734228%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡è®°å½• Android ä¸­ WebView æŽ§ä»¶çš„ç›¸å…³ä½¿ç”¨ï¼Œä¸æ–­å®Œå–„ä¸­â€¦ ä¸»è¦åŒ…æ‹¬ï¼š åŸºæœ¬å±žæ€§çš„é…ç½® WebView ç¼“å­˜ç›¸å…³å†…å®¹ Java ä¸Ž Js çš„äº¤äº’ WebView æ‰“å¼€æœ¬åœ°åº”ç”¨(æ”¯ä»˜å®ç­‰) åŠ è½½ç½‘ç»œé“¾æŽ¥ï¼Œæœ¬åœ° sd å¡è·¯å¾„ï¼Œassert ç›®å½•è·¯å¾„çš„æ–¹æ³• WebView æ”¯æŒä¸‹è½½ç­‰å…¶å®ƒä¸€äº›å†…å®¹ åŸºæœ¬é…ç½®æ±‡æ€»æ±‡æ€»çš„è®°å½•ä¸€ä¸‹ WebView çš„é…ç½®æ–¹æ³•ï¼Œé‡è¦çš„å±žæ€§åŽé¢ä¼šå±•å¼€è¯´æ˜Žã€‚ 123456789101112131415161718192021222324252627282930313233343536373839@SuppressLint("SetJavaScriptEnabled")public static void initWebViewSettings(WebView mWebView) &#123; //æ”¯æŒèŽ·å–æ‰‹åŠ¿ç„¦ç‚¹ mWebView.requestFocusFromTouch(); // è§¦è§‰åé¦ˆï¼Œæš‚æ—¶æ²¡å‘çŽ°ç”¨å¤„åœ¨å“ªé‡Œ mWebView.setHapticFeedbackEnabled(false); WebSettings settings = mWebView.getSettings(); // æ”¯æŒæ’ä»¶ settings.setPluginState(WebSettings.PluginState.ON); // å…è®¸jsäº¤äº’ settings.setJavaScriptEnabled(true); // è®¾ç½®WebViewæ˜¯å¦å¯ä»¥ç”± JavaScript è‡ªåŠ¨æ‰“å¼€çª—å£ï¼Œé»˜è®¤ä¸º false // é€šå¸¸ä¸Ž JavaScript çš„ window.open() é…åˆä½¿ç”¨ã€‚ settings.setJavaScriptCanOpenWindowsAutomatically(true); // å…è®¸ä¸­æ–‡ç¼–ç  settings.setDefaultTextEncodingName("UTF-8"); // ä½¿ç”¨å¤§è§†å›¾ï¼Œè®¾ç½®é€‚åº”å±å¹• settings.setUseWideViewPort(true); settings.setLoadWithOverviewMode(true); // æ”¯æŒå¤šçª—å£ settings.setSupportMultipleWindows(true); // éšè—è‡ªå¸¦ç¼©æ”¾æŒ‰é’® settings.setBuiltInZoomControls(false); // æ”¯æŒç¼©æ”¾ settings.setSupportZoom(true); // è®¾ç½®å¯è®¿é—®æ–‡ä»¶ settings.setAllowFileAccess(true); // å½“WebViewè°ƒç”¨requestFocusæ—¶ä¸ºWebViewè®¾ç½®èŠ‚ç‚¹ settings.setNeedInitialFocus(true); //æ”¯æŒè‡ªåŠ¨åŠ è½½å›¾ç‰‡ settings.setLoadsImagesAutomatically(true); // æŒ‡å®šWebViewçš„é¡µé¢å¸ƒå±€æ˜¾ç¤ºå½¢å¼ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¼šå¼•èµ·é¡µé¢é‡ç»˜ã€‚ // NORMAL,SINGLE_COLUMN è¿‡æ—¶, NARROW_COLUMNS è¿‡æ—¶ ,TEXT_AUTOSIZING settings.setLayoutAlgorithm(WebSettings.LayoutAlgorithm.SINGLE_COLUMN); // ä»ŽLollipop(5.0)å¼€å§‹WebViewé»˜è®¤ä¸å…è®¸æ··åˆæ¨¡å¼ï¼Œhttpså½“ä¸­ä¸èƒ½åŠ è½½httpèµ„æºï¼Œéœ€è¦è®¾ç½®å¼€å¯ if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123; settings.setMixedContentMode(WebSettings.MIXED_CONTENT_ALWAYS_ALLOW); &#125;&#125; WebView ç¼“å­˜æ¸…é™¤ç¼“å­˜ï¼Œtrue è¡¨ç¤ºæ¸…é™¤ç£ç›˜ç¼“å­˜ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å…¨å±€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæ¸…é™¤æŽ‰æ•´ä¸ªåº”ç”¨æ‰€æœ‰çš„ ç½‘é¡µç¼“å­˜ã€‚ 1mWebView.clearCache(true); æ¸…é™¤åŽ†å²è®°å½• 1mWebView.clearHistory(); ç½‘ä¸Šæœ‰ä»‹ç»è¯´ï¼Œè®¾ç½®ç¼“å­˜çš„ç›®å½•ï¼Œæ¸…é™¤ç¼“å­˜æ—¶åˆ é™¤æŽ‰ç¼“å­˜æ–‡ä»¶ï¼Œä½†æ˜¯ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è®¾ç½®ç¼“å­˜è·¯å¾„åŽï¼Œå‘çŽ°æ–‡ä»¶å¹¶æ²¡æœ‰ç¼“å­˜åˆ°æŒ‡å®šçš„ç›®å½•ï¼Œä¸çŸ¥é“æ˜¯æ€Žä¹ˆå›žäº‹ï¼Ÿæ±‚æŒ‡æ•™ ç¼“å­˜æ¨¡å¼ æè¿° LOAD_DEFAULT é»˜è®¤çš„ç¼“å­˜ä½¿ç”¨æ¨¡å¼ã€‚åœ¨è¿›è¡Œé¡µé¢å‰è¿›æˆ–åŽé€€çš„æ“ä½œæ—¶ï¼Œå¦‚æžœç¼“å­˜å¯ç”¨å¹¶æœªè¿‡æœŸå°±ä¼˜å…ˆåŠ è½½ç¼“å­˜ï¼Œå¦åˆ™ä»Žç½‘ç»œä¸ŠåŠ è½½æ•°æ®ã€‚è¿™æ ·å¯ä»¥å‡å°‘é¡µé¢çš„ç½‘ç»œè¯·æ±‚æ¬¡æ•°ã€‚ LOAD_CACHE_ELSE_NETWORK åªè¦ç¼“å­˜å¯ç”¨å°±åŠ è½½ç¼“å­˜ï¼Œå“ªæ€•å®ƒä»¬å·²ç»è¿‡æœŸå¤±æ•ˆã€‚å¦‚æžœç¼“å­˜ä¸å¯ç”¨å°±ä»Žç½‘ç»œä¸ŠåŠ è½½æ•°æ®ã€‚ LOAD_NO_CACHE ä¸åŠ è½½ç¼“å­˜ï¼Œåªä»Žç½‘ç»œåŠ è½½æ•°æ®ã€‚ LOAD_CACHE_ONLY ä¸ä»Žç½‘ç»œåŠ è½½æ•°æ®ï¼Œåªä»Žç¼“å­˜åŠ è½½æ•°æ®ã€‚ 123456789101112131415161718private static void initWebViewCache(WebView mWebView) &#123; String cachePath = new File(Environment.getExternalStorageDirectory() , "webCache").getAbsolutePath(); WebSettings settings = mWebView.getSettings(); settings.setAppCacheEnabled(true); settings.setAppCachePath(cachePath); settings.setDatabaseEnabled(true); // è¿‡æ—¶ settings.setDatabasePath(cachePath); // å¼€å¯domç¼“å­˜ settings.setDomStorageEnabled(true); // åŠ è½½æ¨¡å¼ settings.setCacheMode(WebSettings.LOAD_NO_CACHE); // ç¼“å­˜æœ€å¤§å€¼ï¼Œè¿‡æ—¶ settings.setAppCacheMaxSize(1000 * 1024);&#125; åŠ è½½ UrlåŠ è½½ç½‘ç»œè·¯å¾„ï¼Œheaders ä¸æ˜¯å¿…é€‰çš„ 123Map&lt;String,String&gt; headers = new HashMap&lt;&gt;();headers.put("auth","110");mWebView.loadUrl("https://www.baidu.com/",headers); åŠ è½½ assert è·¯å¾„ 123456// WebViewUtil.javapublic static String getAssertUrl(String fileUrl) &#123; return "file:///android_asset/" + fileUrl;&#125;mWebView.loadUrl(WebViewUtil.getAssertUrl("index.html")); åŠ è½½ sd å¡è·¯å¾„ 123456// WebViewUtil.javapublic static String getSdUrl(String fileUrl) &#123; return "file://" + Environment.getExternalStorageDirectory() + "/" + fileUrl;&#125;mWebView.loadUrl(WebViewUtil.getSdUrl("index.html")); Js è°ƒç”¨ JavaJava ä¸Ž Js äº¤äº’éœ€è¦å®šä¹‰ä¸€ä¸ªå¸¦æœ‰ @JavascriptInterface æ³¨è§£æ–¹æ³•çš„å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š 123456789101112public class JsBridge &#123; @JavascriptInterface public void toast(String msg) &#123; ToastUtils.show(msg); &#125; @JavascriptInterface public void log(String msg) &#123; Log.e(TAG, msg); &#125;&#125; ä½¿ç”¨ JsBridge è¿žæŽ¥ Java å’Œ Jsï¼Œä½¿ç”¨ mWebView.addJavascriptInterface(obj, name); æ–¹æ³•ã€‚ objï¼šå¸¦æœ‰ JavascriptInterface æ³¨è§£æ–¹æ³•çš„å¯¹è±¡å®žä¾‹ã€‚ nameï¼šä¸€ä¸ªæ ‡å¿—ç¬¦ï¼Œjs å°†ä¼šä½¿ç”¨è¯¥æ ‡å¿—æ¥è°ƒç”¨ java å±‚çš„æ–¹æ³•ã€‚ 12mWebView.getSettings().setJavaScriptEnabled(true);mWebView.addJavascriptInterface(new JsBridge(), "android"); åœ¨æ·»åŠ è°ƒç”¨æŽ¥å£æ—¶ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ ‡è®°ï¼Œå¦‚ä¸Šé¢ä»£ç ä¸­æ·»åŠ çš„æ˜¯ androidï¼Œå®ƒç›¸å½“äºŽè°ƒç”¨æŽ¥å£å¯¹è±¡çš„ä¸€ä¸ªåˆ«åï¼Œå› æ­¤åœ¨ js ä¸­è°ƒç”¨ java æ–¹æ³•æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨ window å¯¹è±¡ï¼Œå¦‚ä¸‹: 1window.android.log('test js invoke java method'); Java è°ƒç”¨ Jsä½¿ç”¨ java è°ƒç”¨ js æ–¹æ³•ç›¸å¯¹ç®€å•ï¼Œå‡å¦‚åœ¨ js ä¸­åº”è¯¥å£°æ˜Žå¦‚ä¸‹ functionï¼Œ 123456789101112&lt;script&gt;// æœ‰å‚æ— è¿”å›žå€¼ function funcParam(param)&#123; alert(param+""); &#125; // æœ‰å‚æœ‰è¿”å›žå€¼ function newFunc(param1,param2,param3)&#123; alert((param1 + param2) + " " + param3); return param3; &#125;&lt;/script&gt; åœ¨ java å±‚è°ƒç”¨æ—¶åªéœ€ loadUrl(&quot;Javascript:jsæ–¹æ³•å()) å³å¯ï¼Œä½†æ˜¯ Android 4.4 ä¹‹åŽåœ¨è°ƒç”¨ js æ–¹æ³•æ—¶å¯ä»¥èŽ·å–è¿”å›žå€¼ï¼Œå†™ä¸€ä¸ªæ–¹æ³•å…¼å®¹ä¸€ä¸‹ 12345678910111213public static final String JS_FUNC_PREFIX = "javascript:";public void invokeJs(String jsFunc, final ValueCallback&lt;String&gt; callback) &#123; if (!jsFunc.startsWith(JS_FUNC_PREFIX)) &#123; jsFunc = JS_FUNC_PREFIX + jsFunc; &#125; // api 19 if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT) &#123; mWebView.evaluateJavascript(jsFunc, callback); &#125; else &#123; mWebView.loadUrl(jsFunc); &#125;&#125; åœ¨ä¸Ž js è¿›è¡Œå‚æ•°ä¼ é€’æ—¶ï¼ŒåŸºæœ¬æ•°æ®ç±»åž‹å¯ä»¥ç›´æŽ¥ä¼ é€’ï¼Œå­—ç¬¦ä¸²ç±»åž‹è¦ä½¿ç”¨å¼•å·åŒ…å«ï¼Œè€Œä¸”ç›´æŽ¥æ‹¼æŽ¥å­—ç¬¦ä¸²ä¸å¤ªå¥½ï¼Œå› æ­¤å†™ä¸€ä¸ªç®€åŒ–æž„å»º js æ–¹æ³•ï¼Œè‡ªåŠ¨æŒ‰é¡ºåºè¿›è¡Œå‚æ•°çš„æ‹¼æŽ¥ã€‚ 123456789101112131415161718// åˆ›å»ºä¸€ä¸ª js æ–¹æ³•public static String generateJsFunc(String funcName, Object... params) &#123; StringBuilder sb = new StringBuilder(funcName).append("("); for (int i = 0; i &lt; params.length; i++) &#123; if (params[i] != null) &#123; if (params[i] instanceof String) &#123; sb.append("'").append(params[i]).append("'"); &#125; else &#123; sb.append(params[i]); &#125; if (i != params.length - 1) &#123; sb.append(","); &#125; &#125; &#125; sb.append(")"); return sb.toString();&#125; ç®€å•è°ƒç”¨ 123456789101112// è°ƒç”¨æœ‰å‚æœ‰è¿”å›žå€¼çš„æ–¹æ³•String jsFunc = JsBridge.generateJsFunc("newFunc", "str", 100, 100);mJsBridge.invokeJs(jsFunc, new ValueCallback&lt;String&gt;() &#123; @Override public void onReceiveValue(String value) &#123; Log.e(TAG, "value = " + value); &#125;&#125;);// è°ƒç”¨æœ‰å‚æ— è¿”å›žå€¼æ–¹æ³•String funcParam = JsBridge.generateJsFunc("funcParam", 100);mJsBridge.invokeJs(funcParam, null); æ‹¦æˆª Url æ‰“å¼€åº”ç”¨(æ”¯ä»˜å®)ä¸»è¦åŽŸç†æ˜¯ç”±äºŽæŸäº›åº”ç”¨ä¼šæš´éœ²ä¸€äº›é¡µé¢å‡ºæ¥ä¾›åˆ«çš„ app å”¤èµ·ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‹¦æˆªè¿™ç§ Urlï¼Œç„¶åŽä½¿ç”¨ intent æ‰“å¼€å³å¯ï¼Œä¸‹é¢ä»¥æ”¯ä»˜å®ä¸ºä¾‹è¯´æ˜Žï¼š å‰ç«¯ä½¿ç”¨æ”¯ä»˜å®è¿›è¡Œæ”¯ä»˜æ—¶ï¼Œéœ€è¦æ‰“å¼€æ‰‹æœºæ”¯ä»˜å®å®¢æˆ·ç«¯ï¼Œæ–­ç‚¹çœ‹åˆ°æ”¯ä»˜å®ä¼šåŠ è½½ä¸€ä¸ª scheme ä¸º alipays çš„urlï¼Œé“¾æŽ¥ä¸­é…ç½®äº†æ”¯ä»˜çš„ç›¸å…³ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯è¦åšçš„å°±æ˜¯æ‹¦æˆªè¯¥ Urlï¼Œä½¿ç”¨ intent æ‰“å¼€æ”¯ä»˜å®ã€‚ å½“ html åŠ è½½ç½‘é¡µä¹‹å‰ä¼šå…ˆèµ° shouldOverrideUrlLoading() æ–¹æ³•ï¼Œæ­¤æ—¶æˆªæ–­ä¸ä½¿ç”¨ webView åŠ è½½ï¼Œè€Œæ˜¯ä½¿ç”¨ intent æ‰“å¼€ï¼Œæ­¤æ–¹æ³•ä¸ä»…é€‚ç”¨æ”¯ä»˜å®ï¼Œä¹Ÿé€‚ç”¨æ‰“å¼€å…¶ä»–åº”ç”¨ã€‚ 12345678910111213141516171819202122232425262728293031323334mWebView.setWebViewClient(new WebViewClient() &#123; @Override public boolean shouldOverrideUrlLoading(WebView view, String url) &#123; // å¦‚æžœä¸ä½¿ç”¨ intent è¦†ç›–åŠ è½½è¿™ä¸ªé“¾æŽ¥ï¼Œå°±èµ°åŽŸæ¥ if (!shouldOverrideIntentUrl(getContext(), url)) &#123; view.loadUrl(url, Api.makeHttpHeaders(getContext())); &#125; return true; &#125;&#125;);public static final String ALIPAY_SCHEME = "alipays";public static boolean shouldOverrideIntentUrl(Context context, String url) &#123; Uri uri = Uri.parse(url); if (uri != null &amp;&amp; uri.getScheme() != null &amp;&amp; uri.getScheme().equals(ALIPAY_SCHEME)) &#123; try &#123; Intent intent = Intent.parseUri(url, Intent.URI_INTENT_SCHEME); intent.addCategory(Intent.CATEGORY_BROWSABLE); intent.setComponent(null); intent.setSelector(null); context.startActivity(intent); &#125; catch (Exception e) &#123; e.printStackTrace(); if (e instanceof ActivityNotFoundException) &#123; ToastUtil.show("æœªæ£€æµ‹åˆ°æ”¯ä»˜å®å®¢æˆ·ç«¯"); &#125; return true; &#125; return true; &#125; return false;&#125; æ”¯æŒä¸‹è½½é“¾æŽ¥å½“ç½‘é¡µä¸­åŠ è½½ä¸€ä¸ªä¸‹è½½çš„é“¾æŽ¥ï¼Œå¦‚ http://xxx.apk è¿™ç§é“¾æŽ¥ï¼Œä¼šèµ° shouldOverrideUrlLoading() æ–¹æ³•ï¼Œä½†æ˜¯ï¼Œå®ƒæ˜¯æ— æ³•åŠ è½½ä¸€ä¸ªç½‘é¡µçš„ï¼Œç»“æžœå°±æ˜¯æ²¡æœ‰ä»»ä½•ååº”ï¼Œæ­¤æ—¶éœ€è¦è®¾ç½® DownloadListenerï¼Œéœ€è¦ä¸‹è½½çš„é“¾æŽ¥ä¼šè¿›å…¥ç›‘å¬ï¼Œä½ å¯ä»¥åœ¨ç›‘å¬ä¸­è‡ªå·±è¿›è¡Œç½‘ç»œä¸‹è½½ä¿å­˜åˆ°æ–‡ä»¶ï¼Œä¸‹é¢æˆ‘ä½¿ç”¨ç›´æŽ¥æ‰“å¼€æµè§ˆå™¨çš„æ–¹å¼ï¼Œæ›´ç®€å•ä¸€äº›ã€‚ 12345678910111213141516171819public static void setDefDownloadListener(final WebView webView) &#123; webView.setDownloadListener(new DownloadListener() &#123; @Override public void onDownloadStart(String url, String userAgent, String contentDisposition, String mimetype, long contentLength) &#123; //åŽ»ä¸‹è½½ Intent intent = new Intent(Intent.ACTION_VIEW); String downLoadUrl = url; if (!downLoadUrl.contains("http://")) &#123; downLoadUrl = "http://" + downLoadUrl; &#125; intent.setData(Uri.parse(downLoadUrl)); intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); webView.getContext().startActivity(intent); &#125; &#125;);&#125; WebChromeClientWebView é»˜è®¤æ˜¯æ— æ³•å¼¹å‡º alert() çš„ï¼Œéœ€è¦è®¾ç½® WebChromeClient 1mWebView.setWebChromeClient(new WebChromeClient()); todoæ›´å¤šå†…å®¹è¡¥å……ä¸­ â€¦]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RecyclerView Adapter]]></title>
    <url>%2Farticle%2F1632666977%2F</url>
    <content type="text"><![CDATA[LightAdapter å¸Œæœ›èƒ½å¤Ÿå®žçŽ°ä¸€ä¸ªè½»é‡çº§çš„ã€æ›´å®¹æ˜“ä½¿ç”¨å’Œç†è§£çš„RecyclerView Adapter ç±»åº“ï¼Œå¸å–åˆ«äººçš„é•¿å¤„ï¼Œä¸æ–­å®Œå–„ä¸­ã€‚ åŸºæœ¬çš„æ•°æ®åŠ è½½ä¸Žç»‘å®šç”± LightAdapter æ¥å®žçŽ°ï¼Œæ›´å¤šå¢žå¼ºåŠŸèƒ½ç”±å¤šä¸ªæ¨¡å— Module åˆ†å·¥åˆä½œå®Œæˆï¼ŒçŽ°åœ¨å…·æœ‰ä»¥ä¸‹æ¨¡å— HFModuleï¼Œå®žçŽ°ä¸º RecyclerView æ·»åŠ  Header å’Œ Footer çš„åŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€çš„æ˜¾ç¤ºå’Œç§»é™¤ Header å’Œ Footerã€‚ LoadMoreModuleï¼Œå®žçŽ°åˆ°è¾¾åˆ—è¡¨åº•éƒ¨è‡ªåŠ¨è§¦å‘ç›‘å¬åŠ è½½æ›´å¤šæ•°æ®ã€‚ TopLoadMoreModuleï¼Œå®žçŽ°åˆ°è¾¾åˆ—è¡¨é¡¶éƒ¨è‡ªåŠ¨è§¦å‘ç›‘å¬åŠ è½½æ›´å¤šæ•°æ®ã€‚ SelectorModuleï¼Œå®žçŽ°é€‰æ‹©å™¨åŠŸèƒ½ï¼Œè¾…åŠ©ç®€åŒ–åˆ—è¡¨å•é€‰å’Œå¤šé€‰æ“ä½œå’Œæ•°æ®æ›´æ–°å’Œå­˜å‚¨ã€‚ UpdateModuleï¼Œå®žçŽ°åŒ…è£…æ•°æ®æ›´æ–°åŠŸèƒ½ï¼Œåœ¨ä¸»çº¿ç¨‹æ›´æ–°æ•°æ®ï¼Œå¹¶æä¾›æ›´å¤šæ›´æ–°æ•°æ®çš„æ–¹æ³•ã€‚]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Contribute</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidç¼–è¯‘FFmpegä¹‹å‘½ä»¤è¡Œ]]></title>
    <url>%2Farticle%2F4043209466%2F</url>
    <content type="text"><![CDATA[ä¸Šç¯‡æ–‡ç« ä»‹ç»äº† FFmpeg å¤§ä½“çš„ç¼–è¯‘æµç¨‹ï¼Œå¹¶åœ¨ Java å±‚è¿›è¡Œ JNI æŽ¥å£çš„è°ƒç”¨ï¼Œå€Ÿæ­¤äº†è§£ Android ç¼–è¯‘åº•å±‚ so åº“çš„æ–¹å¼ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•åœ¨ Android å¹³å°ä½¿ç”¨ FFmoeg å‘½ä»¤è¡Œå¯¹éŸ³è§†é¢‘è¿›è¡Œæ“ä½œã€‚ æ‰¿æŽ¥ä¸Šæ–‡ï¼Œæœ¬æ–‡ä»Žç¼–è¯‘å¥½å„ä¸ª so æ–‡ä»¶ä¹‹åŽï¼Œç¼–å†™ Java å±‚è°ƒç”¨çš„ c æ–‡ä»¶å¼€å§‹ã€‚ æºä»£ç  GitHub - FFmpegAndroidSupport(æ³¨æ„åœ¨ try_cmd åˆ†æ”¯) Java å±‚ Native æ–¹æ³•é¦–å…ˆè¿›è¡Œ Java å±‚ä»£ç çš„ç¼–å†™ï¼Œåˆ›å»º FFmpegSupport ç±»ï¼ŒåŠ è½½ so æ–‡ä»¶ï¼Œå£°æ˜Ž native æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536public class FFmpegSupport &#123; static &#123; try &#123; System.loadLibrary("avdevice-57"); System.loadLibrary("avfilter-6"); System.loadLibrary("avformat-57"); System.loadLibrary("avutil-55"); System.loadLibrary("avcodec-57"); System.loadLibrary("postproc-54"); System.loadLibrary("swresample-2"); System.loadLibrary("swscale-4"); System.loadLibrary("ffmpegjni"); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static int ffmpegRunCommand(String command) &#123; if (command.isEmpty()) &#123; return 1; &#125; String[] args = command.split(" "); return ffmpegRunCommand(args); &#125; static int ffmpegRunCommand(String[] commands) &#123; for (String command : commands) &#123; Log.d("ffmpeg-jni", command); &#125; return ffmpegRun(commands.length, commands); &#125; public static native int ffmpegRun(int argc, String[] args);&#125; ç”Ÿæˆ .h å¤´æ–‡ä»¶ä½¿ç”¨ javah å‘½ä»¤æ ¹æ®ä½ çš„ java æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ .h æ–‡ä»¶ï¼Œjavah å‘½ä»¤éœ€è¦ class æ–‡ä»¶ï¼Œæ‰€ä»¥é¦–å…ˆä½ éœ€è¦å¯¹å·¥ç¨‹è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆ class æ–‡ä»¶ï¼Œå®ƒä½äºŽ project/app/build/intermediates/classes/debug ç›®å½•ä¸‹ã€‚ æ¯”å¦‚æˆ‘çš„ç±»å«åš FFmpegSupportï¼ŒåŒ…å com.march.fasï¼Œè¿è¡Œå‘½ä»¤åŽç”Ÿæˆäº† com_march_fas_FFmpegSupport.h æ–‡ä»¶ï¼Œè¿™ä¸ª .h æ–‡ä»¶çš„åå­—åº”è¯¥æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼ŒçŽ°åœ¨æ˜¯é»˜è®¤çš„åŒ…åç±»åï¼Œæˆ‘è¿˜æ²¡æœ‰æŸ¥åˆ°ç›¸å…³å‚æ•°ã€‚ 123456javah -d &lt;.hæ–‡ä»¶ç”Ÿæˆçš„ç›®å½•&gt; -classpath &lt;classæ–‡ä»¶å­˜å‚¨çš„ç›®å½•&gt; &lt;åŒ…å.ç±»å&gt;// å¦‚ä¸‹javah -d /Users/march/AndroidPro/FFmpegAndroidSupport/app/src/main/jni \-classpath /Users/march/AndroidPro/FFmpegAndroidSupport/app/build/intermediates/classes/debug \com.march.fas.FFmpegSupport æŸ¥çœ‹ .h æ–‡ä»¶çš„å†…å®¹ï¼Œå°† jclass æ”¹ä¸º jobjectï¼ŒåŽŸå› çš„è¯æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä¸æ˜¯å¾ˆæ‡‚è¿™ä¸€å—å„¿ï¼Œä¹Ÿæ˜¯æŸ¥èµ„æ–™æ…¢æ…¢æ€»ç»“çš„ã€‚ 123456789101112131415161718192021/* DO NOT EDIT THIS FILE - it is machine generated */#include &lt;jni.h&gt;/* Header for class com_march_fas_FFmpegSupport */#ifndef _Included_com_march_fas_FFmpegSupport#define _Included_com_march_fas_FFmpegSupport#ifdef __cplusplusextern "C" &#123;#endif/* * Class: com_march_fas_FFmpegSupport * Method: ffmpegRun * Signature: (I[Ljava/lang/String;)I */JNIEXPORT jint JNICALL Java_com_march_fas_FFmpegSupport_ffmpegRun (JNIEnv *, jobject, jint, jobjectArray);#ifdef __cplusplus&#125;#endif#endif ç¼–å†™å¯¹åº” c æ–‡ä»¶æ ¹æ®ç”Ÿæˆçš„ .h ç¼–å†™ c æ–‡ä»¶ï¼Œå…¶ä¸­ logjni.h æ˜¯ä¸€ä¸ªæ‰“å°æ—¥å¿—çš„å·¥å…·ç±»ï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒ github ä¸Šé¢çš„æºæ–‡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233343536#include "logjni.h"#include "com_march_fas_FFmpegSupport.h"#include &lt;stdlib.h&gt;#include &lt;stdbool.h&gt;int main(int argc, char **argv);JNIEXPORT jint JNICALL Java_com_march_fas_FFmpegSupport_ffmpegRun(JNIEnv *env, jobject obj, jint argc, jobjectArray args) &#123; int i = 0; char **argv = NULL; jstring *strr = NULL; if (args != NULL) &#123; argv = (char **) malloc(sizeof(char *) * argc); strr = (jstring *) malloc(sizeof(jstring) * argc); for (i = 0; i &lt; argc; ++i) &#123; strr[i] = (jstring)(*env)-&gt;GetObjectArrayElement(env, args, i); argv[i] = (char *)(*env)-&gt;GetStringUTFChars(env, strr[i], 0); LOGD("args: %s", argv[i]); &#125; &#125; LOGD("Run ffmpeg"); int result = main(argc, argv); LOGD("ffmpeg result %d", result); for (i = 0; i &lt; argc; ++i) &#123; (*env)-&gt;ReleaseStringUTFChars(env, strr[i], argv[i]); &#125; free(argv); free(strr); return result;&#125; å‡†å¤‡å·¥ä½œå¦‚ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ ffmpeg.c ä¸­çš„ main() å‡½æ•°ï¼Œå› æ­¤éœ€è¦å°† ffmpeg.c å’Œ ffmpeg.h æ‹·è´åˆ° jni ç›®å½•ä¸­ï¼ŒåŒæ—¶ ffmpeg.c åˆå¼•ç”¨äº†å¤šä¸ªæ–‡ä»¶ï¼Œå¤§è‡´æœ‰ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶éƒ½éœ€è¦æ‹·è´åˆ° jni ç›®å½•ä¸­ 12345678config.hffmpeg.cffmpeg.hffmpeg_filter.cffmpeg_opt.ccmdutils_common_opts.hcmdutils.hcmdutils.c è·Ÿä¸Šä¸€ç¯‡æ–‡ç« è¯´çš„ä¸€æ ·ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å°†ç¼–è¯‘å¥½çš„ so æ–‡ä»¶æ‹·è´åˆ° jni ç›®å½•ï¼ŒåŒæ—¶ç¼–å†™ Android.mk å’Œ Application.mk æ–‡ä»¶ã€‚ä¸ºäº†è®©ç»“æž„æ›´åŠ æ¸…æ™°ï¼Œæˆ‘å¯¹ç›®å½•åšäº†äº›è®¸æ”¹åŠ¨ã€‚åœ¨ jni ç›®å½•ä¸‹æ–°å»ºäº† prebuilt/armeabi æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ so æ–‡ä»¶ã€‚åŒæ—¶ Android.mk å’Œ Application.mk æ–‡ä»¶ä¹Ÿéœ€è¦åšç›¸åº”ä¿®æ”¹ã€‚ Android.mk æ–‡ä»¶ï¼Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172LOCAL_PATH:= $(call my-dir)include $(CLEAR_VARS)LOCAL_MODULE:= avcodec-prebuilt-armeabiLOCAL_SRC_FILES:= prebuilt/armeabi/libavcodec-57.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE:= avdevice-prebuilt-armeabiLOCAL_SRC_FILES:= prebuilt/armeabi/libavdevice-57.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE:= avfilter-prebuilt-armeabiLOCAL_SRC_FILES:= prebuilt/armeabi/libavfilter-6.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE:= avformat-prebuilt-armeabiLOCAL_SRC_FILES:= prebuilt/armeabi/libavformat-57.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := avutil-prebuilt-armeabiLOCAL_SRC_FILES := prebuilt/armeabi/libavutil-55.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := swresample-prebuilt-armeabiLOCAL_SRC_FILES := prebuilt/armeabi/libswresample-2.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := swscale-prebuilt-armeabiLOCAL_SRC_FILES := prebuilt/armeabi/libswscale-4.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := postproc-prebuilt-armeabiLOCAL_SRC_FILES := prebuilt/armeabi/libpostproc-54.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := libffmpegjniLOCAL_ARM_MODE := armLOCAL_SRC_FILES := com_march_fas_FFmpegSupport.c \ ffmpeg.c \ cmdutils.c \ ffmpeg_opt.c \ ffmpeg_filter.cLOCAL_LDLIBS := -L$(SYSROOT)/usr/lib -llog -lzLOCAL_SHARED_LIBRARIES:= avcodec-prebuilt-armeabi \ avdevice-prebuilt-armeabi \ avfilter-prebuilt-armeabi \ avformat-prebuilt-armeabi \ avutil-prebuilt-armeabi \ swresample-prebuilt-armeabi \ swscale-prebuilt-armeabi \ postproc-prebuilt-armeabiLOCAL_C_INCLUDES += -L$(SYSROOT)/usr/includeLOCAL_C_INCLUDES += /Users/march/AndroidPro/FFmpegAndroidSupport/ffmpeg-3.3.1LOCAL_CFLAGS := -DUSE_ARM_CONFIGinclude $(BUILD_SHARED_LIBRARY) Application.mk æ–‡ä»¶ 12APP_ABI := armeabi-v7aAPP_PLATFORM := android-14 ä¿®æ”¹ ffmpeg æºä»£ç ]]></content>
      <categories>
        <category>Android</category>
        <category>Ndk</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>FFmpeg</tag>
        <tag>Ndk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-5-ç±»ä¸Žå¯¹è±¡]]></title>
    <url>%2Farticle%2F2717980190%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Kotlin ç±»ä¸Žå¯¹è±¡ã€‚ çœ‹äº†å®˜æ–¹æ–‡æ¡£çš„ç›¸å…³æè¿°ï¼Œå‘çŽ°å¾ˆå¤šåè¯åœ¨ Kotlin ä¸­å’Œ Java éƒ½æœ‰ä¸å¤ªä¸€æ ·ï¼Œåœ¨ Kotlin ä¸­ æ–¹æ³• è¢«ç§°ä¸º å‡½æ•°ï¼Œè€Œåƒ open , final è¿™ç§å…³é”®å­—è¢«ç§°ä¸ºæ³¨è§£(annotation)ï¼Œåœ¨æˆ‘ä¹‹å‰çš„è®¤çŸ¥å½“ä¸­åªæœ‰ @Inject è¿™ç§æ‰æ˜¯æ³¨è§£ã€‚å› æ­¤æ–‡ç« ä¸­çš„æè¿°éƒ½å°½é‡ä½¿ç”¨ Kotlin ä¸­çš„æœ¯è¯­ã€‚ æž„é€ å™¨Kotlin ä¸­çš„ç±»å¯ä»¥æœ‰ä¸€ä¸ª ä¸»æž„é€ å™¨ (primary constructor), ä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ª æ¬¡æž„é€ å™¨ (secondary constructor)ã€‚ä¸»æž„é€ å™¨æ˜¯ç±»å¤´éƒ¨çš„ä¸€éƒ¨åˆ†, ä½äºŽç±»åç§°(ä»¥åŠå¯é€‰çš„ç±»åž‹å‚æ•°)ä¹‹åŽã€‚ ä¸»æž„é€ å™¨ä¸»æž„é€ å™¨ç´§è·Ÿåœ¨ç±»ååŽé¢è¿›è¡Œå£°æ˜Žï¼Œå£°æ˜Žçš„ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼Œå¯è§åº¦ä¿®é¥°ç¬¦é»˜è®¤ä¸º publicï¼Œ(å¦‚æžœä¸»æž„é€ å™¨æ˜¯ public çš„ï¼ŒåŒæ—¶æ²¡æœ‰æ³¨è§£é‚£ä¹ˆå¯ä»¥çœç•¥ constructor å…³é”®å­—)ã€‚å½“ç„¶å¦‚æžœç±»å†…éƒ¨æ²¡æœ‰å…·ä½“çš„å®žçŽ°ï¼Œ{} ä¹Ÿæ˜¯å¯ä»¥çœç•¥çš„ã€‚ 12345678// å®Œæ•´çš„å†™æ³•class Engineer private @Inject constructor(name: String, age: Int, language: String)// ç®€åŒ–å†™æ³•ï¼Œç”±äºŽæ˜¯publicçš„ï¼ŒåŒæ—¶æ²¡æœ‰æ³¨è§£ï¼Œçœç•¥äº†constructorå…³é”®å­—class Engineer (name: String, age: Int, language: String)// é»˜è®¤ç”Ÿæˆä¸€ä¸ªpublicçš„æ— å‚æž„é€ å™¨class Engineer ç”±äºŽä¸»æž„é€ å™¨ä¸­æ— æ³•ä½¿ç”¨åˆå§‹åŒ–ä»£ç ï¼Œå¯ä»¥åœ¨ç±»å†…è¿›è¡Œå±žæ€§çš„åˆå§‹åŒ–ï¼Œä½¿ç”¨ init{} å…³é”®å­—è¡¨ç¤ºã€‚ 123456789101112class Engineer (name: String, age: Int, language: String) &#123; var name: String = "" var age:Int = 0 var language:String = "" init &#123; this.name = name this.age = age this.language = language log("name = $name,age = $age, lan = $language") &#125;&#125; åœ¨ä¸»æž„é€ å™¨å†…å¯ä»¥ç›´æŽ¥ä½¿ç”¨ val å’Œ var å£°æ˜Žå’Œåˆå§‹åŒ–å±žæ€§ï¼Œä»–ä»¬éƒ½æ˜¯ç±»çš„æˆå‘˜å±žæ€§ã€‚ 123class Engineer(val name: String = "", age: Int = 0, language: String = "") &#123;&#125; æ³¨æ„: åœ¨ JVM ä¸­, å¦‚æžœä¸»æž„é€ å™¨çš„æ‰€æœ‰å‚æ•°éƒ½æŒ‡å®šäº†é»˜è®¤å€¼, ç¼–è¯‘å™¨å°†ä¼šäº§ç”Ÿä¸€ä¸ªé¢å¤–çš„æ— å‚æ•°æž„é€ å™¨, è¿™ä¸ªæ— å‚æ•°æž„é€ å™¨ä¼šä½¿ç”¨é»˜è®¤å‚æ•°å€¼æ¥è°ƒç”¨æ—¢æœ‰çš„æž„é€ å™¨. æœ‰äº›åº“(æ¯”å¦‚ Jackson æˆ– JPA) ä¼šä½¿ç”¨æ— å‚æ•°æž„é€ å™¨æ¥åˆ›å»ºå¯¹è±¡å®žä¾‹, è¿™ä¸ªç‰¹æ€§å°†ä½¿å¾— Kotlin æ¯”è¾ƒå®¹æ˜“ä¸Žè¿™ç§åº“ååŒå·¥ä½œ. æ¬¡çº§æž„é€ å™¨å¦‚æžœç±»æœ‰ä¸»æž„é€ å™¨, é‚£ä¹ˆæ¯ä¸ªæ¬¡çº§æž„é€ å™¨éƒ½å¿…é¡»å§”æ‰˜ç»™ä¸»æž„é€ å™¨, è¦ä¹ˆç›´æŽ¥å§”æ‰˜, è¦ä¹ˆé€šè¿‡å…¶ä»–æ¬¡çº§æž„é€ å™¨é—´æŽ¥å§”æ‰˜. å§”æ‰˜åˆ°åŒä¸€ä¸ªç±»çš„å¦ä¸€ä¸ªæž„é€ å™¨æ—¶, ä½¿ç”¨ this å…³é”®å­—å®žçŽ°ã€‚ 12345class Engineer(val name: String = "", age: Int = 0, language: String = "") &#123; constructor(name: String, age: Int) : this(name, age, "en")&#123; log("æ¬¡çº§æž„é€ å™¨") &#125;&#125; åˆ›å»ºå¯¹è±¡æž„é€ å™¨ä¸­çš„å±žæ€§æŒ‡å®šåˆå§‹å€¼åŽåœ¨åˆ›å»ºå¯¹è±¡æ—¶å¯ä»¥çœç•¥ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼Œé¿å…é‡è½½æž„é€ æ–¹æ³•ï¼Œä¸»æž„é€ å™¨ä¸­å…·æœ‰é»˜è®¤å€¼çš„å±žæ€§ä¸æ˜¯å¿…é¡»èµ‹å€¼çš„ã€‚ 123val en = Engineer("",12)val en1 = Engineer(name = "test")val en2 = Engineer(name = "test",age = 12,language = "") ç»§æ‰¿kotlin ä¸­æ‰€æœ‰çš„ç±»é»˜è®¤ç»§æ‰¿è‡ªè¶…ç±» Any,Any ä¸æ˜¯ java.lang.Object; å°¤å…¶è¦æ³¨æ„, é™¤ equals() , hashCode() å’Œ toString() ä¹‹å¤–, å®ƒæ²¡æœ‰ä»»ä½•æˆå‘˜ã€‚ Kotlin ä¸­æ‰€æœ‰çš„ç±»éƒ½æ˜¯ fnial çš„ï¼Œä¹Ÿå°±æ˜¯ä¸å…è®¸ç»§æ‰¿ï¼Œè¿™ç‚¹å’Œ Java æ­£å¥½ç›¸åï¼Œå¦‚æžœä½ æƒ³ç»§æ‰¿ä¸€ä¸ªç±»å¿…é¡»ä½¿ç”¨ open å…³é”®å­—å£°æ˜Žã€‚ Kotlin ä½¿ç”¨ : è¡¨ç¤ºç»§æ‰¿ï¼Œå­ç±»å’Œçˆ¶ç±»æž„é€ å™¨è°ƒç”¨åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µ å¦‚æžœç±»æœ‰ä¸»æž„é€ å™¨, é‚£ä¹ˆå¿…é¡»åœ¨ä¸»æž„é€ å™¨ä¸­ä½¿ç”¨ä¸»æž„é€ å™¨çš„å‚æ•°æ¥åˆå§‹åŒ–åŸºç±»ã€‚ 12345open class Engineer(var name: String = "", var age: Int = 0, var language: String = "") &#123;&#125;class BigEngineer(var level: Int) : Engineer("name",12) &#123;&#125; å¦‚æžœç±»æ²¡æœ‰ä¸»æž„é€ å™¨, é‚£ä¹ˆæ‰€æœ‰çš„æ¬¡çº§æž„é€ å™¨éƒ½å¿…é¡»ä½¿ç”¨ super å…³é”®å­—æ¥åˆå§‹åŒ–åŸºç±», æˆ–è€…å§”æ‰˜åˆ°å¦ä¸€ä¸ªæž„é€ å™¨, ç”±è¢«å§”æ‰˜çš„æž„é€ å™¨æ¥åˆå§‹åŒ–åŸºç±»ã€‚ æ³¨æ„, è¿™ç§æƒ…å†µä¸‹, ä¸åŒçš„æ¬¡çº§æž„é€ å™¨å¯ä»¥è°ƒç”¨åŸºç±»ä¸­ä¸åŒçš„æž„é€ å™¨ã€‚ 12345678910open class Engineer(var name: String = "", var age: Int = 0, var language: String = "") &#123; &#125;class BigEngineer : Engineer &#123; var level = 0 constructor(name:String,age:Int,level:Int):super(name,age,"en")&#123; this.level = level &#125;&#125; æ–¹æ³•çš„è¦†ç›–å’Œç±»ä¸€æ ·ï¼Œç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤æ˜¯ final çš„ï¼Œå³ä¸å…è®¸åœ¨å­ç±»ä¸­è¿›è¡Œé‡å†™ï¼Œå¦‚æžœæƒ³è¦åœ¨å­ç±»ä¸­æ›´æ”¹ï¼Œéœ€è¦ä½¿ç”¨ open æ³¨è§£å£°æ˜Žï¼Œå¦‚å®žä¾‹ä¸­ 3ã€‚ å¦‚æžœå­ç±»æƒ³è¦è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•ï¼Œå¿…é¡»æ·»åŠ  override æ³¨è§£ã€‚ å¦‚æžœé—æ¼äº†è¿™ä¸ªæ³¨è§£ï¼Œç¼–è¯‘å™¨å°†ä¼šæŠ¥å‘Šé”™è¯¯ã€‚ å¦‚æžœä¸€ä¸ªå‡½æ•°æ²¡æœ‰æ ‡æ³¨ open æ³¨è§£ï¼Œ é‚£ä¹ˆåœ¨å­ç±»ä¸­å£°æ˜Žä¸€ä¸ªåŒååŒå‚çš„æ–¹æ³•å°†æ˜¯éžæ³•çš„, æ— è®ºæ˜¯å¦æ·»åŠ  override æ³¨è§£ï¼Œ éƒ½ä¸å¯ä»¥ï¼Œå¦‚å®žä¾‹ä¸­ 4ã€‚ å½“ä¸€ä¸ªå­ç±»æˆå‘˜æ ‡è®°äº† override æ³¨è§£æ¥è¦†ç›–çˆ¶ç±»æˆå‘˜æ—¶ï¼Œ è¦†ç›–åŽçš„å­ç±»æˆå‘˜æœ¬èº«ä¹Ÿå°†æ˜¯ open çš„, ä¹Ÿå°±æ˜¯è¯´ï¼Œ å­ç±»æˆå‘˜å¯ä»¥è¢«è‡ªå·±çš„å­ç±»å†æ¬¡è¦†ç›–ï¼Œå¦‚å®žä¾‹ä¸­ 1ã€‚ å¦‚æžœä½ å¸Œæœ›ç¦æ­¢è¿™ç§å†æ¬¡è¦†ç›–ï¼Œå¯ä»¥ä½¿ç”¨ final æ³¨è§£ï¼Œå¦‚å®žä¾‹ä¸­ 2ã€‚ å®žä¾‹ï¼š 12345678910111213141516171819202122open class Engineer(var name: String = "", var age: Int = 0, var language: String = "") &#123; open fun test() &#123;&#125; open fun test2() &#123;&#125; // æ­¤å‡½æ•°ä¸å…è®¸åœ¨å­ç±»è¦†ç›– fun test3() &#123;&#125;&#125;open class BigEngineer(name: String = "", age: Int = 0, var level: Int = 0) : Engineer(name, age, "en") &#123; // 1. æ­¤å‡½æ•°è¦†ç›–äº†è¶…ç±»ä¸­çš„å‡½æ•°ï¼Œä»–å°†é»˜è®¤æ˜¯opençš„ï¼Œä»–çš„å­ç±»å¯ä»¥è¦†ç›–è¯¥æ–¹æ³•ã€‚ override fun test() &#123;&#125; // 2. æ­¤å‡½æ•°åœ¨å­ç±»ä¸­å°†ä¸ä¼šè¢«è¦†ç›–ï¼Œå› ä¸ºæ˜¾å¼çš„æ·»åŠ äº†finalæ³¨è§£ final override fun test2() &#123;&#125; // 3. è¿™å¥æ˜¯ç¼–è¯‘é”™è¯¯çš„ï¼Œå› ä¸ºtest3()ä¸æ˜¯opençš„ // override fun test3() &#123;&#125; // 4. è¿™å¥æ˜¯ç¼–è¯‘é”™è¯¯çš„ï¼Œè¶…ç±»ä¸­test3()æ˜¯finalçš„ï¼Œåœ¨å­ç±»ä¸­å£°æ˜ŽåŒååŒå‚çš„å‡½æ•°æ˜¯éžæ³•çš„ // fun test3()&#123;&#125;&#125; åœ¨ä¸€ä¸ª final ç±»(æ¯”å¦‚ï¼Œ ä¸€ä¸ªæ²¡æœ‰æ·»åŠ  open æ³¨è§£çš„ç±»)ä¸­ï¼Œ å£°æ˜Ž open æˆå‘˜æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ 123456class Test&#123; // è­¦å‘Šâš ï¸open has no effect in a final classã€‚ // åœ¨ä¸€ä¸ªfinalç±»ä¸­å£°æ˜Žopenæˆå‘˜æ˜¯æ— æ„ä¹‰çš„ï¼Œå› ä¸ºç±»æ— æ³•è¢«ç»§æ‰¿ï¼Œæˆå‘˜å‡½æ•°å’Œå˜é‡ä¹Ÿæ— æ³•è¢«é‡å†™ã€‚ open fun test()&#123;&#125; open val a = 0&#125; å±žæ€§çš„è¦†ç›–å‰æï¼Œå±žæ€§çš„è¦†ç›–æ–¹å¼ä¸Žæ–¹æ³•è¦†ç›–ç±»ä¼¼ï¼ŒåŒæ ·å¿…é¡»åœ¨çˆ¶ç±»ä¸­å£°æ˜Žä¸º openï¼Œå½“è¶…ç±»ä¸­å£°æ˜Žçš„å±žæ€§åœ¨åŽä»£ç±»ä¸­å†æ¬¡å£°æ˜Žæ—¶ï¼Œå¿…é¡»ä½¿ç”¨ override å…³é”®å­—æ¥æ ‡è®°ï¼Œè€Œä¸”è¦†ç›–åŽçš„å±žæ€§æ•°æ®ç±»åž‹å¿…é¡»ä¸Žè¶…ç±»ä¸­çš„å±žæ€§æ•°æ®ç±»åž‹å…¼å®¹ã€‚ å¯ä»¥ä½¿ç”¨å¸¦åˆå§‹åŒ–å™¨çš„å±žæ€§æ¥è¦†ç›–è¶…ç±»å±žæ€§ï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦å–å€¼æ–¹æ³•(getter)çš„å±žæ€§æ¥è¦†ç›–ã€‚ å¯ä»¥åœ¨ä¸»æž„é€ å™¨çš„å±žæ€§å£°æ˜Žä¸­ä½¿ç”¨ override å…³é”®å­—ï¼Œè¦†ç›–ä¸»æž„é€ å™¨ä¸­çš„å±žæ€§ã€‚ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª var å±žæ€§è¦†ç›–ä¸€ä¸ª val å±žæ€§ï¼Œä½†ä¸å¯ä»¥åè¿‡æ¥ä½¿ç”¨ä¸€ä¸ª val å±žæ€§è¦†ç›–ä¸€ä¸ª var å±žæ€§ã€‚ å…è®¸è¿™ç§è¦†ç›–çš„åŽŸå› æ˜¯ï¼Œ val å±žæ€§æœ¬è´¨ä¸Šåªæ˜¯å®šä¹‰äº†ä¸€ä¸ª get æ–¹æ³•ï¼Œä½¿ç”¨ var å±žæ€§æ¥è¦†ç›–å®ƒï¼Œ åªæ˜¯å‘åŽä»£ç±»ä¸­æ·»åŠ äº†ä¸€ä¸ª set æ–¹æ³•ã€‚ 123456789101112131415161718192021222324// nameå±žæ€§æ˜¯opençš„ï¼Œå®ƒå¯ä»¥åœ¨å­ç±»ä¸­è¢«è¦†ç›–open class Engineer(open var name: String = "", var age: Int = 0, var language: String = "") &#123; open val a: Int get() = 100 open val b: Int = 100 open var c:Int = 100&#125;// è¦†ç›–äº†è¶…ç±»ä¸­çš„nameå±žæ€§open class BigEngineer(override var name: String = "", age: Int = 0, var level: Int = 0) : Engineer(name, age, "en") &#123; // å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–å™¨æˆ–getteræ–¹æ³•å¯¹å±žæ€§è¿›è¡Œè¦†ç›–ï¼Œéƒ½æ˜¯å…è®¸çš„ã€‚ override val a: Int = 100 override var b = 0 get() = 1 // è¿™å¥æ˜¯ç¼–è¯‘é”™è¯¯çš„ï¼Œå› ä¸ºvalå˜é‡ä¸èƒ½è¦†ç›–varå˜é‡ // override val c:Int = 1&#125; è¦†ç›–çš„åŽŸåˆ™åœ¨ Kotlin ä¸­ï¼Œ ç±»ç»§æ‰¿ä¸­çš„æ–¹æ³•å®žçŽ°é—®é¢˜, éµå®ˆä»¥ä¸‹è§„åˆ™: å¦‚æžœä¸€ä¸ªç±»ä»Žå®ƒçš„ç›´æŽ¥è¶…ç±»ä¸­ç»§æ‰¿äº†åŒä¸€ä¸ªæˆå‘˜çš„å¤šä¸ªå®žçŽ°ï¼Œé‚£ä¹ˆè¿™ä¸ªå­ç±»å¿…é¡»è¦†ç›–è¿™ä¸ªæˆå‘˜ï¼Œå¹¶æä¾›ä¸€ä¸ªè‡ªå·±çš„å®žçŽ°ï¼Œè¿™æ ·åœ¨å­ç±»ä¸­æ¶ˆé™¤æ­§ä¹‰ï¼Œä¸ºäº†è¡¨ç¤ºä½¿ç”¨çš„æ–¹æ³•æ˜¯ä»Žå“ªä¸ªè¶…ç±»ç»§æ‰¿å¾—åˆ°çš„ï¼Œ æˆ‘ä»¬ä½¿ç”¨ super å…³é”®å­—, å°†è¶…ç±»åç§°æ”¾åœ¨å°–æ‹¬å·ç±», æ¯”å¦‚ super&lt;çˆ¶ç±»&gt;ã€‚ 12345678910111213141516171819202122232425open class ClsA &#123; open val a = 100 open fun test() &#123;&#125;&#125;interface ClsB &#123; val a: Int get() = 200 fun test() &#123;&#125;&#125;class ClsC : ClsA(), ClsB &#123; // å±žæ€§å¿…é¡»è¿›è¡Œåˆå§‹åŒ–ï¼Œå› æ­¤ä¸å­˜åœ¨è¿™æ ·çš„é—®é¢˜ override val a = 300 // æ–¹æ³•çš„è¦†ç›– // æ­¤æ—¶ç¼–è¯‘å™¨å¼ºåˆ¶å¿…é¡»å®žçŽ°test()æ–¹æ³•,å› ä¸ºå¯ä»¥ä»Žè¶…ç±»ä¸­ç»§æ‰¿å¤šä¸ªå®žçŽ° override fun test() &#123; // æ˜Žç¡®çš„è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³• super&lt;ClsA&gt;.test() super&lt;ClsB&gt;.test() &#125;&#125;]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-4-æŽ¥å£]]></title>
    <url>%2Farticle%2F6a146f82%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Kotlin æŽ¥å£ã€‚ å£°æ˜ŽæŽ¥å£ä½¿ç”¨ interface å…³é”®å­—å£°æ˜Žï¼› æŽ¥å£ä¸­å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•çš„å£°æ˜Žï¼Œä¹Ÿå¯ä»¥åŒ…å«æ–¹æ³•çš„å®žçŽ°ã€‚ æŽ¥å£ä¸ŽæŠ½è±¡ç±»çš„åŒºåˆ«åœ¨äºŽï¼Œ æŽ¥å£ä¸èƒ½å­˜å‚¨çŠ¶æ€æ•°æ®ã€‚ æŽ¥å£å¯ä»¥æœ‰å±žæ€§ï¼Œ ä½†è¿™äº›å±žæ€§å¿…é¡»æ˜¯æŠ½è±¡çš„ï¼Œä¸èƒ½ä½¿ç”¨åˆå§‹åŒ–å™¨æ¥åˆå§‹åŒ–ï¼Œæˆ–è€…å¿…é¡»æä¾›è®¿é—®å™¨çš„è‡ªå®šä¹‰å®žçŽ°ã€‚ æŽ¥å£ä¸æ”¯æŒ Backing Fieldï¼Œå› æ­¤ var å˜é‡æ— æ³•å®šä¹‰è®¿é—®å™¨ï¼Œå› æ­¤ var ç±»åž‹çš„å±žæ€§å¿…å®šæ˜¯æŠ½è±¡çš„ã€‚ 123456789101112131415161718192021222324252627interface FirstInterface &#123; // å¯ä»¥å…·æœ‰å±žæ€§ï¼Œä½†æ˜¯å±žæ€§å¿…é¡»æ˜¯æŠ½è±¡çš„ // æˆ–è€…å¿…é¡»æä¾›è®¿é—®å™¨çš„è‡ªå®šä¹‰å®žçŽ° val testVal1: Int var testVar2: Int val testVal3: Int get() = 100 // ç¼–è¯‘é”™è¯¯ï¼ŒæŽ¥å£ä¸æ”¯æŒ backing field // å› æ­¤ var ç±»åž‹çš„å±žæ€§ä¸èƒ½è‡ªå®šä¹‰è®¿é—®å™¨ var testVar4: Int get() = 100 // ç¼–è¯‘é”™è¯¯ï¼Œå±žæ€§å¿…é¡»æ˜¯æŠ½è±¡çš„ // æˆ–è€…å¿…é¡»æä¾›è®¿é—®å™¨çš„è‡ªå®šä¹‰å®žçŽ° val testVal10: Int = 1 var testVar10: Int = 1 // å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•çš„å£°æ˜Ž fun testFun1() // ä¹Ÿå¯ä»¥åŒ…å«æ–¹æ³•çš„å®žçŽ° fun testFun2(param: Int): String &#123; return "test fun 2" &#125;&#125; å®žçŽ°æŽ¥å£12345678910111213141516171819202122232425class SecondInterface:FirstInterface&#123; // ä½¿ç”¨åˆå§‹åŒ–å™¨è¦†ç›–æŽ¥å£æŠ½è±¡å±žæ€§ override val testVal1: Int = 10 // ä½¿ç”¨è‡ªå®šä¹‰è®¿é—®å™¨è¦†ç›–æŽ¥å£æŠ½è±¡å±žæ€§ override var testVar2: Int get() = 100 set(value) &#123;&#125; // è¦†ç›–æŽ¥å£éžæŠ½è±¡å±žæ€§ override val testVal3: Int get() = super.testVal3 // è¦†ç›–æŽ¥å£æŠ½è±¡æ–¹æ³• override fun testFun1() &#123; &#125; // è¦†ç›–æŽ¥å£éžæŠ½è±¡æ–¹æ³• override fun testFun2(param: Int): String &#123; return super.testFun2(param) &#125;&#125; è§£å†³æŽ¥å£è¦†ç›–å†²çªç”±äºŽæŽ¥å£æ˜¯å¯ä»¥å¤šç»§æ‰¿çš„ï¼Œå¦‚æžœå®žçŽ°å¤šä¸ªæŽ¥å£ï¼ŒåŒæ—¶æŽ¥å£ä¸­æœ‰ç›¸åŒæ–¹æ³•çš„å£°æ˜Žï¼Œå°±ä¼šå‡ºçŽ°è¦†ç›–å†²çªï¼Œä½¿ç”¨å®˜ç½‘çš„ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜Žä¸€ä¸‹è¦†ç›–å†²çªçš„è§£å†³ã€‚å•ç»§æ‰¿æ—¶è‡ªç„¶è¦å®žçŽ°æŽ¥å£ä¸­æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œå½“å®žçŽ°å¤šä¸ªæŽ¥å£æ—¶ï¼Œå¦‚æžœå®žçŽ°çš„æŽ¥å£ä¸­å…·æœ‰åŒåçš„æŠ½è±¡æ–¹æ³•ï¼Œå³ä½¿åœ¨æŽ¥å£ä¸­å¯¹è¯¥æ–¹æ³•éƒ½å·²ç»æœ‰äº†å®žçŽ°ï¼Œé‚£ä¹ˆåœ¨å­ç±»ä¸­ä¹Ÿå¿…é¡»å®žçŽ°è¯¥æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨super&lt;æŽ¥å£åç§°&gt;.æ–¹æ³•åï¼Œå¦‚ä¸‹é¢çš„ super&lt;A&gt;.bar() æ¥åœ¨å­ç±»ä¸­æ˜¾å¼çš„å£°æ˜Žåˆ°åº•æ˜¯ç»§æ‰¿å“ªä¸€ä¸ªå®žçŽ°ã€‚ 123456789101112131415161718192021222324252627interface A &#123; fun foo() &#123; print("A") &#125; fun bar()&#125;interface B &#123; fun foo() &#123; print("B") &#125; fun bar() &#123; print("bar") &#125;&#125;class C : A &#123; override fun bar() &#123; print("bar") &#125;&#125;class D : A, B &#123; // é‡åå‡½æ•°å¿…é¡»å®žçŽ°ï¼Œå³ä½¿ç»§æ‰¿çš„æŽ¥å£ä¸­å·²ç»æœ‰äº†å…·ä½“å®žçŽ° override fun foo() &#123; super&lt;A&gt;.foo() super&lt;B&gt;.foo() &#125; override fun bar() &#123; super&lt;B&gt;.bar() // ç”±äºŽ A ä¸­å¯¹ bar æ²¡æœ‰å®žçŽ°ï¼Œå¯ä»¥å¦‚ä¸‹ç®€å†™ // super.bar() &#125;&#125;]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-3-å±žæ€§ä¸ŽåŸŸ]]></title>
    <url>%2Farticle%2F12ba0671%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Kotlin å±žæ€§å’ŒåŸŸçš„ç›¸å…³å†…å®¹ã€‚ Kotlin ä¸­ï¼Œä½¿ç”¨ val å£°æ˜Žå¸¸é‡(ä¸å¯å˜)ï¼Œä½¿ç”¨ var å£°æ˜Žå˜é‡(å¯å˜)ã€‚ 12345public val a = 100 // å¸¸é‡ï¼Œä¸å¯å˜ï¼Œå½“ä½ å†æƒ³æ”¹å˜ä»–çš„å€¼æ—¶ä¼šæŠ¥é”™private var b = 1000 // å˜é‡ï¼Œå¯å˜b = -100val c:Int? = null å±žæ€§çš„å£°æ˜Žå£°æ˜Žå±žæ€§çš„å®Œæ•´è¯­æ³•å¦‚ä¸‹ï¼Œå…¶ä¸­çš„åˆå§‹åŒ–å™¨(initializer)ï¼Œ å–å€¼æ–¹æ³•(getter)ï¼Œ ä»¥åŠè®¾å€¼æ–¹æ³•(setter)éƒ½æ˜¯å¯é€‰çš„ã€‚Kotlin å…·æœ‰ç±»åž‹è‡ªåŠ¨æŽ¨æ–­å¾—ç‰¹æ€§ï¼Œå¦‚æžœå±žæ€§ç±»åž‹å¯ä»¥é€šè¿‡åˆå§‹åŒ–å™¨è‡ªåŠ¨æŽ¨æ–­å¾—åˆ°ï¼Œ æˆ–è€…å¯ä»¥é€šè¿‡è¿™ä¸ªå±žæ€§è¦†ç›–çš„åŸºç±»æˆå‘˜å±žæ€§æŽ¨æ–­å¾—åˆ°ï¼Œ åˆ™å±žæ€§ç±»åž‹çš„å£°æ˜Žä¹Ÿå¯ä»¥çœç•¥ã€‚ æ ‡å‡†çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œéœ€è¦æ¸…æ¥šå…¶ä¸­å‡ ä¸ªæ¦‚å¿µ propertyName ï¼šå˜é‡å PropertyType ï¼šå˜é‡ç±»åž‹ï¼Œå¦‚æžœå¯ä»¥æŽ¨æ–­å¾—åˆ°ï¼Œå¯ä»¥çœç•¥ property_initializer ï¼šåˆå§‹åŒ–å™¨ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªå›ºå®šå€¼æˆ–ä¸€ä¸ªè¡¨è¾¾å¼ getter ï¼šå–å€¼æ–¹æ³•ï¼Œè®¿é—®å™¨çš„ä¸€ç§ setter ï¼šè®¾å€¼æ–¹æ³•ï¼Œè®¿é—®å™¨çš„ä¸€ç§ 123var &lt;propertyName&gt;: &lt;PropertyType&gt; [= &lt;property_initializer&gt;] [&lt;getter&gt;] [&lt;setter&gt;] æ³¨æ„ï¼Œå¦‚ä¸‹æ³¨é‡Š 1 å¤„ï¼Œå¯¹äºŽ var å˜é‡æ¥è¯´ï¼Œåˆå§‹åŒ–å™¨ï¼Œè®¾å€¼ï¼Œå–å€¼æ–¹æ³•éƒ½æ˜¯å…è®¸åŒæ—¶å­˜åœ¨çš„ï¼›å¦‚ä¸‹æ³¨é‡Š 2 å¤„ï¼Œå¯¹äºŽ val å˜é‡æ¥è¯´ï¼Œä¸å…è®¸æœ‰è®¾å€¼æ–¹æ³•ï¼ŒåŒæ—¶ getter æ–¹æ³•å’Œ åˆå§‹åŒ–å™¨ ä¸å…è®¸åŒæ—¶æŒ‡å®šï¼Œå› ä¸ºåªè¯»å˜é‡åªå…è®¸åˆå§‹åŒ–ä¸€æ¬¡ã€‚ ä½¿ç”¨ æ³¨è§£ å’Œ å¯è§åº¦ä¿®é¥°ç¬¦ï¼Œå¦‚ä¸‹æ³¨é‡Š 3 å¤„ï¼Œï¼Œå¦‚æžœä¸æƒ³åœ¨å¤–ç•Œè®¿é—®å±žæ€§çš„ setï¼get æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨å¯è§åº¦ä¿®é¥°ç¬¦æ¥é¿å…å¤–éƒ¨è®¿é—®ã€‚åŒæ ·ä¹Ÿå¯ä»¥åœ¨ setï¼get æ–¹æ³•å‰ä½¿ç”¨æ³¨è§£ã€‚ 1234567891011121314151617181920212223242526open class ClsA &#123; // 1 var x: Int = 100 get() = 100 set(value) &#123; field = value &#125; // 2. ä¸å…è®¸æœ‰è®¾å€¼æ–¹æ³•ï¼ŒåŒæ—¶getæ–¹æ³•å’Œåˆå§‹åŒ–å™¨ä¸å…è®¸åŒæ—¶æŒ‡å®šï¼Œå› ä¸ºåªè¯»å˜é‡åªå…è®¸åˆå§‹åŒ–ä¸€æ¬¡ val y: Int get() = 100 // è¿™æ˜¯ä¸å…è®¸çš„ï¼Œå› ä¸ºvalåªè¯»çš„ // set(value) &#123; // field = value // &#125; // 3. åœ¨set/getæ–¹æ³•å‰ä½¿ç”¨å¯è§åº¦ä¿®é¥°ç¬¦å’Œæ³¨è§£ var z: Int = 100 @Inject get private set&#125;eg:val param:ClsA = ClsA()// ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºä¸å…è®¸è®¿é—®zçš„è®¾å€¼æ–¹æ³•param.z = 100 Backing FieldsKotlin æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨å±žæ€§åç§°å¯¹ç±»çš„å±žæ€§è¿›è¡Œè®¿é—®ï¼Œä½†æ˜¯å®žé™…ä¸Šæˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æŽ¥è®¿é—®è¯¥å±žæ€§çš„å¼•ç”¨ï¼Œè€Œæ˜¯åœ¨ç¼–è¯‘æ—¶è¢«è½¬æ¢æˆäº† getter/setter æ–¹æ³•æ¥è¿›è¡Œè®¿é—®ï¼Œå¦‚æ³¨é‡Šä¸­ 1 å¤„ä»£ç ï¼Œè¿™æ ·æˆ‘ä»¬æ—¢å¯ä»¥ç®€åŒ–ä»£ç ï¼Œåˆä¿æŒäº†ç±»çš„å°é—­æ€§ã€‚ Kotlin çš„ç±»ä¸­ä¸å…è®¸æ‹¥æœ‰åŸŸ(Field)ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ åœ¨ç±»å†…éƒ¨ä¹Ÿæ— æ³•ç›´æŽ¥ä½¿ç”¨å±žæ€§çš„åç§°å¯¹å±žæ€§è¿›è¡Œè®¿é—®ï¼Œè€Œæ˜¯éƒ½ä¼šè½¬æ¢ä¸º getter/getter æ–¹æ³•ã€‚å› æ­¤å½“ä½ åœ¨ set æ–¹æ³•ä¸­è°ƒç”¨è¯¥å±žæ€§ä¸ºä»–èµ‹å€¼æ—¶åˆä¼šè°ƒç”¨ set æ–¹æ³•ï¼Œå¯¼è‡´ å †æ ˆæº¢å‡ºï¼Œå¦‚å®žä¾‹ä¸­ 2ï¼Œè¿™æ˜¯æˆ‘åœ¨å¼€å§‹å†™çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜ã€‚ 12345678910// 1 ä¼ªä»£ç ClsA().x = 100 ç›¸å½“äºŽ ClsA().setX(100)val a = ClsA.x ç›¸å½“äºŽ val a = ClsA().getX()// 2var xx: Int = 100 set(value) &#123; // å†æ¬¡è°ƒç”¨ set æ–¹æ³• xx = value + 1 &#125; ä½†æ˜¯è‡ªå®šä¹‰å±žæ€§çš„è®¿é—®å™¨æ—¶ä¸å¯é¿å…çš„è¦ä½¿ç”¨ åŸŸå˜é‡ï¼Œå› æ­¤ Kotlin æä¾›äº† Backing Fields çš„ç‰¹æ€§ï¼Œä½¿ç”¨å…³é”®å­— field è¡¨ç¤ºï¼Œfield æ ‡è¯†ç¬¦åªå…è®¸åœ¨å±žæ€§çš„è®¿é—®å™¨å‡½æ•°å†…ä½¿ç”¨ï¼Œå¦‚ä¸‹ä»£ç ä¸­ï¼Œä½¿ç”¨ field å³å¯çœŸå®žçš„è®¿é—®(ä¸ç»è¿‡getter/setter) å˜é‡ xxï¼Œå®Œæˆèµ‹å€¼æ“ä½œã€‚ 12345var xx: Int = 100 get() = field++ set(value) &#123; field = value - 1 &#125; Backing Propertyæœ‰æ—¶éšå«çš„åŽç«¯åŸŸå±žæ€§ä¸è¶³ä»¥è§£å†³æŸäº›æƒ…å†µçš„é—®é¢˜ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ Backing Propertyã€‚å¦‚ä¸‹å®žä¾‹ä¸­ï¼ŒBacking Property å°±æ˜¯å¦å¤–å®šä¹‰ä¸€ä¸ªå±žæ€§ _yy ç”¨æ¥å­˜å‚¨æ•°æ®ï¼Œè€Œå¤–ç•Œè®¿é—®çš„å±žæ€§ yy åªæ˜¯æä¾›äº†ä¸€ä¸ªè®¿é—®å™¨æ–¹æ³•è€Œå·²ï¼Œæœ¬èº«å·²ç»ä¸å…·å¤‡ä»€ä¹ˆæ„ä¹‰å•¦ï¼Œå°†è®¿é—®å™¨çš„å£°æ˜Žå’Œæ•°æ®çš„å­˜å‚¨æ”¾åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼Œå°±ä¸ä¼šå‘ç”Ÿä¹‹å‰çš„å†²çªï¼ˆæˆ‘çš„ç†è§£ðŸ˜Šï¼‰ 12345678910111213141516private var _yy: String? = nullvar yy: String get() &#123; if (_yy == null) &#123; _yy = "init str" &#125; return _yy ?: "be changed" &#125; set(value) &#123; _yy = "this is $value" &#125; // è®¿é—®yyval param: ClsA = ClsA()param.yy ç¼–è¯‘æœŸå¸¸æ•°å¦‚æžœå±žæ€§å€¼åœ¨ç¼–è¯‘æœŸé—´å°±èƒ½ç¡®å®š, åˆ™å¯ä»¥ä½¿ç”¨ const ä¿®é¥°ç¬¦, å°†å±žæ€§æ ‡è®°ä¸º ç¼–è¯‘æœŸå¸¸æ•°å€¼(compile time constants)ã€‚ è¿™ç±»å±žæ€§å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶: å¿…é¡»æ˜¯é¡¶çº§å±žæ€§ï¼Œ æˆ–è€…æ˜¯ä¸€ä¸ª object çš„æˆå‘˜ã€‚ å€¼è¢«åˆå§‹åŒ–ä¸º String ç±»åž‹, æˆ–åŸºæœ¬ç±»åž‹(primitive type)ã€‚ ä¸å­˜åœ¨è‡ªå®šä¹‰çš„å–å€¼æ–¹æ³•ã€‚ 1234567// é¡¶çº§å±žæ€§const val TEST_CONST = "TEST_CONST"// å£°æ˜Žåœ¨ object ä¸­object Const&#123; const val TEST_CONST_IN_OBJ = "TEST_CONST_IN_OBJ"&#125; å±žæ€§åˆå§‹åŒ– - å»¶è¿Ÿ(lateinit)lateinit å…³é”®å­—è¡¨ç¤ºå½“å‰ å˜é‡ ä¸ä¼šåœ¨å£°æ˜Žæ—¶è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œåˆå§‹åŒ–æ“ä½œä¼šåœ¨åŽé¢è¿›è¡Œï¼Œåƒæ˜¯ä¸€ç§åè®®æœºåˆ¶ï¼Œå‘ŠçŸ¥ç¼–è¯‘å™¨æˆ‘ä¼šåœ¨åŽé¢ä½¿ç”¨è¯¥å˜é‡ä¹‹å‰çš„æ°å½“æ—¶æœºåˆå§‹åŒ–è¯¥å˜é‡ï¼Œä¸è¦è¿›è¡Œè­¦å‘Šâš ï¸ã€‚åœ¨ä¸€ä¸ª lateinit å±žæ€§è¢«åˆå§‹åŒ–ä¹‹å‰è®¿é—®å®ƒï¼Œ ä¼šæŠ›å‡ºä¸€ä¸ªç‰¹åˆ«çš„å¼‚å¸¸ï¼Œè¿™ä¸ªå¼‚å¸¸å°†ä¼šæŒ‡æ˜Žè¢«è®¿é—®çš„å±žæ€§ï¼Œä»¥åŠå®ƒæ²¡æœ‰è¢«åˆå§‹åŒ–è¿™ä¸€é”™è¯¯ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨ lateinit å…³é”®å­—æœ‰å¾ˆå¤šé™åˆ¶: å¿…é¡»æ˜¯å˜é‡ï¼Œå³ä½¿ç”¨ var å…³é”®å­—è¿›è¡Œå£°æ˜Žã€‚ ä¸èƒ½ä¿®é¥°å¯ä¸º null çš„ç±»åž‹ï¼Œæ¯”å¦‚ lateinit var str:String? æ˜¯ç¼–è¯‘ä¸é€šè¿‡çš„ã€‚ ä¸èƒ½ä¿®é¥°åŸºæœ¬æ•°æ®ç±»åž‹ã€‚ä¾‹å¦‚ Int,Floatç­‰ 123lateinit var stuLateInit:StudentstuLateInit = Student("name",11) å±žæ€§å»¶è¿Ÿåˆå§‹åŒ– - ä»£ç†(by lazy)by lazy æ˜¯å±žæ€§ä»£ç†çš„åŸºæœ¬è¿ç”¨ï¼Œæ˜¯ç»è¿‡ç®€åŒ–åŽçš„å±žæ€§ä»£ç†ï¼Œä»–ä¸ºå±žæ€§æä¾›åˆå§‹åŒ–æ–¹æ³•ã€‚è¿™é‡Œä¸æ‰©å±•å±žæ€§ä»£ç†çš„ç›¸å…³é—®é¢˜ã€‚ å› ä¸ºä»–åªæä¾›å–å€¼æ–¹æ³•æ‰€ä»¥ä»…å¯ä»¥ç”¨åœ¨å¸¸é‡çš„åˆå§‹åŒ–ä¸­ï¼Œä½¿ç”¨ by lazy å½“å±žæ€§è¢«ç¬¬ä¸€æ¬¡è®¿é—®æ—¶ï¼Œå°±ä¼šè§¦å‘åˆå§‹åŒ–æµç¨‹ã€‚ åªæœ‰å¸¸é‡ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ valæ‰èƒ½ä½¿ç”¨ by lazy å»¶è¿Ÿåˆå§‹åŒ– 1234567891011val stuByLazy:Student by lazy &#123; Student("name",11)&#125;val mMyMsgTv:TextView by lazy &#123; findViewById(R.id.mTestTv) as TextView&#125;// å½“å¸¸é‡è¢«ä½¿ç”¨æ—¶æ‰è¿›è¡Œåˆå§‹åŒ–logError(stuByLazy.myCls)mMyMsgTv.text="æ–‡æœ¬"]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-2-åŸºç¡€]]></title>
    <url>%2Farticle%2F811551029%2F</url>
    <content type="text"><![CDATA[æœ¬ç¯‡ä¸»è¦ä»‹ç» Kotlin çš„åŸºç¡€è¯­æ³•ï¼ŒæŽ§åˆ¶æµï¼Œå†…å»ºæ•°æ®ç±»åž‹ç­‰å†…å®¹â€¦ import è¯­å¥å’ŒåŒ…çš„ç›¸å…³æ¦‚å¿µã€‚ å¯è§åº¦ä¿®é¥°ç¬¦çš„ä½¿ç”¨ã€‚ å¤§éƒ¨åˆ†å†…å»ºæ•°æ®ç±»åž‹çš„ä»‹ç»ã€‚åŒ…æ‹¬æ•°å€¼ç±»åž‹ï¼Œå­—ç¬¦ç±»åž‹ï¼Œå¸ƒå°”ç±»åž‹ï¼Œæ•°ç»„ç±»åž‹ï¼Œå­—ç¬¦ä¸²ç±»åž‹ã€‚ æŽ§åˆ¶æµçš„ä½¿ç”¨ï¼Œif , when , for , while ç­‰å…³é”®å­—åœ¨ Kotlin ä¸­çš„æ–°ç‰¹æ€§ã€‚ å¦‚ä½•åœ¨å‡½æ•°ä¸­è¿”å›žå’Œè·³è½¬ï¼Œreturn , continue , break ç­‰å…³é”®å­—çš„ä½¿ç”¨ã€‚ go~ åŒ…123456// å¯¼åŒ…import com.march.ktexample.model.Student// å¯¼åŒ…æ—¶ä½¿ç”¨åˆ«åï¼Œç„¶åŽå°±å¯ä»¥ä½¿ç”¨åˆ«åè°ƒç”¨import android.util.Log as LL.e(TAG, str) å¯è§åº¦ä¿®é¥°ç¬¦ç±»ï¼Œå¯¹è±¡ï¼ŒæŽ¥å£ï¼Œæž„é€ å™¨ï¼Œå‡½æ•°ï¼Œå±žæ€§ä»¥åŠå±žæ€§è®¿é—®å™¨è®¾å€¼æ–¹æ³•(è®¿é—®å™¨å–å€¼æ–¹æ³•æ€»ä¸Žå±žæ€§æœ¬èº«å¯è§åº¦ç›¸åŒï¼Œå› æ­¤ä¸éœ€è¦æŽ§åˆ¶å…¶å¯è§åº¦)ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ å¯è§åº¦ä¿®é¥°ç¬¦ ã€‚Kotlin ä¸­çš„å››ç§å¯è§åº¦ä¿®é¥°ç¬¦ï¼šprivateã€protectedã€internalã€publicï¼Œé»˜è®¤ä¸º publicã€‚ä¸Ž Java ä¸åŒçš„æ˜¯å°‘äº† default å¤šäº† internalã€‚ æ³¨æ„ï¼šå±€éƒ¨å˜é‡ï¼Œ å±€éƒ¨å‡½æ•°ï¼Œä»¥åŠå±€éƒ¨ç±»ï¼Œéƒ½ä¸èƒ½æŒ‡å®šå¯è§åº¦ä¿®é¥°ç¬¦ã€‚ top-leveltop-levelï¼Œ åƒ class è¿™ç§å¯ä»¥ç›´æŽ¥å£°æ˜Žåœ¨åŒ…ä¸‹ã€‚åœ¨ Kotlin ä¸­ï¼Œå‡½æ•°, å±žæ€§, ç±», å¯¹è±¡, æŽ¥å£éƒ½å¯ä»¥å£°æ˜Žä¸º top-levelã€‚æ¯”å¦‚æ‰©å±•å‡½æ•°å’Œæ‰©å±•å±žæ€§å°±æ˜¯ å£°æ˜Žä¸º top-level çš„ã€‚æ³¨æ„ï¼Œè¿™é‡Œè¯´çš„æ˜¯ top-level çº§åˆ«å£°æ˜Žï¼Œåœ¨è¿™äº›å£°æ˜Žå†…éƒ¨å†å£°æ˜Žåˆ«çš„å‡½æ•°æˆ–è€…å±žæ€§ï¼Œä¸åœ¨è®¨è®ºèŒƒç•´ï¼Œå°†åœ¨ä¸‹ä¸€éƒ¨åˆ†è¯´æ˜Žï¼Œå¯¹äºŽ top-level ä¸­çš„å£°æ˜Žæ¥è¯´ï¼š public ï¼šæ„ä¸ºè¯¥å£°æ˜Žåœ¨ä»»ä½•ä½ç½®éƒ½å¯ä»¥è®¿é—®ï¼Œpublic æ˜¯é»˜è®¤çš„ï¼Œå¯ä»¥çœç•¥ã€‚If you do not specify any visibility modifier, public is used by default, which means that your declarations will be visible everywhere; private ï¼šæ„ä¸ºè¯¥å£°æ˜Žåªèƒ½åœ¨åŒä¸€ä¸ªæºä»£ç æ–‡ä»¶ä¸­è®¿é—®ã€‚If you mark a declaration private, it will only be visible inside the file containing the declaration; internal ï¼šæ„ä¸ºè¯¥å£°æ˜Žåœ¨åŒä¸€ä¸ªmoduleçš„ä»»æ„ä½ç½®æ˜¯å¯ä»¥è®¿é—®çš„ã€‚If you mark it internal, it is visible everywhere in the same module; protected ï¼šå¯¹ top-level çš„å£°æ˜Žæ˜¯æ— æ•ˆçš„ã€‚protected is not available for top-level declarations. 1234567891011121314151617package com.march.ktexample// filename:VisibilityModifiersTest.kt// ç±»å£°æ˜Žclass MyCls // æŽ¥å£å£°æ˜Žï¼ŒåŒ module è®¿é—®internal interface MyInter // å‡½æ•°å£°æ˜Žï¼Œåªå…è®¸åœ¨æ–‡ä»¶å†…è®¿é—®private fun MyFun()&#123;&#125; // å±žæ€§å£°æ˜Žï¼Œæ‰€æœ‰åœ°æ–¹éƒ½å¯ä»¥è®¿é—®ï¼Œé»˜è®¤ public å¯ä»¥çœç•¥public var MyVal = 10 // è®¾ç½®æ–¹æ³•åªæœ‰æ–‡ä»¶å†…å¯ä»¥è®¿é—® private set ç±»ä¸ŽæŽ¥å£åœ¨ç±»å’ŒæŽ¥å£å†…éƒ¨ä½¿ç”¨å¯è§åº¦ä¿®é¥°ç¬¦ private ï¼šåœ¨ç±»å†…(ä»¥åŠå®ƒçš„æ‰€æœ‰æˆå‘˜ä¹‹é—´)å¯ä»¥è®¿é—®ã€‚private means visible inside this class only (including all its members); protected ï¼šå’Œ private ç›¸åŒï¼Œè€Œä¸”åœ¨å­ç±»ä¸­ä¹Ÿå¯ä»¥è®¿é—®ã€‚protected â€” same as private + visible in subclasses too; internal ï¼šåœ¨åŒä¸€ä¸ª module å†…ï¼Œèƒ½è®¿é—®è¯¥ç±»çš„åœ°æ–¹ï¼Œä¹Ÿèƒ½è®¿é—®è¯¥ç±»çš„ internal æˆå‘˜ã€‚any client inside this module who sees the declaring class sees its internal members; public ï¼šåœ¨ä»»ä½•ä½ç½®å‡¡æ˜¯èƒ½è®¿é—®è¯¥ç±»ï¼Œåˆ™ä¹Ÿèƒ½è®¿é—®è¯¥ç±»çš„ public æˆå‘˜ã€‚any client who sees the declaring class sees its public members. æ³¨æ„ï¼š åœ¨ Kotlin ä¸­ï¼Œå¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å…¶å†…éƒ¨ç±»çš„ private æˆå‘˜ã€‚å¦‚æžœä½ è¦†ç›–ä¸€ä¸ª protected æˆå‘˜ï¼Œå¹¶ä¸”æ²¡æœ‰æ˜Žç¡®æŒ‡å®šå¯è§åº¦ï¼Œé‚£ä¹ˆè¦†ç›–åŽæˆå‘˜çš„å¯è§åº¦ä¹Ÿå°†æ˜¯ protectedã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475open class OuterCls &#123; // ç±»å†…å¯è®¿é—® private var a = 1 // ç±»å†…å¯è®¿é—®ï¼Œå­ç±»å¯è®¿é—® protected open val b = 2 // æ¨¡å—å†…å¯ä»¥è®¿é—®è¯¥ç±»çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥è®¿é—®è¯¥å±žæ€§ internal val c = 3 // é»˜è®¤ä¸º public,ä»»ä½•ä½ç½®ï¼Œå¯ä»¥è®¿é—®è¯¥ç±»çš„åœ°æ–¹éƒ½å¯ä»¥è®¿é—®è¯¥å±žæ€§ var d = 4 fun test() &#123; a = 1 // å¤–éƒ¨ç±»è®¿é—®åµŒå¥—ç±»pubicæˆå‘˜ NestedCls().publicVar // ç¼–è¯‘é”™è¯¯ï¼Œå¤–éƒ¨ç±»ä¸èƒ½è®¿é—®åµŒå¥—ç±» private æˆå‘˜ NestedCls().privateVar // ç¼–è¯‘é”™è¯¯ï¼Œå¤–éƒ¨ç±»ä¸èƒ½è®¿é—®åµŒå¥—ç±» protected æˆå‘˜ NestedCls().protectedVar // å¤–éƒ¨ç±»è®¿é—®å†…éƒ¨å§ç±»publicæˆå‘˜ InnerCls().publicVar // ç¼–è¯‘é”™è¯¯ï¼Œå¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å†…éƒ¨ç±» protected æˆå‘˜ InnerCls().privateVar // ç¼–è¯‘é”™è¯¯ï¼Œå¤–éƒ¨ç±»ä¸èƒ½è®¿é—®å†…ç±» protected æˆå‘˜ InnerCls().protectedVar &#125; // åµŒå¥—ç±» private class NestedCls &#123; public var publicVar: Int = 5 private var privateVar: Int = 5 protected var protectedVar: Int = 5 // åµŒå¥—ç±»ï¼Œä¸èƒ½è®¿é—®å¤–éƒ¨ç±»æˆå‘˜ï¼Œä¸è®º private public fun test() &#123; // ç¼–è¯‘é”™è¯¯ a = 1 // ç¼–è¯‘é”™è¯¯ d = 10 &#125; &#125; inner class InnerCls &#123; public var publicVar: Int = 5 private var privateVar: Int = 5 protected var protectedVar: Int = 5 // å†…éƒ¨ç±»ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç±»æˆå‘˜ï¼Œä¸è®º private public fun test() &#123; a = 1 d = 10 &#125; &#125;&#125;class Subclass : OuterCls() &#123; // a ä¸å¯è®¿é—® // b, c å’Œ d å¯ä»¥è®¿é—® // Nested å’Œ e å¯ä»¥è®¿é—® // è¦†ç›–äº†çˆ¶ç±»ä¸­çš„ bï¼Œbå¯è§åº¦ä»ç„¶ä¸º protectedï¼Œå¯ä»¥è¢«å­ç±»è¦†ç›– override val b = 5 fun testSub()&#123; // ç¼–è¯‘é”™è¯¯ï¼Œå­ç±»ä¸å¯ä»¥è®¿é—® NestedCls å› ä¸ºä»–æ˜¯ private çš„ NestedCls().publicVar // å¯ä»¥è®¿é—® InnerClsï¼Œä»–æ˜¯ public çš„ InnerCls().publicVar &#125;&#125;class Unrelated(o: OuterCls) &#123; // o.a, o.b ä¸å¯è®¿é—® // o.c å’Œ o.d å¯ä»¥è®¿é—®(å±žäºŽåŒä¸€æ¨¡å—) // Outer.Nested ä¸å¯è®¿é—®, Nested::e ä¹Ÿä¸å¯è®¿é—®&#125; æž„é€ å™¨æ³¨æ„ï¼ŒæŒ‡å®šç±»æž„é€ å™¨å¯è§åº¦ï¼Œä½ éœ€è¦æ˜Žç¡®æ·»åŠ ä¸€ä¸ª constructor å…³é”®å­—ã€‚ private ï¼šè¡¨ç¤ºæž„é€ å™¨åªåœ¨ç±»å†…å¯ä»¥è®¿é—®ã€‚ protected ï¼šç±»æž„é€ å™¨å¯è§åº¦ä¸æ”¯æŒ protectedã€‚ internal ï¼šè¡¨ç¤ºåŒæ¨¡å—å†…å¯ä»¥è®¿é—®è¯¥æž„é€ å™¨ã€‚ public ï¼šåœ¨ä»»ä½•ä½ç½®éƒ½å¯è®¿é—®ï¼Œæž„é€ å™¨é»˜è®¤ publicã€‚ 1234567891011121314class MyCls1 private constructor()&#123; fun test()&#123; // ç±»å†…å¯ä»¥è®¿é—® MyCls1() &#125;&#125;class MyCls2 public constructor()class MyCls3 internal constructor()class MyCls4 internal constructor()&#123; fun test()&#123; // ç¼–è¯‘é”™è¯¯ï¼Œprivate çš„æž„é€ å™¨åŒæ–‡ä»¶å†…ä¸èƒ½è®¿é—® MyCls1() &#125;&#125; å†…å»ºæ•°æ®ç±»åž‹ä»‹ç» Kotlin çš„å†…å»ºæ•°æ®ç±»åž‹ï¼ŒåŒ…æ‹¬æ•°å€¼ç±»åž‹ï¼Œå­—ç¬¦ç±»åž‹ï¼Œå¸ƒå°”ç±»åž‹ï¼Œæ•°ç»„ç±»åž‹ï¼Œå­—ç¬¦ä¸²ç±»åž‹ã€‚ æ•°å€¼ç±»åž‹Kotlin æ•°å€¼ä½¿ç”¨å†…å»ºå¯¹è±¡è¡¨ç¤ºï¼Œæ‰€æœ‰æ•°å€¼ç±»åž‹ç»§æ‰¿è‡ª Number æŠ½è±¡ç±»ï¼ŒNumber ä¸­å®šä¹‰äº†æ•°å€¼åœ¨å„ä¸ªç±»åž‹ä¹‹é—´è½¬æ¢çš„æ–¹æ³•ã€‚ Long ç±»åž‹éœ€è¦åœ¨æ•°å­—æœ«å°¾è¿½åŠ  å¤§å†™ çš„ L è¡¨ç¤ºï¼Œå¦‚ 123Lï¼›Float ç±»åž‹éœ€è¦åœ¨æ•°å­—æœ«å°¾è¿½åŠ  fï¼F è¡¨ç¤ºï¼Œå¦‚ 123.5Fã€‚é»˜è®¤åè¿›åˆ¶è®¡æ•°ï¼Œå¦‚ï¼š 123ï¼›åå…­è¿›åˆ¶ä»¥ 0x å¼€å¤´ï¼Œå¦‚ 0x1FAï¼›äºŒè¿›åˆ¶ä»¥ 0b å¼€å¤´ï¼Œå¦‚ 0b001101ï¼›ä¸æ”¯æŒ å…«è¿›åˆ¶è¡¨ç¤ºã€‚ Double (64 bit) ï¼›Float (32 bit) ï¼›Long (64 bit) ï¼›Int (32 bit) ï¼›Short (16 bit) ï¼›Byte (8 bit) ï¼› åŒä¸€æ€§ï¼šå¯¹è±¡çš„ç±»åž‹ï¼Œå†…å®¹ç›¸åŒï¼Œä½¿ç”¨ === è¿ç®—ç¬¦æ¯”è¾ƒä¸º true ç›¸ç­‰æ€§ï¼šå†…å®¹ç›¸ç­‰ï¼Œä½¿ç”¨ == è¿ç®—æ³•æ¯”è¾ƒä¸º true æ•°å€¼è£…ç®± Kotlin ä¸­ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ï¼Œå› æ­¤å†…å»ºçš„æ•°å€¼ç±»åž‹ä¹Ÿä¸ºå¯¹è±¡ï¼Œä½†æ˜¯ä»–ä»¬å…·æœ‰å¦‚åŒåŸºæœ¬æ•°æ®ç±»åž‹çš„ç‰¹æ€§ï¼Œå³ åŒä¸€æ€§ï¼Œæ•°å€¼å†…å»ºå¯¹è±¡å°±å¦‚åŒ Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œä»–ä»¬çš„å€¼æ˜¯ä¸èƒ½ä¸º null çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨åƒ Int? è¿™æ ·æ¥è¿›è¡Œæ•°å€¼è£…ç®±ï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒ Java ä¸­æ•°å€¼è£…ç®±çš„æ¦‚å¿µã€‚è£…ç®±ä¹‹åŽçš„æ•°å€¼ä¼šä¿æŒ ç›¸ç­‰æ€§ ä½†æ— æ³•ä¿æŒ åŒä¸€æ€§ 12345678910111213141516// å†…å»ºå¯¹è±¡çš„åŒä¸€æ€§val aInt = 10val bInt = 10logError("$&#123;aInt === bInt&#125;")// truelogError("$&#123;aInt == bInt&#125;")// true// æ•°å€¼è£…ç®±åŽä¿æŒç›¸ç­‰æ€§ï¼Œä½†æ˜¯ä¸ä¿æŒåŒä¸€æ€§val aOrigin:Int = 10000val aBoxInt: Int? = aOriginval bBoxInt: Int? = aOriginlogError("$&#123;aBoxInt === bBoxInt&#125;")// falselogError("$&#123;aBoxInt == bBoxInt&#125;")// trueå›°æƒ‘ï¼šå½“aOrigin = 10æ—¶ï¼ŒaBoxInt === bBoxInt ä¸º trueï¼Œå½“aOrigin = 10000æ—¶ï¼ŒaBoxInt === bBoxInt ä¸º false ç±»åž‹è½¬æ¢ Kotlin ä¸ä¼šå°†è¾ƒå°çš„æ•°æ®ç±»åž‹éšå¼åœ°è½¬æ¢ä¸ºè¾ƒå¤§çš„æ•°æ®ç±»åž‹. ä¹Ÿå°±æ˜¯è¯´, å¦‚æžœä¸è¿›è¡Œæ˜¾å¼ç±»åž‹è½¬æ¢, æˆ‘ä»¬å°±ä¸èƒ½å°†ä¸€ä¸ª Byte ç±»åž‹å€¼èµ‹ç»™ä¸€ä¸ª Int ç±»åž‹çš„å˜é‡ã€‚ä½ éœ€è¦ä½¿ç”¨ toInt() æ˜¾å¼æ‰©å¤§ä¸ºæ›´å¤§çš„ç±»åž‹ï¼Œ Number ç±»ä¸­å®šä¹‰äº†å‘å„ä¸ªæ•°æ®ç±»åž‹è½¬æ¢çš„æ–¹å¼ã€‚ 123456val bb : Byte = 1val ll:Long = 1// æ‰©å¤§val ii1:Int = bb.toInt()// ç¼©å°val ii2:Int = ll.toInt() æ•°å€¼è¿ç®—ç¬¦ 1234567shl(bits) â€“ å¸¦ç¬¦å·å·¦ç§» (ç­‰äºŽ Java çš„&lt;&lt;)shr(bits) â€“ å¸¦ç¬¦å·å³ç§» (ç­‰äºŽ Java çš„ &gt;&gt;)ushr(bits) â€“ æ— ç¬¦å·å³ç§» (ç­‰äºŽ Java çš„ &gt;&gt;&gt;)and(bits) â€“ æŒ‰ä½ä¸Ž(and)or(bits) â€“ æŒ‰ä½æˆ–(or)xor(bits) â€“ æŒ‰ä½å¼‚æˆ–(xor)inv() â€“ æŒ‰ä½å–å å­—ç¬¦ç±»åž‹Char ç±»åž‹ä¸æ˜¯ Number çš„å­ç±»ï¼Œä¹Ÿå°±æ˜¯è¯´ Char ç±»åž‹å¹¶ä¸æ˜¯æ•°å€¼ç±»åž‹ã€‚ Char ç±»åž‹ä½¿ç”¨ å•å¼•å· å¦‚ &#39;a&#39; è¡¨ç¤ºã€‚ç‰¹æ®Šå­—ç¬¦ä½¿ç”¨åæ–œçº¿è½¬ä¹‰è¡¨è¾¾. Kotlinæ”¯æŒçš„è½¬ä¹‰å­—ç¬¦åŒ…æ‹¬: \t, \b, \n, \r, \&#39;, \&quot;, \\, \$ ã€‚ å…¶ä»–ä»»ä½•å­—ç¬¦, éƒ½å¯ä»¥ä½¿ç”¨ Unicode è½¬ä¹‰è¡¨è¾¾æ–¹å¼: &#39;\uFF00&#39;ã€‚ Char ç±»åž‹ä¹Ÿå…·æœ‰ä¸€ç³»åˆ—çš„ç±»åž‹è½¬æ¢æ–¹æ³•ï¼Œä½ å¯ä»¥ä½¿ç”¨ &#39;0&#39;.toInt() è¿™æ ·çš„è¯­æ³•å°† Char ç±»åž‹è½¬æ¢ä¸ºæ•°å€¼ç±»åž‹ã€‚ å¯ä»¥ä½¿ç”¨ Char? ç±»åž‹å¯¹ Char ç±»åž‹è¿›è¡Œè£…ç®±æ“ä½œï¼Œä¸Žæ•°å€¼ç±»åž‹ä¸€æ ·ï¼Œè£…ç®±æ“ä½œä¸èƒ½ä¿æŒå¯¹è±¡åŒä¸€æ€§ã€‚ å¸ƒå°”ç±»åž‹Boolean ç±»åž‹ç”¨æ¥è¡¨ç¤ºå¸ƒå°”å€¼, æœ‰ä¸¤ä¸ªå¯èƒ½çš„å€¼: true å’Œ false. å½“éœ€è¦ä¸€ä¸ªå¯ä¸º null çš„å¸ƒå°”å€¼å¼•ç”¨æ—¶, å¸ƒå°”å€¼ä¹Ÿä¼šè¢«è£…ç®±(box). å¸ƒå°”å€¼çš„è®¡ç®—ä¸Ž Java ç›¸åŒã€‚ æ•°ç»„ç±»åž‹Kotlin ä¸­çš„æ•°ç»„é€šè¿‡ Array ç±»è¡¨è¾¾, è¿™ä¸ªç±»æ‹¥æœ‰ get å’Œ set å‡½æ•°(è¿™äº›å‡½æ•°é€šè¿‡è¿ç®—ç¬¦é‡è½½è½¬æ¢ä¸º [] è¿ç®—ç¬¦), æ­¤å¤–è¿˜æœ‰ size å±žæ€§, ä»¥åŠå…¶ä»–ä¸€äº›æœ‰ç”¨çš„æˆå‘˜å‡½æ•°ã€‚ Kotlin ä¸­ä¹Ÿæœ‰ä¸“é—¨çš„ç±»æ¥è¡¨è¾¾åŸºæœ¬æ•°æ®ç±»åž‹çš„æ•°ç»„: ByteArray, ShortArray, IntArray ç­‰ç­‰, è¿™äº›æ•°ç»„å¯ä»¥é¿å…æ•°å€¼å¯¹è±¡è£…ç®±å¸¦æ¥çš„æ€§èƒ½æŸè€—. è¿™äº›ç±»ä¸Ž Array ç±»ä¹‹é—´ä¸å­˜åœ¨ç»§æ‰¿å…³ç³», ä½†å®ƒä»¬çš„æ–¹æ³•å’Œå±žæ€§æ˜¯ä¸€è‡´çš„. å„ä¸ªåŸºæœ¬æ•°æ®ç±»åž‹çš„æ•°ç»„ç±»éƒ½æœ‰å¯¹åº”çš„å·¥åŽ‚å‡½æ•°ã€‚ 1234567891011121314151617181920// åˆå§‹åŒ–ä¸€ä¸ª Arrayval array1 = arrayOf(1, 2, 4)// åˆå§‹åŒ–ä¸€ä¸ªå…¨ä¸º null çš„ Arrayval array2 = arrayOfNulls&lt;Int&gt;(10)// IntArrayç±»åž‹val array3 = intArrayOf(1, 2, 3)// ShortArrayç±»åž‹val array4 = shortArrayOf(1, 2, 3)// ä½¿ç”¨å·¥åŽ‚å‡½æ•°åˆå§‹åŒ–val array5 = Array(10, &#123; i -&gt; i * i&#125;)// æŽ¨èä¸‹æ ‡è®¿é—®logError(array5[0])logError(array5.get(0))logError(array5.size) å­—ç¬¦ä¸²ç±»åž‹ä½¿ç”¨åŒå¼•å· &quot;abc&quot; è¡¨ç¤ºè½¬ç§»å­—ç¬¦ä¸²ï¼Œæ”¯æŒè½¬ä¹‰å­—ç¬¦ã€‚ä½¿ç”¨ä¸‰ä¸ªåŒå¼•å· &quot;&quot;&quot;abc&quot;&quot;&quot; è¡¨ç¤ºåŽŸç”Ÿå­—ç¬¦ä¸²ï¼ŒåŽŸç”Ÿå­—ç¬¦ä¸²ä¸æ”¯æŒè½¬ä¹‰ï¼Œå¯ä»¥åŒ…å«ä»»ä½•è½¬ä¹‰å­—ç¬¦ã€‚ 1234567891011121314// é»˜è®¤ä½¿ç”¨ | åˆ†å‰²val text = """ |Tell me and I forget\n. |Teach me and I remember\t. |Involve me and I learn. |(Benjamin Franklin) """.trimMargin()logError(text)// è¾“å‡ºTell me and I forget\n.Teach me and I remember\t.Involve me and I learn.(Benjamin Franklin) å­—ç¬¦ä¸²æ¨¡æ¿ï¼Œè½¬ä¹‰å­—ç¬¦ä¸²å’ŒåŽŸç”Ÿå­—ç¬¦ä¸²éƒ½æ”¯æŒå­—ç¬¦ä¸²æ¨¡æ¿ï¼Œä½¿ç”¨ ${è¡¨è¾¾å¼} çš„æ–¹å¼å¯ä»¥åœ¨å­—ç¬¦ä¸²ä¸­é—´æ’å…¥æ•°æ®ã€‚åªæœ‰ä¸€ä¸ªç®€å•å€¼æ—¶å¯ä»¥çœç•¥ {} ,åŒæ—¶ä¹Ÿæ”¯æŒå¤æ‚è¡¨è¾¾å¼çš„è®¡ç®—ã€‚è½¬ä¹‰å­—ç¬¦ä¸²ä¸­ä½ å¯ä»¥ä½¿ç”¨ \$ æ¥å†™å…¥ $ å­—ç¬¦ï¼ŒåŽŸç”Ÿå­—ç¬¦ä¸²ä¸­ç”±äºŽä¸æ”¯æŒè½¬ä¹‰å­—ç¬¦ï¼Œä½ å¯ä»¥ä½¿ç”¨ ${&quot;$&quot;} çš„æ–¹å¼å†™å…¥ $ å­—ç¬¦ã€‚ 12345val user = User()val param = 100var str = "test str template like $param"str = "test str template like $&#123;user.name&#125; "str = "test str template like $&#123;if (user.age &lt;= 0) 100 else user.age&#125;" æŽ§åˆ¶æµæŽ§åˆ¶æµä¸»è¦åŒ…æ‹¬åˆ¤æ–­ç»“æž„ï¼Œåˆ†æ”¯ç»“æž„ï¼Œå¾ªçŽ¯ç»“æž„ if åˆ¤æ–­ç»“æž„123456789101112131415var a = 0if (a == 0) a = 100if (a == 0) a = 100 else a = 1000// ä½œä¸ºè¡¨è¾¾å¼æ—¶å¿…é¡»æœ‰elseåˆ†æ”¯val rst1 = if (a == 0) 100 else 1000// å…·æœ‰å¤šè¡Œè¯­å¥å¿…é¡»ä½¿ç”¨&#123;&#125;val rst2 = if (a == 0) &#123; logError(100) 100&#125; else &#123; logError(1000) 1000&#125; when åˆ†æ”¯ç»“æž„Kotlin ä½¿ç”¨ when å…³é”®å­—å®žçŽ°åˆ†æ”¯ç»“æž„ã€‚ å½“ when ä½œä¸ºè¡¨è¾¾å¼å‡ºçŽ°æ—¶ï¼Œå¿…é¡»å…·æœ‰ else åˆ†æ”¯ï¼Œé™¤éžä½ çš„åˆ†æ”¯å·²ç»åŒ…å«äº†æ‰€æœ‰çš„æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºä½œä¸ºè¡¨è¾¾å¼æ—¶ä»–å¿…é¡»æœ‰ä¸€ä¸ªè¿”å›žå€¼ï¼Œè€Œ else åˆ†æ”¯å°†ä¼šåœ¨æ‰€æœ‰æ¡ä»¶éƒ½ä¸æ»¡è¶³æ—¶æ‰§è¡Œã€‚ when ä½œä¸ºè¡¨è¾¾å¼ 12345678910111213fun testFun3(param: Int): Int = when (param) &#123; // ä¸€èˆ¬ç”¨æ³• 0 -&gt; 0 // ä½¿ç”¨ in æ“ä½œç¬¦åŒ¹é…èŒƒå›´ in 1..5 -&gt; 1 !in 100..105 -&gt; -1 // ä½¿ç”¨å¤šä¸ªåŒ¹é… 5, 6, 7 -&gt; 2 // ç±»åž‹åˆ¤æ–­ is Int -&gt; 3 // ä½œä¸ºè¡¨è¾¾å¼å¿…é¡»æœ‰elseåˆ†æ”¯ else -&gt; 100&#125; åœ¨å‡½æ•°ä¸­ä½¿ç”¨ when 12345678// ä½œä¸ºå‡½æ•°æ—¶ä¸éœ€è¦å¿…é¡»æœ‰ else åˆ†æ”¯fun testFun5() &#123; val param: Any? = 100 when (param) &#123; // è‡ªåŠ¨çš„ç±»åž‹æŽ¨æ–­ï¼Œæ­¤æ—¶param æ˜¯ String ç±»åž‹ is String -&gt; param.startsWith("") &#125;&#125; for å¾ªçŽ¯ç»“æž„ä»»ä½•å€¼, åªè¦èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ªè¿­ä»£å™¨( iterator), å°±å¯ä»¥ä½¿ç”¨ for å¾ªçŽ¯è¿›è¡ŒéåŽ†ã€‚ èƒ½å¤Ÿäº§ç”Ÿä¸€ä¸ªè¿­ä»£å™¨æ˜¯æŒ‡ï¼š å­˜åœ¨ä¸€ä¸ªæˆå‘˜å‡½æ•°- æˆ–æ‰©å±•å‡½æ•° iterator(), å®ƒçš„è¿”å›žç±»åž‹åº”è¯¥ å­˜åœ¨ä¸€ä¸ªæˆå‘˜å‡½æ•°- æˆ–æ‰©å±•å‡½æ•° next(), å¹¶ä¸” å­˜åœ¨ä¸€ä¸ªæˆå‘˜å‡½æ•°- æˆ–æ‰©å±•å‡½æ•° hasNext(), å®ƒçš„è¿”å›žç±»åž‹ä¸º Boolean ç±»åž‹ã€‚ éåŽ†æ•°ç»„å’Œ List 12345678910111213141516171819202122232425262728// éåŽ†ä¸´æ—¶æ•°ç»„for (item in (1..4)) &#123; logError(item)&#125;// éåŽ†listval lists = mutableListOf(1, 2, 4)// éåŽ†itemfor (item in lists) &#123; logError(item)&#125;// ä½¿ç”¨ä¸‹æ ‡éåŽ†for (i in lists.indices) &#123; logError(lists.get(i))&#125;// èŽ·å–ä¸‹æ ‡å’Œå€¼for((i,item) in lists.withIndex())&#123; logError("$i = $item")&#125;// éåŽ†æ•°ç»„ä¹Ÿæ˜¯ä¸€æ ·çš„val arrays = arrayOf(1,2,3)for (item in arrays)&#123; logError(item)&#125;for (i in arrays.indices)&#123; logError(arrays[i])&#125; éåŽ† map 12345// éåŽ†mapval maps = mapOf(Pair("a", "b"), Pair("a1", "b1"))for ((key, value) in maps) &#123; logError("map($key-&gt;$value)")&#125; éåŽ†å­—ç¬¦ä¸² 12345// éåŽ†å­—ç¬¦ä¸²val str = "test"for (s in str)&#123; logError("$s in str")&#125; while å¾ªçŽ¯ç»“æž„ç”¨æ³•ä¸Žå…¶ä»–è¯­è¨€æ˜¯ä¸€è‡´çš„ã€‚ 12345678910var a = 0while (a &gt; 100) &#123; logError("a is $a") a++&#125;do &#123; logError("a is $a") a++&#125; while (a &gt; 100) è¿”å›žä¸Žè·³è½¬Kotlin ä¸­æœ‰ä¸‰ç§æ ‡ç­¾å¯ä»¥è·³å‡ºç¨‹åºæµç¨‹ return. é»˜è®¤è¡Œä¸ºæ˜¯, ä»Žæœ€å†…å±‚çš„å‡½æ•°æˆ– åŒ¿åå‡½æ•° ä¸­è¿”å›žã€‚break. ç»“æŸæœ€å†…å±‚çš„å¾ªçŽ¯ã€‚continue. åœ¨æœ€å†…å±‚çš„å¾ªçŽ¯ä¸­, è·³è½¬åˆ°ä¸‹ä¸€æ¬¡å¾ªçŽ¯ã€‚ Kotlin ä¸­çš„ä»»ä½•è¡¨è¾¾å¼éƒ½å¯ä»¥ç”¨ label æ ‡ç­¾æ¥æ ‡è®°ã€‚æ ‡ç­¾çš„å½¢å¼ä¸Žæ ‡è¯†ç¬¦ç›¸åŒ, åŽé¢é™„åŠ ä¸€ä¸ª @ ç¬¦å·,å¦‚ loopOut@,ä½¿ç”¨æ ‡ç­¾æ ‡è®°ä½ç½®ï¼Œå°±å¯ä»¥ä½¿ç”¨ç¨‹åºè·³å‡ºæ“ä½œç¬¦è·³å‡ºæŒ‡å®šä½ç½®ï¼Œå¦‚ break@loopOut,continue@loopOut,return@loopOutã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸­é—´ä¸éœ€è¦æœ‰ç©ºæ ¼ï¼Œä»–ä»¬æ˜¯ä¸€ä½“çš„ã€‚å¦‚æžœæœ‰æ ‡ç­¾çš„åŒæ—¶åˆæœ‰è¿”å›žå€¼ï¼Œä½¿ç”¨ return@loopOut 100 è¿™æ ·çš„å½¢å¼ï¼Œæ„ä¸ºè·³å‡ºåˆ° loopOut æ ‡ç­¾ä½ç½®ï¼Œè¿”å›žå€¼æ˜¯ 100 ã€‚ 12345678910111213fun testFun6() &#123; loopOut@ for (i in 1..10) &#123; loopIn@ for (j in 10..100) &#123; if (i * j == 100) break@loopOut if (i * j &lt; 10) continue@loopIn if (i * j == 101) break@loopIn logError("result = $&#123;i * j&#125;") &#125; &#125;&#125; åœ¨ Kotlin ä¸­, é€šè¿‡ä½¿ç”¨å­—é¢å€¼å‡½æ•°(function literal), å±€éƒ¨å‡½æ•°(local function), ä»¥åŠå¯¹è±¡è¡¨è¾¾å¼(object expression), å…è®¸å®žçŽ°å‡½æ•°çš„åµŒå¥—ã€‚é€šè¿‡æ ‡ç­¾é™å®šçš„ return è¯­å¥, å¯ä»¥ä»Žä¸€ä¸ªå¤–å±‚å‡½æ•°ä¸­è¿”å›ž. æœ€é‡è¦çš„ä½¿ç”¨åœºæ™¯æ˜¯ä»Ž Lambda è¡¨è¾¾å¼ä¸­è¿”å›žã€‚ å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œé»˜è®¤ä¼šä»Žå‡½æ•° testFun61() ä¸­è¿”å›žï¼Œè¿”å›žå€¼ä¸º9ï¼Œè€Œä¸”ä½ å†™ return è¯­å¥æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæç¤ºä½ å¿…é¡»è¿”å›žä¸€ä¸ª Int ç±»åž‹ã€‚è¿™ç§éžå±€éƒ¨çš„è¿”å›ž(non-local return), ä»…å¯¹ä¼ é€’ç»™ å†…è”å‡½æ•°(inline function) çš„ Lambda è¡¨è¾¾å¼æœ‰æ•ˆã€‚ 123456789// å‡½æ•°ä¼šè¿”å›ž 9fun testFun61(): Int &#123; val arrays = Array(10, &#123; i -&gt; i * i &#125;) arrays.forEach &#123; if (it == 9) return it &#125; return 0&#125; å¦‚æžœéœ€è¦ä»Žå†…éƒ¨ Lambda è¡¨è¾¾å¼è·³å‡ºè€Œä¸æ˜¯ä»Žå‡½æ•°ä¸­è¿”å›žï¼Œå¯ä»¥ä½¿ç”¨æ ‡ç­¾æŒ‡å®šè·³å‡ºç›®æ ‡ã€‚ä½¿ç”¨éšå«æ ‡ç­¾ä¼šæ›´æ–¹ä¾¿ä¸€äº›, éšå«æ ‡ç­¾çš„åç§°ä¸Ž Lambda è¡¨è¾¾å¼è¢«ä¼ é€’åŽ»çš„å‡½æ•°åç§°ç›¸åŒã€‚å¦‚ä¸‹é¢çš„éšå«æ ‡ç­¾ä¸º forEach@ã€‚ 12345678910111213141516171819// æ­¤æ—¶è¿”å›ž 0fun testFun62():Int&#123; val arrays = Array(10, &#123; i -&gt; i * i &#125;) arrays.forEach signal@&#123; if (it == 9) return@signal &#125; return 0&#125;// ä½¿ç”¨éšå«æ ‡ç­¾fun testFun63():Int&#123; val arrays = Array(10, &#123; i -&gt; i * i &#125;) arrays.forEach &#123; if (it == 9) return@forEach &#125; return 0&#125;]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AS å‡çº§ gradle åˆ°2.3.1å¼‚å¸¸]]></title>
    <url>%2Farticle%2F2758264870%2F</url>
    <content type="text"><![CDATA[AndroidStudioå‡çº§gradleæ’ä»¶ç‰ˆæœ¬åˆ°2.3.1ä¹‹åŽä¸èƒ½è¿è¡Œäº†ï¼Œæç¤ºMultiDexæ‰¾ä¸åˆ°ï¼Œç”±æ­¤å¼•å‘äº†å¾ˆå¤šé—®é¢˜ã€‚ å¼€å§‹å‡çº§æ’ä»¶ç‰ˆæœ¬å‡çº§åˆ°2.3.1ï¼Œé…ç½®project / build.gradle 1classpath "com.android.tools.build:gradle:2.3.1" gradleç‰ˆæœ¬å‡çº§åˆ°3.3ï¼Œé…ç½®project / gradle / gradle-wrapper.properties 123456#Sun Mar 05 00:36:45 CST 2017distributionBase=GRADLE_USER_HOMEdistributionPath=wrapper/distszipStoreBase=GRADLE_USER_HOMEzipStorePath=wrapper/distsdistributionUrl=https\://services.gradle.org/distributions/gradle-3.3-all.zip åˆ†åŒ…å¼•èµ·çš„é—®é¢˜é…ç½®åˆ†åŒ…123456defaultConfig &#123; multiDexEnabled true &#125; ä¾èµ–æ·»åŠ compile 'com.android.support:multidex:1.0.1' å°ç±³çš„é—®é¢˜ä¸€åˆ‡éƒ½okä¹‹åŽå‡ºçŽ°äº†æ–°çš„é—®é¢˜ï¼ŒFailed to establish sessionç„¶åŽæ— æ³•å®‰è£…åº”ç”¨ï¼Œåœ¨githubä¸Šé¢æ‰¾åˆ°äº†å›žç­”ï¼Œçž»ä»°ä¸€ä¸‹ã€‚ æœ€åŽæ€»ç»“å°±æ˜¯è¦æŠŠå¼€å‘è€…æ¨¡å¼çš„MIUIä¼˜åŒ–é€‰é¡¹ç»™å…³é—­æŽ‰ï¼Œä¸ç„¶å®‰è£…ä¸äº†ã€‚ä¹‹å‰è¿˜æœ‰ä¸€ä¸ªå¼€å¯å…è®¸Usbå®‰è£…çš„é€‰é¡¹ï¼Œä¸æ‰“å¼€çš„è¯ä¹Ÿæ— æ³•å®‰è£…åº”ç”¨ï¼Œæ€»ä¹‹å°ç±³æ‰‹æœºç‰¹åˆ«ä¸€ç‚¹ã€‚ 123456789101112Works !for those who suffer from this:enable developer mode - In your phone, go to Settings, About phone and click on MIUI version 7 times. Youâ€™ll see a pop up which says you are a developer now. Go back to Settings, Additional settings, Developer options and enable USB Debugging. Connect your phone to your PC/Mac and on the phone authorize your computergo back to Developer options, scroll down to find Turn on MIUI optimization and disable it. Your phone will be rebootedTry it now :)]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidç¼–è¯‘FFmpegä¹‹HelloWorld]]></title>
    <url>%2Farticle%2F3809198562%2F</url>
    <content type="text"><![CDATA[ç¼–è¯‘FFmpeg3.3.1çš„soæ–‡ä»¶ï¼Œå¹¶åœ¨Androidå·¥ç¨‹ä¸­ä½¿ç”¨ã€‚ FFmpegç‰ˆæœ¬ï¼š3.3.1 ï¼ OSï¼šMac OSX æœ¬æ–‡åšå®¢é“¾æŽ¥ GitHubï¼Œæœ¬æ–‡ä»‹ç»å†…å®¹è¯·æŸ¥çœ‹hello_worldåˆ†æ”¯ ps: å¼€å§‹çš„æ—¶å€™æˆ‘åªç¼–è¯‘å‡ºäº†6ä¸ªsoæ–‡ä»¶ï¼Œç¼ºå°‘libavdevice.soå’Œlibpostproc.soï¼Œä¸»è¦æ˜¯å› ä¸ºbuild_andorid.shçš„é…ç½®ä¸åŒï¼ŒçŽ°åœ¨å¯ä»¥ç¼–è¯‘å‡º8ä¸ªsoæ–‡ä»¶ï¼Œåœ¨æ–‡ç« ä¸­çš„å›¾ç‰‡å‡ºçŽ°çš„éƒ½æ˜¯6ä¸ªsoæ–‡ä»¶ï¼Œç‰¹æ­¤å£°æ˜Žã€‚ æºä»£ç  GitHub - FFmpegAndroidSupport(æ³¨æ„åœ¨ hello_world åˆ†æ”¯) é…ç½® NDK çŽ¯å¢ƒæ‰“å¼€~/.bash_profileæ–‡ä»¶ï¼Œæ·»åŠ ndkçš„çŽ¯å¢ƒå˜é‡ï¼Œæœ€åŽåˆ«å¿˜äº†source .bash_profileæ›´æ–°é…ç½®ï¼Œå®Œæˆä¹‹åŽè¿è¡Œ ndk-build -væŸ¥çœ‹ç‰ˆæœ¬ï¼Œæ²¡æœ‰æç¤ºæ‰¾ä¸åˆ°å‘½ä»¤å°±å¯ä»¥äº†ã€‚ 12# ndk export PATH=$&#123;PATH&#125;:/Users/march/AndroidRes/sdk/ndk-bundle ä¿®æ”¹ configureä¿®æ”¹ffmpeg-3.3.1/configureæ–‡ä»¶ï¼Œè¿™ä¸ªä¸»è¦æ˜¯ç”Ÿæˆçš„libåŒ…çš„åŒ…åè§„èŒƒæˆä»¥libxxx.soçš„å½¢å¼ã€‚ å¦åˆ™ç”Ÿæˆçš„soæ–‡ä»¶åœ¨androidä¸‹æ˜¯æ— æ³•åŠ è½½çš„ï¼Œæ›¿æ¢è¿‡ç¨‹ä¸€å®šè¦è°¨æ…Žï¼Œéœ€è¦å…¨éƒ¨æ›¿æ¢æŽ‰ã€‚è¿™é‡Œæˆ‘æä¾›ä¸€ä¸ªæ›¿æ¢å¥½çš„configureæ–‡ä»¶ä¾›å‚è€ƒ:thumbsup: 1234567891011# æ‰¾åˆ°ä¸‹é¢å‡ è¡Œæ›¿æ¢ä¸€ä¸‹SLIBNAME_WITH_MAJOR='$(SLIBNAME).$(LIBMAJOR)' LIB_INSTALL_EXTRA_CMD='$$(RANLIB)"$(LIBDIR)/$(LIBNAME)"' SLIB_INSTALL_NAME='$(SLIBNAME_WITH_VERSION)' SLIB_INSTALL_LINKS='$(SLIBNAME_WITH_MAJOR)$(SLIBNAME)'# æ›¿æ¢åŽçš„ç»“æžœSLIBNAME_WITH_MAJOR='$(SLIBPREF)$(FULLNAME)-$(LIBMAJOR)$(SLIBSUF)' LIB_INSTALL_EXTRA_CMD='$$(RANLIB)"$(LIBDIR)/$(LIBNAME)"' SLIB_INSTALL_NAME='$(SLIBNAME_WITH_MAJOR)' SLIB_INSTALL_LINKS='$(SLIBNAME)' ç¼–å†™ build_android.sh è„šæœ¬ç¼–å†™ffmpeg-3.3.1/build_android.shè„šæœ¬æ³¨æ„,NDKåŽé¢çš„è·¯å¾„æ¢æˆè‡ªå·±çš„è·¯å¾„ï¼Œå¯ä»¥å‚è€ƒç¼–å†™å¥½çš„æ–‡ä»¶:smile: å…³æ³¨ä¸‹é¢çš„é…ç½®ï¼Œä¸è¦ç›´æŽ¥æ‹·è´--disable-avdeviceåŠ ä¸Šä¹‹åŽå°†ä¸ä¼šç”Ÿæˆavdevice.soæ–‡ä»¶--enable-gplåŠ ä¸Šä¹‹åŽå°†ä¼šç”Ÿæˆpostproc.soæ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839#!/bin/shNDK=/Users/march/AndroidRes/sdk/ndk-bundleSYSROOT=$NDK/platforms/android-23/arch-armTOOLCHAIN=$NDK/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64function build_one&#123;./configure \--target-os=linux \--prefix=$PREFIX \--arch=arm \--disable-doc \--enable-shared \--disable-static \--disable-yasm \--disable-symver \--enable-gpl \--disable-ffmpeg \--disable-ffplay \--disable-ffprobe \--disable-ffserver \--disable-doc \--disable-symver \--cross-prefix=$TOOLCHAIN/bin/arm-linux-androideabi- \--enable-cross-compile \--sysroot=$SYSROOT \--extra-cflags="-Os -fpic $ADDI_CFLAGS" \--extra-ldflags="$ADDI_LDFLAGS" \$ADDITIONAL_CONFIGURE_FLAGmake cleanmakemake install&#125;make cleanCPU=armPREFIX=$(pwd)/android/$CPUADDI_CFLAGS="-marm"build_one ç¼–è¯‘ç”Ÿæˆ ffmpeg so åº“æ‰§è¡Œbuild_android.shè„šæœ¬å¦‚æžœæ²¡æœ‰æƒé™å¯ä»¥ä½¿ç”¨chomd +xå¢žåŠ æ‰§è¡Œæƒé™ç„¶åŽç­‰ä¸€æ®µæ—¶é—´ï¼ŒðŸ˜¯ä¸ï¼Œæ˜¯å¾ˆé•¿æ—¶é—´ï¼Œæ‰€ä»¥å‰é¢çš„é…ç½®è¦è°¨æ…Žï¼Œä¸ç„¶ç¼–è¯‘å®Œäº†ä¹‹åŽå‘çŽ°æœ‰é—®é¢˜ï¼Œå°±ä¼šå¾ˆðŸ’”ï¼Œä½ ä¼šå‘çŽ°åœ¨FFmpegä¸­å‡ºçŽ°äº†ä¸€ä¸ªåä¸ºandroidçš„æ–‡ä»¶å¤¹ã€‚ç›®å½•å¦‚ä¸‹ å°†ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶ copy åˆ° AS ä¸­ç›®å½•å¦‚ä¸‹ï¼ŒjniLibsé‡Œé¢æ˜¯æœ€åŽæˆ‘ä»¬ç¼–è¯‘ç”Ÿæˆå¥½ä¹‹åŽæ‹·è´è¿›åŽ»çš„ï¼ŒçŽ°åœ¨åº”è¯¥æ˜¯ç©ºçš„ï¼Œç¼–è¯‘ç”Ÿæˆçš„soæ–‡ä»¶ä¼šç”Ÿæˆåœ¨src/main/libsç›®å½•é‡Œé¢ï¼Œç”Ÿæˆå¥½ä¹‹åŽï¼Œå¦‚æžœä½ ä½¿ç”¨jniLibsç›®å½•åŠ è½½so,å°±æ‹·è´åˆ°è¿™é‡Œã€‚å›¾ç‰‡ä¸­çš„æè¿°ç•¥æœ‰æ­§ä¹‰ã€‚ ç¼–å†™ C è¯­è¨€çš„ JNI æŽ¥å£è¿™é‡Œæ˜¯æ‹·è´äº†åˆ«äººå†™å¥½çš„ä»£ç ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦è¿˜æ˜¯æŠŠæ•´ä¸ªç¼–è¯‘æµç¨‹å®Œæˆï¼Œå› æ­¤ç›´æŽ¥ç”¨äº†åˆ«äººå·²ç»å†™å¥½çš„ï¼ŒåŽé¢çš„æ–‡ç« ä¼šå¯¹è¿™ä¸€å—è¯¦ç»†ä»‹ç»ã€‚ ç¼–å†™æ–‡ä»¶åä¸ºffmpeg_support.cçš„cæ–‡ä»¶ï¼Œå£°æ˜Žjavaè°ƒç”¨æŽ¥å£ï¼Œå‡½æ•°å‘½åéœ€è¦æŒ‰ç…§Java_åŒ…å_ç±»å_æ–¹æ³•åçš„å½¢å¼æ¥ç¼–å†™ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;stdio.h&gt;#include "libavcodec/avcodec.h"#include "libavformat/avformat.h"#include "libavfilter/avfilter.h"#ifdef ANDROID#include &lt;jni.h&gt;#include &lt;android/log.h&gt;#define LOGE(format,...) __android_log_print(ANDROID_LOG_ERROR,"myndk",format,##__VA_ARGS__)#else#define LOGE(format,...) printf("(&gt;_&lt;)"format "\n",##__VA_ARGS__)#endifJNIEXPORT jstring Java_com_march_fas_FFmpegSupport_ffmpegHello(JNIEnv *env,jobject obj)&#123; char info[40000] =&#123;0&#125;; av_register_all(); AVCodec *c_temp = av_codec_next(NULL); while(c_temp != NULL)&#123; if(c_temp-&gt;decode!=NULL)&#123; sprintf(info,"%s[Dec]",info); &#125;else&#123; sprintf(info,"%s[Enc]",info); &#125; switch(c_temp-&gt;type)&#123; case AVMEDIA_TYPE_VIDEO: sprintf(info,"%s[Video]",info); break; case AVMEDIA_TYPE_AUDIO: sprintf(info,"%s[AUDIO]",info); break; default: sprintf(info,"%s[Other]",info); break; &#125; sprintf(info,"%s[%10s]\n",info,c_temp-&gt;name); c_temp=c_temp-&gt;next; LOGE("chendong"); &#125; return (*env)-&gt;NewStringUTF(env,info);&#125; ç¼–å†™ Android.mk12345678910111213141516171819202122232425262728293031323334353637383940LOCAL_PATH :=$(call my-dir)include $(CLEAR_VARS)LOCAL_MODULE := avcodecLOCAL_SRC_FILES := libavcodec-57.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := avfilterLOCAL_SRC_FILES := libavfilter-6.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := avformatLOCAL_SRC_FILES := libavformat-57.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := avutilLOCAL_SRC_FILES := libavutil-55.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := swresampleLOCAL_SRC_FILES := libswresample-2.soinclude $(PREBUILT_SHARED_LIBRARY)include $(CLEAR_VARS)LOCAL_MODULE := swscaleLOCAL_SRC_FILES := libswscale-4.soinclude $(PREBUILT_SHARED_LIBRARY)#Programinclude $(CLEAR_VARS)LOCAL_MODULE :=sffhelloworldLOCAL_SRC_FILES := simplest_ffmpeg_helloworld.cLOCAL_C_INCLUDES += $(LOCAL_PATH)/includeLOCAL_LDLIBS := -llog -lzLOCAL_SHARED_LIBRARIES := avcodec avfilter avformat avutil swresample swscaleinclude $(BUILD_SHARED_LIBRARY) ç¼–å†™ Application.mkå…³äºŽApplication.mkçš„ç›¸å…³é…ç½®å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ä¸‹é¢android-14æŒ‡çš„æ˜¯æœ€å°æ”¯æŒçš„AndroidApiåœ¨4.0ä»¥ä¸Šï¼Œå…·ä½“çœ‹å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£APP_PLATFORMè¿™å—çš„å†…å®¹ã€‚è¿™ä¸ªè·Ÿä½ åœ¨manifestæ–‡ä»¶é‡Œé¢é…ç½®çš„min-sdkä¹Ÿæœ‰äº›å…³è”ï¼Œä¸æ‹¼é…ä¼šæœ‰è­¦å‘Šï¼Œä¸è¿‡çŽ°åœ¨éƒ½ä¼šåœ¨gradleæ–‡ä»¶ä¸­é…ç½®minSdkï¼Œä¸ç”¨åœ¨æ„ä¹Ÿå¯ä»¥ï¼Œå®žåœ¨å¼ºè¿«ç—‡å°±åœ¨manifesté‡Œé¢å†å£°æ˜Žä¸€æ¬¡ã€‚ 12APP_ABI := armeabi armeabi-v7aAPP_PLATFORM := android-14 ç¼–è¯‘ç”Ÿæˆå¯ç”¨çš„ so æ–‡ä»¶local.properties å¦‚ä¸‹é…ç½®ndkç›®å½•,é€šå¸¸æ˜¯é»˜è®¤é…ç½®å¥½çš„ã€‚ 12ndk.dir=/Users/march/AndroidRes/sdk/ndk-bundlesdk.dir=/Users/march/AndroidRes/sdk ç„¶åŽè¿›å…¥åˆ°terminalï¼Œcdåˆ°jniç›®å½•ï¼Œæ‰§è¡Œ ndk-build å‘½ä»¤ç­‰å¾…ä¸€æ®µæ—¶é—´ç¼–è¯‘å®Œæˆçš„ç»“æžœåº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œå¦‚æžœä½ ä½¿ç”¨jniLibsç›®å½•ä½œä¸ºåŠ è½½soçš„ç›®å½•ï¼Œå°†soæ–‡ä»¶æ‹·è´åˆ°jniLibsä¸­ã€‚ åœ¨ app/build.gradle é…ç½®ä»¥ä¸‹ä»£ç ï¼Œå¯ä»¥å°† jniLibs ç›®å½•æŒ‡å‘ libsï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡æ‹·è´ so æ–‡ä»¶åˆ° jniLibs äº† 12345678sourceSets &#123; //å®šä¹‰ç¼–è¯‘æ—¶ç¼–è¯‘æ–‡ä»¶çš„è·¯å¾„ main &#123; res.srcDirs = ['src/main/res'] jniLibs.srcDirs = ['src/main/libs'] jni.srcDirs = [] &#125; &#125; è°ƒç”¨ JNIåŠ è½½soæ–‡ä»¶ä»¥åŠjavaå±‚çš„è°ƒç”¨æŽ¥å£ 123456789101112131415161718192021222324252627282930public class FFmpegSupport &#123; static &#123; try &#123; System.loadLibrary("avutil-55"); System.loadLibrary("swresample-2"); System.loadLibrary("avcodec-57"); System.loadLibrary("avformat-57"); System.loadLibrary("swscale-4"); System.loadLibrary("avfilter-6"); System.loadLibrary("ffmpeg_support"); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static native String ffmpegHello();&#125;// æµ‹è¯•public class MainActivity extends AppCompatActivity &#123; @Override protected void onCreate(@Nullable Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); FFmpegSupport.ffmpegHello(); &#125;&#125; è¿è¡Œé¡¹ç›®ç¼–è¾‘app/build.gradleé…ç½®å¥½soåŠ è½½è·¯å¾„ï¼Œå°†soæ–‡ä»¶æ‹·è´è¿›jniLibsç›®å½•ï¼Œå½“ç„¶ä½ å¦‚æžœå–œæ¬¢æ”¾åœ¨libsç›®å½•é‡Œé¢ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä¸€å®šè¦è®°å¾—armeabi/xxx.soï¼Œabiç›®å½•ä¸è¦å¿˜è®°ï¼Œä¸ç„¶ä¼šæç¤ºæ‰¾ä¸åˆ°ï¼Œä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆç‰¹åˆ«æé†’ :smile: 1234567sourceSets &#123; //å®šä¹‰ç¼–è¯‘æ—¶ç¼–è¯‘æ–‡ä»¶çš„è·¯å¾„ main &#123; res.srcDirs = [&apos;src/main/res&apos;] jniLibs.srcDirs = [&apos;src/main/jniLibs&apos;] &#125; &#125; ç‚¹å‡»è¿è¡Œï¼Œå‡ºçŽ°äº†ä»¥ä¸‹é”™è¯¯ï¼šYour project contains C++ files but it is not using a supported native build systemã€‚ä¸‹é¢çš„é…ç½®å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 123456789101112// åœ¨gradle.propertiesæ·»åŠ Android.useDeprecatedNdk=true// åœ¨app/build.gradle æ·»åŠ jni.srcDirs = []è¿™ä¸€è¡ŒsourceSets &#123; //å®šä¹‰ç¼–è¯‘æ—¶ç¼–è¯‘æ–‡ä»¶çš„è·¯å¾„ main &#123; res.srcDirs = [&apos;src/main/res&apos;] jniLibs.srcDirs = [&apos;src/main/jniLibs&apos;] jni.srcDirs = [] &#125; &#125;]]></content>
      <categories>
        <category>Android</category>
        <category>Ndk</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>FFmpeg</tag>
        <tag>Ndk</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kotlinå¼€å‘-1-æ–°ç‰¹æ€§ç¯‡]]></title>
    <url>%2Farticle%2F3395269050%2F</url>
    <content type="text"><![CDATA[Google 2017 IOå¤§ä¼šå®£å¸ƒKotlinä½œä¸ºAndroidä¸€çº§å¼€å‘è¯­è¨€ï¼Œä¸€æ—¶é—´å„å¤§æŠ€æœ¯åšå®¢ç½‘ç«™ï¼Œå¾®ä¿¡è®¢é˜…å·ï¼Œæœ‹å‹åœˆéƒ½è¢«kotlinåˆ·å±äº†ï¼Œå…¨éƒ½æ˜¯å¯¹kotlinçš„ç®€è¦ä»‹ç»ï¼ŒçŽ°åœ¨è¿‡äº†å¤§çº¦ä¸€å‘¨æ„Ÿè§‰å¤§å®¶æ…¢æ…¢å¹³é™ä¸‹æ¥äº†ï¼Œå‘å¸ƒçš„æ–‡ç« çš„è´¨é‡ä¹Ÿæ›´é«˜ï¼Œæ›´æœ‰é’ˆå¯¹æ€§ï¼Œç›¸ä¿¡ä¸ä¹…çš„å°†æ¥å†å¹¿å¤§å¼€å‘è€…çš„æŽ¨åŠ¨ä¸‹ï¼Œkotlinä¼šå‘å±•çš„è¶Šæ¥è¶Šå¥½ã€‚ å°±åƒGoogleå‘å¸ƒAndroidä¸“ç”¨çš„å¼€å‘å·¥å…·AndroidStudioä¸€æ ·ï¼Œä»…ä»…ä¸€å¹´å¤šçš„æ—¶é—´ï¼ŒEclipseå’ŒIdeaåœ¨Androidå¼€å‘é¢†åŸŸå°±è¢«å®Œå…¨å–ä»£äº†ï¼ŒGoogleçš„å†³å¿ƒæ˜¯çœ‹å¾—è§çš„ã€‚kotlinèƒ½å¤Ÿä¸ŽJavaæ— ç¼å…¼å®¹ï¼Œæ€§èƒ½æ›´å¥½ï¼Œè¯­æ³•æ›´ä¼˜é›…ï¼Œåˆæœ‰ç±»åž‹æŽ¨æ–­ï¼Œå‡½æ•°å¼ç¼–ç¨‹ç­‰æ–°ç‰¹æ€§æ”¯æŒï¼Œç›¸ä¿¡åœ¨Androidå¼€å‘é¢†åŸŸï¼Œå–ä»£Javaåªæ˜¯æ—¶é—´é—®é¢˜ï¼Œæ¯•ç«Ÿæ˜¯å®˜ç½‘æ”¯æŒçš„ã€‚ æœ¬æ–‡æ˜¯å¯¹Kotlinçš„ç¬¬ä¸€æ¬¡æŽ¥è§¦ï¼Œé‡ç‚¹æ”¾åœ¨é¡¹ç›®æ­å»ºå’Œæ–°ç‰¹æ€§çš„ä½“éªŒä¸Šï¼Œæ›´æ·±çš„ç»†èŠ‚å°†ä¼šæ”¾åœ¨åŽé¢çš„æ–‡ç« ä¸­ç ”ç©¶ï¼Œgo ~ æŽ¨èæ–‡ç« Kotlin å®˜ç½‘å’Œå¯¹åº”ä¸­æ–‡ç‰ˆï¼Œè¿™ä¸ªä¸­æ–‡ç‰ˆæ–‡æ¡£çš„é£Žæ ¼å’Œå®˜ç½‘é£Žæ ¼ä¸€æ ·ï¼Œå¯¹æ¯”çœ‹èµ·æ¥èˆ’æœä¸€ç‚¹ï¼ŒæŽ¨èã€‚ kotlinå®˜ç½‘æ–‡æ¡£ ï¼ http://kotlinlang.org Kotlinå®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬ ï¼ http://www.liying-cn.net/kotlin/ Kotlin çš„ä¸¤ç¯‡æŽ¨èæ–‡ç« ï¼Œå¾ˆæ—©å°±åœ¨æŽ¨èä½¿ç”¨äº† å¾®ä¿¡æ–‡ç« -ä½ ä¸ºä»€ä¹ˆéœ€è¦kotlin Segmentfaultä¸Šè…¾è®¯buglyçš„ä¸€ç¯‡æ–‡ç« ï¼Œä»‹ç»äº†kotlinçš„åŸºæœ¬ç‰¹æ€§ å¦å¤–å¤‡æ³¨å‡ ä»½å‚è€ƒæ–‡æ¡£ï¼Œå„æœ‰ä¼˜åŠ¿ï¼Œä½œè¡¥å……ç”¨ kotlinå®˜ç½‘æ–‡æ¡£ä¸­æ–‡ç‰ˆ ï¼ https://hltj.gitbooks.io &lt; kotlin for andriod developer&gt; ä¸­æ–‡ç¿»è¯‘ç‰ˆ ï¼ https://wangjiegulu.gitbooks.io https://huanglizhuo.gitbooks.io åŸºæœ¬é…ç½®AS 3.0 å·²ç»è‡ªå¸¦äº†Kotlinçš„é…ç½®ï¼Œæœ¬æ–‡åœ¨ AS 2.3 åŸºç¡€ä¸Šè¿›è¡Œé…ç½®ã€‚ æ‰“å¼€Setting -&gt; pluginä¸‹è½½æ’ä»¶ï¼Œé‡å¯ASï¼Œåˆ›å»ºé¡¹ç›® -&gt; new File -&gt; Kotlin Activityï¼Œä¼šæç¤ºé…ç½®ç›¸å…³ä¿¡æ¯ï¼Œç‚¹å‡»é…ç½®å³å¯ï¼Œæ’ä»¶ä¼šåœ¨å·¥ç¨‹ä¸­ä½œä¸‹é¢çš„ç›¸å…³é…ç½®ï¼Œä»¥ä¸Šå¯ä»¥ä½¿ç”¨IDEå¾ˆå¿«å®Œæˆï¼Œæ•´ä½“é¡¹ç›®æ²¡æœ‰å¾ˆå¤§å˜åŒ–ã€‚ project/build.gradleæ–‡ä»¶ 123456buildscript &#123; ext.kotlin_version = '1.0.6' dependencies &#123; classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version" &#125;&#125; app/build.gradle æ–‡ä»¶ 1234567891011121314151617181920212223242526272829apply plugin: 'com.android.application'apply plugin: 'kotlin-android'// åŸºäºŽAndroidçš„æ‰©å±•å¢žå¼ºapply plugin: 'kotlin-android-extensions'android &#123; compileSdkVersion 25 buildToolsVersion "25.0.1" defaultConfig &#123; ... &#125; buildTypes &#123; ... &#125; // èµ„æºè·¯å¾„ sourceSets &#123; main.java.srcDirs += 'src/main/kotlin' &#125;&#125;dependencies &#123; // kotlin compile "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"&#125;// éœ€è¦åŠ å…¥è¿™ä¸ªrepositories &#123; mavenCentral()&#125; æ±‡æ€»ä¸€äº›ç»†èŠ‚ Kotlin ä¸å¼ºåˆ¶åœ¨æ¯å¥ä»£ç åŽé¢åŠ  ;ã€‚ Kotlin ä¸æ”¯æŒä¸‰ç›®è¿ç®—ç¬¦äº†ï¼Œå¯ä»¥ä½¿ç”¨ if(condition) è¡¨è¾¾å¼1 else è¡¨è¾¾å¼2 çš„æ–¹å¼ä»£æ›¿ï¼Œæ¯”å¦‚ val a = if(b&gt;0) 100 else 0 ä¸å†ä½¿ç”¨ new å…³é”®å­—åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯æ›´ç®€å•çš„ val user = User() ä¸Ž Java ç›¸åï¼ŒKotlin ä¸­æ‰€æœ‰ç±»å’Œæ–¹æ³•éƒ½é»˜è®¤æ˜¯ä¸å…è®¸ç»§æ‰¿çš„ï¼Œä¹Ÿå°±æ˜¯ final çš„ï¼Œå¦‚æžœæƒ³è¦ç»§æ‰¿ç±»æˆ–é‡å†™æ–¹æ³•å¯ä»¥ä½¿ç”¨ open å…³é”®å­—ã€‚ Kotlin ä¸­ç±»åä¸å¿…ä¸Žæ–‡ä»¶åŒåï¼Œå‡½æ•°ä¹Ÿä¸æ˜¯å¿…é¡»å£°æ˜Žåœ¨ç±»ä¸­æ‰å¯ä»¥ï¼Œå¯ä»¥ç›´æŽ¥å£°æ˜Žåœ¨æ–‡ä»¶ä¸­ã€‚ Kotlin ä¸­æ³¨é‡Šå…è®¸åµŒå¥—ã€‚ ä½¿ç”¨ is ä»£æ›¿ instanceof ï¼Œå¦‚ if(str is String){...} å¼•ç”¨xmlä¸­çš„æŽ§ä»¶å†ä¹Ÿä¸ç”¨ findViewById() ä¹Ÿä¸ç”¨ ButterKnife æ³¨è§£å•¦. è¿™ç§æ‰©å±•åœ¨æ€§èƒ½ä¸Šå’Œ findViewById() æ˜¯ä¸€æ ·çš„ï¼Œå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨è¿™ç§æ‰©å±•å¿…é¡»è¦åœ¨ layout è¢«è®¾ç½®å¥½äº†æ‰èƒ½ä½¿ç”¨, åœ¨ fragment é‡Œé¢, è¦ç­‰åˆ° onViewCreated() ä¹‹åŽæ‰èƒ½ä½¿ç”¨. 12345678910111213141516&lt;!--åœ¨xmlå®šä¹‰ï¼Œidä¸º mTestTv --&gt;&lt;TextView android:id="@+id/mTestTv" android:layout_width="match_parent" android:layout_height="match_parent" android:background="#fff" android:gravity="center" android:text="test" android:textColor="#000" android:textSize="18sp"/&gt;// app/build.gradleä¸­æ‰©å±•å¢žå¼ºæ’ä»¶apply plugin: 'kotlin-android-extensions' import kotlinx.android.synthetic.main.main_activity.*mTestTv.text = "test it" ç©ºå€¼å®‰å…¨(Null Safety)Kotlin æ˜¯ä¸€ç§ç©ºå€¼å®‰å…¨çš„è¯­è¨€ï¼Œä»–åŸºæœ¬èƒ½å¸®åŠ©ä½ å‘Šåˆ« NPEï¼Œå¹¶ä¸”æä¾›äº†å¤§é‡çš„æ“ä½œç¬¦ç®€åŒ–åˆ¤ç©ºæ“ä½œï¼Œæ›´å¤šå†…å®¹å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« &lt;å¸¸é‡å˜é‡ç¯‡&gt;ä¸­è¯¦ç»†ä»‹ç»ã€‚ ä¸€ä¸ªä½¿ç”¨ safe calls ç®€åŒ–è°ƒç”¨çš„å®žä¾‹ 123456789val myParam1:Student? = null// java ä¸­ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåšä¸€ç³»åˆ—åˆ¤ç©ºæ“ä½œif(myParam1!=null &amp;&amp; myParam1.myCls!=null)&#123; Log.e(TAG,"$&#123;myParam1.myCls.length&#125;")&#125;// Kotlin safe callsLog.e(TAG,"$&#123;myParam1?.myCls?.length&#125;") å­—ç¬¦ä¸²æ¨¡ç‰ˆå†ä¹Ÿä¸ç”¨ + æˆ–è€… StringBuilder æ¥å›žæ‹¼æŽ¥å’Œè®¡ç®—å­—ç¬¦ä¸²ï¼Œkotlinæä¾›äº†æ›´åŠ ä¼˜é›…çš„å®žçŽ°æ–¹å¼ã€‚ ä½¿ç”¨ ${è¡¨è¾¾å¼} çš„æ–¹å¼å¯ä»¥åœ¨å­—ç¬¦ä¸²ä¸­é—´æ’å…¥æ•°æ®ã€‚åªæœ‰ä¸€ä¸ªç®€å•å€¼æ—¶å¯ä»¥çœç•¥ {} ,åŒæ—¶ä¹Ÿæ”¯æŒå¤æ‚è¡¨è¾¾å¼çš„è®¡ç®—ã€‚ 12345val user = User()val param = 100var str = "test str template like $param"str = "test str template like $&#123;user.name&#125; "str = "test str template like $&#123;if (user.age &lt;= 0) 100 else user.age&#125;" æ‰©å±•å‡½æ•°å’Œå±žæ€§Kotlin æä¾›äº†å‘ä¸€ä¸ªç±»æ‰©å±•æ–°åŠŸèƒ½çš„èƒ½åŠ›ï¼Œè€Œä¸”ä¸å¿…ä»Žè¿™ä¸ªç±»ç»§æ‰¿, ä¹Ÿä¸å¿…ä½¿ç”¨ä»»ä½•è®¾è®¡æ¨¡å¼, æ¯”å¦‚ Decorator æ¨¡å¼ä¹‹ç±»ã€‚ è¿™ç§åŠŸèƒ½æ˜¯é€šè¿‡ä¸€ç§ç‰¹æ®Šçš„å£°æ˜Žæ¥å®žçŽ°çš„, Kotlin ä¸­ç§°ä¸º æ‰©å±•(extension)ã€‚ Kotlin æ”¯æŒ æ‰©å±•å‡½æ•°(extension function) å’Œ æ‰©å±•å±žæ€§(extension property)ã€‚ å¦å¤–æˆ‘åˆšå¼€å§‹çœ‹è¿™ä¸ªåœ°æ–¹çš„æ—¶å€™ï¼Œæ˜¯å°†æ‰©å±•å‡½æ•°å£°æ˜Žåœ¨ä½¿ç”¨å®ƒçš„ç±»ä¸­ï¼Œåœ¨å¦ä¸€ä¸ªç±»ä¸­è¦ä½¿ç”¨å°±æ— æ³•å¼•ç”¨äº†ï¼Œéš¾é“æ¯æ¬¡éƒ½è¦é‡æ–°å†™ï¼Ÿé‚£ä¸æ˜¯å¾ˆé¸¡è‚‹ã€‚å…¶å®žç”±äºŽ java çš„æƒ¯æ€§ï¼Œæˆ‘è§‰å¾—æ‰€æœ‰çš„æ–¹æ³•å¿…é¡»å£°æ˜Žåœ¨ç±»ä¸­ï¼Œjava ä¸­ç¡®å®žæ˜¯è¿™æ ·çš„ï¼Œ ä½†æ˜¯ Kotlin ä¸å¿…è¿™æ ·åšï¼Œä½ çš„ç±»æ–‡ä»¶çš„åå­—å¯ä»¥ä¸å’Œæ–‡ä»¶åç›¸åŒï¼Œå‡½æ•°ä¹Ÿå¯ä»¥ç›´æŽ¥å£°æ˜Žåœ¨æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯æŸä¸ªç±»ä¸­ã€‚ æ³¨æ„ï¼šä¸éœ€è¦å£°æ˜Ž classï¼Œæ‰©å±•æ–¹æ³•å’Œå±žæ€§æ˜¯é™æ€åŠ è½½çš„ï¼Œ ç›´æŽ¥å†™åœ¨ .kt æ–‡ä»¶ä¸­å³å¯ã€‚ æ³¨æ„ï¼šåœ¨æ‰©å±•å±žæ€§çš„ get() æ–¹æ³•ä¸­ä¸è¦è®¿é—®è¯¥å±žæ€§ï¼Œå› ä¸ºä½ ä¸€æ—¦è®¿é—®è¯¥å±žæ€§ï¼Œå°±ä¼šè°ƒç”¨ get() æ–¹æ³•ï¼Œä»Žè€Œé€ æˆå †æ ˆæº¢å‡ºã€‚ æ–°å»º ContextExtensions.kt æ–‡ä»¶ï¼Œåœ¨é‡Œé¢å£°æ˜Žè¯¥æ‰©å±•å‡½æ•°å’Œæ‰©å±•å±žæ€§ 12345678910111213// æ‰©å±•å‡½æ•°fun Context.logError(msg: String) &#123; Log.e(this.javaClass.simpleName, msg)&#125;// æ‰©å±•å±žæ€§var Context.extensionProperty: String get() &#123; return javaClass.simpleName &#125; set(value) &#123; extensionProperty = value &#125; æŽ¥ä¸‹æ¥å°±å¯ä»¥åœ¨ä»»ä½• Context çš„å®žçŽ°ç±»ï¼Œæ¯”å¦‚ Activity ä¸­ä½¿ç”¨ logError() å‡½æ•°å’Œ extensionProperty å±žæ€§ 1234// æ‰©å±•å‡½æ•°logError("æ–¹æ³•æ‰©å±•")// æ‰©å±•å±žæ€§logError(extensionProperty) è‡ªåŠ¨ç±»åž‹æŽ¨æ–­Kotlinæ”¯æŒè‡ªåŠ¨çš„ç±»åž‹æŽ¨æ–­ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥å¦‚ä¸‹å£°æ˜Žä¸€ä¸ªå¸¸é‡ï¼Œé‚£ä¹ˆå¸¸é‡ myStr çš„ç±»åž‹è¢«æŽ¨æ–­ä¸º String ç±»åž‹ã€‚å¯ä»¥ä½¿ç”¨ String çš„APIã€‚ 12val myStr = ""Log.e(tag,"str length = $&#123;myStr.length&#125;") å½“è¿›è¡Œæ˜¾ç¤ºç±»åž‹è½¬æ¢æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œç±»åž‹æŽ¨æ–­ï¼Œä¸‹é¢å£°æ˜Žäº†ä¸¤ä¸ªç±»ï¼ŒStudent ç»§æ‰¿è‡ª User ,åœ¨ stuUser is Student çš„åˆ¤æ–­ä¹‹åŽï¼ŒstuUser çš„ç±»åž‹è¢«æŽ¨æ–­ä¸º Student ï¼Œå› æ­¤å¯ä»¥ç›´æŽ¥è®¿é—® myClass å±žæ€§ã€‚ 123456789101112open class User(val name: String, val age: Int) &#123; // äºŒçº§æž„é€ å‡½æ•° constructor() : this("", 0)&#125;class Student(name: String, age: Int,val myCls: String) : User(name, age)// è‡ªåŠ¨ç±»åž‹æŽ¨æ–­val stuUser = User()if (stuUser is Student) &#123; // è¿™é‡ŒstuUserå·²ç»æ˜¯Studentç±»åž‹ï¼Œä¸éœ€è¦è¿›è¡Œå¼ºåˆ¶è½¬æ¢ã€‚ Log.e(tag, stuUser.myCls)&#125; æ”¯æŒ lambda è¡¨è¾¾å¼ä½¿ç”¨ lambda è¡¨è¾¾å¼å¯ä»¥ä½¿ä»£ç æ›´åŠ æ¸…æ™°ï¼ŒåŽŸæ¥ä¸€å±‚ä¸€å±‚çš„ {} éƒ½è¢«çœç•¥æŽ‰äº†ï¼Œä¸å¯å¦è®¤çš„æ˜¯å¯è¯»æ€§è¦æ¯”åŽŸæ¥å·®ä¸€ç‚¹ï¼Œä¸è¿‡ä¹ æƒ¯äº†å°±å¥½å¤šäº†ã€‚ å¦å¤– Kotlin ä¹Ÿä¸º lambda è¡¨è¾¾å¼æä¾›äº†å¾ˆå¤šæ‰©å±•æ”¯æŒï¼Œæ¥å¼ºåŒ– lambda è¡¨è¾¾å¼çš„ä½¿ç”¨ï¼Œåœ¨kotlinä¸­,å¦‚æžœå‡½æ•°çš„æœ€åŽä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°å¯ä»¥ç›´æŽ¥å†™åœ¨åœ†æ‹¬å·å¤–é¢ï¼ˆè¦ç”¨èŠ±æ‹¬å·ï¼‰ï¼Œå¦‚æžœåªæœ‰ä¸€ä¸ªå‡½æ•°å‚æ•°ï¼Œå¯ä»¥ç›´æŽ¥çœç•¥åœ†æ‹¬å·ï¼è€Œä¸”å½“å‚æ•°åªæœ‰ä¸€ä¸ªæ—¶å¯ä»¥çœç•¥å‚æ•°è€Œä½¿ç”¨ it æ¥ä»£æ›¿ã€‚ 12345678910111213141516171819mTestTv.setOnClickListener &#123; v -&gt; run &#123; logError("test" + v.id) &#125;&#125;mTestTv.setOnClickListener &#123; v -&gt; if (v.id == 0) &#123; logError("test$&#123;v.id&#125;)") &#125; else &#123; logError( "test$&#123;v.id&#125;)") &#125;&#125;mTestTv.setOnClickListener &#123; logError("test$&#123;it.id&#125;)")&#125; å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘æŒ‡çš„æ˜¯å‡½æ•°å’Œå¯¹è±¡ï¼ŒåŸºæœ¬æ•°æ®ç±»åž‹ä¸€æ ·ï¼Œå¯ä»¥ä½œä¸ºå˜é‡ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå¯ä»¥ä½œä¸ºè¿”å›žå€¼ã€‚ å‡½æ•°ä¸ä¾èµ–äºŽç±»ï¼Œå¯ä»¥ç‹¬ç«‹å­˜åœ¨ã€‚ Kotlinæ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ã€‚å‡½æ•°å£°æ˜Žçš„æ–¹å¼ä¸º (å‚æ•°å:å‚æ•°ç±»åž‹...)-&gt; è¿”å›žå€¼ç±»åž‹ ï¼Œæ¯”å¦‚ (param:String)-&gt;Int ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªå‚æ•°ä¸º String ç±»åž‹ï¼Œè¿”å›žå€¼æ˜¯ Int ç±»åž‹çš„å‡½æ•°ï¼Œå¦‚æžœæ²¡æœ‰è¿”å›žå€¼åˆ™ä½¿ç”¨ Unit å…³é”®å­—ã€‚ åˆšå¼€å§‹å°è¯•åƒä½¿ç”¨å˜é‡ä¸€æ ·ä½¿ç”¨å‡½æ•°ï¼Œæœ‰äº›ä¸å¤ªé€‚åº”ï¼Œå½“ä½ éœ€è¦å°†å‡½æ•°è¿›è¡Œä¼ é€’èµ‹å€¼æ—¶ï¼Œå…ˆå†™ä¸€ä¸ª {}ï¼Œå°†å‡½æ•°å£°æ˜Žåœ¨ {} ä¸­å³å¯ï¼› å°è¯•ç®€å•å£°æ˜Žå‡½æ•° 12345678fun myFun(param: String): Int &#123; logError("å‡½æ•°") return param.hashCode()&#125;fun myFunReturnVoid(param: String): Unit &#123; logError("å£°æ˜Žå‡½æ•°è¿”å›žç©º")&#125; å‡½æ•°ä½œä¸ºå˜é‡ 12345678// å‡½æ•°ä½œä¸ºå˜é‡val funVal: (param: String) -&gt; Int = &#123; // å‚æ•°param param: String -&gt; // è¿”å›žhashcode param.hashCode()&#125;funVal("æµ‹è¯•å‡½æ•°ä½œä¸ºå˜é‡è°ƒç”¨") å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œä¸‹é¢çš„å‡½æ•°æŽ¥å—ä¸€ä¸ªå‚æ•°ä¸º String è¿”å›žå€¼ä¸º Int çš„å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è°ƒç”¨ä»–ã€‚lis æ˜¯å½¢å‚ï¼Œ(String) -&gt; Int)æ˜¯å‡½æ•°ç±»åž‹ã€‚ä¸‹é¢çš„ä¸¤ä¸ªé‡è½½å‡½æ•°çš„ä¾‹å­ï¼Œæ˜¯ä¸ºäº†å±•ç¤ºåªæœ‰ä¸€ä¸ªå‡½æ•°å‚æ•°æ—¶çš„ç®€åŒ–å†™æ³•ï¼Œå¤šä¸ªå‚æ•°æ—¶ä½¿ç”¨å¸¸è§„å†™æ³•ã€‚ç»“åˆä¸Šé¢ lambda è¡¨è¾¾å¼çš„ç›¸å…³ç”¨æ³•ã€‚ 12345678910111213141516171819// åªæœ‰ä¸€ä¸ªå‡½æ•°åšå‚æ•°ï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªå‚æ•°fun testFunOneFunParam(lis: (String) -&gt; Int): Int &#123; return lis("æµ‹è¯•å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’,åªæœ‰ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°")&#125;// æœ‰å¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”å‡½æ•°ä¸æ˜¯æœ€åŽä¸€ä¸ªfun testFunMultiParam(lis: (String) -&gt; Int, param: String): Int &#123; return lis("æµ‹è¯•å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’,ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°")&#125;// è°ƒç”¨testFunOneFunParam &#123; param -&gt; param.hashCode()&#125;testFunMultiParam(&#123; param -&gt; param.hashCode()&#125;, "æµ‹è¯•å‡½æ•°ä¸æ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„æƒ…å†µ") å‡½æ•°ä½œä¸ºè¿”å›žå€¼ 12345678910// å‡½æ•°ä½œä¸ºè¿”å›žå€¼fun returnFun(param: String): ((intParam: Int) -&gt; String) &#123; return &#123; intParam -&gt; "int param is $intParam param is $param" &#125;&#125;// è°ƒç”¨returnFun("æ‰§è¡Œå®Œè¿”å›žä¸€ä¸ªå‡½æ•°")(100) å•è¡¨è¾¾å¼å‡½æ•°ï¼Œå½“å‡½æ•°çš„è¿”å›žå€¼åªæœ‰ä¸€ä¸ªç®€å•è¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å•è¡¨è¾¾å¼å‡½æ•°ï¼Œç®€åŒ–ä»£ç  123456789// å•è¡¨è¾¾å¼å‡½æ•°fun testFun2() = 100// å•è¡¨è¾¾å¼å‡½æ•°ç»“åˆwhenfun testFun3(param: Int) = when (param) &#123; 0 -&gt; 0 in 1..5 -&gt; 1 5, 6, 7 -&gt; 2 else -&gt; 100&#125; æ•°æ®ç±»æˆ‘ä»¬ç»å¸¸ä¼šåˆ›å»ºä¸€äº›æ•°æ®ç±», ä»€ä¹ˆåŠŸèƒ½ä¹Ÿæ²¡æœ‰, è€Œä»…ä»…ç”¨æ¥ä¿å­˜æ•°æ®. åœ¨è¿™äº›ç±»ä¸­, æŸäº›å¸¸è§çš„åŠŸèƒ½ç»å¸¸å¯ä»¥ç”±ç±»ä¸­ä¿å­˜çš„æ•°æ®å†…å®¹å³å¯è‡ªåŠ¨æŽ¨æ–­å¾—åˆ°. åœ¨ Kotlin ä¸­, æˆ‘ä»¬å°†è¿™æ ·çš„ç±»ç§°ä¸º æ•°æ®ç±», é€šè¿‡ data å…³é”®å­—æ ‡è®°ï¼› å®šä¹‰ä¸€ä¸ªæ•°æ®ç±»ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç å³å¯ï¼Œ{} å¯ä»¥çœç•¥æŽ‰ï¼Œæ•°æ®ç±»ä¼šé»˜è®¤ç”Ÿæˆ equals() ï¼ŒtoString() ï¼Œ copy() ç­‰æ–¹æ³•ï¼Œè¿™é‡Œç‰¹åˆ«æä¸€ä¸‹ copy() ï¼Œå¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®ï¼Œè¿™ä¸ªç‰¹æ€§æ˜¯ç›¸å½“ä¸é”™çš„ã€‚ å½“ç„¶æ•°æ®ç±»ä¹Ÿæœ‰å¾ˆå¤šé™åˆ¶ ä¸»æž„é€ å™¨è‡³å°‘è¦æœ‰ä¸€ä¸ªå‚æ•°;ä¸»æž„é€ å™¨çš„æ‰€æœ‰å‚æ•°å¿…é¡»æ ‡è®°ä¸º val æˆ– var;æ•°æ®ç±»ä¸èƒ½æ˜¯abstractç±», open ç±», å°é—­(sealed)ç±», æˆ–å†…éƒ¨(inner)ç±»;æ•°æ®ç±»ä¸èƒ½ç»§æ‰¿è‡ªä»»ä½•å…¶ä»–ç±»(ä½†å¯ä»¥å®žçŽ°æŽ¥å£). 1234data class DataModel(val param1: String, val param2: Int)// ä½¿ç”¨val dataModel = DataModel("p1",100)dataModel.copy("p2",99) æ•°æ®ç±»æ·»åŠ æˆå‘˜æ–¹æ³• 123456data class DataModel(val param1: String, val param2: Int) &#123; fun speak(msg: String) &#123; Log.e("DataModel", "speak$msg") &#125;&#125;dataModel.speak("haha")]]></content>
      <categories>
        <category>Kotlin</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SQL]]></title>
    <url>%2Farticle%2F1299261529%2F</url>
    <content type="text"><![CDATA[1. å‰è¨€ SQLï¼ŒæŒ‡ç»“æž„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œå…¨ç§°æ˜¯(Structured Query Language)ï¼ŒSQL è¯­å¥æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ã€‚è¯´æ˜Žï¼šä½¿ç”¨db_nameä½œä¸ºæ•°æ®åº“åï¼Œä½¿ç”¨tb_nameä½œä¸ºè¡¨åã€‚ä½¿ç”¨col_nameä½œä¸ºåˆ—åï¼Œä½¿ç”¨row_nameä½œä¸ºè¡Œåã€‚ä½¿ç”¨alias_nameä½œä¸ºåˆ«åã€‚[xxx]è¡¨ç¤ºå¯é€‰ä½¿ç”¨çš„å±žæ€§ã€‚(aâ€¦|bâ€¦|câ€¦)è¡¨ç¤ºä¸‰ç§æƒ…å†µä»»é€‰ä¸€ç§ä½¿ç”¨ã€‚ 2. æ•°æ®åº“é…ç½®123456789ç¼–è¾‘ ./bash_profile æ–‡ä»¶ï¼ŒåŠ å…¥åˆ«åopen ~/.bash_profile# mysqlalias mysql=/usr/local/mysql/bin/mysqlè¿žæŽ¥åˆ°mysqlæœåŠ¡mysql -u root -p 3. åº“æ“ä½œè¯­å¥1234567891011121314æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨SHOW databases;åˆ›å»ºæ•°æ®åº“CREATE DATABASE db_name; ä½¿ç”¨æ•°æ®åº“USE db_name; åˆ é™¤æ•°æ®åº“DROP database db_name;ä½¿ç”¨å­—ç¬¦é›†SET names utf8; 4. è¡¨æ“ä½œè¯­å¥å…³äºŽè¡¨å­—æ®µçº¦æŸçš„è®²è§£è§é™„2 123456789101112131415161718192021222324252627282930313233343536373839404142434445åˆ›å»ºè¡¨CREATE TABLE table_name(col_name1 data_type(size) [çº¦æŸ],col_name2 data_type(size) [çº¦æŸ],col_name3 data_type(size) [çº¦æŸ],....);eg:CREATE TABLE Persons(PersonID int,LastName varchar(255),FirstName varchar(255),Address varchar(255),City varchar(255));åˆ é™¤è¡¨DROP TABLE tb_name;åˆ é™¤è¡¨æ•°æ®ï¼Œä½†æ˜¯ä¿ç•™è¡¨ç»“æž„TRUNCATE TABLE tb_nameå¢žåŠ ä¸€åˆ—ALTER TABLE tb_name ADD col_name æ•°æ®ç±»åž‹ [çº¦æŸ]åˆ é™¤ä¸€åˆ—ALTER TABLE tb_name DROP COLUMN col_name;ä¿®æ”¹ä¸€åˆ—ALTER TABLE tb_name ALTER old_col_name new_col_name æ•°æ®ç±»åž‹ [çº¦æŸ]ä¿®æ”¹ä¸€åˆ—çš„æ•°æ®ç±»åž‹/* SQL Server / MS Access */ALTER TABLE tb_nameMODIFY COLUMN col_name æ•°æ®ç±»åž‹/* My SQL / Oracle */ALTER TABLE tb_nameALTER COLUMN col_name æ•°æ®ç±»åž‹æ·»åŠ ä¸»é”®ALTER TABLE tb_name ADD PRIMARY KEY(col_name);åˆ é™¤ä¸»é”®ALTER TABLE tb_name DROP PRIMARY KEY(col_name); 5. å¢žåˆ æ”¹æŸ¥è¯­å¥5.1 SELECT è¯­å¥123456åŸºæœ¬æŸ¥è¯¢è¯­å¥[DISTINCT] å¯é€‰ï¼Œç”¨äºŽè¿”å›žå”¯ä¸€ä¸åŒçš„å€¼ã€‚SELECT [DISTINCT] * FROM tb_name;SELECT [DISTINCT] col_name1,col_name2 FROM tb_name;eg:SELECT name,country FROM Websites; 5.2 SELECT INTO è¯­å¥ä½¿ç”¨SELECT INTOå’Œ INSERT INTO SELECT è¯­å¥ï¼Œå¤åˆ¶è¡¨æ•°æ®ã€‚MySQL æ•°æ®åº“ä¸æ”¯æŒ SELECT INTO è¯­å¥ï¼Œä½†æ”¯æŒ INSERT INTO SELECTã€‚æ–°è¡¨å°†ä¼šä½¿ç”¨ SELECT è¯­å¥ä¸­å®šä¹‰çš„åˆ—åç§°å’Œç±»åž‹è¿›è¡Œåˆ›å»ºã€‚æ‚¨å¯ä»¥ä½¿ç”¨ AS å…³é”®å­—æ¥åº”ç”¨æ–°åç§°ã€‚ 12345678910111213141516171819å¤åˆ¶å…¨éƒ¨æ•°æ®æˆ–è€…ä½¿ç”¨WHEREå­å¥ç­›é€‰SELECT *INTO new_tb_name [IN db_name]FROM old_tb_name;orå¤åˆ¶æŒ‡å®šåˆ—æ•°æ®æˆ–è€…ä½¿ç”¨WHEREå­å¥ç­›é€‰SELECT col_name...INTO new_tb_name [IN db_name]FROM old_tb_name;å¤åˆ¶å…¨éƒ¨æ•°æ®æˆ–è€…ä½¿ç”¨WHEREå­å¥ç­›é€‰INSERT INTO new_tb_nameSELECT * FROM old_tb_name;orå¤åˆ¶æŒ‡å®šåˆ—æ•°æ®æˆ–è€…ä½¿ç”¨WHEREå­å¥ç­›é€‰INSERT INTO new_tb_name(col_name...)SELECT col_name...FROM old_tb_name; 5.3 INSERT INTO è¯­å¥1234567891011// ä¸æŒ‡å®šåˆ—åæ’å…¥INSERT INTO tb_nameVALUES (value1,value2,value3,...);// æŒ‡å®šåˆ—åæ’å…¥INSERT INTO tb_name (col_name1,col_name2,col_name3,...)VALUES (value1,value2,value3,...);eg:INSERT INTO Websites (name, url, country)VALUES ('stackoverflow', 'http://stackoverflow.com/', 'IND'); 5.4 UPDATE è¯­å¥12345678910ä½¿ç”¨UPDATEè¯­å¥æ—¶ï¼Œä¸€å®šè¦æ·»åŠ WHEREæ¡ä»¶ï¼Œå¦åˆ™ä¼šæ›´æ–°æ‰€æœ‰çš„æ•°æ®ã€‚UPDATE tb_nameSET col_name1=value1,col_name2=value2,...WHERE (è¿™é‡Œå‚ç…§WHEREå­å¥ï¼ŒåŒ¹é…æŒ‡å®šæ•°æ®);eg:UPDATE Websites SET alexa='5000', country='USA' WHERE name='aasdfghjkl'; 5.5 DELETE è¯­å¥123456789DELETE FROM tb_nameWHERE (è¿™é‡Œå‚ç…§WHEREå­å¥ï¼ŒåŒ¹é…æŒ‡å®šæ•°æ®);DELETE * FROM tb_nameWHERE (è¿™é‡Œå‚ç…§WHEREå­å¥ï¼ŒåŒ¹é…æŒ‡å®šæ•°æ®);eg:DELETE FROM WebsitesWHERE name='ç™¾åº¦' AND country='CN'; 6. WHERE å­å¥1234SELECT col_name1,col_name2FROM tb_nameWHERE col_name1 operator value1 [é€»è¾‘è¿ç®—ç¬¦ col_name2 operator value2...]; 6.1 é€»è¾‘è¿ç®—ç¬¦1234567891011é€»è¾‘è¿ç®—ç¬¦NOT éžæ“ä½œAND ä¸Žæ“ä½œï¼Œè¡¨è¾¾å¼å‰åŽæ¡ä»¶å¿…é¡»éƒ½æˆç«‹æ‰ä¸ºtrueOR æˆ–æ“ä½œï¼Œè¡¨è¾¾å¼å‰åŽæ“ä½œæœ‰ä¸€ä¸ªæˆç«‹å³ä¸ºtrueé€»è¾‘è¿ç®—çš„ä¼˜å…ˆçº§ï¼š() NOT AND OReg:SELECT * FROM WebsitesWHERE alexa &gt; 15AND (country='CN' OR country='USA'); 6.2 æ¯”è¾ƒè¿ç®—ç¬¦123456789101112131415161718192021222324252627282930313233343536373839/*æ¯”è¾ƒè¿ç®—ç¬¦=,&gt;,&lt;,&gt;=,&lt;=,&lt;&gt;(ä¸ç­‰äºŽï¼Œä¸€äº›ç‰ˆæœ¬ä¸­å†™ä½œ!=),BETWEEN...AND(åœ¨èŒƒå›´å†…),LIKE(æ¨¡ç³ŠæŸ¥è¯¢),IN(æŒ‡å®šæ‰€æœ‰å¯èƒ½å€¼è¿›è¡ŒåŒ¹é…),IS NULL(ç©ºå€¼åˆ¤æ–­)*/eg:ç©ºå€¼æŸ¥è¯¢ IS NULLSELECT * FROM tb)nae WHERE col_name IS NULL;å­˜åœ¨æŸ¥è¯¢ INSELECT * FROM tb_name WHERE col_name IN (5000,3000,1500);SELECT * FROM tb_name WHERE col_name IN ('abc','tyu','test');åŒºé—´æŸ¥è¯¢ BETWEEN...AND...åŒºé—´æŸ¥è¯¢ä¸¤è¾¹éƒ½æ˜¯é—­åŒºé—´ï¼Œç±»ä¼¼[1,100]SELECT * FROM tb_name WHERE col_name BETWEEN 100 AND 200;æ¨¡ç³ŠæŸ¥è¯¢ LIKESELECT * FROM tb_name WHERE col_name LIKE 'M%';todo æ¨¡ç³ŠæŸ¥è¯¢é€šé…ç¬¦% è¡¨ç¤ºå¤šä¸ªå­—å€¼ï¼Œ_ ä¸‹åˆ’çº¿è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚ M% : ä¸ºèƒ½é…ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºçš„æ„æ€ä¸ºæ¨¡ç³ŠæŸ¥è¯¢ä¿¡æ¯ä¸º M å¼€å¤´çš„ã€‚ %M% : åŒç™¾åˆ†å·è¡¨ç¤ºæŸ¥è¯¢çš„ä¿¡æ¯åœ¨å†…å®¹ä¸­é—´ã€‚ %M_% : è¡¨ç¤ºæŸ¥è¯¢çš„å­—æ¯åœ¨å†…å®¹çš„å€’æ•°ç¬¬äºŒä½ã€‚ 7. JOIN å­å¥(è¡¨è¿žæŽ¥)JOIN å­å¥ç”¨äºŽåŸºäºŽè¿™äº›è¡¨ä¹‹é—´çš„å…±åŒå­—æ®µæŠŠæ¥è‡ªä¸¤ä¸ªæˆ–å¤šä¸ªè¡¨çš„è¡Œç»“åˆèµ·æ¥ã€‚ è¿žæŽ¥æ–¹å¼ æè¿° INNER JOIN å¦‚æžœè¡¨ä¸­æœ‰è‡³å°‘ä¸€ä¸ªåŒ¹é…ï¼Œåˆ™è¿”å›žè¡Œ LEFT JOIN å³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»Žå·¦è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œ RIGHT JOIN å³ä½¿å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»Žå³è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œ FULL JOIN åªè¦å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨åŒ¹é…ï¼Œåˆ™è¿”å›žè¡Œ 7.1 INNER JOIN å†…è¿žæŽ¥INNER JOIN ä¹Ÿå¯ä»¥ç®€å†™ä¸º JOININNER JOINå…³é”®å­—åœ¨è¡¨ä¸­å­˜åœ¨è‡³å°‘ä¸€ä¸ªåŒ¹é…æ—¶è¿”å›žè¡Œã€‚1234SELECT col_nameFROM tb_name1INNER JOIN tb_name2ON tb_name1.col_name=tb_name2.col_name; 7.2 LEFT OUTER JOIN å·¦å¤–è¿žæŽ¥LEFT OUTER JOINä¹Ÿå¯ä»¥ç®€å†™ä¸º LEFT JOINLEFT JOIN å…³é”®å­—ä»Žå·¦è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œï¼Œå³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œå¦‚æžœå³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œåˆ™ç»“æžœä¸º NULLã€‚1234SELECT col_nameFROM tb_name1LEFT OUTER JOIN tb_name2ON tb_name1.col_name=tb_name2.col_name; 7.3 RIGHT OUTER JOIN å³å¤–è¿žæŽ¥RIGHT OUTER JOIN ä¹Ÿå¯ä»¥ç®€å†™ä¸º RIGHT JOINRIGHT JOIN å…³é”®å­—ä»Žå³è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œï¼Œå³ä½¿å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œå¦‚æžœå·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œåˆ™ç»“æžœä¸ºNULLã€‚1234SELECT col_nameFROM tb_name1RIGHT OUTER JOIN tb_name2ON tb_name1.col_name=tb_name2.col_name; 7.4 FULL OUTER JOIN å…¨å¤–è¿žæŽ¥FULL OUTER JOIN å…³é”®å­—åªè¦å·¦è¡¨ å’Œå³è¡¨ å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨åŒ¹é…ï¼Œåˆ™è¿”å›žè¡Œ.FULL OUTER JOIN å…³é”®å­—ç»“åˆäº† LEFT JOIN å’Œ RIGHT JOIN çš„ç»“æžœã€‚1234SELECT col_nameFROM tb_name1FULL OUTER JOIN tb_name2ON tb_name1.col_name=tb_name2.col_name; 8. å…³é”®å­—8.1 AS å…³é”®å­—,ä½¿ç”¨åˆ«åä½¿ç”¨ASå…³é”®å­—ï¼Œå¯ä»¥ä¸ºè¡¨åç§°æˆ–åˆ—åç§°æŒ‡å®šåˆ«åï¼ŒåŸºæœ¬ä¸Šï¼Œåˆ›å»ºåˆ«åæ˜¯ä¸ºäº†è®©åˆ—åç§°çš„å¯è¯»æ€§æ›´å¼ºï¼Œä»¥ä¸‹æƒ…å†µä½¿ç”¨åˆ«åå¾ˆæœ‰ç”¨ã€‚ åœ¨æŸ¥è¯¢ä¸­æ¶‰åŠè¶…è¿‡ä¸€ä¸ªè¡¨ åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨äº†å‡½æ•° åˆ—åç§°å¾ˆé•¿æˆ–è€…å¯è¯»æ€§å·® éœ€è¦æŠŠä¸¤ä¸ªåˆ—æˆ–è€…å¤šä¸ªåˆ—ç»“åˆåœ¨ä¸€èµ· ps:åˆ«åå¦‚æžœåŒ…å«ç©ºæ ¼ï¼Œè¦æ±‚ä½¿ç”¨åŒå¼•å·æˆ–æ–¹æ‹¬å·ã€‚ 12345678910111213141516åˆ—åˆ«åç”¨æ³•ä½¿ç”¨åˆ—åˆ«åæŸ¥è¯¢ä¹‹åŽçš„å±•ç¤ºæ•°æ®å°†ä½¿ç”¨åˆ«åæ¥å±•ç¤ºSELECT col_name AS alias_nameFROM tb_name;eg:SELECT name AS n, country AS cFROM Websites;è¡¨åˆ«åç”¨æ³•SELECT col_nameFROM tb_name AS alias_name;eg:SELECT w.name, w.url, a.count, a.date FROM Websites AS w, access_log AS a WHERE a.site_id=w.id and w.name="ç™¾åº¦"; 8.2 ORDER BY å…³é”®å­—12345678910ORDER BY å…³é”®å­—é»˜è®¤æŒ‰ç…§å‡åºå¯¹è®°å½•è¿›è¡ŒæŽ’åºã€‚å¦‚æžœéœ€è¦æŒ‰ç…§é™åºå¯¹è®°å½•è¿›è¡ŒæŽ’åºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ DESC å…³é”®å­—ã€‚SELECT col_name1,col_name2FROM tb_nameORDER BY col_name (ASC|DESC)[,col_name (ASC|DESC)...];eg:SELECT * FROM WebsitesORDER BY alexa DESC; 8.3 LIMIT å…³é”®å­—12345ä½¿ç”¨limitå…³é”®å­—ï¼Œå¯ä»¥è·³è¿‡mæ¡æ•°æ®ï¼ŒæŸ¥è¯¢næ¡æ•°æ®ï¼Œmå¯ä»¥çœç•¥ï¼Œè¡¨ç¤ºä»Žå¤´å¼€å§‹æŸ¥è¯¢ã€‚SELECT * FROM tb_name LIMIT [m,]n;egï¼šSELECT * FROM Websites LIMIT 3,2; 8.4 UNION å…³é”®å­—UNION æ“ä½œç¬¦ç”¨äºŽåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª SELECT è¯­å¥çš„ç»“æžœé›†ã€‚UNION å†…éƒ¨çš„æ¯ä¸ª SELECT è¯­å¥å¿…é¡»æ‹¥æœ‰ç›¸åŒæ•°é‡çš„åˆ—ã€‚åˆ—ä¹Ÿå¿…é¡»æ‹¥æœ‰ç›¸ä¼¼çš„æ•°æ®ç±»åž‹ã€‚åŒæ—¶ï¼Œæ¯ä¸ª SELECT è¯­å¥ä¸­çš„åˆ—çš„é¡ºåºå¿…é¡»ç›¸åŒã€‚UNION ç»“æžœé›†ä¸­çš„åˆ—åæ€»æ˜¯ç­‰äºŽ UNION ä¸­ç¬¬ä¸€ä¸ª SELECT è¯­å¥ä¸­çš„åˆ—åã€‚UNION åªä¼šé€‰å–ä¸åŒçš„å€¼ã€‚è¯·ä½¿ç”¨ UNION ALL æ¥é€‰å–é‡å¤çš„å€¼ï¼ 1234567SELECT col_name FROM tb_name1UNIONSELECT col_name FROM tb_name2;SELECT col_name FROM tb_name1UNION ALLSELECT col_name FROM tb_name2; 9. å‡½æ•°9.1 CONCAT()è¿žæŽ¥å‡½æ•°ç»“æžœå°†ä¼šæ‹¼æŽ¥CONCAT()å‡½æ•°ä¸­çš„å…¨éƒ¨å€¼ 1234ä¸‹é¢çš„ä¾‹å­å°†ä¼šæ‹¼æŽ¥ä¸‰ä¸ªå­—æ®µçš„å€¼(ç»“æžœï¼š'www.baidu.com,100,china')ï¼Œå¹¶ä½œä¸ºä¸€åˆ—(site_info)æ˜¾ç¤ºSELECT name, CONCAT(url, ', ', alexa, ', ', country) AS site_infoFROM Websites; 10. ç´¢å¼•åœ¨ä¸è¯»å–æ•´ä¸ªè¡¨çš„æƒ…å†µä¸‹ï¼Œç´¢å¼•ä½¿æ•°æ®åº“åº”ç”¨ç¨‹åºå¯ä»¥æ›´å¿«åœ°æŸ¥æ‰¾æ•°æ®ã€‚åœ¨è¡¨ä¸­åˆ›å»ºç´¢å¼•ï¼Œä»¥ä¾¿æ›´åŠ å¿«é€Ÿé«˜æ•ˆåœ°æŸ¥è¯¢æ•°æ®ã€‚ç”¨æˆ·æ— æ³•çœ‹åˆ°ç´¢å¼•ï¼Œå®ƒä»¬åªèƒ½è¢«ç”¨æ¥åŠ é€Ÿæœç´¢/æŸ¥è¯¢ã€‚æ›´æ–°ä¸€ä¸ªåŒ…å«ç´¢å¼•çš„è¡¨éœ€è¦æ¯”æ›´æ–°ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„è¡¨èŠ±è´¹æ›´å¤šçš„æ—¶é—´ï¼Œè¿™æ˜¯ç”±äºŽç´¢å¼•æœ¬èº«ä¹Ÿéœ€è¦æ›´æ–°ã€‚å› æ­¤ï¼Œç†æƒ³çš„åšæ³•æ˜¯ä»…ä»…åœ¨å¸¸å¸¸è¢«æœç´¢çš„åˆ—ï¼ˆä»¥åŠè¡¨ï¼‰ä¸Šé¢åˆ›å»ºç´¢å¼•ã€‚ 10.1 åˆ›å»ºç´¢å¼•12345678910111213141516åˆ›å»ºä¸€ä¸ªç®€å•çš„ç´¢å¼•ã€‚å…è®¸ä½¿ç”¨é‡å¤çš„å€¼ï¼šCREATE INDEX index_nameON table_name (column_name)åœ¨è¡¨ä¸Šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ã€‚ä¸å…è®¸ä½¿ç”¨é‡å¤çš„å€¼ï¼šå”¯ä¸€çš„ç´¢å¼•æ„å‘³ç€ä¸¤ä¸ªè¡Œä¸èƒ½æ‹¥æœ‰ç›¸åŒçš„ç´¢å¼•å€¼ã€‚ CREATE UNIQUE INDEX index_nameON table_name (column_name)æ³¨é‡Šï¼šç”¨äºŽåˆ›å»ºç´¢å¼•çš„è¯­æ³•åœ¨ä¸åŒçš„æ•°æ®åº“ä¸­ä¸ä¸€æ ·ã€‚å› æ­¤ï¼Œæ£€æŸ¥æ‚¨çš„æ•°æ®åº“ä¸­åˆ›å»ºç´¢å¼•çš„è¯­æ³•ã€‚ eg:åˆ›å»ºç´¢å¼•CREATE INDEX PIndexON Persons (LastName)åœ¨å¤šä¸ªåˆ—ä¸Šåˆ›å»ºç´¢å¼•CREATE INDEX PIndexON Persons (LastName, FirstName) 10.2 åˆ é™¤ç´¢å¼•12345678/* MS Access */DROP INDEX index_name ON table_name/* MS SQL Server */DROP INDEX table_name.index_name/* DB2/Oracle */DROP INDEX index_name/* MySQL */ALTER TABLE table_name DROP INDEX index_name é™„1. æ¨¡ç³ŠæŸ¥è¯¢é™„1.1. é€šé…ç¬¦ é€šé…ç¬¦ æè¿° ç¤ºä¾‹ % ä»£æ›¿0ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦ chen%,åŒ¹é…chenå¼€å¤´çš„å…¨éƒ¨æ•°æ® _ ä»£æ›¿ä¸€ä¸ªå­—ç¬¦ ch_n,åŒ¹é…ç±»ä¼¼chan,chbn,chcnè¿™ç§æ•°æ® [charlist] å­—ç¬¦åºåˆ—ä¸­çš„ä»»ä¸€ä¸ªå•ä¸ªå­—ç¬¦ [ABC],åŒ¹é…A,B,C [^charlist] or [!charlist] ä¸åœ¨å­—ç¬¦åºåˆ—ä¸­çš„ä»»ä¸€ä¸ªå­—ç¬¦ [!ABC],åŒ¹é…é™¤äº†A,B,Cä»¥å¤–çš„å…¶ä»–å­—ç¬¦ 123SELECT col_nameFROM tb_nameWHERE col_name LIKE pattern; é™„1.2 æ­£åˆ™è¡¨è¾¾å¼1todo é™„2. è¡¨çº¦æŸ çº¦æŸ æè¿° NOT NULL æŒ‡ç¤ºæŸåˆ—ä¸èƒ½å­˜å‚¨ NULL å€¼ã€‚ UNIQUE ä¿è¯æŸåˆ—çš„æ¯è¡Œå¿…é¡»æœ‰å”¯ä¸€çš„å€¼ã€‚ PRIMARY KEY NOT NULL å’Œ UNIQUE çš„ç»“åˆã€‚ç¡®ä¿æŸåˆ—ï¼ˆæˆ–ä¸¤ä¸ªåˆ—å¤šä¸ªåˆ—çš„ç»“åˆï¼‰æœ‰å”¯ä¸€æ ‡è¯†ï¼Œæœ‰åŠ©äºŽæ›´å®¹æ˜“æ›´å¿«é€Ÿåœ°æ‰¾åˆ°è¡¨ä¸­çš„ä¸€ä¸ªç‰¹å®šçš„è®°å½•ã€‚ FOREIGN KEY ä¿è¯ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®åŒ¹é…å¦ä¸€ä¸ªè¡¨ä¸­çš„å€¼çš„å‚ç…§å®Œæ•´ æ€§ã€‚ CHECK ä¿è¯åˆ—ä¸­çš„å€¼ç¬¦åˆæŒ‡å®šçš„æ¡ä»¶ã€‚ DEFAULT è§„å®šæ²¡æœ‰ç»™åˆ—èµ‹å€¼æ—¶çš„é»˜è®¤å€¼ã€‚ é™„2.1 NOT NULL éžç©ºçº¦æŸNOT NULL çº¦æŸå¼ºåˆ¶åˆ—ä¸æŽ¥å—NULLå€¼ã€‚NOT NULL çº¦æŸå¼ºåˆ¶å­—æ®µå§‹ç»ˆåŒ…å«å€¼ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æžœä¸å‘å­—æ®µæ·»åŠ å€¼ï¼Œå°±æ— æ³•æ’å…¥æ–°è®°å½•æˆ–è€…æ›´æ–°è®°å½•ã€‚ 1234567CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255)); é™„2.2 UNIQUE å”¯ä¸€çº¦æŸUNIQUE çº¦æŸå”¯ä¸€æ ‡è¯†æ•°æ®åº“è¡¨ä¸­çš„æ¯æ¡è®°å½•ã€‚UNIQUEå’Œ PRIMARY KEY çº¦æŸå‡ä¸ºåˆ—æˆ–åˆ—é›†åˆæä¾›äº†å”¯ä¸€æ€§çš„ä¿è¯ã€‚PRIMARY KEY çº¦æŸæ‹¥æœ‰è‡ªåŠ¨å®šä¹‰çš„ UNIQUE çº¦æŸã€‚è¯·æ³¨æ„ï¼Œæ¯ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ª UNIQUE çº¦æŸï¼Œä½†æ˜¯æ¯ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ª PRIMARY KEY çº¦æŸã€‚ 1234567891011121314151617181920212223242526272829303132/* MySQL */CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),UNIQUE (P_Id))/* SQL Server / Oracle / MS Access */CREATE TABLE Persons(P_Id int NOT NULL UNIQUE,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255))å‘½å UNIQUE çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ UNIQUE çº¦æŸCREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),CONSTRAINT uc_PersonID UNIQUE (P_Id,LastName)) æ›´æ”¹UNIQUEçº¦æŸ12345678910111213ALTER TABLE PersonsADD UNIQUE (P_Id)å¦‚éœ€å‘½å UNIQUE çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ UNIQUE çº¦æŸï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ SQL è¯­æ³•ï¼šALTER TABLE PersonsADD CONSTRAINT uc_PersonID UNIQUE (P_Id,LastName)æ’¤é”€ UNIQUE çº¦æŸ MySQLï¼šALTER TABLE PersonsDROP INDEX uc_PersonIDSQL Server / Oracle / MS Accessï¼šALTER TABLE PersonsDROP CONSTRAINT uc_PersonID é™„2.3 PRIMARY KEY ä¸»é”®çº¦æŸPRIMARY KEY çº¦æŸå”¯ä¸€æ ‡è¯†æ•°æ®åº“è¡¨ä¸­çš„æ¯æ¡è®°å½•ã€‚ä¸»é”®å¿…é¡»åŒ…å«å”¯ä¸€çš„å€¼ã€‚ä¸»é”®åˆ—ä¸èƒ½åŒ…å« NULL å€¼ã€‚æ¯ä¸ªè¡¨éƒ½åº”è¯¥æœ‰ä¸€ä¸ªä¸»é”®ï¼Œå¹¶ä¸”æ¯ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ã€‚ 123456789101112131415161718192021222324252627282930313233/* MySQL */CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),PRIMARY KEY (P_Id))/* SQL Server / Oracle / MS Access */CREATE TABLE Persons(P_Id int NOT NULL PRIMARY KEY,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255))å‘½å PRIMARY KEY çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ PRIMARY KEY çº¦æŸ CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),CONSTRAINT pk_PersonID PRIMARY KEY (P_Id,LastName))æ³¨é‡Šï¼šåœ¨ä¸Šé¢çš„å®žä¾‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªä¸»é”® PRIMARY KEYï¼ˆpk_PersonIDï¼‰ã€‚ç„¶è€Œï¼Œpk_PersonID çš„å€¼æ˜¯ç”±ä¸¤ä¸ªåˆ—ï¼ˆP_Id å’Œ LastNameï¼‰ç»„æˆçš„ã€‚ æ›´æ”¹PRIMARY KEYçº¦æŸ123456789101112131415ALTER TABLE PersonsADD PRIMARY KEY (P_Id)å¦‚éœ€å‘½å PRIMARY KEY çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ PRIMARY KEY çº¦æŸï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ SQL è¯­æ³•ï¼šALTER TABLE PersonsADD CONSTRAINT pk_PersonID PRIMARY KEY (P_Id,LastName)æ³¨é‡Šï¼šå¦‚æžœæ‚¨ä½¿ç”¨ ALTER TABLE è¯­å¥æ·»åŠ ä¸»é”®ï¼Œå¿…é¡»æŠŠä¸»é”®åˆ—å£°æ˜Žä¸ºä¸åŒ…å« NULL å€¼ï¼ˆåœ¨è¡¨é¦–æ¬¡åˆ›å»ºæ—¶ï¼‰ã€‚æ’¤é”€ PRIMARY KEY çº¦æŸ/* MySQL */ALTER TABLE PersonsDROP PRIMARY KEY/* SQL Server / Oracle / MS Access */ALTER TABLE PersonsDROP CONSTRAINT pk_PersonID é™„2.4 FOREIGN KEY å¤–é”®çº¦æŸä¸€ä¸ªè¡¨ä¸­çš„ FOREIGN KEY æŒ‡å‘å¦ä¸€ä¸ªè¡¨ä¸­çš„ PRIMARY KEYã€‚FOREIGN KEY çº¦æŸç”¨äºŽé¢„é˜²ç ´åè¡¨ä¹‹é—´è¿žæŽ¥çš„è¡Œä¸ºã€‚FOREIGN KEY çº¦æŸä¹Ÿèƒ½é˜²æ­¢éžæ³•æ•°æ®æ’å…¥å¤–é”®åˆ—ï¼Œå› ä¸ºå®ƒå¿…é¡»æ˜¯å®ƒæŒ‡å‘çš„é‚£ä¸ªè¡¨ä¸­çš„å€¼ä¹‹ä¸€ã€‚ ä¾‹å¦‚ï¼šæˆ‘ä»¬çŽ°åœ¨æœ‰Personsè¡¨ç”¨æ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼ŒPersonsè¡¨ä¸»é”®P_Idè¡¨ç¤ºç”¨æˆ·idï¼ŒOrdersè¡¨ç”¨æ¥å­˜å‚¨ç”¨æˆ·è®¢å•ï¼ŒOrdersè¡¨å¤–é”®P_IdæŒ‡å‘ Personsè¡¨çš„ä¸»é”®P_Idï¼Œæ¥çº¦æŸOrdersè¡¨ä¸­æ‰€æœ‰è®¢å•çš„ç”¨æˆ·idå¿…é¡»æ˜¯åœ¨ç”¨æˆ·è¡¨ä¸­å‡ºçŽ°çš„ã€‚ Orders è¡¨ä¸­çš„ P_Id åˆ—æŒ‡å‘ Persons è¡¨ä¸­çš„ P_Id åˆ—ã€‚ Persons è¡¨ä¸­çš„ P_Id åˆ—æ˜¯ Persons è¡¨ä¸­çš„ PRIMARY KEYã€‚ Orders è¡¨ä¸­çš„ P_Id åˆ—æ˜¯ Orders è¡¨ä¸­çš„ FOREIGN KEYã€‚ 1234567891011121314151617181920212223242526272829/* MySQL */CREATE TABLE Orders(O_Id int NOT NULL,OrderNo int NOT NULL,P_Id int,PRIMARY KEY (O_Id),FOREIGN KEY (P_Id) REFERENCES Persons(P_Id))/* SQL Server / Oracle / MS Access */CREATE TABLE Orders(O_Id int NOT NULL PRIMARY KEY,OrderNo int NOT NULL,P_Id int FOREIGN KEY REFERENCES Persons(P_Id))å‘½å FOREIGN KEY çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ FOREIGN KEY çº¦æŸCREATE TABLE Orders(O_Id int NOT NULL,OrderNo int NOT NULL,P_Id int,PRIMARY KEY (O_Id),CONSTRAINT fk_PerOrders FOREIGN KEY (P_Id)REFERENCES Persons(P_Id)) æ›´æ”¹å¤–é”®çº¦æŸ 1234567891011121314151617ALTER TABLE OrdersADD FOREIGN KEY (P_Id)REFERENCES Persons(P_Id)å¦‚éœ€å‘½å FOREIGN KEY çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ FOREIGN KEY çº¦æŸï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ SQL è¯­æ³•ï¼šALTER TABLE OrdersADD CONSTRAINT fk_PerOrdersFOREIGN KEY (P_Id)REFERENCES Persons(P_Id)æ’¤é”€ FOREIGN KEY çº¦æŸ /* MySQL */ALTER TABLE OrdersDROP FOREIGN KEY fk_PerOrders/* SQL Server / Oracle / MS Access */ALTER TABLE OrdersDROP CONSTRAINT fk_PerOrders é™„2.5 CHECK çº¦æŸCHECK çº¦æŸç”¨äºŽé™åˆ¶åˆ—ä¸­çš„å€¼çš„èŒƒå›´ã€‚å¦‚æžœå¯¹å•ä¸ªåˆ—å®šä¹‰ CHECK çº¦æŸï¼Œé‚£ä¹ˆè¯¥åˆ—åªå…è®¸ç‰¹å®šçš„å€¼ã€‚å¦‚æžœå¯¹ä¸€ä¸ªè¡¨å®šä¹‰ CHECK çº¦æŸï¼Œé‚£ä¹ˆæ­¤çº¦æŸä¼šåŸºäºŽè¡Œä¸­å…¶ä»–åˆ—çš„å€¼åœ¨ç‰¹å®šçš„åˆ—ä¸­å¯¹å€¼è¿›è¡Œé™åˆ¶ã€‚1234567891011121314151617181920212223242526272829303132/* MySQL */CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),CHECK (P_Id&gt;0))/* SQL Server / Oracle / MS Access */CREATE TABLE Persons(P_Id int NOT NULL CHECK (P_Id&gt;0),LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255))å¦‚éœ€å‘½å CHECK çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ CHECK çº¦æŸ CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),CONSTRAINT chk_Person CHECK (P_Id&gt;0 AND City='Sandnes')) æ›´æ”¹CHECKçº¦æŸ1234567891011121314ALTER TABLE PersonsADD CHECK (P_Id&gt;0)å¦‚éœ€å‘½å CHECK çº¦æŸï¼Œå¹¶å®šä¹‰å¤šä¸ªåˆ—çš„ CHECK çº¦æŸALTER TABLE PersonsADD CONSTRAINT chk_Person CHECK (P_Id&gt;0 AND City='Sandnes')æ’¤é”€ CHECK çº¦æŸ /* MySQL */ALTER TABLE PersonsDROP CHECK chk_Person/* SQL Server / Oracle / MS Access */ALTER TABLE PersonsDROP CONSTRAINT chk_Person é™„2.6 DEFAULT çº¦æŸDEFAULT çº¦æŸç”¨äºŽå‘åˆ—ä¸­æ’å…¥é»˜è®¤å€¼ã€‚å¦‚æžœæ²¡æœ‰è§„å®šå…¶ä»–çš„å€¼ï¼Œé‚£ä¹ˆä¼šå°†é»˜è®¤å€¼æ·»åŠ åˆ°æ‰€æœ‰çš„æ–°è®°å½•ã€‚1234567891011121314151617CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255) DEFAULT 'Sandnes')é€šè¿‡ä½¿ç”¨ç±»ä¼¼ GETDATE() è¿™æ ·çš„å‡½æ•°ï¼ŒDEFAULT çº¦æŸä¹Ÿå¯ä»¥ç”¨äºŽæ’å…¥ç³»ç»Ÿå€¼CREATE TABLE Orders(O_Id int NOT NULL,OrderNo int NOT NULL,P_Id int,OrderDate date DEFAULT GETDATE()) æ›´æ”¹DEFAULTçº¦æŸ1234567891011121314151617181920æ·»åŠ  DEFAULT çº¦æŸ/* MySQL */ï¼šALTER TABLE PersonsALTER City SET DEFAULT 'SANDNES'/* SQL Server / MS Access */ALTER TABLE PersonsALTER COLUMN City SET DEFAULT 'SANDNES'/* Oracle */ALTER TABLE PersonsMODIFY City DEFAULT 'SANDNES'æ’¤é”€ DEFAULT çº¦æŸ /* MySQL */ALTER TABLE PersonsALTER City DROP DEFAULT/* SQL Server / Oracle / MS Access */ALTER TABLE PersonsALTER COLUMN City DROP DEFAULT é™„2.7 AUTO INCREMENT]]></content>
      <categories>
        <category>Db</category>
      </categories>
      <tags>
        <tag>Database</tag>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fragmentæ‡’åŠ è½½]]></title>
    <url>%2Farticle%2F2799403346%2F</url>
    <content type="text"><![CDATA[ViewPager ç»“åˆ Fragment ä½¿ç”¨æ—¶ï¼Œç”±äºŽ ViewPager çš„ç‰¹æ€§ï¼Œä¼šé¢„å…ˆåŠ è½½å½“å‰æ˜¾ç¤ºé¡µé¢å·¦å³ä¸¤è¾¹çš„é¡µé¢ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤ä¼šç¼“å­˜3ä¸ªé¡µé¢ï¼Œï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨ mViewPager.setOffscreenPageLimit(3); è¿™ä¸ªæ–¹æ³•æ¥æ”¹å˜è¿™ä¸ªè®¾ç½®ã€‚ï¼‰]]></content>
      <categories>
        <category>Android</category>
        <category>todo</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexo]]></title>
    <url>%2Farticle%2F185805107%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨ Hexo+NexT æ­å»ºè‡ªå·±çš„åšå®¢ï¼Œå’Œåœ¨å»ºç«™æœŸé—´é‡åˆ°çš„ä¸€äº›é—®é¢˜ä»¥åŠä¼˜åŒ–æ–¹å¼ã€‚ å¼„æ‡‚ NexTpost.md ä¸­ bool å±žæ€§é»˜è®¤å€¼æ˜¯ false BugFixé”™è¯¯ Cannot set property &#39;lastIndex&#39; of undefinedï¼Œä¿®æ”¹ hexo/config.yml è®¾ç½® auto_detect: false 12345highlight: enable: true line_number: true auto_detect: false tab_replace: SEOä¼˜åŒ– Hexo NexTä¸»é¢˜SEOä¼˜åŒ– SEOä¼˜åŒ–ï¼ŒGoogleæ”¶å½• é¡µé¢ç®€å•åŠ å¯†è®¿é—®æ‰¾åˆ°æ–‡ä»¶themes-&gt;next-&gt;layout-&gt;_partials-&gt;head.swigåœ¨&lt;meta&gt;æ ‡ç­¾ä¹‹åŽæ·»åŠ å¦‚ä¸‹jsä»£ç  12345678910&lt;script&gt; (function()&#123; if('&#123;&#123; page.password &#125;&#125;')&#123; if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') !== '&#123;&#123; page.password &#125;&#125;')&#123; alert('å¯†ç é”™è¯¯ï¼'); history.back(); &#125; &#125; &#125;)();&lt;/script&gt; åœ¨æ–‡ç« çš„Front-matterå®šä¹‰password 123456789---layout: posttitle: HexoåŠ å¯†æ–‡ç« ç¤ºä¾‹date: 2017-03-02category: tags: keywords:password: 123456--- æ·»åŠ ç•™è¨€ç•Œé¢æ·»åŠ pageï¼Œåœ¨åšå®¢æ ¹ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¼šåœ¨sourceç›®å½•ä¸‹é¢åˆ›å»ºmsg/index.mdæ–‡ä»¶ã€‚ 1hexo new page msg é…ç½®æ–‡å­—å’Œå›¾æ ‡ï¼Œæ‰“å¼€themes/next/_config.ymlæ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼Œæ‰èƒ½ä½¿ç•™è¨€çš„ç•Œé¢æ˜¾ç¤º 1234567menu: home: / #about: /about archives: /archives tags: /tags categories: /categories guestbook: /guestbook é…ç½®å›¾æ ‡ï¼Œæ‰“å¼€themes/next/_config.ymlæ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼Œå¯ä»¥è‡ªå®šä¹‰æ˜¾ç¤ºåœ¨ä¾§è¾¹æ çš„ç•™è¨€çš„å›¾æ ‡ï¼Œå›¾æ ‡çš„é…ç½®ä½¿ç”¨key-valueçš„å½¢å¼ï¼Œä¸‹é¢ä»£ç ä¸­home``calendarç­‰éƒ½æ˜¯keyï¼Œä½¿ç”¨è¿™ä¸ªkeyå¯ä»¥ä»Žè¿™ä¸ªç½‘ç«™-FontAwesomeèŽ·å–å›¾æ ‡ï¼Œå¦‚æžœæƒ³æ›´æ¢å›¾æ ‡ï¼Œåªéœ€è¦åŽ»é‚£ä¸ªç½‘ç«™èŽ·å–å›¾æ ‡çš„åå­—åŽ»æŽ‰å¤´éƒ¨çš„iconä½œä¸ºkeyæ·»åŠ åˆ°ä¸‹é¢ä»£ç ä¸­å³å¯ã€‚ 12345678910menu_icons: enable: true home: home about: user categories: th schedule: calendar tags: tags guestbook : comments archives: archive commonweal: heartbeat æ‰“å¼€themes/next/language/zh-CN.ymlæ–‡ä»¶ï¼Œè¿›è¡Œå¦‚ä¸‹é…ç½®ï¼Œæ‰èƒ½æ˜¾ç¤ºä¸º ç•™è¨€ å­—æ · 123456789menu: home: é¦–é¡µ archives: å½’æ¡£ categories: åˆ†ç±» tags: æ ‡ç­¾ about: å…³äºŽ search: æœç´¢ commonweal: å…¬ç›Š404 guestbook: ç•™è¨€ è¿‡æ»¤æ–‡ä»¶ä¸è¿›è¡Œæ¸²æŸ“åœ¨ç»™ç«™ç‚¹æ·»åŠ  README.md å’Œ Googleï¼Œç™¾åº¦ç›¸å…³çš„éªŒè¯æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªæ–‡ä»¶ä¸è¦è¢«ä¸»é¢˜æ¸²æŸ“ï¼Œè€Œæ˜¯æºæ–‡ä»¶ç›´æŽ¥æ‹·è´åˆ° public æ–‡ä»¶å¤¹ä¸­ï¼Œåªéœ€è¦åœ¨ hexo/_config.yml ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®ã€‚ 1234skip_render: - 'README.*' - 'google26933bad87c2b3ba.*' - 'baidu_verify_HnYctWkkrH.*' category åˆ†çº§åœ¨å¤´éƒ¨å¦‚ä¸‹å†™å…¥ categories æ ‡ç­¾ 123categories: - Extensions - Hexo é“¾æŽ¥å”¯ä¸€åŒ–å®‰è£… hexo-abbrlink æ’ä»¶ 1npm install hexo-abbrlink --save é…ç½® hexo/_config.ymlï¼Œæ·»åŠ å¦‚ä¸‹ï¼Œå®ŒæˆåŽæ‰“å¼€æ–‡ä»¶ï¼Œä¿å­˜å‡ æ¬¡ï¼Œä¼šè‡ªåŠ¨æ·»åŠ  abbrlink å±žæ€§ï¼Œå¦‚æžœå·²ç»æœ‰å€¼äº†åˆ™ä¸ä¼šæ›´æ”¹ã€‚ 123456permalink: article/:abbrlink/ # article/ å¯è‡ªè¡Œæ›´æ¢# abbrlink configabbrlink: alg: crc32 # ç®—æ³•ï¼šcrc16(default) and crc32 rep: hex # è¿›åˆ¶ï¼šdec(default) and hex æ–‡ç« åŽ‹ç¼©å®‰è£…æ’ä»¶ hexo-all-minifier 1npm install hexo-all-minifier é…ç½® hexo/_config.ymlï¼Œæ·»åŠ å¦‚ä¸‹ 1234567891011121314151617181920212223242526# æ–‡ç« åŽ‹ç¼©html_minifier: enable: true ignore_error: false exclude:css_minifier: enable: true exclude: - &apos;*.min.css&apos;js_minifier: enable: true mangle: true output: compress: exclude: - &apos;*.min.js&apos;image_minifier: enable: true interlaced: false multipass: false optimizationLevel: 2 pngquant: false progressive: false æ·»åŠ  fork me on githubä¿®æ”¹ hexoBlog/themes/next/layout/_layout.swig æ–‡ä»¶ï¼Œåœ¨ headeræ ‡ç­¾ä¹‹å‰æ·»åŠ å›¾ç‰‡ï¼Œå›¾ç‰‡æ ·å¼å¯ä»¥åˆ°è¯¥ç«™ç‚¹é€‰æ‹©é¢œè‰²å’Œä½ç½®ç­‰ã€‚href ä¸­éœ€è¦ä¿®æ”¹ä½ ä¸ºçš„ github åœ°å€12345678910&lt;div class=&quot;&#123;&#123; container_class &#125;&#125; &#123;% block page_class %&#125;&#123;% endblock %&#125; &quot;&gt; &lt;div class=&quot;headband&quot;&gt;&lt;/div&gt; &lt;!--- add Fork me on Github --&gt; &lt;div class=&quot;forkme&quot;&gt; &lt;a target=&quot;_blank&quot; href=&quot;https://github.com/chendongMarch&quot;&gt;&lt;img style=&quot;position: absolute; top: 0; left: 0; border: 0;&quot; src=&quot;https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67&quot; alt=&quot;Fork me on GitHub&quot; data-canonical-src=&quot;https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png&quot;&gt;&lt;/a&gt; &lt;/div&gt; &lt;!--- add Fork me on Github --&gt; &lt;header id=&quot;header&quot; class=&quot;header&quot; itemscope itemtype=&quot;//schema.org/WPHeader&quot;&gt; åœ¨ head æ ‡ç­¾å†…æ·»åŠ  style ä½¿å°å±å¹•è®¿é—®æ—¶ä¸æ˜¾ç¤ºè¿™ä¸ªå›¾ç‰‡ 123456789101112131415&lt;head&gt; &#123;% include '_partials/head.swig' %&#125; &lt;title&gt;&#123;% block title %&#125;&#123;% endblock %&#125;&lt;/title&gt;&lt;style&gt; .forkme&#123; display: none; &#125;@media (min-width: 768px) &#123; .forkme&#123; display: inline; &#125;&#125; &lt;/style&gt; &#123;% include '_third-party/analytics/index.swig' %&#125;&lt;/head&gt; ä»£ç é£Žæ ¼å¤„ç†æŸ¥çœ‹ hexoBlog/themes/next/source/css/_common/components/highlight/highlight.styl æ–‡ä»¶ï¼Œæ˜¯å¯¹é«˜äº®ä»£ç çš„ç›¸å…³é…ç½®ã€‚æ‰¾åˆ°æ ‡ç­¾ä¿®æ”¹æ—¢å¯ã€‚ 1234567// è¡Œå†…ä»£ç code&#123; // åˆ†è¡Œæ—¶æ˜¯ä¸æ˜¯æ ¹æ®å•è¯åˆ’åˆ† word-wrap: break-all/break-word; // ä»£ç é¢œè‰² color:#fff;&#125; æ·»åŠ æœ¬åœ°æœç´¢å®‰è£…æ’ä»¶ hexo-generator-searchdb 1npm install hexo-generator-searchdb --save é…ç½® hexo/_config.yml 12345search: path: search.xml field: post format: html limit: 10000 é…ç½® next/_config.yml 123# Local searchlocal_search: enable: true æ·»åŠ åŠ è½½è¿›åº¦åœ¨ Next ä¸»é¢˜ä¸‹æ‰“å¼€ `` æ–‡ä»¶ï¼Œåœ¨æœ€åŽè¿½åŠ è¿›åº¦æ¡ 1234567891011121314151617&#123;# æ·»åŠ è¿›åº¦æ¡ #&#125;&lt;script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"&gt;&lt;/script&gt;&lt;link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"&gt;&lt;style&gt; .pace .pace-progress &#123; background: #00d9cf; /*è¿›åº¦æ¡é¢œè‰²*/ height: 2px; &#125; .pace .pace-progress-inner &#123; box-shadow: 0 0 10px #1E92FB, 0 0 5px #1E92FB; /*é˜´å½±é¢œè‰²*/ &#125; .pace .pace-activity &#123; border-top-color: #1E92FB; /*ä¸Šè¾¹æ¡†é¢œè‰²*/ border-left-color: #1E92FB; /*å·¦è¾¹æ¡†é¢œè‰²*/ &#125;&lt;/style&gt; è§£å†³è¡¨æ ¼è¢«ç­‰åˆ†æ–‡ä»¶ themes/next/source/css/_common/scaffolding/tables.styl 1table-layout: auto; æ·»åŠ  Leancloud ç»Ÿè®¡ä»Šå¤©å‘çŽ°ç½‘é¡µè®¿é—®å¾ˆæ…¢ï¼ŒæŸ¥äº†ä¹‹åŽå‘çŽ°ä¸è’œå­ç»Ÿè®¡è®¿é—®å¤ªæ…¢ï¼Œæ¢æˆleancloud,ä½†æ˜¯åªæœ‰pvç»Ÿè®¡ã€‚ å‚è€ƒæ–‡ç«  æŒ‡å®šæ–‡ç« ä¸åœ¨é¦–é¡µæ˜¾ç¤ºæ–‡ä»¶ /Users/march/Documents/hexoBlog/themes/next/layout/index.swig ä¿®æ”¹ã€‚ 123456789101112&lt;section id=&quot;posts&quot; class=&quot;posts-expand&quot;&gt; &#123;% for post in page.posts %&#125; &#123;%if !post.hide %&#125; &#123;&#123; post_template.render(post, true) &#125;&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&lt;/section&gt;// render ä¹‹å‰åˆ¤æ–­&#123;%if !post.hide %&#125; &#123;&#123; post_template.render(post, true) &#125;&#125;&#123;% endif %&#125; ç„¶åŽåœ¨æ–‡ç« æ–‡ä»¶å¤´éƒ¨ï¼Œå¢žåŠ  1234---...hide: true---]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HexoåŠ å¯†æ–‡ç« ç¤ºä¾‹]]></title>
    <url>%2Farticle%2F684233485%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä½¿ç”¨HexoåŠ å¯†]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Extensions</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¿«é€Ÿå®žçŽ°Fragmentåˆ‡æ¢åŠŸèƒ½]]></title>
    <url>%2Farticle%2F4099568815%2F</url>
    <content type="text"><![CDATA[ä¸€ä¸ªappé¦–é¡µé€šå¸¸æ˜¯ä½¿ç”¨Activity + Fragmentçš„å½¢å¼å±•ç¤ºï¼ŒæŽ§åˆ¶Fragmentçš„æ˜¾ç¤ºå’Œéšè—åŸºæœ¬æœ‰ä¸¤ç§å®žçŽ°æ–¹æ³•:&emsp;&emsp;1. ViewPager , æ¯”å¦‚å¾®ä¿¡ , ä¼˜åŠ¿æ˜¯æ‰‹åŠ¿æ“ä½œæ›´åŠ æ–¹ä¾¿ï¼Œå®˜æ–¹æä¾›äº†FragmentPagerAdapterå¯ä»¥å¾ˆæ–¹ä¾¿å¸®åŠ©æˆ‘ä»¬å®žçŽ°æ•°æ®åŠ è½½ï¼ˆFragmentè¦ä½¿ç”¨æ‡’åŠ è½½çš„æ–¹å¼ï¼Œé¿å…æµªè´¹èµ„æºï¼‰ï¼ŒåŠ£åŠ¿å°±æ˜¯å½“ä½ çš„ç¬¬ä¸€ä¸ªFragmentä¸­å·²ç»ä½¿ç”¨äº†ViewPagerï¼Œä¸¤å±‚å¥—ä¸€èµ·äº‹ä»¶ä¼šå†²çªï¼Œè€Œä¸”æ“ä½œä¹Ÿä¸å‹å¥½å•¦ã€‚&emsp;&emsp;2. FragmentManager , æ¯”å¦‚å¤´æ¡ï¼Œé’ˆå¯¹ä½¿ç”¨ViewPagerç»„åˆFragmentçš„é—®é¢˜ï¼Œä½¿ç”¨FragmentManageræŽ§åˆ¶Fragmentçš„æ˜¾ç¤ºå’Œéšè—ï¼Œä¸éœ€è¦è€ƒè™‘æ‡’åŠ è½½çš„é—®é¢˜ï¼Œä¸è¿‡ä¸èƒ½æ”¯æŒæ»‘åŠ¨å•¦ã€‚&emsp;&emsp;3. æœ¬æ–‡ä¸»è¦æ˜¯å°è£…FragmentManageråˆ‡æ¢é¡µé¢çš„ç›¸å…³æ“ä½œã€‚ è®¾è®¡æ€è·¯è®¾è®¡ä¸€ä¸ªç®¡ç†ç±»ï¼Œè´Ÿè´£ Fragment çš„åˆ›å»ºï¼Œæ˜¾ç¤ºï¼Œéšè—ï¼Œå›žæ”¶ç­‰é€»è¾‘ï¼Œæƒ³è¦è¿›è¡Œ Framgnet åˆ‡æ¢çš„ç•Œé¢ï¼Œåªéœ€è¦åˆ›å»ºè¿™ä¸ªç®¡ç†ç±»å®žçŽ°ç›‘å¬å³å¯ï¼Œä»Žè€Œå°†è¿™äº›é€»è¾‘åˆ†ç¦»å‡ºæ¥ï¼Œè¾¾åˆ°å¤ç”¨çš„ç›®çš„ã€‚ å®šä¹‰æŽ¥å£é¦–å…ˆå®šä¹‰ FragmentOperator æŽ¥å£ï¼Œè¿™ä¸ªæŽ¥å£çš„ç›®çš„æ˜¯åœ¨å®Œæˆ Framgent åˆ‡æ¢ä¹‹åŽèƒ½å¤Ÿå‘ŠçŸ¥æ‰€åœ¨çš„ Activity ä½œå‡ºç›¸åº”å“åº”æ“ä½œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061interface FragmentOperator &#123; /** * èŽ·å–æ”¾ç½®fragmentçš„æŽ§ä»¶id * * @return id */ int getFragmentContainerId(); /** * æž„å»ºfragment * * @param showItem å°†è¦å±•ç¤ºçš„fragment pos * @return fragment */ Fragment makeFragment(int showItem); /** * è¿›è¡Œè½¬æ¢ä¹‹å‰åšæ“ä½œ,å®žçŽ°è¯¥æ–¹æ³•å¯ä»¥è‡ªå®šä¹‰fragmentåˆ‡æ¢çš„åŠ¨ç”»æ•ˆæžœç­‰ * * @param transaction transaction */ void beginTransaction(FragmentTransaction transaction); /** * åˆ‡æ¢æˆåŠŸä¹‹åŽä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ­¥é€‰ä¸­ä¹‹åŽçš„æ˜¾ç¤ºçŠ¶æ€ * æ¯”å¦‚æ”¹å˜æŒ‰é’®çš„é¢œè‰²ç­‰æ“ä½œ * * @param selectImage è¢«é€‰ä¸­çš„item */ void syncSelectState(int showItem); /** * å½“ç‚¹å‡»æ˜¾ç¤ºåŒä¸€ä¸ªï¼Œå½“ä¸¤æ¬¡åˆ‡æ¢åˆ°äº†åŒä¸€ä¸ªfragmentï¼Œè¿”å›žtrueæ—¶ä¼šè¿›è¡Œæ­¤æ¬¡åˆ‡æ¢ * * @param showItem æ˜¾ç¤ºçš„item * @return è¿”å›žfalseè¡¨ç¤ºå¿½ç•¥æ­¤æ¬¡ç‚¹å‡»çš„åˆ‡æ¢ */ boolean whenShowSameFragment(int showItem); /** * å½“ç‚¹å‡»æ˜¾ç¤ºçš„ä¸æ˜¯åŒä¸€ä¸ªï¼Œç”¨äºŽéœ€è¦é’ˆå¯¹åˆ‡æ¢åˆ°æŸä¸ªfragmentæ—¶çš„åœºæ™¯ * * @param showItem æ˜¾ç¤ºçš„item * @return è¿”å›žfalseè¡¨ç¤ºå¿½ç•¥æ­¤æ¬¡ç‚¹å‡»çš„åˆ‡æ¢ */ boolean whenShowNotSameFragment(int showItem);&#125;// ä¸Šé¢çš„æŽ¥å£ä¸­ä¸æ˜¯æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯å¿…é¡»çš„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å®žçŽ°public static abstract class SimpleFragmentOperator implements FragmentOper @Override public boolean whenShowNotSameFragment(int showItem) &#123; return true; &#125; @Override public boolean whenShowSameFragment(int showItem) &#123; return false; &#125; @Override public void syncSelectState(int showItem) &#123; &#125; @Override public void beginTransaction(FragmentTransaction transaction) &#123; &#125;&#125; æ ¸å¿ƒæ–¹æ³•ä½¿ç”¨ tag ä½œä¸ºæ ‡è®°æ·»åŠ  fragment ,é¿å…é‡å¤åˆ›å»º 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465private static final String FRAGMENT_ATG = "FragmentHelper";private static final String ITEM_HIDE = "mHideItem";private static final String ITEM_SHOW = "mShowItem";private FragmentOperator operator;private Fragment mCurrentFragment;private FragmentManager mFragmentManager;private int mShowItem, mHideItem;private int mExactlyItem = 0; /** * éšè—å½“å‰æ˜¾ç¤ºçš„fragment,æ˜¾ç¤ºå°†è¦æ˜¾ç¤ºçš„fragment * * @param hideItem éœ€è¦éšè—çš„fragment * @param showItem éœ€è¦æ˜¾ç¤ºçš„fragment * @param isOnCreate æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ä»ŽOnCreateä¸­å¯åŠ¨,ç‚¹å‡»éƒ½æ˜¯false */private void performSelectItem(int hideItem, int showItem, boolean isOnCreate) &#123; // èŽ·å¾—å°†è¦æ˜¾ç¤ºé¡µçš„tag String currentTag = getFragmentTag(hideItem); // éšè—å½“å‰çš„çš„fragment FragmentTransaction transaction = mFragmentManager.beginTransaction(); operator.beginTransaction(transaction); // ç¬¬ä¸€æ¬¡åˆ›å»ºï¼Œä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œä¸éœ€è¦éšè—ï¼Œç›´æŽ¥æ˜¾ç¤º if (mFragmentManager.getFragments() == null) &#123; mShowItem = showItem; mExactlyItem = showItem; mCurrentFragment = operator.makeFragment(showItem); transaction.add(operator.getFragmentContainerId(), mCurrentFragment, getFragmentTag( .show(mCurrentFragment); &#125; else &#123; // ä¼˜åŒ–ï¼Œå¦‚æžœè¢«æ€åŽå†è¿›æ¥ï¼Œå…¨éƒ¨çš„fragmentéƒ½ä¼šè¢«å‘ˆçŽ°æ˜¾ç¤ºçŠ¶æ€ï¼Œæ‰€ä»¥éƒ½éšè—ä¸€é if (isOnCreate &amp;&amp; mFragmentManager.getFragments() != null) &#123; for (Fragment fragment : mFragmentManager.getFragments()) &#123; transaction.hide(fragment); &#125; &#125; else &#123; // æ­£å¸¸æŒ‰é’®ç‚¹å‡»è¿›å…¥ï¼Œéšè—ä¸Šä¸€ä¸ªå³å¯ Fragment lastFragment = mFragmentManager.findFragmentByTag(currentTag); if (lastFragment != null) &#123; transaction.hide(lastFragment); &#125; &#125; // èŽ·å¾—å°†è¦æ˜¾ç¤ºé¡µçš„tag String toTag = getFragmentTag(showItem); // findè¦æ˜¾ç¤ºçš„Fragment mCurrentFragment = mFragmentManager.findFragmentByTag(toTag); if (mCurrentFragment != null) &#123; // å·²ç»å­˜åœ¨åˆ™æ˜¾ç¤º transaction.show(mCurrentFragment); &#125; else &#123; // ä¸å­˜åœ¨åˆ™æ·»åŠ æ–°çš„fragment mCurrentFragment = operator.makeFragment(showItem); if (mCurrentFragment != null) &#123; transaction.add(operator.getFragmentContainerId(), mCurrentFragment, toTag); &#125; &#125; &#125; // åŒæ­¥çŠ¶æ€ operator.syncSelectState(showItem); // ä¿å­˜å½“å‰æ˜¾ç¤ºfragmentçš„item mHideItem = hideItem; mShowItem = showItem; transaction.commitAllowingStateLoss();&#125; æ˜¾ç¤º Fragmentåœ¨ Activity ä¸­ä½¿ç”¨æ—¶åªéœ€è¦è°ƒç”¨ showFragment() æ–¹æ³•å³å¯ 123456789101112131415161718/** * æ˜¾ç¤ºæŸä¸ªfragment * * @param showItem æ˜¾ç¤ºçš„item */public void showFragment(int showItem) &#123; if (showItem == mShowItem) &#123; if (operator.whenShowSameFragment(showItem)) &#123; performSelectItem(mExactlyItem, showItem, false); mExactlyItem = showItem; &#125; &#125; else &#123; if (operator.whenShowNotSameFragment(showItem)) &#123; performSelectItem(mExactlyItem, showItem, false); mExactlyItem = showItem; &#125; &#125;&#125; ä¼˜åŒ–å½“ Activity è¢«å›žæ”¶æ—¶ï¼Œè®°å½•ä¸Šæ¬¡çš„çŠ¶æ€ 123456789101112131415161718192021222324252627282930313233343536// ä¿å­˜æ•°æ®// FragmentHelperpublic void onCreate(Bundle save) &#123; if (save != null) &#123; mHideItem = save.getInt(ITEM_HIDE, 0); mShowItem = save.getInt(ITEM_SHOW, 0); performSelectItem(mHideItem, mShowItem, true); &#125;&#125;// åœ¨Activityé”€æ¯æ—¶è°ƒç”¨@Overrideprotected void onSaveInstanceState(Bundle outState) &#123; super.onSaveInstanceState(outState); if (mFragmentHelper != null) &#123; mFragmentHelper.onSaveInstanceState(outState); &#125;&#125;// é‡æ–°åŠ è½½// FragmentHelperpublic void onCreate(Bundle save) &#123; if (save != null) &#123; mHideItem = save.getInt(ITEM_HIDE, 0); mShowItem = save.getInt(ITEM_SHOW, 0); performSelectItem(mHideItem, mShowItem, true); &#125;&#125;// åœ¨Activityåˆ›å»ºæ—¶è°ƒç”¨@Overridepublic void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); mFragmentHelper = new FragmentHelper(getSupportFragmentManager(), mSimpleOperator); mFragmentHelper.onCreate(savedInstanceState);&#125; ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536373839404142public class TestMultiFragmentActivity2 extends BaseActivity &#123; private FragmentHelper mFragmentHelper; private FragmentHelper.SimpleFragmentOperator mSimpleOperator; @Override public void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); mSimpleOperator = new FragmentHelper.SimpleFragmentOperator() &#123; @Override public int getFragmentContainerId() &#123; return 0; &#125; @Override public Fragment makeFragment(int showItem) &#123; return null; &#125; @Override public void syncSelectState(int showItem) &#123; &#125; &#125;; mFragmentHelper = new FragmentHelper(getSupportFragmentManager(), mSimpleOperator); // åªæœ‰é”€æ¯åŽå›žæ¥æ‰ä¼šè°ƒèµ·åˆ‡æ¢æ“ä½œå¦åˆ™æ²¡ååº” mFragmentHelper.onCreate(savedInstanceState); &#125; @Override protected void onSaveInstanceState(Bundle outState) &#123; super.onSaveInstanceState(outState); if (mFragmentHelper != null) &#123; mFragmentHelper.onSaveInstanceState(outState); &#125; &#125; @Override protected int getLayoutId() &#123; return 0; &#125;&#125; æºä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206/** * CreateAt : 2016/11/5 * Describe : å®žçŽ°Fragmentåˆ‡æ¢ * * @author chendong */public class FragmentHelper &#123; private static final String FRAGMENT_ATG = "FragmentHelper"; private static final String ITEM_HIDE = "mHideItem"; private static final String ITEM_SHOW = "mShowItem"; private FragmentOperator operator; private Fragment mCurrentFragment; private FragmentManager mFragmentManager; private int mShowItem, mHideItem; private int mExactlyItem = 0; public void onCreate(Bundle save) &#123; if (save != null) &#123; mHideItem = save.getInt(ITEM_HIDE, 0); mShowItem = save.getInt(ITEM_SHOW, 0); performSelectItem(mHideItem, mShowItem, true); &#125; &#125; public void onSaveInstanceState(Bundle outState) &#123; outState.putInt(ITEM_HIDE, mHideItem); outState.putInt(ITEM_SHOW, mShowItem); &#125; public FragmentHelper(FragmentManager mFragmentManager, FragmentOperator operator) &#123; this.mFragmentManager = mFragmentManager; this.mFragmentManager = mFragmentManager; this.operator = operator; &#125; /** * æ˜¾ç¤ºæŸä¸ªfragment * * @param showItem æ˜¾ç¤ºçš„item */ public void showFragment(int showItem) &#123; if (showItem == mShowItem) &#123; if (operator.whenShowSameFragment(showItem)) &#123; performSelectItem(mExactlyItem, showItem, false); mExactlyItem = showItem; &#125; &#125; else &#123; if (operator.whenShowNotSameFragment(showItem)) &#123; performSelectItem(mExactlyItem, showItem, false); mExactlyItem = showItem; &#125; &#125; &#125; /** * èŽ·å–å½“å‰å¤„äºŽæ´»åŠ¨çŠ¶æ€çš„fragment' * * @return fragment */ public Fragment getCurrentFragment() &#123; return mCurrentFragment; &#125; /** * éšè—å½“å‰æ˜¾ç¤ºçš„fragment,æ˜¾ç¤ºå°†è¦æ˜¾ç¤ºçš„fragment * * @param hideItem éœ€è¦éšè—çš„fragment * @param showItem éœ€è¦æ˜¾ç¤ºçš„fragment * @param isOnCreate æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ä»ŽOnCreateä¸­å¯åŠ¨,ç‚¹å‡»éƒ½æ˜¯false */ private void performSelectItem(int hideItem, int showItem, boolean isOnCreate) &#123; // èŽ·å¾—å°†è¦æ˜¾ç¤ºé¡µçš„tag String currentTag = getFragmentTag(hideItem); // éšè—å½“å‰çš„çš„fragment FragmentTransaction transaction = mFragmentManager.beginTransaction(); operator.beginTransaction(transaction); // ç¬¬ä¸€æ¬¡åˆ›å»ºï¼Œä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œä¸éœ€è¦éšè—ï¼Œç›´æŽ¥æ˜¾ç¤º if (mFragmentManager.getFragments() == null) &#123; mShowItem = showItem; mExactlyItem = showItem; mCurrentFragment = operator.makeFragment(showItem); transaction.add(operator.getFragmentContainerId(), mCurrentFragment, getFragmentTag(showItem)) .show(mCurrentFragment); &#125; else &#123; // ä¼˜åŒ–ï¼Œå¦‚æžœè¢«æ€åŽå†è¿›æ¥ï¼Œå…¨éƒ¨çš„fragmentéƒ½ä¼šè¢«å‘ˆçŽ°æ˜¾ç¤ºçŠ¶æ€ï¼Œæ‰€ä»¥éƒ½éšè—ä¸€é if (isOnCreate &amp;&amp; mFragmentManager.getFragments() != null) &#123; for (Fragment fragment : mFragmentManager.getFragments()) &#123; transaction.hide(fragment); &#125; &#125; else &#123; // æ­£å¸¸æŒ‰é’®ç‚¹å‡»è¿›å…¥ï¼Œéšè—ä¸Šä¸€ä¸ªå³å¯ Fragment lastFragment = mFragmentManager.findFragmentByTag(currentTag); if (lastFragment != null) &#123; transaction.hide(lastFragment); &#125; &#125; // èŽ·å¾—å°†è¦æ˜¾ç¤ºé¡µçš„tag String toTag = getFragmentTag(showItem); // findè¦æ˜¾ç¤ºçš„Fragment mCurrentFragment = mFragmentManager.findFragmentByTag(toTag); if (mCurrentFragment != null) &#123; // å·²ç»å­˜åœ¨åˆ™æ˜¾ç¤º transaction.show(mCurrentFragment); &#125; else &#123; // ä¸å­˜åœ¨åˆ™æ·»åŠ æ–°çš„fragment mCurrentFragment = operator.makeFragment(showItem); if (mCurrentFragment != null) &#123; transaction.add(operator.getFragmentContainerId(), mCurrentFragment, toTag); &#125; &#125; &#125; // åŒæ­¥çŠ¶æ€ operator.syncSelectState(showItem); // ä¿å­˜å½“å‰æ˜¾ç¤ºfragmentçš„item mHideItem = hideItem; mShowItem = showItem; transaction.commitAllowingStateLoss(); &#125; private String getFragmentTag(int item) &#123; return FRAGMENT_ATG + item; &#125; interface FragmentOperator &#123; /** * èŽ·å–æ”¾ç½®fragmentçš„æŽ§ä»¶id * * @return id */ int getFragmentContainerId(); /** * æž„å»ºfragment * * @param showItem å°†è¦å±•ç¤ºçš„fragment pos * @return fragment */ Fragment makeFragment(int showItem); /** * è¿›è¡Œè½¬æ¢ä¹‹å‰åšæ“ä½œ,å®žçŽ°è¯¥æ–¹æ³•å¯ä»¥è‡ªå®šä¹‰fragmentåˆ‡æ¢çš„åŠ¨ç”»æ•ˆæžœç­‰ * * @param transaction transaction */ void beginTransaction(FragmentTransaction transaction); /** * åˆ‡æ¢æˆåŠŸä¹‹åŽä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ­¥é€‰ä¸­ä¹‹åŽçš„æ˜¾ç¤ºçŠ¶æ€ * æ¯”å¦‚æ”¹å˜æŒ‰é’®çš„é¢œè‰²ç­‰æ“ä½œ * * @param showItem è¢«é€‰ä¸­çš„item */ void syncSelectState(int showItem); /** * å½“ç‚¹å‡»æ˜¾ç¤ºåŒä¸€ä¸ªï¼Œå½“ä¸¤æ¬¡åˆ‡æ¢åˆ°äº†åŒä¸€ä¸ªfragmentï¼Œè¿”å›žtrueæ—¶ä¼šè¿›è¡Œæ­¤æ¬¡åˆ‡æ¢ * * @param showItem æ˜¾ç¤ºçš„item * @return è¿”å›žfalseè¡¨ç¤ºå¿½ç•¥æ­¤æ¬¡ç‚¹å‡»çš„åˆ‡æ¢ */ boolean whenShowSameFragment(int showItem); /** * å½“ç‚¹å‡»æ˜¾ç¤ºçš„ä¸æ˜¯åŒä¸€ä¸ªï¼Œç”¨äºŽéœ€è¦é’ˆå¯¹åˆ‡æ¢åˆ°æŸä¸ªfragmentæ—¶çš„åœºæ™¯ * * @param showItem æ˜¾ç¤ºçš„item * @return è¿”å›žfalseè¡¨ç¤ºå¿½ç•¥æ­¤æ¬¡ç‚¹å‡»çš„åˆ‡æ¢ */ boolean whenShowNotSameFragment(int showItem); &#125; // ä¸Šé¢çš„æŽ¥å£ä¸­ä¸æ˜¯æ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯å¿…é¡»çš„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å®žçŽ° public static abstract class SimpleFragmentOperator implements FragmentOperator &#123; @Override public boolean whenShowNotSameFragment(int showItem) &#123; return true; &#125; @Override public boolean whenShowSameFragment(int showItem) &#123; return false; &#125; @Override public void syncSelectState(int showItem) &#123; &#125; @Override public void beginTransaction(FragmentTransaction transaction) &#123; &#125; &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[EditText]]></title>
    <url>%2Farticle%2F2515477621%2F</url>
    <content type="text"><![CDATA[EditText æ˜¯ TextView çš„å­ç±»ï¼Œç”¨äºŽè¿›è¡Œæ–‡å­—è¾“å…¥ç­‰æ“ä½œï¼Œæ˜¯å¼€å‘ä¸­ç‰¹åˆ«å¸¸ç”¨çš„ä¸€ä¸ªæŽ§ä»¶äº†ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ï¼š æ›´æ”¹EditTextçš„èƒŒæ™¯ è®¾ç½®ç›‘å¬äº‹ä»¶ ç»™EditTextè®¾ç½®å…·æœ‰å¸¦å›¾ç‰‡çš„Hint 2. ç›‘å¬äº‹ä»¶2.1 ç›‘å¬ç„¦ç‚¹å˜åŒ–123456etInput.setOnFocusChangeListener(new OnFocusChangeListener() &#123; @Override public void onFocusChange(View v, boolean hasFocus) &#123; // hasFocus å½“å‰æ˜¯å¦èŽ·å¾—ç„¦ç‚¹ &#125;&#125;); 2.2 æ–‡æœ¬è¾“å…¥ç›‘å¬äº‹ä»¶1234567891011121314etInput.addTextChangedListener(new TextWatcher() &#123; @Override public void beforeTextChanged(CharSequence s, int start, int count, int after) &#123; // æ–‡æœ¬è¾“å…¥ä¹‹å‰å›žè°ƒ &#125; @Override public void onTextChanged(CharSequence s, int start, int before, int count) &#123; // è¾“å…¥è¿‡ç¨‹ä¸­ä¼šé¢‘ç¹å›žè°ƒ &#125; @Override public void afterTextChanged(Editable s) &#123; // è¾“å…¥ç»“æŸå›žè°ƒ &#125;&#125;); 3. è‡ªå®šä¹‰EditTextèƒŒæ™¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“ç¦»å¼€å½“å‰EditTextæ—¶ï¼Œæ£€æŸ¥è¾“å…¥æ˜¯å¦æœ‰é—®é¢˜ï¼Œè¾“å…¥é”™è¯¯ä¼šæ˜¾ç¤ºçº¢è‰² 3.1 å®šä¹‰èƒŒæ™¯drawableæ–‡ä»¶å…¶ä»–å½¢æ€çš„èƒŒæ™¯ä¹Ÿç›¸å¯¹ç®€å•ï¼Œåªæœ‰ä¸€æ¡çº¿çš„è¿™ç§èƒŒæ™¯drawableå†™èµ·æ¥è¿˜æ˜¯éœ€è¦ç ”ç©¶ä¸€ä¸‹çš„ï¼Œç›´æŽ¥ä¸Šä»£ç å•¦,ä¸»è¦æ˜¯ç”¨äº†ä¸€ä¸ªselector -&gt; layer-list -&gt; shape,åœ¨selectå±žæ€§æ”¹å˜æ—¶ï¼Œæ”¹å˜çº¿æ¡çš„é¢œè‰²ã€‚åŽŸæœ¬æ˜¯ä¸€ä¸ªçŸ©å½¢ï¼Œç„¶åŽå°†å¦å¤–ä¸‰ä¸ªè¾¹åç§»ä¸€ä¸‹ï¼Œåªç•™ä¸‹åº•è¾¹ï¼Œè¾¾åˆ°çº¿æ¡æ˜¾ç¤ºçš„æ•ˆæžœã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;selector xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;item android:state_selected="true"&gt; &lt;layer-list xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;item&gt; &lt;shape android:shape="rectangle"&gt; &lt;solid android:color="@android:color/transparent" /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:left="-2dip" android:right="-2dip" android:top="-2dip"&gt; &lt;shape&gt; &lt;solid android:color="@android:color/transparent" /&gt; &lt;stroke android:width="1dip" android:color="@color/red" android:dashGap="0dp" android:dashWidth="0dip" /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;/layer-list&gt; &lt;/item&gt; &lt;item&gt; &lt;layer-list xmlns:android="http://schemas.android.com/apk/res/android"&gt; &lt;item&gt; &lt;shape android:shape="rectangle"&gt; &lt;solid android:color="@android:color/transparent" /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;item android:left="-2dip" android:right="-2dip" android:top="-2dip"&gt; &lt;shape&gt; &lt;solid android:color="@android:color/transparent" /&gt; &lt;stroke android:width="1dip" android:color="@color/colorPrimary" android:dashGap="0dp" android:dashWidth="0dip" /&gt; &lt;/shape&gt; &lt;/item&gt; &lt;/layer-list&gt; &lt;/item&gt;&lt;/selector&gt; 3.2 ç„¦ç‚¹æ”¹å˜æ—¶æ”¹å˜èƒŒæ™¯123456789101112etInput.setOnFocusChangeListener(new OnFocusChangeListener() &#123; @Override public void onFocusChange(View v, boolean hasFocus) &#123; String trim = etInput.getText().toString().trim(); // æ²¡æœ‰ç„¦ç‚¹&amp;&amp;æœ‰æ–‡å­— if (!hasFocus &amp;&amp; trim.length() &gt; 0) &#123; etInput.setSelected(true); &#125; else &#123; etInput.setSelected(false); &#125; &#125; &#125;); 4. å¸¦å›¾ç‰‡çš„Hintå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå®žçŽ°å¸¦æœ‰å›¾ç‰‡çš„hintï¼Œä½¿ç”¨ SpannableStringå®žçŽ° ï¼Œä½†æ˜¯å¼€å§‹çš„æ•ˆæžœä¸æ˜¯å¾ˆç†æƒ³ï¼Œå›¾ç‰‡ä¸èƒ½å¾ˆå¥½çš„å±…ä¸­ï¼Œä½¿ç”¨é‡å†™ImageSpançš„æ–¹æ³•è§£å†³äº†è¿™ä¸ªé—®é¢˜ 4.1 å›¾ç‰‡åž‚ç›´å±…ä¸­çš„span1234567891011121314151617181920212223242526272829303132333435class VerticalCenterImageSpan extends ImageSpan &#123; VerticalCenterImageSpan(Drawable drawable) &#123; super(drawable); &#125; public int getSize(Paint paint, CharSequence text, int start, int end, Paint.FontMetricsInt fontMetricsInt) &#123; Drawable drawable = getDrawable(); Rect rect = drawable.getBounds(); if (fontMetricsInt != null) &#123; Paint.FontMetricsInt fmPaint = paint.getFontMetricsInt(); int fontHeight = fmPaint.bottom - fmPaint.top;// è®¡ç®—æ–‡å­—çš„é«˜åº¦ int drHeight = rect.bottom - rect.top;// è®¡ç®—å›¾ç‰‡çš„é«˜åº¦ int top = drHeight / 2 - fontHeight / 4; int bottom = drHeight / 2 + fontHeight / 4; fontMetricsInt.ascent = -bottom; fontMetricsInt.top = -bottom; fontMetricsInt.bottom = top; fontMetricsInt.descent = top; &#125; return rect.right; &#125; @Override public void draw(Canvas canvas, CharSequence text, int start, int end, float x, int top, int y, int bottom, Paint paint) &#123; Drawable drawable = getDrawable(); canvas.save(); int transY; transY = ((bottom - top) - drawable.getBounds().bottom) / 2 + top; canvas.translate(x, transY); drawable.draw(canvas); canvas.restore(); &#125; &#125; 4.2 è®¾ç½®hint123456789// è®¾ç½®å›¾æ–‡hint private void initEditText(EditText editText) &#123; SpannableString msp = new SpannableString("å›¾ç‰‡ å†™ç‚¹ä»€ä¹ˆå§..."); Drawable drawable = ContextCompat.getDrawable(getContext(), R.drawable.icon_hint_edit); drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight()); // è¿™é‡Œä»Žstart = 0å¼€å§‹ï¼Œend = 2ç»“æŸï¼Œå›¾ç‰‡å–ä»£äº†ä¸¤ä¸ªå­—çš„ä½ç½®ï¼Œä¸Šé¢çš„å­—ç¬¦ä¸²ä¸­å›½å¹´çš„å›¾ç‰‡ä¸¤ä¸ªå­—ä¼šè¢«æ›¿ä»£ msp.setSpan(new VerticalCenterImageSpan(drawable), 0, 2, Spanned.SPAN_EXCLUSIVE_EXCLUSIVE); editText.setHint(msp); &#125; 5 ä¿®æ”¹é”®ç›˜çš„å›žè½¦é”®åœ¨xmlé…ç½® 12android:imeOptions="actionSearch"android:inputType="text" æˆ–åœ¨javaä»£ç ä¸­é…ç½® 12editText.setImeOptions(EditorInfo.IME_ACTION_SEARCH);editText.setInputType(EditorInfo.TYPE_CLASS_TEXT); å®žçŽ°ç›‘å¬ï¼Œè¿›è¡Œç›¸å…³æ“ä½œ 12345678910editText.setOnEditorActionListener(new TextView.OnEditorActionListener() &#123; public boolean onEditorAction(TextView v, int actionId, KeyEvent event) &#123; if (actionId == EditorInfo.IME_ACTION_SEND || (event != null &amp;&amp; event.getKeyCode() == KeyEvent.KEYCODE_ENTER)) &#123; //do something; return true; &#125; return false; &#125;&#125;);]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç§»åŠ¨ç«¯ä¸ŽæœåŠ¡å™¨tokenæœºåˆ¶]]></title>
    <url>%2Farticle%2F1482489498%2F</url>
    <content type="text"><![CDATA[ç§»åŠ¨ç«¯ä¸ŽæœåŠ¡å™¨tokenæœºåˆ¶]]></content>
      <categories>
        <category>Android</category>
        <category>todo</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰æŽ§ä»¶-ä»¿QQç›¸å†Œæ»‘åŠ¨é€‰ä¸­]]></title>
    <url>%2Farticle%2F3936083469%2F</url>
    <content type="text"><![CDATA[æ˜¾ç¤ºç›¸å†Œåœ¨appä¸­æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„æ“ä½œï¼Œå¤§è‡´çš„æ“ä½œå°±æ˜¯é€šè¿‡ContentProviderèŽ·å–å¤šåª’ä½“èµ„æºè¿›è¡Œå±•ç¤ºï¼Œæˆ‘ç»¼åˆäº†ä¸€ä¸‹QQ çš„å’Œå¾®ä¿¡çš„æ˜¾ç¤ºæ•ˆæžœï¼Œå®žçŽ°äº†ä¸€ä¸‹,ä»¿å¾®ä¿¡QQæ˜¾ç¤ºæ‰‹æœºç›¸å†Œï¼Œåœ¨QQçš„ç›¸å†Œé€‰æ‹©æ—¶æ˜¯æ”¯æŒæ»‘åŠ¨é€‰ä¸­çš„ï¼Œå³æ‰‹æŒ‡ç¢°åˆ°å“ªä¸ªå°±é€‰ä¸­å“ªå¼ ç…§ç‰‡ï¼Œæ­£å¥½å…¬å¸çš„é¡¹ç›®ä¸­ç”¨åˆ°äº†è¿™ä¸ªåŠŸèƒ½ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†æ‰¾æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥é€šè¿‡è‡ªå®šä¹‰æŽ§ä»¶å¤„ç†äº‹ä»¶ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»è¿™ä¸ªåŠŸèƒ½çš„å®žçŽ°ã€‚ è‡ªå®šä¹‰æŽ§ä»¶SlidingSelectLayoutçš„æºä»£ç ç‚¹å‡»è¿™é‡ŒèŽ·å– å¤§ä½“æ€è·¯è‡ªå®šä¹‰æŽ§ä»¶å°†ä¼šä½œä¸º RecyclerView çš„çˆ¶æŽ§ä»¶ï¼Œè¿™æ ·ä½¿ä»–å¯ä»¥ä¼˜å…ˆäºŽRecyclerView æ•æ‰äº‹ä»¶ å½“æ‰‹æŒ‡ç«–å‘æ»‘åŠ¨æ—¶ï¼Œçˆ¶æŽ§ä»¶ä¸ä½œå¤„ç†ï¼ŒRecyclerViewå¤„ç†äº‹ä»¶ï¼Œè¿›è¡Œæ»‘åŠ¨ã€‚å½“æ‰‹æŒ‡æ¨ªå‘æ»‘åŠ¨è¾¾åˆ°é˜ˆå€¼æ—¶è‡ªå®šä¹‰çˆ¶æŽ§ä»¶ä¼šæˆªæ–­äº‹ä»¶è‡ªå·±è¿›è¡Œè¿›è¡Œå¤„ç†ã€‚ æ ¹æ®æ‰‹æŒ‡çš„æ»‘åŠ¨MotionEventèŽ·å–x,yåæ ‡ï¼Œä½¿ç”¨RecycelrViewçš„findViewUnder(float x,float y) çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æŽ¥èŽ·å–åˆ¶å®šä½ç½®çš„Viewï¼Œå†ä½¿ç”¨tagä»Žviewä¸­æ‹¿åˆ°ä¹‹å‰ä½¿ç”¨mScl.markView()æ–¹æ³•ç»‘å®šçš„poså’Œdataæ•°æ® ä½¿ç”¨è¯¥æ–¹æ³•å°±ä¸ä¼šå› ä¸ºåŠ¨æ€è®¡ç®—è·ç¦»è€Œå±€é™äºŽRecyclerViewçš„å¸ƒå±€ï¼Œä¹å®«æ ¼æ¨¡å¼ä¸‹ä»ç„¶å¯ä»¥å¾ˆå¥½çš„æ”¯æŒã€‚ åˆå§‹åŒ–å‚æ•°åœ¨å¤„ç†äº‹ä»¶èŽ·å–æ‰‹æŒ‡æ»‘åŠ¨çš„ä½ç½®æ—¶ï¼Œéœ€è¦ä½¿ç”¨RecyclerViewçš„LayoutManagerç­‰ï¼Œä¸ºäº†å°½é‡å¯¹å¤–ç®€åŒ–ä½¿ç”¨çš„æµç¨‹ï¼Œåœ¨æŽ§ä»¶å†…éƒ¨ä½¿ç”¨éåŽ†å­æŽ§ä»¶çš„æ–¹å¼æ¥èŽ·å–RecyclerViewå’ŒGridLayoutManagerçš„åˆ—æ•°ç­‰å‚æ•°ï¼Œåˆå§‹åŒ–ä¸€äº›å€¼ã€‚ èŽ·å– RecyclerView 1234567891011121314151617181920212223242526/** * èŽ·å–RecyclerView */private void ensureTarget() &#123; if (mTargetRv != null) return; View findView = searchInViewGroup(this); if (findView == null) &#123; Logger.e(TAG, "can not find RecyclerView"); &#125; else &#123; mTargetRv = (RecyclerView) findView; &#125;&#125;private View searchInViewGroup(ViewGroup viewGroup) &#123; View rstView = null; for (int i = 0; i &lt; viewGroup.getChildCount(); i++) &#123; View childAt = viewGroup.getChildAt(i); if (childAt instanceof RecyclerView) &#123; rstView = childAt; &#125; else if (childAt instanceof ViewGroup) &#123; rstView = searchInViewGroup((ViewGroup) childAt); &#125; &#125; return rstView;&#125; å¤„ç†LayoutManagerï¼Œåˆå§‹åŒ–xTouchSlopï¼Œè¿™ä¸ªå€¼æ˜¯æ»‘åŠ¨å¤šå¤§è·ç¦»è§¦å‘æ°´å¹³æ»‘åŠ¨ï¼Œæ ¹æ®GridLayoutManagerçš„åˆ—æ•°æ¥åŠ¨æ€è®¾ç½®ã€‚ 12345678910111213141516private void ensureLayoutManager() &#123; if (mTargetRv == null || itemSpanCount != INVALID_PARAM) return; RecyclerView.LayoutManager lm = mTargetRv.getLayoutManager(); if (lm == null) return; if (lm instanceof GridLayoutManager) &#123; GridLayoutManager glm = (GridLayoutManager) lm; itemSpanCount = glm.getSpanCount(); &#125; else &#123; Logger.e(TAG,"æš‚æ—¶ä¸æ”¯æŒå…¶ä»–å¸ƒå±€ç±»åž‹ï¼Œè¯·ä½¿ç”¨GridLayoutManager"); itemSpanCount = 4; &#125; int size = (int) (getResources().getDisplayMetrics().widthPixels / (itemSpanCount * 1.0f)); xTouchSlop = yTouchSlop = size * TOUCH_SLOP_RATE;&#125; æ‹¦æˆªäº‹ä»¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546// å¦‚æžœRecyclerViewæ²¡æœ‰èŽ·å–åˆ°ï¼Œä¸è¿›è¡Œäº‹ä»¶çš„æ‹¦æˆªprivate boolean isReadyToIntercept() &#123; return mTargetRv != null &amp;&amp; mTargetRv.getAdapter() != null &amp;&amp; itemSpanCount != INVALID_PARAM;&#125;@Overridepublic boolean onInterceptTouchEvent(MotionEvent ev) &#123; if (!isEnabled()) return super.onInterceptTouchEvent(ev); // ä¸æ”¯æŒå¤šç‚¹è§¦æ‘¸ int pointerCount = ev.getPointerCount(); if (pointerCount &gt; 1) &#123; return super.onInterceptTouchEvent(ev); &#125; // èŽ·å–RecyclerView ensureTarget(); // åˆå§‹åŒ–å‚æ•° ensureLayoutManager(); if (!isReadyToIntercept()) return super.onInterceptTouchEvent(ev); int action = MotionEventCompat.getActionMasked(ev); switch (action) &#123; case MotionEvent.ACTION_DOWN: // init mInitialDownX = ev.getX(); mInitialDownY = ev.getY(); break; case MotionEvent.ACTION_UP: // stop isBeingSlide = false; break; case MotionEvent.ACTION_MOVE: // handle float xDiff = Math.abs(ev.getX() - mInitialDownX); float yDiff = Math.abs(ev.getY() - mInitialDownY); if (yDiff &lt; yTouchSlop &amp;&amp; xDiff &gt; xTouchSlop) &#123; isBeingSlide = true; &#125; break; &#125; return isBeingSlide;&#125; è§¦æ‘¸äº‹ä»¶å¤„ç†Touchäº‹ä»¶123456789101112131415161718@Overridepublic boolean onTouchEvent(MotionEvent ev) &#123; int action = MotionEventCompat.getActionMasked(ev); switch (action) &#123; case MotionEvent.ACTION_DOWN: break; case MotionEvent.ACTION_UP: // re init æ‰‹æŒ‡æŠ¬èµ·æ—¶é‡ç½® isBeingSlide = false; preViewPos = INVALID_PARAM; break; case MotionEvent.ACTION_MOVE: // æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œè§¦å‘ç›‘å¬äº‹ä»¶ publishSlidingCheck(ev); break; &#125; return isBeingSlide;&#125; èŽ·å–æ•°æ®123456789101112131415// ä»ŽViewä¸­ä½¿ç”¨getTag(int key)èŽ·å–tagï¼Œä¹Ÿå°±æ˜¯ä¹‹å‰åœ¨onBindViewHolderä¸­è®¾ç½®çš„æ•°æ®// ä»ŽTagä¸­èŽ·å–posprivate int getPos(View parentView) &#123; int pos = INVALID_PARAM; Object tag = parentView.getTag(tagPosKey); if (tag != null) pos = (int) tag; return pos; &#125; // ä»Žtagä¸­èŽ·å–dataprivate Object getData(View parentView) &#123; return parentView.getTag(tagDataKey);&#125; è§¦å‘ç›‘å¬ä½¿ç”¨ç›‘å¬å‘å¤–å‘å¸ƒäº‹ä»¶,å°†èŽ·å–çš„poså’Œdataé€šè¿‡ç›‘å¬å‘å¸ƒ 12345678910111213141516171819202122232425/** * å‘å¸ƒç»“æžœ * * @param event äº‹ä»¶ */private void publishSlidingCheck(MotionEvent event) &#123; float x = generateX(event.getX()); float y = generateY(event.getY()); View childViewUnder = mTargetRv.findChildViewUnder(x, y); // fast stop if (onSlidingSelectListener == null || childViewUnder == null) return; int pos = getPos(childViewUnder); Object data = getData(childViewUnder); // fast stop å½“å‰è§¦æ‘¸çš„ç‚¹ä¸Žä¸Šä¸€æ¬¡è§¦æ‘¸çš„ç‚¹ç›¸åŒ || æ²¡æœ‰pos || æ²¡æœ‰æ•°æ® if (preViewPos == pos || pos == INVALID_PARAM || data == null) return; try &#123; // è¿™é‡Œä½¿ç”¨èŒƒåž‹å¼ºåˆ¶è½¬æ¢ onSlidingSelectListener.onSlidingSelect(pos, childViewUnder, data); preViewPos = pos; &#125; catch (ClassCastException e) &#123; Log.e("SlidingSelect", "ClassCastException:å¡«å†™çš„èŒƒåž‹æœ‰è¯¯ï¼Œæ— æ³•è½¬æ¢"); &#125;&#125; æ•ˆæžœæ¼”ç¤ºæ™®é€šæ¨¡å¼æ¼”ç¤ºè§†é¢‘ ä¹å®«æ ¼æ¨¡å¼æ¼”ç¤ºè§†é¢‘ ä½¿ç”¨xml ä¸­ä½¿ç”¨1234567891011&lt;com.march.slidingselect.SlidingSelectLayout android:id="@+id/scl" android:layout_width="match_parent" android:layout_height="match_parent"&gt; &lt;android.support.v7.widget.RecyclerView android:id="@+id/recyclerview" android:layout_width="match_parent" android:layout_height="match_parent" /&gt; &lt;/com.march.slidingselect.SlidingSelectLayout&gt; java ä»£ç ä¸­é…ç½®åœ¨Adapterçš„onBindViewHolderæ–¹æ³•ä¸­å°†poså’Œdataä¸Žviewè¿›è¡Œç»‘å®šï¼Œä¹‹æ‰€ä»¥è¿™æ ·åšæ˜¯ä¸ºäº†å¯ä»¥åœ¨æ‰‹æŒ‡åˆ’è¿‡Itemæ—¶å°†å¯¹åº”çš„æ•°æ®å’Œä½ç½®é€šè¿‡ç›‘å¬å‘é€å›žæ¥ã€‚ 123456789private SlidingSelectLayout mScl;mScl = getView(R.id.scl);class MyAdapter extends RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;&#123; @Override public void onBindViewHolder(RecyclerView.ViewHolder holder, int position) &#123; mScl.markView(holder.itemView,position,demos.get(position)); &#125;&#125; ç›‘å¬å›žè°ƒä½¿ç”¨èŒƒåž‹èŽ·å¾—æ‰‹æŒ‡è§¦æ‘¸åˆ°çš„ä½ç½®å’Œå½“å‰ä½ç½®å¯¹åº”çš„æ•°æ®è¿›è¡Œæ›´æ–°adapter 1234567mScl.setOnSlidingSelectListener(new SlidingSelectLayout.OnSlidingSelectListener&lt;Demo&gt;() &#123; @Override public void onSlidingSelect(int pos, View parentView, Demo data) &#123; demos.get(pos).isChanged = !demos.get(pos).isChanged; adapter.notifyItemChanged(pos); &#125; &#125;); æºä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251package com.march.dev.widget;import android.content.Context;import android.support.v4.view.MotionEventCompat;import android.support.v7.widget.GridLayoutManager;import android.support.v7.widget.RecyclerView;import android.util.AttributeSet;import android.util.Log;import android.view.MotionEvent;import android.view.View;import android.view.ViewGroup;import android.widget.FrameLayout;import com.march.dev.R;import com.march.dev.helper.Logger;/** * Project : CommonLib * Package : com.march.lib.view * CreateAt : 2016/9/12 * Describe : æ»‘åŠ¨é€‰ä¸­ * * @author chendong */public class SlidingSelectLayout extends FrameLayout &#123; public static final String TAG = SlidingSelectLayout.class.getSimpleName(); private static final float TOUCH_SLOP_RATE = 0.15f;// åˆå§‹åŒ–å€¼ private static final int INVALID_PARAM = -1; public SlidingSelectLayout(Context context) &#123; this(context, null); &#125; public SlidingSelectLayout(Context context, AttributeSet attrs) &#123; super(context, attrs); setTagKey(R.id.sliding_pos, R.id.sliding_data); itemSpanCount = INVALID_PARAM; preViewPos = INVALID_PARAM; &#125; private RecyclerView mTargetRv;// å†…éƒ¨çš„rv private int offsetTop; private float xTouchSlop;// æ¨ªè½´æ»‘åŠ¨é˜ˆå€¼ï¼Œè¶…è¿‡é˜ˆå€¼è¡¨ç¤ºè§¦å‘æ¨ªè½´æ»‘åŠ¨ private float yTouchSlop;// çºµè½´æ»‘åŠ¨é˜ˆå€¼ï¼Œè¶…è¿‡é˜ˆå€¼è¡¨ç¤ºè§¦å‘çºµè½´æ»‘åŠ¨ private int itemSpanCount;// æ¨ªå‘çš„itemæ•°é‡ private float mInitialDownX;// down äº‹ä»¶åˆå§‹å€¼ private float mInitialDownY;// down äº‹ä»¶åˆå§‹å€¼ private boolean isBeingSlide;// æ˜¯å¦æ­£åœ¨æ»‘åŠ¨ private int tagPosKey; private int tagDataKey; private int preViewPos; private OnSlidingSelectListener onSlidingSelectListener;// æ»‘åŠ¨é€‰ä¸­ç›‘å¬ @Override public boolean onInterceptTouchEvent(MotionEvent ev) &#123; if (!isEnabled()) return super.onInterceptTouchEvent(ev); // ä¸æ”¯æŒå¤šç‚¹è§¦æ‘¸ int pointerCount = ev.getPointerCount(); if (pointerCount &gt; 1) &#123; return super.onInterceptTouchEvent(ev); &#125; // èŽ·å–RecyclerView ensureTarget(); // åˆå§‹åŒ–å‚æ•° ensureLayoutManager(); if (!isReadyToIntercept()) return super.onInterceptTouchEvent(ev); int action = MotionEventCompat.getActionMasked(ev); switch (action) &#123; case MotionEvent.ACTION_DOWN: // init mInitialDownX = ev.getX(); mInitialDownY = ev.getY(); break; case MotionEvent.ACTION_UP: // stop isBeingSlide = false; break; case MotionEvent.ACTION_MOVE: // handle float xDiff = Math.abs(ev.getX() - mInitialDownX); float yDiff = Math.abs(ev.getY() - mInitialDownY); if (yDiff &lt; yTouchSlop &amp;&amp; xDiff &gt; xTouchSlop) &#123; isBeingSlide = true; &#125; break; &#125; return isBeingSlide; &#125; private float generateX(float x) &#123; return x; &#125; private float generateY(float y) &#123; return y - offsetTop; &#125; private void setTargetRv(RecyclerView mTargetRv) &#123; this.mTargetRv = mTargetRv; &#125; @Override public boolean onTouchEvent(MotionEvent ev) &#123; int action = MotionEventCompat.getActionMasked(ev); switch (action) &#123; case MotionEvent.ACTION_DOWN: break; case MotionEvent.ACTION_UP: // re init æ‰‹æŒ‡æŠ¬èµ·æ—¶é‡ç½® isBeingSlide = false; preViewPos = INVALID_PARAM; break; case MotionEvent.ACTION_MOVE: // æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œè§¦å‘ç›‘å¬äº‹ä»¶ publishSlidingCheck(ev); break; &#125; return isBeingSlide; &#125; /** * åˆå§‹åŒ–å‚æ•° */ private void ensureLayoutManager() &#123; if (mTargetRv == null || itemSpanCount != INVALID_PARAM) return; RecyclerView.LayoutManager lm = mTargetRv.getLayoutManager(); if (lm == null) return; if (lm instanceof GridLayoutManager) &#123; GridLayoutManager glm = (GridLayoutManager) lm; itemSpanCount = glm.getSpanCount(); &#125; else &#123; Logger.e(TAG, "æš‚æ—¶ä¸æ”¯æŒå…¶ä»–å¸ƒå±€ç±»åž‹ï¼Œè¯·ä½¿ç”¨GridLayoutManager"); itemSpanCount = 4; &#125; int size = (int) (getResources().getDisplayMetrics().widthPixels / (itemSpanCount * 1.0f)); xTouchSlop = yTouchSlop = size * TOUCH_SLOP_RATE; &#125; /** * å‘å¸ƒç»“æžœ * * @param event äº‹ä»¶ */ private void publishSlidingCheck(MotionEvent event) &#123; float x = generateX(event.getX()); float y = generateY(event.getY()); View childViewUnder = mTargetRv.findChildViewUnder(x, y); // fast stop if (onSlidingSelectListener == null || childViewUnder == null) return; int pos = getPos(childViewUnder); Object data = getData(childViewUnder); // fast stop å½“å‰è§¦æ‘¸çš„ç‚¹ä¸Žä¸Šä¸€æ¬¡è§¦æ‘¸çš„ç‚¹ç›¸åŒ || æ²¡æœ‰pos || æ²¡æœ‰æ•°æ® if (preViewPos == pos || pos == INVALID_PARAM || data == null) return; try &#123; // è¿™é‡Œä½¿ç”¨èŒƒåž‹å¼ºåˆ¶è½¬æ¢ onSlidingSelectListener.onSlidingSelect(pos, childViewUnder, data); preViewPos = pos; &#125; catch (ClassCastException e) &#123; Log.e("SlidingSelect", "ClassCastException:å¡«å†™çš„èŒƒåž‹æœ‰è¯¯ï¼Œæ— æ³•è½¬æ¢"); &#125; &#125; private void setTagKey(int tagPosKey, int tagDataKey) &#123; this.tagPosKey = tagPosKey; this.tagDataKey = tagDataKey; &#125; /** * è®¾ç½®poså’Œdataä½œä¸ºViewçš„tag * @param parentView * @param pos * @param data */ public void markView(View parentView, int pos, Object data) &#123; parentView.setTag(tagPosKey, pos); parentView.setTag(tagDataKey, data); &#125; private int getPos(View parentView) &#123; int pos = INVALID_PARAM; Object tag = parentView.getTag(tagPosKey); if (tag != null) pos = (int) tag; return pos; &#125; private Object getData(View parentView) &#123; return parentView.getTag(tagDataKey); &#125; /** * æ˜¯å¦å¯ä»¥å¼€å§‹æ‹¦æˆªå¤„ç†äº‹ä»¶ï¼Œå½“recyclerViewæ•°æ®å®Œå…¨okä¹‹åŽå¼€å§‹ * * @return æ˜¯å¦å¯ä»¥å¼€å§‹æ‹¦æˆªå¤„ç†äº‹ä»¶ */ private boolean isReadyToIntercept() &#123; return mTargetRv != null &amp;&amp; mTargetRv.getAdapter() != null &amp;&amp; itemSpanCount != INVALID_PARAM; &#125; /** * èŽ·å–RecyclerView */ private void ensureTarget() &#123; if (mTargetRv != null) return; View findView = searchInViewGroup(this); if (findView == null) &#123; Logger.e(TAG, "can not find RecyclerView"); &#125; else &#123; mTargetRv = (RecyclerView) findView; &#125; &#125; private View searchInViewGroup(ViewGroup viewGroup) &#123; View rstView = null; for (int i = 0; i &lt; viewGroup.getChildCount(); i++) &#123; View childAt = viewGroup.getChildAt(i); if (childAt instanceof RecyclerView) &#123; rstView = childAt; &#125; else if (childAt instanceof ViewGroup) &#123; rstView = searchInViewGroup((ViewGroup) childAt); &#125; &#125; return rstView; &#125; public void setOffsetTop(int offsetTop) &#123; this.offsetTop = offsetTop; &#125; public &lt;D&gt; void setOnSlidingSelectListener(OnSlidingSelectListener&lt;D&gt; onSlidingCheckListener) &#123; this.onSlidingSelectListener = onSlidingCheckListener; &#125; public interface OnSlidingSelectListener&lt;D&gt; &#123; void onSlidingSelect(int pos, View parentView, D data); &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidäº‹ä»¶äº¤äº’]]></title>
    <url>%2Farticle%2F3766638624%2F</url>
    <content type="text"><![CDATA[Androidäº‹ä»¶äº¤äº’,å½“ç”¨æˆ·æ‰‹æŒ‡è§¦ç¢°å±å¹•æ—¶ä¼šè§¦å‘onTouchEvent(MotionEven event)æ–¹æ³•ã€‚ æŽ¨èé˜…è¯»ç®€ä¹¦ï¼MotionEventè¯¦è§£ å¸¸ç”¨äº‹ä»¶1234567MotionEvent.ACTION_DOWN: 0MotionEvent.ACTION_UP: 1MotionEvent.ACTION_MOVE: 2MotionEvent.ACTION_CANCEL: 3MotionEvent.ACTION_OUTSIDE: 4MotionEvent.ACTION_POINTER_DOWN: 5MotionEvent.ACTION_POINTER_UP: 6 èŽ·å–äº‹ä»¶ event.getAction()å’Œevent.getActionMasked()å’ŒMotionEventCompat.getActionMasked(event)éƒ½å¯ä»¥èŽ·å–äº‹ä»¶ç±»åž‹ã€‚å¸¦æœ‰Maskæ ‡å¿—çš„æ–¹æ³•æ˜¯é’ˆå¯¹å¤šç‚¹è§¦æŽ§çš„æƒ…å†µæ‹¿åˆ°çš„æŽ©ç ã€‚å¤šç‚¹è§¦æŽ§æ—¶ï¼ŒèŽ·å–Actionä¼šè¿”å›žæ¯ä¸ªè§¦æ‘¸ç‚¹çš„äº‹ä»¶ï¼Œå…¶ä¸­ä½¿ç”¨pointerIndexåŒºåˆ†æ¯ä¸ªè§¦æ‘¸ç‚¹ã€‚ ä¸ºäº†èƒ½è¡¨ç¤ºæ¯ä¸ªpointerIndexå¯¹åº”çš„äº‹ä»¶ï¼Œä»¥åŠæ›´æ–¹ä¾¿è½¬åŒ–ï¼Œæ¯ä¸ªèŽ·å–çš„actionå®žé™…ä¸Šæ˜¯pointerIndexå’Œeventæ‹¼æŽ¥æˆçš„16è¿›åˆ¶è¡¨ç¤ºï¼Œæ¯”å¦‚ç¬¬äºŒä¸ªç‚¹çš„Moveäº‹ä»¶ï¼Œè¿”å›žçš„å€¼æ˜¯0x0100,01è¡¨ç¤ºpointerIndex,00è¡¨ç¤ºDownäº‹ä»¶ï¼Œæ‰€ä»¥è¿”å›žçš„actionçš„å€¼ä¸º256. å•ç‚¹è§¦æ‘¸æ—¶åªæœ‰ä¸€ä¸ªpointerIndex = 0,æ‰€ä»¥èŽ·å–çš„åˆ°çš„actionå®žé™…ä¸Šæ˜¯0x0000(Downäº‹ä»¶)ï¼Œ0x0001(UPäº‹ä»¶)ã€‚ã€‚ã€‚æ‰€ä»¥ç»“æžœå’Œäº‹ä»¶çš„å€¼æ˜¯ä¸€æ ·çš„ã€‚ å½“å¤šç‚¹è§¦æ‘¸æ—¶ï¼Œç¬¬ä¸€ä¸ªç‚¹çš„Downäº‹ä»¶0x0000,ç¬¬äºŒä¸ªç‚¹çš„Downäº‹ä»¶0x0100,æ­¤æ—¶ç®€å•çš„getAction()æ–¹æ³•å¹¶ä¸èƒ½èŽ·å–æ­£ç¡®çš„äº‹ä»¶å€¼ã€‚ getActionMasked()æ–¹æ³•æ˜¯å°†getAction()çš„å€¼ä¸ŽACTION_MASKåšâ€˜ä¸Žâ€™è¿ç®—ï¼Œä¾‹å¦‚å½“æœ‰ä¸€ä¸ªäº‹ä»¶æ˜¯0x0102,èŽ·å–æŽ©ç æ—¶å¯ä»¥è¿‡æ»¤æŽ‰pointerIndexçš„å€¼èŽ·å–eventçš„å€¼ï¼Œevent.getActionMasked()åŽŸç†å¤§è‡´ç›¸åŒã€‚ æè¿° å€¼ getAction()åå…­è¿›åˆ¶è¡¨ç¤º 0x0101 ACTION_MASKåå…­è¿›åˆ¶è¡¨ç¤º 0x00ff getAction()äºŒè¿›åˆ¶è¡¨ç¤º 000001 000001 ACTION_MASKäºŒè¿›åˆ¶è¡¨ç¤º 000000 011111 getActionMasked()äºŒè¿›åˆ¶è¡¨ç¤º 000000 000001 getActionMasked()åå…­è¿›åˆ¶è¡¨ç¤º 0x0001(Moveäº‹ä»¶) 1234public static final int ACTION_MASK = 0xff;public static int getActionMasked(MotionEvent event) &#123; return event.getAction() &amp; ACTION_MASK;&#125; MotionEventCompat.getActionMasked()æ˜¯å¯¹ç‰ˆæœ¬å…¼å®¹çš„æ–¹æ³•ã€‚æŽ¨èä½¿ç”¨è¿™ä¸ªç±»è¿›è¡Œç›¸å…³æ“ä½œè¾¾åˆ°å…¼å®¹ç‰ˆæœ¬çš„ç›®çš„ã€‚ Pointer pointer , pointerIndex , event , action , poiterId pointerä»£è¡¨ä¸€ä¸ªè§¦æ‘¸ç‚¹ pointerIndexæ˜¯pointeråœ¨MotionEventä¸­çš„ç´¢å¼• eventä»£è¡¨äº‹ä»¶ï¼Œæ¯”å¦‚0(Down),1(UP)â€¦ actionæ˜¯pointerIndexå’Œeventæ‹¼æŽ¥çš„åå…­è¿›åˆ¶å½¢å¼ pointerIdæ˜¯ä¸€ä¸ªpointerçš„å”¯ä¸€æ ‡ç¤ºï¼Œä»–åœ¨æ•´ä¸ªäº‹ä»¶æµä¸­æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œä½†æ˜¯pointerIndexçš„å€¼ä¼šæ”¹å˜ï¼Œæ¯”å¦‚ï¼Œå…ˆåŽæ”¾ç½®ä¸‰ä¸ªæŒ‡å¤´åœ¨å±å¹•ä¸Šä¼šæŽ¥æ”¶åˆ°0x0000(ç¬¬ä¸€ä¸ªæŒ‡å¤´Downäº‹ä»¶),0x0105(ç¬¬äºŒä¸ªæŒ‡å¤´Pointer_Downäº‹ä»¶),0x0205(ç¬¬ä¸‰ä¸ªæŒ‡å¤´Pointer_Downäº‹ä»¶),æŠ¬èµ·ç¬¬äºŒä¸ªæŒ‡å¤´æ—¶ä¼šè§¦å‘0x0106(Pointer_Up),å†æŠ¬èµ·ç¬¬ä¸‰ä¸ªæŒ‡å¤´ä¹Ÿä¼šè§¦å‘0x0106(Pointer_Up),ä¹Ÿå°±æ˜¯è¯´æŠ¬èµ·ç¬¬äºŒä¸ªæŒ‡å¤´ä¹‹åŽç¬¬ä¸‰ä¸ªæŒ‡å¤´çš„indexç”±02å˜æˆäº†01,æ‰€ä»¥indexåªæ˜¯MotionEvnetä¸­æ¯ä¸ªäº‹ä»¶çš„ä¸‹æ ‡ï¼Œä¸Žäº‹ä»¶ä¸èƒ½å½¢æˆæ ‡å¿—æ€§çš„å…³ç³»ã€‚ MotionEventCompat MotionEventCompatæ˜¯ä¸€ä¸ªé’ˆå¯¹äº‹ä»¶å¤„ç†æä¾›çš„è¾…åŠ©ç±»ï¼Œå†…éƒ¨åšäº†ç‰ˆæœ¬å…¼å®¹ã€‚ getActionIndex(MotionEvent event)èŽ·å–è¯¥äº‹ä»¶çš„ç´¢å¼•ï¼Œæœ‰ç‚¹ç±»ä¼¼äºŽMotionEventCompat.getActionMasked(),éƒ½ä½¿ç”¨â€˜ä¸Žâ€™è¿ç®—ï¼Œåªä¸è¿‡ä¸€ä¸ªå–çš„æ˜¯é«˜ä½çš„pointerIndex,åŽè€…å–å¾—æ˜¯ä½Žä½çš„eventäº‹ä»¶ã€‚ 1234public static int getActionIndex(MotionEvent event) &#123; return (event.getAction() &amp; ACTION_POINTER_INDEX_MASK) &gt;&gt; ACTION_POINTER_INDEX_SHIFT; &#125; getPointerId(MotionEvent event, int pointerIndex)åœ¨ä¸€ä¸ªMotionEventä¸­æ ¹æ®è§¦æ‘¸ç‚¹pointerIndexçš„å€¼èŽ·å–pointerId 123public static int getPointerId(MotionEvent event, int pointerIndex) &#123; return IMPL.getPointerId(event, pointerIndex);&#125; findPointerIndex(MotionEvent event, int pointerId)åœ¨ä¸€ä¸ªMotionEventä¸­æ ¹æ®pointerIdèŽ·å–pointerIndex 123public static int findPointerIndex(MotionEvent event, int pointerId) &#123; return IMPL.findPointerIndex(event, pointerId);&#125; ä»Žä¸€ä¸ªMotionEventä¸­æ ¹æ®pointerIndexèŽ·å–å¯¹åº”è§¦æ‘¸ç‚¹çš„XYåæ ‡ 123456public static float getX(MotionEvent event, int pointerIndex) &#123; return IMPL.getX(event, pointerIndex);&#125;public static float getY(MotionEvent event, int pointerIndex) &#123; return IMPL.getY(event, pointerIndex);&#125;]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†æžSwipeRefreshLayoutå®žçŽ°è‡ªå®šä¹‰åˆ·æ–°]]></title>
    <url>%2Farticle%2F308486771%2F</url>
    <content type="text"><![CDATA[å‰è¨€ åˆ†æžSwipeRefreshLayoutçš„æºä»£ç æ¥æ·±å…¥çš„ç†è§£ä¸€ä¸‹å…³äºŽåˆ·æ–°çš„äº‹ä»¶å¤„ç†å’ŒNestedScrollingæœºåˆ¶çš„ä½¿ç”¨ã€‚Android5.0ä¹‹åŽå®˜æ–¹æŽ¨å‡ºäº†SwipeRefreshLayoutæ¥å®žçŽ°ä¸‹æ‹‰åˆ·æ–°ï¼Œå½“ç„¶è¿˜æœ‰å¾ˆå¤šå…¶ä»–æŽ§ä»¶ï¼Œå› ä¸ºåƒä¸‹æ‹‰åˆ·æ–°ï¼ŒæŠ½å±‰æ•ˆæžœï¼ŒtabLayoutæ•ˆæžœå‡ ä¹Žæ˜¯æ¯ä¸ªAppéƒ½éœ€è¦çš„ï¼Œåœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­Androidæ²¡æœ‰å®šä¹‰è¿™äº›æŽ§ä»¶ï¼Œå› æ­¤GitHubä¸Šä¹Ÿæ¶ŒçŽ°äº†å¤§é‡çš„è‡ªå®šæŽ§ä»¶çš„åº“ï¼Œå¤§å®¶å¯ä»¥å¾ˆæ–¹ä¾¿çš„å¼•ç”¨è¿™äº›åº“å®žçŽ°æ•ˆæžœï¼Œæ¯”å¦‚å¾ˆç«çš„pull-to-refreshä»¥åŠåŽæ¥çš„ultra-pull-to-refreshã€‚Androidåœ¨æŽ¨å‡ºSwipeRefreshLayoutä¹‹åŽå¹¶æ²¡æœ‰åœ¨å›½å†…å¾—åˆ°å¾ˆå¥½çš„ä½¿ç”¨ï¼Œå¤§å®¶è¿˜æ˜¯åœ¨ç”¨è‡ªå·±çš„åˆ·æ–°å’Œå¼€æºåº“æ¥å®žçŽ°ã€‚å¯èƒ½æ˜¯å› ä¸ºï¼š SwipeRefreshLayoutçš„æ•ˆæžœè·Ÿä»¥å‰çš„åˆ·æ–°æ•ˆæžœæœ‰äº›å‡ºå…¥ï¼Œå¤§å®¶æŽ¥å—äº†ä»¥å‰çš„æ•ˆæžœå¯¹æ–°çš„æ•ˆæžœä¸å¤ªæ»¡æ„ã€‚ SwipeRefreshLayoutè‡ªå®šä¹‰åº¦ä¸å¼ºï¼Œæ¯ä¸ªAppéƒ½æƒ³æœ‰è‡ªå·±çš„ç‰¹è‰²ï¼Œè‡ªç„¶ä¸æ„¿æ„é‡‡ç”¨å¤§ä¼—çš„åšæ³•ã€‚ è¿™ç¯‡æ–‡ç« çš„ç›®çš„å°±æ˜¯ï¼Œç†è§£SwipeRefreshLayout çš„å®žçŽ°ï¼ŒåŸºäºŽSwipeRefreshLayoutå®žçŽ°ç±»ä¼¼ä¼ ç»Ÿçš„åˆ·æ–°æ•ˆæžœå¹¶æ”¯æŒè‡ªå®šä¹‰ã€‚]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>SourceCode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NestedScrollingäº¤äº’]]></title>
    <url>%2Farticle%2F2940188893%2F</url>
    <content type="text"><![CDATA[å‰è¨€äº¤äº’ è§¦å‘æ—¶æœº NestedScrollChild NestedScrollParent Down startNestScroll onStartNestScroll onNestScrollAccept Move dispatchNestPreScroll onNestPreScroll dispatchNestScroll onNestScroll Up stopNest]]></content>
      <categories>
        <category>Android</category>
        <category>todo</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NestedScrollingParentåˆ†æž]]></title>
    <url>%2Farticle%2F1655050953%2F</url>
    <content type="text"><![CDATA[å‰è¨€ å¯¹NestedScrollingParentæŽ¥å£è¿›è¡Œåˆ†æžï¼Œä¸»è¦æ˜¯æ–‡æ¡£çš„ç¿»è¯‘å’Œä¸€äº›ç†è§£ï¼Œä»¥åŠæ¯ä¸ªæ–¹æ³•è§¦å‘çš„æ—¶æœºã€‚ NestedScrollingParentæŽ¥å£ This interface should be implemented by {@link android.view.ViewGroup ViewGroup} subclassesthat wish to support scrolling operations delegated by a nested child view. ç¿»è¯‘ï¼šè¿™ä¸ªæŽ¥å£è¢«ViewGroupçš„å­ç±»å®žçŽ°æ¥æ”¯æŒå¤„ç†nestå­è§†å›¾çš„æ»‘åŠ¨æ“ä½œã€‚ Classes implementing this interface should create a final instance of a {@link NestedScrollingParentHelper} as a field and delegate any View or ViewGroup methodsto the NestedScrollingParentHelper methods of the same signature. ç¿»è¯‘ï¼šå®žçŽ°è¿™ä¸ªæŽ¥å£çš„ç±»åº”è¯¥åˆ›å»ºä¸€ä¸ªfinalç±»åž‹çš„NestedScrollingParentHelperå®žä¾‹ä½œä¸ºä¸€ä¸ªå±žæ€§ï¼Œæ¥ä»£ç†NestedScrollingParentä¸­ä¸ŽNestedScrollingParentHelperå…·æœ‰ç›¸åŒæ–¹æ³•åå­—çš„æ“ä½œã€‚ Views invoking nested scrolling functionality should always do so from the relevant {@link ViewCompat}, {@link ViewGroupCompat} or {@link ViewParentCompat} compatibility shim static methods. This ensures interoperability with nested scrolling views on Android 5.0 Lollipop and newer. ç¿»è¯‘ï¼šViewè°ƒç”¨åµŒå¥—æ»‘åŠ¨çš„ç›¸å…³åŠŸèƒ½æ—¶åº”è¯¥ä»Žç›¸å…³çš„ViewCompatï¼ŒViewGroupCompatï¼ŒViewParentCompatè°ƒç”¨å…¼å®¹çš„é™æ€æ–¹æ³•ï¼Œè¿™ä¿è¯äº†åœ¨5.0æˆ–è€…æ›´æ–°ç‰ˆæœ¬ä¸­ä¸ŽåµŒå¥—æ»‘åŠ¨çš„äº’ç”¨æ€§ã€‚ onStartNestedScrollæ–¹æ³•1public boolean onStartNestedScroll(View child, View target, int nestedScrollAxes); å‚æ•°å’Œè¿”å›žå€¼ 12345678//ViewParentåŒ…æ¶µçš„ç›´æŽ¥çš„å­View@param child Direct child of this ViewParent containing target //å¯åŠ¨åµŒå¥—æ»‘åŠ¨æ“ä½œçš„View@param target View that initiated the nested scroll //flagåž‚ç›´æ»‘åŠ¨è¿˜æ˜¯æ°´å¹³æ»‘åŠ¨@param nestedScrollAxes Flags consisting of &#123;@link ViewCompat#SCROLL_AXIS_HORIZONTAL&#125;, &#123;@link ViewCompat#SCROLL_AXIS_VERTICAL&#125; or both //å¦‚æžœè¿”å›žtrueä»£è¡¨çˆ¶ViewæŽ¥å—æ¶ˆè€—è¿™ä¸ªæ»‘åŠ¨æ“ä½œã€‚@return true if this ViewParent accepts the nested scroll operation React to a descendant view initiating a nestable scroll operation, claiming the nested scroll operation if appropriate. ç¿»è¯‘ï¼šå¯¹ä¸€ä¸ªæ´¾ç”ŸViewçš„åµŒå¥—æ»‘åŠ¨æ“ä½œä½œå‡ºååº”ï¼Œå¦‚æžœéœ€è¦çš„è¯å°†ä¼šæ‹¦æˆªï¼ˆæ¶ˆè€—ï¼‰è¿™ä¸ªæ»‘åŠ¨æ“ä½œã€‚ This method will be called in response to a descendant view invoking ink ViewCompat#startNestedScroll(View, int)}. Each parent up the view hierarchy will be given an opportunity to respond and claim the nested scrolling operation by returning true. ç¿»è¯‘ï¼šè¿™ä¸ªæ–¹æ³•å°†ä¼šè¢«ä½œä¸ºæ´¾ç”ŸViewè°ƒç”¨ViewCompat.startNestedScroll(View, int)æ—¶çš„å›žå¤å“åº”ï¼Œæ¯ä¸ªä¸Šå±‚çš„çˆ¶è§†å›¾å¦‚æžœè¿™ä¸ªæ–¹æ³•è¿”å›žtrue,éƒ½å°†æœ‰æœºä¼šå“åº”å’Œæ‹¦æˆªï¼ˆæ¶ˆè€—ï¼‰è¿™ä¸ªåµŒå¥—æ»‘åŠ¨æ“ä½œ. onNestedScrollAcceptedæ–¹æ³•1public void onNestedScrollAccepted(View child, View target, int nestedScrollAxes); React to the successful claiming of a nested scroll operation. ç¿»è¯‘ï¼šå¯¹åµŒå¥—æ»‘åŠ¨æ“ä½œçš„æˆåŠŸå£°æ˜Žä½œå‡ºå“åº”ï¼Œ This method will be called after {@link #onStartNestedScroll(View, View, int) onStartNestedScroll} returns true. It offers an opportunity for the view and its superclasses to perform initial configuration for the nested scroll. Implementations of this method should always call their superclassâ€™s implementation of this method if one is present. ç¿»è¯‘ï¼šè¿™ä¸ªæ–¹æ³•å°†ä¼šåœ¨ onStartNestedScrollæ–¹æ³•è¿”å›žtrueæ—¶è¢«è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•æä¾›ç»™Viewå’Œä»–çš„çˆ¶ç±»ä¸€ä¸ªå¯¹åµŒå¥—æ»‘åŠ¨æ“ä½œè¿›è¡Œåˆå§‹åŒ–é…ç½®çš„æœºä¼šã€‚å¦‚æžœçˆ¶ç±»å¯¹è¯¥æ–¹æ³•æœ‰æ“ä½œï¼Œå®žçŽ°æ­¤æ–¹æ³•åº”è¯¥è°ƒç”¨çˆ¶ç±»çš„å®žçŽ°ã€‚ onStopNestedScrollæ–¹æ³•1public void onStopNestedScroll(View target); å‚æ•°å’Œè¿”å›žå€¼ 12//è§¦å‘åµŒå¥—æ»‘åŠ¨çš„View@param target View that initiated the nested scroll React to a nested scroll operation ending. ç¿»è¯‘ï¼šå¯¹åµŒå¥—æ»‘åŠ¨ç»“æŸåšå‡ºå“åº” Perform cleanup after a nested scrolling operation.This method will be called when a nested scroll stops, for example when a nested touch scroll ends with a {@link MotionEvent#ACTION_UP} or {@link MotionEvent#ACTION_CANCEL} event. Implementations of this method should always call their superclassâ€™s implementation of this method if one is present. ç¿»è¯‘ï¼šç¡®è®¤åœ¨åµŒå¥—æ»‘åŠ¨æ“ä½œç»“æŸä¹‹åŽçš„æ¸…ç†æ“ä½œï¼Œæ¯”å¦‚ä¸€äº›å‚æ•°çš„é‡æ–°åˆå§‹åŒ–ï¼Œè¿™ä¸ªæ–¹æ³•å°†ä¼šåœ¨åµŒå¥—æ»‘åŠ¨æ“ä½œç»“æŸåŽè°ƒç”¨ï¼Œæ¯”å¦‚åµŒå¥—æ»‘åŠ¨æ“ä½œå› ä¸ºACTION_UPï¼ŒACTION_CANCELäº‹ä»¶è¢«ç»ˆæ­¢ã€‚å¦‚æžœçˆ¶ç±»å¯¹è¯¥æ–¹æ³•æœ‰æ“ä½œï¼Œå®žçŽ°æ­¤æ–¹æ³•åº”è¯¥è°ƒç”¨çˆ¶ç±»çš„å®žçŽ°ã€‚ onNestedScrollæ–¹æ³•1public void onNestedScroll(View target, int dxConsumed, int dyConsumed, int dxUnconsumed, int dyUnconsumed); å‚æ•°å’Œè¿”å›žå€¼ 12345678910// æŽ§åˆ¶åµŒå¥—æ»‘åŠ¨çš„å­View@param target The descendent view controlling the nested scroll// å­Viewæ°´å¹³æ»‘åŠ¨æ¶ˆè€—çš„è·ç¦»@param dxConsumed Horizontal scroll distance in pixels already consumed by target// å­Viewåž‚ç›´æ»‘åŠ¨æ¶ˆè€—çš„è·ç¦»@param dyConsumed Vertical scroll distance in pixels already consumed by target// å­Viewæ°´å¹³æ»‘åŠ¨æ²¡æœ‰æ¶ˆè€—çš„è·ç¦»@param dxUnconsumed Horizontal scroll distance in pixels not consumed by target// å­Viewæ°´å¹³æ»‘åŠ¨æ²¡æœ‰æ¶ˆè€—çš„è·ç¦»@param dyUnconsumed Vertical scroll distance in pixels not consumed by target React to a nested scroll in progress. ç¿»è¯‘ï¼šå¯¹æ»‘åŠ¨è¿‡ç¨‹ä½œå‡ºå“åº” This method will be called when the ViewParentâ€™s current nested scrolling child view dispatches a nested scroll event. To receive calls to this method the ViewParent must have previously returned true for a call to {@link #onStartNestedScroll(View, View, int)}. ç¿»è¯‘ï¼šè¿™ä¸ªæ–¹æ³•å°†ä¼šåœ¨ViewParentä¸­å½“å‰æ­£åœ¨åµŒå¥—æ»‘åŠ¨çš„å­Viewåˆ†å‘åµŒå¥—æ»‘åŠ¨äº‹ä»¶æ—¶è¢«è°ƒç”¨ã€‚ä¸ºäº†èƒ½å¤ŸæŽ¥å—åˆ°è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ŒViewParentå¿…é¡»äº‹å…ˆåœ¨onStartNestedScrollè¿”å›žtrueã€‚ Both the consumed and unconsumed portions of the scroll distance are reported to the ViewParent. An implementation may choose to use the consumed portion to match or chase scroll position of multiple child elements, for example. The unconsumed portion may be used to allow continuous dragging of multiple scrolling or draggable elements, such as scrolling a list within a vertical drawer where the drawer begins dragging once the edge of inner scrolling content is reached. ç¿»è¯‘ï¼šæ¶ˆè€—éƒ¨åˆ†å’Œæ²¡æœ‰æ¶ˆè€—éƒ¨åˆ†çš„åµŒå¥—æ»‘åŠ¨çš„è·ç¦»éƒ½è¢«ä¸ŠæŠ¥ç»™ViewParentã€‚ä¸€ä¸ªå®žçŽ°å¯ä»¥é€‰æ‹©ä½¿ç”¨æ¶ˆè€—çš„éƒ¨åˆ†æ¥åŒ¹é…æˆ–è¿½é€å¤šä¸ªå­å…ƒç´ çš„æ»šåŠ¨ä½ç½®ï¼Œä¾‹å¦‚ã€‚æœªä½¿ç”¨çš„éƒ¨åˆ†å¯ä»¥ç”¨æ¥å…è®¸è¿žç»­æ»šåŠ¨æˆ–æ‹–åŠ¨æ‹–åŠ¨å¤šå…ƒç´ ï¼Œå¦‚åœ¨ä¸€ä¸ªåž‚ç›´çš„æŠ½å±‰å†…æ»šåŠ¨ä¸€ä¸ªåˆ—è¡¨ï¼ŒæŠ½å±‰å¼€å§‹æ‹–åŠ¨æ»šåŠ¨è¾¾åˆ°å†…å®¹çš„è¾¹ç¼˜ã€‚ onNestedPreScrollæ–¹æ³•1public void onNestedPreScroll(View target, int dx, int dy, int[] consumed); å‚æ•°å’Œè¿”å›žå€¼ 12345678// å‘èµ·åµŒå¥—æ»‘åŠ¨çš„å­View@param target View that initiated the nested scroll// æ°´å¹³æ»‘åŠ¨çš„è·ç¦»@param dx Horizontal scroll distance in pixels// åž‚ç›´æ»‘åŠ¨çš„è·ç¦»@param dy Vertical scroll distance in pixels// è¾“å‡º,æ°´å¹³æ»‘åŠ¨å’Œåž‚ç›´æ»‘åŠ¨è¢«çˆ¶Viewæ¶ˆè€—çš„è·ç¦»@param consumed Output. The horizontal and vertical scroll distance consumed by this parent React to a nested scroll in progress before the target view consumes a portion of the scroll. æ»‘åŠ¨è¿‡ç¨‹ä¸­åœ¨å‘èµ·åµŒå¥—æ»‘åŠ¨çš„å­Viewæ¶ˆè€—æ»‘åŠ¨è·ç¦»ä¹‹å‰ä½œå‡ºååº” When working with nested scrolling often the parent view may want an opportunity to consume the scroll before the nested scrolling child does. An example of this is a drawer that contains a scrollable list. The user will want to be able to scroll the list fully into view before the list itself begins scrolling. åœ¨è¿›è¡ŒåµŒå¥—æ»‘åŠ¨æ—¶ï¼Œé€šå¸¸çˆ¶Viewå¸Œæœ›èŽ·å¾—æœºä¼šåœ¨å­Viewä¹‹å‰æ¶ˆè€—æ»‘åŠ¨è·ç¦»ã€‚ä¾‹å¦‚ï¼ŒæŠ½å±‰é‡Œé¢åŒ…å«ä¸€ä¸ªå¯ä»¥æ»‘åŠ¨çš„list,ç”¨æˆ·å°†å¸Œæœ›èƒ½å¤Ÿåœ¨åˆ—è¡¨æœ¬èº«å¼€å§‹æ»šåŠ¨ä¹‹å‰å°†åˆ—è¡¨å®Œå…¨æ»šåŠ¨åˆ°è§†å›¾ä¸­ã€‚ onNestedPreScroll is called when a nested scrolling child invokes {@link View#dispatchNestedPreScroll(int, int, int[], int[])}. The implementation should report how any pixels of the scroll reported by dx, dy were consumed in the consumed array. Index 0 corresponds to dx and index 1 corresponds to dy. This parameter will never be null. Initial values for consumed[0] and consumed[1] will always be 0. onNestedPreScroll æ–¹æ³•åœ¨å­Viewè°ƒç”¨dispatchNestedPreScrollæ–¹æ³•æ—¶è¢«è°ƒç”¨ã€‚è¿™ä¸ªæ–¹æ³•çš„å®žçŽ°åº”è¯¥æŠ¥å‘Šå¯¹dxå’Œdyè¿›è¡Œäº†å¤šå°‘æ¶ˆè€—ã€‚consumed[0]ä»£è¡¨æ¶ˆè€—çš„dx,consumed[1]ä»£è¡¨æ¶ˆè€—çš„dy,è¿™ä¸ªå‚æ•°ä¸ä¼šä¸ºç©ºï¼Œconsumed[0]å’Œconsumed[1]åˆå§‹å€¼ä¸º0ã€‚ onNestedFlingæ–¹æ³•1public boolean onNestedFling(View target, float velocityX, float velocityY, boolean consumed); å‚æ•°å’Œè¿”å›žå€¼ 12345678910// å‘èµ·åµŒå¥—æ»‘åŠ¨çš„å­View@param target View that initiated the nested scroll// æ¨ªå‘æ»‘åŠ¨çš„é€Ÿåº¦@param velocityX Horizontal velocity in pixels per second// ç«–å‘æ»‘åŠ¨çš„é€Ÿåº¦@param velocityY Vertical velocity in pixels per second// å¦‚æžœæ˜¯trueè¡¨ç¤ºè¿™ä¸ªå­Viewæ¶ˆè€—äº†è¿™ä¸ªæ»‘åŠ¨@param consumed true if the child consumed the fling, false otherwise// è¿”å›žtrueè¡¨ç¤ºï¼Œçˆ¶Viewæ¶ˆè€—æ»‘åŠ¨æˆ–å…¶ä»–æƒ…å†µ@return true if this parent consumed or otherwise reacted to the fling Request a fling from a nested scroll. éœ€è¦åµŒå¥—æ»‘åŠ¨å‘ç”Ÿflingäº‹ä»¶ This method signifies that a nested scrolling child has detected suitable conditions for a fling. Generally this means that a touch scroll has ended with a {@link VelocityTracker velocity} in the direction of scrolling that meets or exceeds the {@link ViewConfiguration#getScaledMinimumFlingVelocity() minimum fling velocity} along a scrollable axis. è¿™ä¸ªæ–¹æ³•æ„å‘³ç€åµŒå¥—æ»‘åŠ¨çš„å­Viewç›‘æµ‹åˆ°ä¸€ä¸ªé€‚åˆflingçš„æƒ…å†µã€‚é€šå¸¸æ„å‘³ç€è§¦æ‘¸äº‹ä»¶åœ¨ä¸€ä¸ªå¯æ»‘åŠ¨çš„è½´ä¸Šåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šä»¥ä¸€å®šé€Ÿåº¦ç»“æŸï¼Œè¿™ä¸ªé€Ÿåº¦è¶…è¿‡äº†ViewConfiguration#getScaledMinimumFlingVelocity()çš„å€¼ã€‚ If a nested scrolling child view would normally fling but it is at the edge of its own content, it can use this method to delegate the fling to its nested scrolling parent instead. The parent may optionally consume the fling or observe a child fling. å¦‚æžœä¸€ä¸ªå­Viewåœ¨åµŒå¥—æ»‘åŠ¨ä½†æ˜¯åˆ°è¾¾äº†ä»–çš„å†…å®¹è¾¹ç¼˜ï¼Œå®ƒå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å°†å¤„ç†flingäº‹ä»¶ä»£ç†ç»™çˆ¶View,çˆ¶Viewå¯ä»¥é€‰æ‹©æ€§çš„æ¶ˆè€—flingäº‹ä»¶æˆ–è€…è§‚å¯Ÿå­Viewçš„flingäº‹ä»¶ã€‚ onNestedPreFlingæ–¹æ³•1public boolean onNestedPreFling(View target, float velocityX, float velocityY); å‚æ•°å’Œè¿”å›žå€¼ 12345678// è§¦å‘åµŒå¥—æ»‘åŠ¨çš„å­View@param target View that initiated the nested scroll// æ°´å¹³æ–¹å‘æ»‘åŠ¨é€Ÿåº¦@param velocityX Horizontal velocity in pixels per second// åž‚ç›´æ–¹å‘æ»‘åŠ¨é€Ÿåº¦@param velocityY Vertical velocity in pixels per second// å¦‚æžœçˆ¶Viewè¦å¤„ç†è¿™ä¸ªflingäº‹ä»¶è¿”å›žtrue@return true if this parent consumed the fling ahead of the target view React to a nested fling before the target view consumes it. åœ¨å­Viewå¯¹åµŒå¥—flingäº‹ä»¶æ¶ˆè€—ä¹‹å‰ä½œå‡ºå“åº” This method siginfies that a nested scrolling child has detected a fling with the given velocity along each axis. Generally this means that a touch scroll has ended with a {@link VelocityTracker velocity} in the direction of scrolling that meets or exceeds the {@link ViewConfiguration#getScaledMinimumFlingVelocity() minimum fling velocity} along a scrollable axis. è¿™ä¸ªæ–¹æ³•æ„å‘³ç€åµŒå¥—æ»‘åŠ¨çš„å­Viewåœ¨æ¯ä¸ªè½´ä¸Šç»™å®šçš„é€Ÿåº¦ä¸Šå‘ç”Ÿäº†flingäº‹ä»¶ï¼Œé€šå¸¸æ„å‘³ç€è§¦æ‘¸äº‹ä»¶åœ¨ä¸€ä¸ªå¯æ»‘åŠ¨çš„è½´ä¸Šåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šä»¥ä¸€å®šé€Ÿåº¦ç»“æŸï¼Œè¿™ä¸ªé€Ÿåº¦è¶…è¿‡äº†ViewConfiguration#getScaledMinimumFlingVelocity()çš„å€¼ã€‚ If a nested scrolling parent is consuming motion as part of a {@link #onNestedPreScroll(View, int, int, int[]) pre-scroll}, it may be appropriate for it to also consume the pre-fling to complete that same motion. By returning true from this method, the parent indicates that the child should not fling its own internal content as well. å¦‚æžœçˆ¶Viewåœ¨onNestedPreScrollæ–¹æ³•ä¸­æ¶ˆè€—äº†åµŒå¥—æ»‘åŠ¨ï¼Œé‚£ä¹ˆä»–å¯èƒ½åŒæ ·ä¹Ÿæƒ³åœ¨flingäº‹ä»¶ä¸­è¿›è¡Œæ¶ˆè€—æ“ä½œï¼Œæ¥å®Œæˆå¤„ç†åµŒå¥—æ»‘åŠ¨çš„è¯·æ±‚ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›žtrueè¡¨æ˜Žå­Viewåº”è¯¥åªåœ¨å®ƒè‡ªå·±çš„åŒºåŸŸå†…æ»‘åŠ¨ã€‚ getNestedScrollAxes()æ–¹æ³•1public int getNestedScrollAxes(); å‚æ•°å’Œè¿”å›žå€¼ 12345// è¡¨æ˜Žæ»‘åŠ¨è½´æ–¹å‘çš„flag@return Flags indicating the current axes of nested scrolling@see ViewCompat#SCROLL_AXIS_HORIZONTAL@see ViewCompat#SCROLL_AXIS_VERTICAL@see ViewCompat#SCROLL_AXIS_NONE A NestedScrollingParent returning something other than {@link ViewCompat#SCROLL_AXIS_NONE}ï¼½is currently acting as a nested scrolling parent for one or more descendant views in the hierarchy. å¦‚æžœæ²¡æœ‰è¿”å›žViewCompat#SCROLL_AXIS_NONEï¼Œè¡¨æ˜Žæœ‰å­Viewåœ¨è¿›è¡ŒåµŒå¥—æ»‘åŠ¨ã€‚]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>SourceCode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Android 6.0 æƒé™åŠ¨æ€ç”³è¯·]]></title>
    <url>%2Farticle%2F2939773101%2F</url>
    <content type="text"><![CDATA[minSdkVersion minSdkVersionæŒ‡çš„æ˜¯ä½ çš„åº”ç”¨å¯ä»¥å…¼å®¹åˆ°çš„æœ€ä½Žç‰ˆæœ¬ï¼Œæ¯”å¦‚ä½ åªä½¿ç”¨äº†2.Xçš„APIï¼Œé‚£minSdkVersionå°±å¯ä»¥å°½é‡å°ï¼Œä»¥é€‚é…æ›´å¤šæœºåž‹ï¼Œå°äºŽminSdkVersionçš„æœºåž‹å°†æ— æ³•å®‰è£…ã€‚ maxSdkVersion maxSdkVersionæŒ‡çš„æ˜¯ä½ çš„åº”ç”¨å¯ä»¥æ”¯æŒåˆ°çš„æœ€é«˜ç‰ˆæœ¬ï¼Œé«˜äºŽè¿™ä¸ªç‰ˆæœ¬çš„æœºåž‹å°†ä¸èƒ½å®‰è£…åº”ç”¨ï¼Œä½†æ˜¯è¿™ä¸ªä¸éœ€è¦æˆ‘ä»¬è‡ªå·±åŽ»å†™ï¼ŒAndroidç³»ç»Ÿé»˜è®¤å‘ä¸‹å…¼å®¹çš„ã€‚ targetSdkVersion targetSdkVersionå¦‚æžœè®¾ç½®äº†æ­¤å±žæ€§ï¼Œé‚£ä¹ˆåœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œå¦‚æžœç›®æ ‡è®¾å¤‡çš„APIç‰ˆæœ¬æ­£å¥½ç­‰äºŽæ­¤æ•°å€¼ï¼Œä»–ä¼šå‘Šè¯‰Androidå¹³å°ï¼šæ­¤ç¨‹åºåœ¨æ­¤ç‰ˆæœ¬å·²ç»ç»è¿‡å……åˆ†æµ‹ï¼Œæ²¡æœ‰é—®é¢˜ã€‚ä¸å¿…ä¸ºæ­¤ç¨‹åºå¼€å¯å…¼å®¹æ€§æ£€æŸ¥åˆ¤æ–­çš„å·¥ä½œäº†ã€‚ ä»‹ç» ç”±äºŽAndroid Må¯¹éšç§æƒé™å¿…é¡»åŠ¨æ€ç”³è¯·ï¼Œå½“ä½ çš„targetSdkVersion&gt;=23æ—¶å°±éœ€è¦è¿›è¡Œæƒé™ç”³è¯·äº†ï¼Œå¦åˆ™å°†èŽ·å¾—ä¸äº†æƒé™ã€‚ä¸è¿‡å½“targetSdkVersion&lt;23æ—¶ï¼Œç”±äºŽAndroidç‰ˆæœ¬å‘ä¸‹å…¼å®¹æ€§ï¼Œä½ çš„åº”ç”¨å°†è¿è¡Œåœ¨&lt;23çš„çŽ¯å¢ƒä¸­ï¼Œä¸ä¼šå‡ºçŽ°é—®é¢˜ã€‚ Gitä¸Šå·²ç»æœ‰å¾ˆå¤šå¼€æºåº“ä¾›å¤§å®¶ä½¿ç”¨äº†ï¼Œç¡®å®žæ–¹ä¾¿ç®€å•ï¼ŒPermissionGenè¿™ä¸ªåº“å¥½è¯„çŽ‡è¿˜æ˜¯è›®é«˜çš„ï¼Œä½¿ç”¨æ³¨è§£ç®€åŒ–äº†å¾ˆå¤šæ“ä½œï¼Œç½‘ä¸Šå¾ˆå¤šåšå®¢éƒ½æŽ¨èå®ƒï¼Œä¸è¿‡ï¼Œæˆ‘è§‰å¾—ä¸èƒ½é‡åˆ°å•¥é—®é¢˜å°±å¼•ä¸ªåˆ«äººçš„åº“è¿›æ¥ï¼Œ ä¸€æ–¹é¢å¦‚æžœåº“çš„å®šåˆ¶æ€§ä¸é«˜ï¼Œè‡ªå®šä¹‰èµ·æ¥ä¹Ÿæ˜¯éº»çƒ¦ï¼Œå¦ä¸€æ–¹é¢ï¼Œåƒè¿™ç§æ¯”è¾ƒç®€å•çš„é—®é¢˜ï¼Œè¿˜æ˜¯è‡ªå·±å†™æ¯”è¾ƒå¥½ï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹æ˜¯å¦‚ä½•å®žçŽ°çš„ï¼Œå¯¹è‡ªå·±çš„å­¦ä¹ ä¹Ÿæœ‰å¥½å¤„ã€‚åˆ«äººå°è£…çš„å†å¥½ä¹Ÿä¸æ˜¯è‡ªå·±çš„ï¼Œä»¥åŽåªèƒ½è¯´æˆ‘ä¼šä½¿ç”¨XX,XXXâ€¦ç±»åº“.é‚£å°±å°´å°¬äº†ã€‚æ‰¯è¿œäº†ï½ž Androidæƒé™ Android Mä¹‹åŽå°†æƒé™åˆ†ä¸ºäº†ä¸¤ç±»ï¼ŒNormalå’ŒDangerous Permission,Dangerous Permissionå¤§éƒ½æ˜¯è·Ÿç”¨æˆ·éšç§ç›¸å…³çš„æƒé™ï¼Œå¦‚ä¸‹è¡¨ï¼Œæ›´è¯¦ç»†è§Androidæ–‡æ¡£ï¼Permissions Permission Group Permissions CALENDAR READ _ CALENDAR WRITE _ CALENDAR CAMERA CAMERA CONTACTS READ _ CONTACTS WRITE _ CONTACTS GET _ ACCOUNTS LOCATION ACCESS FINE LOCATION ACCESS COARSE LOCATION MICROPHONE RECORD _ AUDIO PHONE READ PHONE STATE CALL _ PHONE READ CALL LOG WRITE CALL LOG ADD _ VOICEMAIL USE _ SIP PROCESS OUTGOING CALLS SENSORS BODY _ SENSORS SMS SEND _ SMS RECEIVE _ SMS READ _ SMS RECEIVE WAP PUSH RECEIVE _ MMS STORAGE READ EXTERNAL STORAGE WRITE EXTERNAL STORAGE æ€è·¯å’ŒAPI æ¶‰åŠåˆ°çš„æ ¸å¿ƒæ–¹æ³•context.requestPermissions(String[] permissions,int reqCode);è¯¥æ–¹æ³•å¿…é¡»åœ¨Android Mä»¥ä¸Šå¯ä»¥ä½¿ç”¨ã€‚å¤§ä½“çš„æ€è·¯å°±æ˜¯ï¼š å½“å‰æ‰‹æœºç‰ˆæœ¬æ˜¯ä¸æ˜¯å¤§äºŽAndroid M ï¼Ÿ æ˜¯å¦æœ‰ç§æœ‰æƒé™éœ€è¦ç”³è¯·ï¼Ÿ è¯¥æƒé™æ˜¯ä¸æ˜¯å·²ç»åŒæ„äº† å¼¹ä¸ªdialogå‘Šè¯‰ç”¨æˆ·æˆ‘ä»¬å°†è¦ç”³è¯·å“ªäº›æƒé™ï¼ŒçŽ°åœ¨å¸‚é¢ä¸Šappå¤§éƒ½æ˜¯è¿™ä¹ˆåšçš„ å¼€å§‹ç”³è¯· å¤„ç†ç”³è¯·ç»“æžœ PermissionHelper ä¸ºäº†æ–¹ä¾¿æ“ä½œï¼Œæˆ‘å°†éƒ¨åˆ†æ ¸å¿ƒæ–¹æ³•æŠ½è±¡å‡ºæ¥äº†ï¼Œè°ƒç”¨checkPermission()ç”³è¯·æƒé™ï¼Œè¿”å›žå€¼ä¼šå‘Šè¯‰ä½ æ˜¯ä¸æ˜¯éœ€è¦ç”³è¯·ï¼Œè°ƒç”¨onRequestPermissionsResult()ä¼šæ ¼å¼åŒ–å¤„ç†è¿”å›žçš„æ•°æ®ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172/** * com.march.baselib.helper * CommonLib * Created by chendong on 16/8/17. * Copyright Â© 2016å¹´ chendong. All rights reserved. * Desc : */public class PermissionHelper &#123; public static final int REQ_PERMISSION_CODE = 0x12; /** * åŠ¨æ€ç”³è¯·æƒé™ * @param context ä¸Šä¸‹æ–‡ * @param permissions éœ€è¦ç”³è¯·çš„æƒé™ * @return æ˜¯ä¸æ˜¯éœ€è¦ç”³è¯· */ public static boolean checkPermission(Activity context, String[] permissions) &#123; //6.0ä»¥ä¸Š if (AppHelper.isOverMarshmallow()) &#123; //æ²¡æœ‰æƒé™éœ€è¦ç”³è¯·æ—¶ if (permissions == null || permissions.length &lt;= 0) return true; //æ£€æŸ¥æƒé™æ˜¯ä¸æ˜¯å·²ç»æŽˆäºˆ List&lt;String&gt; noOkPermissions = new ArrayList&lt;&gt;(); for (String permission : permissions) &#123; if (context.checkSelfPermission(permission) == PackageManager.PERMISSION_DENIED) &#123; noOkPermissions.add(permission); &#125; &#125; //è¯¥æƒé™å·²ç»æŽˆäºˆï¼Œä¸å†ç”³è¯· if (noOkPermissions.size() &lt;= 0) return true; //6.0ä»¥ä¸Šéœ€è¦ç”³è¯·æƒé™ context.requestPermissions(noOkPermissions.toArray(new String[noOkPermissions.size()]), REQ_PERMISSION_CODE); return false; &#125; //6.0ä»¥ä¸‹ä¸‹ä¸éœ€è¦ç”³è¯· return true; &#125; /** * å¤„ç†æƒé™ç”³è¯·çš„ç»“æžœï¼Œè¿”å›žç»“æž„åŒ–çš„æ•°æ® * @param requestCode è¯·æ±‚ç  * @param permissions è¢«è¯·æ±‚çš„æƒé™ * @param grantResults è¯·æ±‚ç»“æžœ * @param listener ç›‘å¬ */ public static void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults, OnPermissionHandleOverListener listener) &#123; if (requestCode != REQ_PERMISSION_CODE) return; Map&lt;String, Integer&gt; result = new HashMap&lt;&gt;(); boolean isHavePermissionNotOk = false; for (int i = 0; i &lt; Math.min(permissions.length, grantResults.length); i++) &#123; result.put(permissions[i], grantResults[i]); //æœ‰æƒé™æ²¡æœ‰åŒæ„ if (grantResults[i] == PackageManager.PERMISSION_DENIED) &#123; isHavePermissionNotOk = true; &#125; &#125; //å¦‚æžœæƒé™å…¨éƒ¨åŒæ„ï¼Œç»§ç»­æ‰§è¡Œ if (listener != null) listener.onHandleOver(!isHavePermissionNotOk, result); &#125; public interface OnPermissionHandleOverListener &#123; void onHandleOver(boolean isOkExactly, Map&lt;String, Integer&gt; result); &#125;&#125; BaseActivity ä¸€èˆ¬æƒé™ç›‘æµ‹æ˜¯åœ¨Activityè¿›è¡Œï¼Œåœ¨åŸºç±»ä¸­ç›‘æµ‹è¦ç®€å•æ–¹ä¾¿ 1234567891011121314151617181920212223242526272829303132333435@Overridepublic void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); mSaveBundle = savedInstanceState; mActivity = this; mContext = getApplicationContext(); createViewShow(); //å¦‚æžœä¸éœ€è¦ç›‘æµ‹ï¼Œä¼šç«‹åˆ»æ‰§è¡ŒinvokeCommonMethod()å¼€å§‹Activityæ“ä½œï¼Œå¦‚æžœéœ€è¦å°±ä¼šå‘èµ·ç”³è¯· if (PermissionHelper.checkPermission(mActivity, getPermission2Check())) invokeCommonMethod(mSaveBundle); &#125; //æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»æ¥å†³å®šå“ªäº›æƒé™éœ€è¦ç”³è¯·protected abstract String[] getPermission2Check();//å­ç±»å®žçŽ°å†³å®šå¤„ç†ç»“æžœprotected boolean handlePermissionResult(Map&lt;String, Integer&gt; resultNotOk) &#123; return true;&#125;//å¤„ç†è¿”å›žç»“æžœ@Overridepublic void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) &#123; super.onRequestPermissionsResult(requestCode, permissions, grantResults); PermissionHelper.onRequestPermissionsResult(requestCode, permissions, grantResults, new PermissionHelper.OnPermissionHandleOverListener() &#123; @Override public void onHandleOver(boolean isOkExactly, Map&lt;String, Integer&gt; result) &#123; //æƒé™okæˆ–è€…å­ç±»è¦æ±‚ç›´æŽ¥æ‰§è¡Œ if (isOkExactly || handlePermissionResult(result)) invokeCommonMethod(mSaveBundle); &#125; &#125;); &#125; å­ç±»12345678910111213141516//å“ªäº›æƒé™éœ€è¦ç”³è¯·@TargetApi(Build.VERSION_CODES.JELLY_BEAN)@Overrideprotected String[] getPermission2Check() &#123; return new String[]&#123;Manifest.permission.READ_EXTERNAL_STORAGE&#125;;&#125;//å¦‚æžœæƒé™æ²¡æœ‰èŽ·å¾—å¦‚ä½•å¤„ç†@Overrideprotected boolean handlePermissionResult(Map&lt;String, Integer&gt; resultNoOk) &#123; if (resultNoOk.get(Manifest.permission.READ_EXTERNAL_STORAGE) == PackageManager.PERMISSION_DENIED) &#123; Toaster.get().show("æ‚¨æ²¡æœ‰å…è®¸è¯»å–å­˜å‚¨å¡ï¼Œä¸èƒ½ç»§ç»­æ“ä½œ"); return false; &#125; return true;&#125; ä»¥ä¸Š]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonå®žçŽ°å•ä¾‹]]></title>
    <url>%2Farticle%2F3789624758%2F</url>
    <content type="text"><![CDATA[å•ä¾‹è£…é¥°å™¨ åœ¨ç½‘ä¸ŠæŸ¥åˆ°å¾ˆå¤šæ–¹å¼ï¼Œé€‰æ‹©ä¸€ç§æ¯”è¾ƒpythonicçš„æ–¹å¼ 123456789def singleton(cls, *args, **kwargs): instances = &#123;&#125; def _singleton(): if cls not in instances: instances[cls] = cls(*args, **kwargs) return instances[cls] return _singleton ä½¿ç”¨12345678@singletonclass HttpHelper: def __init__(self): pass name = 'http helper' ...... ....]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python Json]]></title>
    <url>%2Farticle%2F2150468451%2F</url>
    <content type="text"><![CDATA[å¼€å§‹12345678910111213141516171819202122232425# -*-coding:utf-8-*-import jsonfrom httptst.Singleton import singleton@singletonclass JsonHelper(object): name = 'json helper' def convert_to_builtin_type(obj): print 'default(', repr(obj), ')' dict = &#123;&#125; dict.update(obj.__dict__) return dict # obj è½¬ json def getJson(self, obj): data = json.dumps(obj, sort_keys=True, default=self.convert_to_builtin_type) return data # json str è½¬dict def parse(self, jsonStr): jsonDict = json.loads(jsonStr) return jsonDict]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonæ™®é€šæ–¹æ³•ã€é™æ€æ–¹æ³•ã€ç±»æ–¹æ³•]]></title>
    <url>%2Farticle%2F1727896955%2F</url>
    <content type="text"><![CDATA[å¼€å§‹123456789101112131415161718192021222324# -*-coding:utf-8-*-# æ™®é€šæ–¹æ³•,ç±»æ–¹æ³•,é™æ€æ–¹æ³•çš„åŒºåˆ«__metaclass__ = typeclass Tst: name = 'tst' data = 'this is data' # æ™®é€šæ–¹æ³• def normalMethod(self, name): print self.data, name # ç±»æ–¹æ³•,å¯ä»¥è®¿é—®ç±»å±žæ€§ @classmethod def classMethod(cls, name): print cls.data, name # é™æ€æ–¹æ³•,ä¸å¯ä»¥è®¿é—®ç±»å±žæ€§ @staticmethod def staticMethod(name): print name æµ‹è¯• ä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥é€šè¿‡å®žä¾‹æ¥è°ƒç”¨ï¼Œä½†æ˜¯é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•æ— æ³•è®¿é—®å®žä¾‹å±žæ€§ï¼Œæ‰€ä»¥æ›´æ”¹äº†tst.dataä»…å¯¹æ™®é€šæ–¹æ³•èµ·äº†ä½œç”¨ 12345678910tst = Tst()tst.data = 'this is new'tst.normalMethod('name')tst.staticMethod('name')tst.classMethod('name')#ç»“æžœthis is new namenamethis is data name åŒºåˆ« æ™®é€šæ–¹æ³•ä¸èƒ½é€šè¿‡ç±»åè°ƒç”¨ï¼Œä½†æ˜¯é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•æ˜¯å¯ä»¥çš„ 12345678# erroræ™®é€šæ–¹æ³•å¿…é¡»é€šè¿‡å®žä¾‹è°ƒç”¨# Tst.normalMethod(&apos;name&apos;)Tst.classMethod(&apos;name&apos;)Tst.staticMethod(&apos;name&apos;)#ç»“æžœthis is data namename æ€»ç»“ æ™®é€šæ–¹æ³•,å¯ä»¥é€šè¿‡selfè®¿é—®å®žä¾‹å±žæ€§ 1def normalMethod(self,data) ç±»æ–¹æ³•,å¯ä»¥é€šè¿‡clsè®¿é—®ç±»å±žæ€§ 12@classmethoddef classMethod(cls,data) é™æ€æ–¹æ³•,ä¸å¯ä»¥è®¿é—®,é€šè¿‡ä¼ å€¼çš„æ–¹å¼ 12@staticmethoddef staticMethod(data)]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidæ·»åŠ å¿«æ·æ–¹å¼]]></title>
    <url>%2Farticle%2F3591670187%2F</url>
    <content type="text"><![CDATA[æƒé™12&lt;uses-permission android:name="com.android.launcher.permission.INSTALL_SHORTCUT"/&gt;&lt;uses-permission android:name="com.android.launcher.permission.UNINSTALL_SHORTCUT"/&gt; é…ç½® å¿«æ·æ–¹å¼è¦æ‰“å¼€ä¸€ä¸ªç•Œé¢ï¼Œéœ€è¦ä¸€ä¸ªIntenté…ç½®è¿™äº›ä¿¡æ¯ 1234567891011121314/*** èŽ·å–Intent** @param thisActivity å½“å‰activity* @param goActivity ç‚¹å‡»æ‰“å¼€çš„activity* @return åˆ›å»ºçš„Intent*/private static Intent getShortCutIntent(Activity thisActivity, Class goActivity) &#123; // ä½¿ç”¨MAINï¼Œå¯ä»¥é¿å…éƒ¨åˆ†æ‰‹æœº(æ¯”å¦‚åŽä¸ºã€HTCéƒ¨åˆ†æœºåž‹)åˆ é™¤åº”ç”¨æ—¶æ— æ³•åˆ é™¤å¿«æ·æ–¹å¼çš„é—®é¢˜ Intent intent = new Intent(Intent.ACTION_MAIN); intent.addCategory(Intent.CATEGORY_DEFAULT); intent.setClass(thisActivity, goActivity); return intent;&#125; Action1234// Action æ·»åŠ Shortcutpublic static final String ACTION_ADD_SHORTCUT = "com.android.launcher.action.INSTALL_SHORTCUT";// Action ç§»é™¤Shortcutpublic static final String ACTION_REMOVE_SHORTCUT = "com.android.launcher.action.UNINSTALL_SHORTCUT"; æ·»åŠ å¿«æ·æ–¹å¼123456789101112131415161718192021222324252627282930/*** æ·»åŠ å¿«æ·æ–¹å¼** @param activity context* @param name name* @param goActivity è¦å¯åŠ¨çš„ç•Œé¢* @param allowRepeat æ˜¯å¦å…è®¸é‡å¤,å»ºè®®false* @param iconBitmap å¿«æ·æ–¹å¼å›¾æ ‡*/public static void addShortcut(Activity activity, Class goActivity, String name,boolean allowRepeat, Bitmap iconBitmap) &#123; Intent addShortcutIntent = new Intent(ACTION_ADD_SHORTCUT); // æ˜¯å¦å…è®¸é‡å¤åˆ›å»º addShortcutIntent.putExtra("duplicate", allowRepeat); // å¿«æ·æ–¹å¼çš„æ ‡é¢˜ addShortcutIntent.putExtra(Intent.EXTRA_SHORTCUT_NAME, name); // å¿«æ·æ–¹å¼çš„å›¾æ ‡ addShortcutIntent.putExtra(Intent.EXTRA_SHORTCUT_ICON, iconBitmap); // å¿«æ·æ–¹å¼çš„åŠ¨ä½œ Intent shortCutIntent = getShortCutIntent(activity, goActivity); addShortcutIntent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, shortCutIntent); activity.sendBroadcast(addShortcutIntent);&#125;public static void addShortcut(Activity activity, Class goActivity, String name, boolean allowRepeat, int res) &#123; BitmapFactory.Options options = new BitmapFactory.Options(); Bitmap bitmap = BitmapFactory.decodeResource(activity.getResources(), res); addShortcut(activity, goActivity, name, allowRepeat, bitmap);&#125; ç§»é™¤å¿«æ·æ–¹å¼12345678910111213141516/** * ç§»é™¤å¿«æ·æ–¹å¼ * * @param activity context * @param goActivity è¦å¯åŠ¨çš„Activity * @param name name */public static void removeShortcut(Activity activity, Class goActivity, String name) &#123; Intent intent = new Intent(ACTION_REMOVE_SHORTCUT); intent.putExtra(Intent.EXTRA_SHORTCUT_NAME, name); //intent.addCategory(Intent.CATEGORY_LAUNCHER); intent.putExtra("duplicate", false); Intent shortCutIntent = getShortCutIntent(activity, goActivity); intent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, shortCutIntent); activity.sendBroadcast(intent);&#125; é™„å…¨éƒ¨ä»£ç ï¼Œäº²æµ‹å¯ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879/** * com.march.libs.helper * CdLibsTest * Created by chendong on 16/7/29. * Copyright Â© 2016å¹´ chendong. All rights reserved. * Desc : */public class ShortCutHelper &#123; // Action æ·»åŠ Shortcut public static final String ACTION_ADD_SHORTCUT = "com.android.launcher.action.INSTALL_SHORTCUT"; // Action ç§»é™¤Shortcut public static final String ACTION_REMOVE_SHORTCUT = "com.android.launcher.action.UNINSTALL_SHORTCUT"; /** * èŽ·å–Intent * * @param thisActivity å½“å‰activity * @param goActivity ç‚¹å‡»æ‰“å¼€çš„activity * @return åˆ›å»ºçš„Intent */ private static Intent getShortCutIntent(Activity thisActivity, Class goActivity) &#123; // ä½¿ç”¨MAINï¼Œå¯ä»¥é¿å…éƒ¨åˆ†æ‰‹æœº(æ¯”å¦‚åŽä¸ºã€HTCéƒ¨åˆ†æœºåž‹)åˆ é™¤åº”ç”¨æ—¶æ— æ³•åˆ é™¤å¿«æ·æ–¹å¼çš„é—®é¢˜ Intent intent = new Intent(Intent.ACTION_MAIN); intent.addCategory(Intent.CATEGORY_DEFAULT); intent.setClass(thisActivity, goActivity); return intent; &#125; /** * æ·»åŠ å¿«æ·æ–¹å¼ * * @param activity context * @param name name * @param goActivity è¦å¯åŠ¨çš„ç•Œé¢ * @param allowRepeat æ˜¯å¦å…è®¸é‡å¤ * @param iconBitmap å¿«æ·æ–¹å¼å›¾æ ‡ */ public static void addShortcut(Activity activity, Class goActivity, String name, boolean allowRepeat, Bitmap iconBitmap) &#123; Intent addShortcutIntent = new Intent(ACTION_ADD_SHORTCUT); // æ˜¯å¦å…è®¸é‡å¤åˆ›å»º addShortcutIntent.putExtra("duplicate", allowRepeat); // å¿«æ·æ–¹å¼çš„æ ‡é¢˜ addShortcutIntent.putExtra(Intent.EXTRA_SHORTCUT_NAME, name); // å¿«æ·æ–¹å¼çš„å›¾æ ‡ addShortcutIntent.putExtra(Intent.EXTRA_SHORTCUT_ICON, iconBitmap); // å¿«æ·æ–¹å¼çš„åŠ¨ä½œ Intent shortCutIntent = getShortCutIntent(activity, goActivity); addShortcutIntent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, shortCutIntent); activity.sendBroadcast(addShortcutIntent); &#125; public static void addShortcut(Activity activity, Class goActivity, String name, boolean allowRepeat, int res) &#123; BitmapFactory.Options options = new BitmapFactory.Options(); Bitmap bitmap = BitmapFactory.decodeResource(activity.getResources(), res); addShortcut(activity, goActivity, name, allowRepeat, bitmap); &#125; /** * ç§»é™¤å¿«æ·æ–¹å¼ * * @param activity context * @param goActivity è¦å¯åŠ¨çš„Activity * @param name name */ public static void removeShortcut(Activity activity, Class goActivity, String name) &#123; Intent intent = new Intent(ACTION_REMOVE_SHORTCUT); intent.putExtra(Intent.EXTRA_SHORTCUT_NAME, name); //intent.addCategory(Intent.CATEGORY_LAUNCHER); intent.putExtra("duplicate", false); Intent shortCutIntent = getShortCutIntent(activity, goActivity); intent.putExtra(Intent.EXTRA_SHORTCUT_INTENT, shortCutIntent); activity.sendBroadcast(intent); &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java èŒƒåž‹]]></title>
    <url>%2Farticle%2F2053934834%2F</url>
    <content type="text"><![CDATA[å…³äºŽå¦‚ä½•ç»§æ‰¿å¸¦æœ‰èŒƒåž‹çš„åŸºç±» ç»§æ‰¿çˆ¶ç±»çš„èŒƒåž‹12345678910111213141516171819202122232425262728293031public class GenericityTst &#123; public class Temp &#123; &#125; //å…·æœ‰æ³›åž‹çš„ClassA public class ClassA&lt;T&gt;&#123; T t; &#125; //ç»§æ‰¿æ³›åž‹ public class ClassB&lt;T&gt; extends ClassA&lt;T&gt;&#123; T t; &#125; //ç¼©å°æ³›åž‹çš„èŒƒå›´ï¼Œæ˜¯å‡†è®¸çš„ï¼Œä½†æ˜¯ä¸å…è®¸æ‰©å¤§æ³›åž‹çš„èŒƒå›´ public class ClassC&lt;T extends Temp&gt; extends ClassA&lt;T&gt;&#123; T t; &#125; //å…·æœ‰æ³›åž‹çš„ç±»ClassD,æ³›åž‹å…·æœ‰çˆ¶ç±»çº¦æŸ public class ClassD&lt;T extends Temp&gt; &#123; T t; &#125; //ç»§æ‰¿ClassD,å£°æ˜Žæ³›åž‹æ—¶è‡³å°‘å…·æœ‰çˆ¶ç±»åŒæ ·çš„çº¦æŸ public class ClassE&lt;T extends Temp&gt; extends ClassD&lt;T&gt;&#123; T t; &#125;&#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨ AS ä¸­ä½¿ç”¨ Lambda è¡¨è¾¾å¼]]></title>
    <url>%2Farticle%2F4229621729%2F</url>
    <content type="text"><![CDATA[é…ç½® AndroidStudio æ”¯æŒ Lambda è¡¨è¾¾å¼ æ ¹ç›®å½•ä¸‹gradleæ–‡ä»¶é…ç½® åœ¨project / build.gradleä¸­é…ç½® 123456789buildscript &#123; repositories &#123; jcenter() &#125; dependencies &#123; classpath &apos;com.android.tools.build:gradle:2.1.3&apos; classpath &apos;me.tatarka:gradle-retrolambda:3.2.5&apos; &#125;&#125; appä¸‹gradleæ–‡ä»¶é…ç½® åœ¨project / app / build.gradleé¡¶éƒ¨é…ç½®æ’ä»¶ 12apply plugin: &apos;me.tatarka.retrolambda&apos;... åœ¨android{â€¦}ä¸­é…ç½®12345678910111213android &#123; ...... // æ³¨é‡Šå†²çª packagingOptions &#123; exclude &apos;META-INF/services/javax.annotation.processing.Processor&apos; &#125; // ä½¿ç”¨Java1.8 compileOptions &#123; sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8 &#125; ......&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>DevEnvironment</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ORMæ¡†æž¶ï¼GreenDao2.0]]></title>
    <url>%2Farticle%2F3564593419%2F</url>
    <content type="text"><![CDATA[GreenDaoå®˜ç½‘å®˜ç½‘ -&gt; http://greendao-orm.com GitHubGitHub -&gt; https://github.com/greenrobot/greenDAO æ€§èƒ½å¯¹æ¯” ä»‹ç» GreenDaoé‡‡ç”¨çš„æ˜¯ç”¨javaä»£ç ç›´æŽ¥ç”ŸæˆBeanï¼ˆå®žä½“ï¼‰å’ŒDaoï¼ˆData Access Objectæ•°æ®è®¿é—®å¯¹è±¡ï¼‰çš„æ–¹å¼ï¼Œéƒ½ä¸ç”¨è‡ªå·±å†™å®žä½“äº†ï¼Œä¹Ÿæ˜¯ä¸€å¤§å¥½å¤„ï¼Œä¸è¿‡è¿™ä¹Ÿé€ æˆäº†ç†è§£ä¸Šçš„éš¾åº¦ï¼Œæˆ‘åˆšå¼€å§‹ç”¨çš„æ—¶å€™å°±æœ‰ç‚¹è’™ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ªJavaçš„Library,ä¸€å®šæ˜¯Javaçš„ï¼Œå‘½åä¸ºdaogeneratorï¼ˆå¯ä»¥èµ·åˆ«çš„åå­—ï¼Œä¸ºäº†åŽé¢å™è¿°æ–¹ä¾¿ï¼‰ã€‚åœ¨appä¸‹é¢å’Œâ€™javaâ€™ç›®å½•åŒçº§åˆ›å»ºâ€™java-genâ€™ç›®å½•ï¼Œå°†ä¼šç”¨æ¥æ”¾ç½®ç”Ÿæˆçš„Beanå’ŒDaoã€‚Daoä¹Ÿå°±æ˜¯æ•°æ®è®¿é—®å¯¹è±¡ï¼Œå®žä½“ç±»åªèƒ½æè¿°ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§å’Œè¡Œä¸ºï¼Œæƒ³ä¸Žæ•°æ®åº“äº¤æµå°±éœ€è¦Daoå¯¹è±¡ï¼Œå®ƒåŒ…å«å¯¹åº”çš„æ•°æ®åº“å­—æ®µå’Œå¢žåˆ æ”¹æŸ¥æ–¹æ³•ã€‚ ç”Ÿæˆæ–‡ä»¶ åœ¨daogeneratoråº“é‡Œåˆ›å»ºâ€™ExampleDaoGenerator.javaâ€™æ–‡ä»¶,åŒ…å«mainæ–¹æ³•ï¼Œæž„å»ºschemaï¼Œç”Ÿæˆç›®å½•å’Œæ–‡ä»¶ 123456789101112131415161718192021public static void main(String[] args) throws Exception&#123; operate();&#125;private static void operate() throws Exception &#123; // Schemaå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥ç”Ÿæˆå®žä½“å’Œdao // ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨ï¼šæ•°æ®åº“ç‰ˆæœ¬å·ä¸Žè‡ªåŠ¨ç”Ÿæˆbeanä»£ç çš„åŒ…è·¯å¾„ã€‚ Schema schema = new Schema(2, "com.march.bean"); // é»˜è®¤çš„daoç›®å½• schema.setDefaultJavaPackageDao("com.march.dao"); // æ¨¡å¼ï¼ˆSchemaï¼‰åŒæ—¶ä¹Ÿæ‹¥æœ‰ä¸¤ä¸ªé»˜è®¤çš„ flagsï¼Œåˆ†åˆ«ç”¨æ¥æ ‡ç¤º entity æ˜¯å¦æ˜¯ activie ä»¥åŠæ˜¯å¦ä½¿ç”¨ keep sectionsã€‚ // å¯ä»¥æ¿€æ´»é¢„çƒ­å®žä½“ï¼Œä½¿è¯»å†™æ›´è¿…é€Ÿ schema.enableActiveEntitiesByDefault(); // è¿™ä¸ªæ˜¯ä¸ºäº†ä½ å¯ä»¥åœ¨è‡ªåŠ¨ç”Ÿæˆçš„å®žä½“ç±»ä¸­æ·»åŠ è‡ªå·±çš„customä»£ç  schema.enableKeepSectionsByDefault(); // ä¸€æ—¦ä½ æ‹¥æœ‰äº†ä¸€ä¸ª Schema å¯¹è±¡åŽï¼Œä½ ä¾¿å¯ä»¥ä½¿ç”¨å®ƒæ·»åŠ å®žä½“ï¼ˆEntitiesï¼‰äº†ã€‚è¿™é‡Œåªæ˜¯ä¸€ä¸ªå‡çš„æ–¹æ³•è¡¨ç¤ºä¸€ä¸‹ï¼Œç”Ÿæˆå®žä½“åœ¨ä¸‹ä¸€èŠ‚ generateBean(schema); // æœ€åŽæˆ‘ä»¬å°†ä½¿ç”¨ DAOGenerator ç±»çš„ generateAll() æ–¹æ³•è‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œæ­¤å¤„ä½ éœ€è¦æ ¹æ®è‡ªå·±çš„æƒ…å†µæ›´æ”¹è¾“å‡ºç›®å½•ï¼ˆæ—¢ä¹‹å‰åˆ›å»ºçš„ java-gen)ã€‚ // å…¶å®žï¼Œè¾“å‡ºç›®å½•çš„è·¯å¾„å¯ä»¥åœ¨ build.gradle ä¸­è®¾ç½®ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªè¡Œæœç´¢ï¼Œè¿™é‡Œå°±ä¸å†è¯¦è§£ã€‚ new DaoGenerator().generateAll(schema, "/Users/march/AndroidPro/Reaper/app/src/main/java-gen");&#125; å¦‚ä½•ç”Ÿæˆå®žä½“12345678910111213private static void addNote(Schema schema) &#123; // ä¸€ä¸ªå®žä½“ï¼ˆç±»ï¼‰å°±å…³è”åˆ°æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨ï¼Œæ­¤å¤„è¡¨åä¸ºã€ŒNoteã€ï¼ˆæ—¢ç±»åï¼‰ Entity note = schema.addEntity("Note"); // greenDAO ä¼šè‡ªåŠ¨æ ¹æ®å®žä½“ç±»çš„å±žæ€§å€¼æ¥åˆ›å»ºè¡¨å­—æ®µï¼Œå¹¶èµ‹äºˆé»˜è®¤å€¼ // æŽ¥ä¸‹æ¥ä½ ä¾¿å¯ä»¥è®¾ç½®è¡¨ä¸­çš„å­—æ®µ,åˆå¾ˆå¤šé“¾å¼ç¼–ç¨‹çš„æ–¹æ³•ï¼Œç»“åˆæ•°æ®åº“çš„create tableæ“ä½œå¯ä»¥è®¾ç½®ç›¸å…³çš„å­—æ®µåŠçº¦æŸ note.addIdProperty().autoincrement(); note.addBooleanProperty("isYes").primaryKey().unique(); note.addStringProperty("text").notNull(); // ä¸Žåœ¨ Java ä¸­ä½¿ç”¨é©¼å³°å‘½åæ³•ä¸åŒï¼Œé»˜è®¤æ•°æ®åº“ä¸­çš„å‘½åæ˜¯ä½¿ç”¨å¤§å†™å’Œä¸‹åˆ’çº¿æ¥åˆ†å‰²å•è¯çš„ã€‚ // For example, a property called â€œcreationDateâ€ will become a database column â€œCREATION_DATEâ€. note.addStringProperty("comment"); note.addDateProperty("date");&#125; è‡ªå®šä¹‰ç”Ÿæˆçš„ä»£ç  å½“é‡æ–°æ‰§è¡Œjavaä»£ç æ—¶ä¼šè¦†ç›–ç”Ÿæˆæ–°çš„æ–‡ä»¶ï¼Œå¦‚æžœä½ ä¿®æ”¹äº†ç”Ÿæˆçš„ç±»ï¼Œå°±ä¼šè¢«é‡æ–°è¦†ç›–ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè®¾ç½®note.setHasKeepSections(true);ä¼šåœ¨æ–‡ä»¶ä¸­ç”Ÿæˆä¸€äº›æ³¨é‡Šï¼Œåœ¨æ³¨é‡Šä¸­é—´çš„ä»£ç å°†ä¸ä¼šè¢«è¦†ç›–ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ç»§æ‰¿ï¼Œå®žçŽ°ç­‰ã€‚ã€‚ã€‚è¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡éƒ½ä¿®æ”¹ä»£ç äº† 1234567891011121314151617181920// KEEP INCLUDES - put your custom includes hereimport com.march.quickrvlibs.inter.RvQuickInterface;// KEEP INCLUDES END// KEEP FIELDS - put your custom fields herepublic static final int TYPE_SHU = 0;public static final int TYPE_HENG = 1;// KEEP FIELDS END// KEEP METHODS - put your custom methods here@Overridepublic int getRvType() &#123; if (height &gt; width) return 0; else return 1;&#125;// KEEP METHODS END 12345678//è®¾ç½®æ”¯æŒè‡ªå®šä¹‰ä»£ç ï¼ˆæˆ–schema.enableKeepSectionsByDefault();ï¼‰note.setHasKeepSections(true);//è®¾ç½®å®žçŽ°çš„æŽ¥å£note.implementsInterface("RvQuickInterface", "java.io.Serializable");//è®¾ç½®ç»§æ‰¿çš„çˆ¶ç±»note.setSuperclass("Album");//ä½ ä¹Ÿå¯ä»¥é‡æ–°ç»™è¡¨å‘½ånote.setTableName("NODE"); åˆå§‹åŒ–æ•°æ®åº“123456789101112131415private DaoSession mDaoSession;public void setupDatabase(Context context) &#123; // é€šè¿‡ DaoMaster çš„å†…éƒ¨ç±» DevOpenHelperï¼Œä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¾¿åˆ©çš„ SQLiteOpenHelper å¯¹è±¡ã€‚ // å¯èƒ½ä½ å·²ç»æ³¨æ„åˆ°äº†ï¼Œä½ å¹¶ä¸éœ€è¦åŽ»ç¼–å†™ã€ŒCREATE TABLEã€è¿™æ ·çš„ SQL è¯­å¥ï¼Œå› ä¸º greenDAO å·²ç»å¸®ä½ åšäº†ã€‚ // æ³¨æ„ï¼šé»˜è®¤çš„ DaoMaster.DevOpenHelper ä¼šåœ¨æ•°æ®åº“å‡çº§æ—¶ï¼Œåˆ é™¤æ‰€æœ‰çš„è¡¨ï¼Œæ„å‘³ç€è¿™å°†å¯¼è‡´æ•°æ®çš„ä¸¢å¤±ã€‚ // æ‰€ä»¥ï¼Œåœ¨æ­£å¼çš„é¡¹ç›®ä¸­ï¼Œä½ è¿˜åº”è¯¥åšä¸€å±‚å°è£…ï¼Œæ¥å®žçŽ°æ•°æ®åº“çš„å®‰å…¨å‡çº§ã€‚ DaoMaster.DevOpenHelper helper = new DaoMaster.DevOpenHelper(context, "notes-db", null); SQLiteDatabase db = helper.getWritableDatabase(); // æ³¨æ„ï¼šè¯¥æ•°æ®åº“è¿žæŽ¥å±žäºŽ DaoMasterï¼Œæ‰€ä»¥å¤šä¸ª Session æŒ‡çš„æ˜¯ç›¸åŒçš„æ•°æ®åº“è¿žæŽ¥ã€‚ DaoMaster daoMaster = new DaoMaster(db); mDaoSession = daoMaster.newSession(); // åœ¨ QueryBuilder ç±»ä¸­å†…ç½®ä¸¤ä¸ª Flag ç”¨äºŽæ–¹ä¾¿è¾“å‡ºæ‰§è¡Œçš„ SQL è¯­å¥ä¸Žä¼ é€’å‚æ•°çš„å€¼ QueryBuilder.LOG_SQL = true; QueryBuilder.LOG_VALUES = true;&#125; èŽ·å–Dao123public WholeAlbumItemDao getWholeAlbumItemDao() &#123; return mDaoSession.getWholeAlbumItemDao();&#125; å¢ž12345678910//è¿™ä¸¤ä¸ªæ–¹æ³•æä¾›ç®€å•çš„æ’å…¥å’Œä¸å­˜åœ¨åˆ™æ’å…¥å­˜åœ¨åˆ™æ›´æ–°çš„æ“ä½œDaoHelper.get().getAlbumDetailDao().insert();DaoHelper.get().getAlbumDetailDao().insertOrReplace();//è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•çš„åŠ å¼ºç‰ˆï¼Œæ”¯æŒiterableç±»åž‹å¤šä¸ªå¯¹è±¡çš„æ’å…¥å’Œæ›´æ–°ï¼ŒåŒæ—¶æ˜¯åŸºäºŽäº‹åŠ¡çš„ã€‚DaoHelper.get().getAlbumDetailDao().insertInTx();DaoHelper.get().getAlbumDetailDao().insertOrReplaceInTx();//å®˜æ–¹è§£é‡Š:Insert an entity into the table associated with a concrete DAO &lt;b&gt;without&lt;/b&gt; setting key property.//Warning: This may be faster, but the entity should not be used anymore. The entity also won't be attached to identity scope.//å¤§æ¦‚æ„æ€å°±æ˜¯å°å¿ƒç‚¹ç”¨ï¼Œè™½ç„¶é€Ÿåº¦å¿«ï¼Œä½†æ˜¯æ’è¿›åŽ»å¯èƒ½å°±æ‹¿ä¸å‡ºæ¥äº†DaoHelper.get().getAlbumDetailDao().insertWithoutSettingPk() åˆ 1234567891011//ä¸Žinsertæ–¹æ³•å¤§åŒå°å¼‚DaoHelper.get().getAlbumDetailDao().delete();DaoHelper.get().getAlbumDetailDao().deleteInTx();//æ ¹æ®ä¸»é”®åˆ é™¤å…ƒç´ DaoHelper.get().getAlbumDetailDao().deleteByKey();DaoHelper.get().getAlbumDetailDao().deleteByKeyInTx();//åˆ é™¤å…¨éƒ¨DaoHelper.get().getAlbumDetailDao().deleteAll();//ä¹Ÿæ˜¯åˆ é™¤ï¼Œå…·ä½“çš„åŒºåˆ«è¿˜æ²¡å¼„æ˜Žç™½DaoHelper.get().getAlbumDetailDao().detach()DaoHelper.get().getAlbumDetailDao().detachAll(); æ”¹12DaoHelper.get().getAlbumDetailDao().update();DaoHelper.get().getAlbumDetailDao().updateInTx(); æŸ¥ å…³äºŽQueryçš„æ“ä½œç›¸å¯¹å¤æ‚ï¼Œ ä¸‹é¢åªæ˜¯æ¯”è¾ƒåŸºæœ¬çš„ï¼Œæ›´å¤šçš„ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚ç…§Queryæ–‡æ¡£ 12345678910111213141516171819// èŽ·å–querybuilderQueryBuilder&lt;RecommendAlbumItem&gt; queryBuilder = DaoHelper.get().getRecommendAlbumItemDao().queryBuilder();// æŸ¥è¯¢æ¡ä»¶ï¼Œå¤§äºŽå°äºŽï¼Œand,orqueryBuilder.where( RecommendAlbumItemDao.Properties.Album_type.eq(""), queryBuilder.or(RecommendAlbumItemDao.Properties.Album_cover.gt(""), queryBuilder.and(RecommendAlbumItemDao.Properties.Album_cover.ge("") ,RecommendAlbumItemDao.Properties.Album_cover.eq(""))));// offset limmit queryBuilder.offset(10).limit(10);//æŽ’åºqueryBuilder.orderAsc();queryBuilder.orderCustom(null,null);queryBuilder.orderDesc();queryBuilder.build();//æŸ¥è¯¢æ•°é‡queryBuilder.count();//è¿”å›žlistqueryBuilder.list();]]></content>
      <categories>
        <category>Android</category>
        <category>Library</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Library</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mac å®‰è£… Mongdb]]></title>
    <url>%2Farticle%2F3372882306%2F</url>
    <content type="text"><![CDATA[MongoDB æ˜¯ç”±C++è¯­è¨€ç¼–å†™çš„ï¼Œæ˜¯ä¸€ä¸ªåŸºäºŽåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„å¼€æºæ•°æ®åº“ç³»ç»Ÿã€‚ åœ¨é«˜è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œæ·»åŠ æ›´å¤šçš„èŠ‚ç‚¹ï¼Œå¯ä»¥ä¿è¯æœåŠ¡å™¨æ€§èƒ½ã€‚MongoDB æ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚ MongoDB å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æž„ç”±é”®å€¼(key=&gt;value)å¯¹ç»„æˆã€‚MongoDB æ–‡æ¡£ç±»ä¼¼äºŽ JSON å¯¹è±¡ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚ ç‰¹ç‚¹:é«˜æ€§èƒ½ã€æ˜“éƒ¨ç½²ã€æ˜“ä½¿ç”¨ï¼Œå­˜å‚¨æ•°æ®éžå¸¸æ–¹ä¾¿ã€‚ å®‰è£… MongoDbå®‰è£…homebrew 1$ /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" æ›´æ–°homebrew 1$ brew update å®‰è£…mongodb 1$ brew install mongodb é…ç½®çŽ¯å¢ƒå˜é‡1234$ open ~/.bash_profile # å†™å…¥ä»¥ä¸‹è·¯å¾„# mongodbexport PATH=$&#123;PATH&#125;:/usr/local/Cellar/mongodb/3.2.6/bin æ ¹æ®é…ç½®å¯åŠ¨mongodbä½¿ç”¨è¯¥å‘½ä»¤å°†ä¼šä½¿ç”¨mongod.confæ–‡ä»¶çš„ç›¸å…³é…ç½®æ¥å¯åŠ¨mongodb æ–‡ä»¶çš„è·¯å¾„åœ¨ /usr/local/etc/mongod.confï¼ˆMacï¼‰ ä»Žé…ç½®æ–‡ä»¶å¯ä»¥çœ‹åˆ°æ•°æ®åº“çš„è·¯å¾„ä»¥åŠlogçš„è·¯å¾„ç­‰ã€‚ 1234567891011$ mongod --config /usr/local/etc/mongod.conf# mongod.conf æ–‡ä»¶å†…å®¹systemLog: destination: file path: /usr/local/var/log/mongodb/mongo.log logAppend: truestorage: dbPath: /usr/local/var/mongodbnet: bindIp: 127.0.0.1 ç›´æŽ¥å¯åŠ¨ç›´æŽ¥å¯åŠ¨å¿«æ·ç®€å•ï¼Œæ•°æ®å°†ä¼šå­˜å‚¨åœ¨/data/dbä¸‹,å…¶ä¸­/dataè·¯å¾„ä¸Ž/usrè·¯å¾„æ˜¯åŒçº§çš„ã€‚ 123456789æ•°æ®ä¼šå­˜æ”¾åœ¨/data/db ç›®å½•ä¸‹ï¼Œéœ€è¦é¦–å…ˆåˆ›å»ºç›®å½•ï¼Œå¹¶æ›´æ”¹ç›®å½•æƒé™$ mkdir -p /data/db $ sudo chown -R march /dataå¯åŠ¨mongodbæœåŠ¡$ mongodè¾“å…¥ mongo ï¼Œè¿žæŽ¥åˆ°mongoæœåŠ¡ï¼Œå³å¯è¿›å…¥å‘½ä»¤è¡Œæ“ä½œ$ mongo]]></content>
      <categories>
        <category>Db</category>
      </categories>
      <tags>
        <tag>Database</tag>
        <tag>MongoDb</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Python DjangoæœåŠ¡å™¨æ­å»º]]></title>
    <url>%2Farticle%2F1002618664%2F</url>
    <content type="text"><![CDATA[å‰è¨€ å®‰è£…çš„éƒ¨åˆ†å·¥å…·ï¼Œæˆ‘æ˜¯åœ¨Macä¸‹ä½¿ç”¨ï¼Œå…¶ä»–çš„å¹³å°è‡ªå·±æœç´¢ä¸€ä¸‹å¦‚ä½•å®‰è£…ã€‚çŽ°åœ¨é»˜è®¤ä½ å·²ç»å®‰è£…äº†PythonçŽ¯å¢ƒï¼Œæˆ‘çš„æ˜¯Python2.7 å®‰è£…pipåŒ…ç®¡ç†å™¨ pipåŒ…ç®¡ç†å™¨æ˜¯pythonä¸‹å®‰è£…æ¨¡å—çš„å·¥å…· 1234567$ curl -O https://raw.github.com/pypa/pip/master/contrib/get-pip.py$ [sudo] python get-pip.py# å®‰è£…åŒ…$ pip install django# å¸è½½åŒ…$ pip uninstall django å®‰è£…ipython ipythonæ˜¯ä¸€ä¸ªå¢žå¼ºå¼çš„pythonäº¤äº’å¼æ“ä½œå‘½ä»¤å·¥å…·ï¼Œæœ‰è‡ªåŠ¨æç¤ºå’Œè¡¥å…¨çš„åŠŸèƒ½ 1$ pip install ipython å®‰è£…django1$ pip install django ç®€å•å°è¯•12345678910111213141516171819# åˆ›å»ºä¸€ä¸ªé¡¹ç›®$ django -admin startproject mysite# å¼€å¯æœåŠ¡$ python manage.py runserver# å‡ºçŽ°å¦‚ä¸‹å­—æ ·May 14, 2016 - 00:00:21Django version 1.9.6, using settings 'mysite.settings'Starting development server at http://127.0.0.1:8000/Quit the server with CONTROL-C.Not Found: /[14/May/2016 00:00:32] "GET / HTTP/1.1" 200 1767Not Found: /favicon.ico[14/May/2016 00:00:32] "GET /favicon.ico HTTP/1.1" 404 1936# æ‰“å¼€æµè§ˆå™¨è¾“å…¥`http://127.0.0.1:8000/`å°±å¯ä»¥çœ‹åˆ°It workedå­—æ ·ï¼Œä¸€ä¸ªç®€å•çš„webæœåŠ¡å°±å¥½äº†# ä½ å¯ä»¥ä½¿ç”¨`python manage.py`æŸ¥çœ‹æ›´å¤šçš„å‘½ä»¤ å„ä¸ªæ–‡ä»¶çš„ç®€å•ä»‹ç»12345678910$ cd mysite/$ lsmanage.py mysite# manage.pyæ˜¯ä¸€ä¸ªç®¡ç†å·¥å…·ï¼Œä½¿ç”¨å®ƒå¯ä»¥ç®¡ç†æœåŠ¡å™¨ï¼Œæ¯”å¦‚å¼€å¯æœåŠ¡ç­‰# mysiteæ˜¯ä½ çš„å·¥ç¨‹ç›®å½•$ cd mysite/__init__.py settings.py urls.py wsgi.py__init__.pyc settings.pyc urls.pyc wsgi.pyc# settings.py æ˜¯ä¸€äº›é…ç½®ä¿¡æ¯# urls.py æ˜¯urlçš„æ˜ å°„ï¼Œä»–è¡¨ç¤ºä¸åŒçš„urlä¼šæ˜ å°„åˆ°ä¸åŒçš„ç½‘é¡µ å»ºç«‹app djangoæ˜¯ä½¿ç”¨appçš„å½¢å¼æ¥é…ç½®æ¨¡å—ï¼Œä½ å¯ä»¥å»ºç«‹æ–°çš„æ¨¡å— 12345678910111213$ python manage.py startapp blog# å¯ä»¥å‘çŽ°åœ¨mysiteç›®å½•ä¸‹æœ‰äº†blogå’Œmysiteä¸¤ä¸ªæ–‡ä»¶å¤¹# åœ¨mysite/mysite/settings.pyä¸­é…ç½®è¿™ä¸ªappæ¨¡å—# Application definitionINSTALLED_APPS = [ 'django.contrib.admin', 'django.contrib.auth', 'django.contrib.contenttypes', 'django.contrib.sessions', 'django.contrib.messages', 'django.contrib.staticfiles', 'blog'] æž„å»ºä¸€ä¸ªç®€å•çš„ç½‘é¡µ123456789101112131415161718192021222324252627$ cd blog/$ ls_init__.py admin.pyc models.py views.py__init__.pyc apps.py models.pyc views.pycadmin.py migrations tests.py# blogç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬çŽ°åœ¨åªä½¿ç”¨views.pyï¼Œä»–æ˜¯ç”¨æ¥æž„å»ºè¾“å‡ºhtml é¡µé¢çš„ä¸€ä¸ªç±»#ï¼ˆ1ï¼‰æ‰“å¼€views.py å®šä¹‰ä¸€ä¸ªç®€å•çš„htmlé¡µé¢from django.shortcuts import renderfrom django.http import HttpResponse# Create your views here.def hello(request): return HttpResponse('&lt;html&gt;hello world&lt;/html&gt;') # (2) æ‰“å¼€mysite/mysite/urls.py é…ç½®urlæ˜ å°„from django.conf.urls import urlfrom django.contrib import adminurlpatterns = [ url(r'^admin/', admin.site.urls), url(r'hello','blog.views.hello')]# (3) å¯åŠ¨æœåŠ¡,åœ¨æµè§ˆå™¨è¾“å…¥http://127.0.0.1:8000/hello,å¯ä»¥èŽ·å¾—è¿”å›žçš„ç½‘é¡µ$ python manage.py runserver]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodeå¼€å‘-1-åŸºç¡€]]></title>
    <url>%2Farticle%2F3697016025%2F</url>
    <content type="text"><![CDATA[åŸºæœ¬å·¥å…·çš„é…ç½®æ£€æµ‹xcodeæ˜¯å¦å®‰è£…12$ xcode-select -p/Applications/Xcode.app/Contents/Developer æ£€æµ‹pythonå’Œrubyç‰ˆæœ¬12$ python -v$ ruby -v å®‰è£…homebrew1$ /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)" å®‰è£…node.js1$ brew install node ç¬¬ä¸€ä¸ªwebåº”ç”¨åˆ›å»ºè¿žæŽ¥12345678910111213141516//æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä¸ºserver.js,å†…å®¹å¦‚ä¸‹const http = require('http');const hostname = '127.0.0.1';const port = 3000;const server = http.createServer((req, res) =&gt; &#123; res.statusCode = 200; res.setHeader('Content-Type', 'text/plain'); res.end('Hello World\n');&#125;);server.listen(port, hostname, () =&gt; &#123; console.log(`Server running at http://$&#123;hostname&#125;:$&#123;port&#125;/`);&#125;); å¯åŠ¨æœåŠ¡ åˆ°ç›¸åº”ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤,æ‰“å¼€æµè§ˆå™¨è¾“å…¥http://127.0.0.1:3000/å¯ä»¥çœ‹åˆ°æœåŠ¡å·²ç»èµ·æ¥äº†ï¼Œä½¿ç”¨ctrl+cåœæ­¢æœåŠ¡ 1$ node server.js]]></content>
      <categories>
        <category>Node</category>
      </categories>
      <tags>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SwiftåŸºç¡€2]]></title>
    <url>%2Farticle%2F1243741076%2F</url>
    <content type="text"><![CDATA[å¯é€‰åž‹çš„æ¦‚å¿µ æ•°æ®ç±»åž‹ï¼‹ï¼Ÿå°†ä¼šæž„æˆä¸€ç§æ–°çš„ç±»åž‹ï¼Œå¯é€‰åž‹ï¼ŒString?ä¸ºå­—ç¬¦ä¸²å¯é€‰åž‹ï¼Œï¼Œåœ¨swiftä¸­ï¼Œç©ºçš„æ¦‚å¿µç•¥æœ‰ä¸åŒï¼Œjavaä¸­ï¼Œå¦‚æžœä¸€ä¸ªå¯¹è±¡å˜é‡ï¼Œæ²¡æœ‰æŒ‡å‘ï¼Œä¸ºnullï¼›ä¸€ä¸ªintç±»åž‹çš„å˜é‡å¦‚æžœæ²¡æœ‰åˆå§‹åŒ–ï¼Œå€¼ä¸º0ï¼Œnullå’Œ0 æ„ä¸ºæ²¡æœ‰ï¼Œåœ¨swiftä¸­ï¼Œç©ºæ˜¯ä¸€ç§å®Œå…¨ç‹¬ç«‹çš„æ•°æ®ç±»åž‹ï¼Œnilçš„ä½ç½®å’ŒIntï¼ŒStringçš„åœ°ä½æ˜¯ä¸€æ ·çš„ï¼Œä»–ä¸æ˜¯å¯¹è±¡æˆ–è€…æ•°æ®çš„ä¸€ç§ç‰¹æ®ŠçŠ¶æ€ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„å¯¹è±¡ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ä»£ç ä¸­(1)çš„éƒ¨åˆ†æ˜¯ç¼–è¯‘é”™è¯¯çš„ï¼Œä¼šæç¤ºï¼Œnilç±»åž‹æ˜¯ä¸èƒ½å’ŒStringç±»åž‹è¿›è¡Œçš„æ¯”è¾ƒçš„ï¼Œè¯¥è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†ä½¿swiftæ›´å…·å®‰å…¨æ€§ï¼Œå› ä¸ºä»»ä½•å¯¹è±¡éƒ½ä¸èƒ½è®¾ç½®ä¸ºnil,å°±å¦‚åŒStringç±»åž‹çš„æ•°æ®ä¸èƒ½è®¾ç½®ä¸ºintç±»åž‹çš„æ•°æ®ï¼Œä»–ä»¬æ˜¯å®Œå…¨ä¸åŒçš„å¯¹è±¡ï¼Œå¯ä»¥é¿å…æ½œåœ¨ç©ºæŒ‡é’ˆçš„å‘ç”Ÿã€‚ 123456789101112131415161718192021222324//(1)var str = "abc"if(str == nil)&#123;&#125;//String? ä¸ºStringå¯é€‰åž‹ï¼Œä»–æ„å‘³ç€è¿™ç§ç±»åž‹ï¼Œå¯ä»¥ä¸ºnil,è¿˜æ˜¯é‚£å¥è¯ï¼Œå¯é€‰åž‹å’Œnilä¸æ˜¯ä¸€ä¸ªç±»åž‹çš„ç‰¹æ®ŠçŠ¶æ€ï¼Œä»–æ˜¯ä¸€ç§æ–°çš„ç±»åž‹ã€‚//2var optionalStr:String? = "hello"optionalStr = "world"print(optionalStr == nil) var greet = "hey"if let name = optionalStr&#123; greet = "hello \(name)";&#125;print(greet) if(optionalStr != nil)&#123; print("optional str is not nil")&#125; whereä¸Žæ¨¡å¼åŒ¹é…1234567891011121314151617181920212223242526272829303132333435//switchä¸­ä½¿ç”¨whereè¯­å¥let point = (3,3)switch point &#123; case let(x,y) where x == y: print("x == y") case let(x,y) where x == -y: print("x == -y") default: print("rst is \(point.0) , \(point.1)")&#125;//switchä¸­ä½¿ç”¨è¿ç®—ç¬¦ let age = 19switch age&#123; case 10 ... 19: print("teenager") default: print("not teenager")&#125; //ifä¸­ä½¿ç”¨æ¨¡å¼ if case 10...19 = age where age &gt; 18&#123; print("teenager and in colldge")&#125; //ifä¸­ä½¿ç”¨æ¨¡å¼å’Œwhereè¯­å¥let vector = (4,0)if case (let x,0) = vector where x &gt; 2 &amp;&amp; x &lt; 5&#123; print("it is vector")&#125; //ifä¸­ä½¿ç”¨æ¨¡å¼ï¼‹where+è¿ç®—ç¬¦ for case let i in 1 ... 100 where i % 3==0&#123; print("i is \(i)")&#125; guardå…³é”®å­—12345678910111213//guard else é˜²æ­¢æ•°æ®é”™è¯¯ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯éœ€è¦æ»¡è¶³çš„ä¸€ç§å…ˆå†³æ¡ä»¶//ä¾‹å¦‚ä¸‹é¢money&gt;price,capacity &gt; volumeæ˜¯å¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼Œç®€åŒ–è¯­æ³•ï¼Œé˜²æ­¢é”™è¯¯func buy(money:Int,price:Int,capacity:Int,volume:Int) -&gt; Bool&#123; guard money &gt; price else &#123; print("not money") return false &#125; guard capacity &gt; volume else&#123; print("not volume") return false &#125; return true&#125; Stringç±»åž‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273//å­—ç¬¦ä¸²var originStr = "this is str"originStr = "this is new str"//å®šä¹‰ä¸€ä¸ªç©ºå­—ç¬¦ä¸²let emptyStr = ""//åˆ¤ç©ºæ“ä½œprint(emptyStr.isEmpty)//åˆå¹¶å­—ç¬¦ä¸²var rstStr = originStr + emptyStr//ä½¿ç”¨+=,æ­¤æ—¶rstStrå¿…é¡»æ˜¯å˜é‡rstStr += originStr//å­—ç¬¦ä¸²æ’å€¼rstStr = "this is new str and insert \(100)"//è½¬ä¹‰å­—ç¬¦ \//éåŽ†å­—ç¬¦ä¸²for c in originStr.characters&#123; print(c)&#125; //Characterlet cc:Character = "!"originStr.append(cc) //å­—ç¬¦ä¸²é•¿åº¦ï¼ŒåŸºäºŽunicodeç ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡æ˜¯3ä¸ªæ±‰å­—æˆ–è€…3ä¸ªå­—æ¯ï¼Œå®ƒçš„countéƒ½æ˜¯3let englishLetter = "abc"let chinseLetter = "æ…•è¯¾ç½‘"let emojiLetter = "ðŸ˜¢ðŸ˜¢ðŸ˜¢"let unicodeLetter = "\u&#123;1f60e&#125;\u&#123;0301&#125;"print(englishLetter.characters.count)print(chinseLetter.characters.count)print(emojiLetter.characters.count)print("enlish is \(englishLetter) chinse is \(chinseLetter) emoji is \(emojiLetter) unicode is \(unicodeLetter)") //ç´¢å¼•è®¿é—®å­—ç¬¦ä¸²ï¼Œéœ€è¦ä½¿ç”¨String.Indexç±»æ¥è®¿é—®//[startIndex,endIndex)let startIndex = originStr.startIndexlet endIndex = originStr.endIndexprint("index is \(startIndex) and content is \(originStr[startIndex])")//å‘åŽnä¸ªstartIndex.advancedBy(6)//å‰é¢ä¸€ä¸ªä½ç½®endIndex.predecessor()//åŽé¢ä¸€ä¸ªä½ç½®startIndex.successor() //Stringçš„ä¸€äº›API//Range&lt;Index&gt;ç±»åž‹let range = startIndex.advancedBy(3) ..&lt; endIndexoriginStr.replaceRange(range, with: "!!!")originStr.appendContentsOf("xxx")originStr.insert("z", atIndex: originStr.endIndex) originStr.removeAtIndex(originStr.endIndex.predecessor()) originStr.removeRange(originStr.endIndex.advancedBy(-2)..&lt;originStr.endIndex) print("upper \(originStr.uppercaseString) low \(originStr.lowercaseString) First up \(originStr.capitalizedString)")originStr.containsString("")originStr.hasSuffix("")originStr.hasPrefix("") //NSString let s2 = NSString(format: "one third is %.2f",1.0/3.0)print("è½¬æ¢ \(s2 as String)") let nsStr:NSString = "one third is 0.33"nsStr.substringFromIndex(4)nsStr.substringFromIndex(3)nsStr.substringWithRange(NSMakeRange(4, 5)) let s6 = " --- Hello --- " as NSString//åŽ»æŽ‰ç©ºæ ¼å’Œï¼print(s6.stringByTrimmingCharactersInSet(NSCharacterSet(charactersInString:" -"))]]></content>
      <categories>
        <category>Swift</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é˜²æ­¢appé—ªç™½å±æˆ–é—ªé»‘å±]]></title>
    <url>%2Farticle%2F3133739946%2F</url>
    <content type="text"><![CDATA[Appå¯åŠ¨æ—¶éœ€è¦åŠ è½½åº”ç”¨è¿›ç¨‹ï¼Œå°±ç®—ä½ çš„è½¯ä»¶åœ¨ Appliation ä¸­ä»€ä¹ˆä¹Ÿæ²¡åšä»æ—§ä¼šæœ‰å»¶æ—¶ï¼Œä¼šæ˜¾ç¤ºç™½å±æˆ–è€…é»‘å±ï¼Œå¾ˆéš¾çœ‹ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»åŽ»æŽ‰é—ªå±ï¼Œç™½å±æˆ–é»‘å±çš„å‡ ç§æ–¹æ¡ˆã€‚ é€æ˜Ž Theme ä½¿ç”¨é€æ˜ŽThemeè§£å†³ï¼ŒåŽŸç†å°±æ˜¯è™½ç„¶ç¨‹åºå¯åŠ¨äº†ï¼Œä½†æ˜¯æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ï¼Œä½ çœ‹åˆ°çš„è¿˜æ˜¯æ¡Œé¢ï¼Œç›®å‰ä¸»æµçš„äº§å“éƒ½æ˜¯ç”¨çš„è¿™ç§æ–¹å¼ï¼Œæ¯”å¦‚QQï¼Œå¾®ä¿¡ã€‚ç¼ºç‚¹å°±æ˜¯ç­‰å¾…çš„æ—¶é—´é•¿ï¼Œé€ æˆç¨‹åºå¯åŠ¨æ…¢çš„æ„Ÿè§‰ã€‚ 1234&lt;style name="Theme.AppStartUseTransparent" parent="Theme.AppCompat.NoActionBar"&gt; &lt;item name="android:windowIsTranslucent"&gt;true&lt;/item&gt; &lt;item name="android:windowNoTitle"&gt;true&lt;/item&gt;&lt;/style&gt; å›¾ç‰‡ Theme ä½¿ç”¨å›¾ç‰‡Themeè§£å†³ï¼ŒåŽŸç†å°±æ˜¯è®¾ç½®ä¸€å¼ èƒŒæ™¯å›¾ï¼Œåœ¨ä½ çš„ç¨‹åºæ²¡æœ‰åŠ è½½å®Œæˆçš„æ—¶å€™ä¼šæ˜¾ç¤ºè¿™å¼ èƒŒæ™¯å›¾ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨shapeè‡ªå®šä¹‰æˆ–è€…ä½¿ç”¨å›¾ç‰‡ï¼Œä¼˜ç‚¹å°±æ˜¯å¯åŠ¨å¾ˆå¿«ï¼Œæ˜¾ç¤ºçš„æ•ˆæžœå–å†³äºŽä½ çš„å›¾ç‰‡ã€‚ 1234&lt;style name="Theme.AppStartUseDrawable" parent="Theme.AppCompat.NoActionBar"&gt; &lt;item name="android:windowBackground"&gt;@drawable/shape_maincolor&lt;/item&gt; &lt;item name="android:windowNoTitle"&gt;true&lt;/item&gt;&lt;/style&gt; åœ¨ manifest.xml ä½¿ç”¨ æˆ‘æ˜¯AppCompatçš„é£Žæ ¼ï¼Œä½ å¯ä»¥å¯¹parentï¼â€œâ€åšé€‚å½“ä¿®æ”¹ã€‚ 123456789 &lt;activity android:name=".activity.LoadingActivity" android:theme="@style/Theme.AppStartUseTransparent"&gt; &lt;intent-filter&gt; &lt;action android:name="android.intent.action.MAIN" /&gt; &lt;category android:name="android.intent.category.LAUNCHER" /&gt; &lt;/intent-filter&gt;&lt;/activity&gt;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RecyclerViewæ·»åŠ Headerå’ŒFooterçš„åŸºæœ¬åŽŸç†]]></title>
    <url>%2Farticle%2F4007050602%2F</url>
    <content type="text"><![CDATA[ä»‹ç» é‡‡ç”¨çš„åŸºæœ¬åŽŸç†å°±æ˜¯Headerå’ŒFooterä½œä¸ºRecyclerViewçš„ä¸€ä¸ªItemï¼Œåªæ˜¯æ˜¾ç¤ºçš„æ–¹å¼ç‰¹åˆ«ä¸€ç‚¹ï¼ŒListViewå®žé™…ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„æ‰€ä»¥æ·»åŠ äº†Headerä¹‹åŽï¼Œæ•°æ®çš„ä½ç½®ä¼šé”™ä¹±ã€‚ ç”±äºŽä½¿ç”¨ä¸åŒçš„LayoutManageræ—¶æ˜¾ç¤ºæ•ˆæžœä¹Ÿä¸ä¸€æ ·ï¼Œ æ‰€ä»¥é’ˆå¯¹ä¸åŒçš„LayoutManageréœ€è¦åšä¸åŒçš„æ“ä½œã€‚ åˆ†æžä¸€ä¸‹ï¼ŒLinearLayoutManageræ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦å°†Headerå’ŒFooterä½œä¸ºä¸€é¡¹å°±å¯ä»¥äº†ï¼ŒGridLayoutManagerå’ŒStaggeredGridLayoutManageråœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿˜éœ€è¦å°†Headerå’ŒFooteræ‰€åœ¨çš„Itemå……æ»¡ä»–æ‰€åœ¨çš„è¿™ä¸€è¡Œã€‚ å˜é‡å’Œæ–¹æ³•123456789101112131415161718//Headerå’ŒFooter,ä»¥åŠå¯¹åº”çš„Typeprivate View mHeaderView;private View mFooterView;private int TYPE_HEADER = -1;private int TYPE_FOOTER = -2;//ä¸€äº›è¾…åŠ©çš„æ–¹æ³•public int getHeaderCount() &#123; return isHasHeader() ? 1 : 0;&#125;private boolean isHasHeader() &#123; return mHeaderView != null;&#125;private boolean isHasFooter() &#123; return mFooterView != null;&#125; æ ¹æ®æ˜¯å¦æœ‰Headerå’ŒFooterèŽ·å–æ•°æ®Size123456789101112//æ ¹æ®æ˜¯å¦æœ‰Headerå’ŒFooterè¿”å›žä¸åŒçš„Size@Overridepublic int getItemCount() &#123; int pos = datas.size(); if (isHasHeader()) pos++; if (isHasFooter()) pos++; return pos;&#125; æ ¹æ®æ˜¯å¦æœ‰Headerå’ŒFooterèŽ·å–Type12345678910111213141516171819202122//èŽ·å–itemçš„typeï¼ŒåŸºæœ¬é€»è¾‘æ˜¯å¦‚æžœæœ‰headeråˆæ˜¯ä½äºŽç¬¬ä¸€ä¸ªçš„åˆ™è¿”å›žHeaderType,å¦‚æžœposè¶…å‡ºäº†dataçš„sizeï¼Œåˆæ˜¯æœ€åŽä¸€ä¸ªï¼Œåˆ™è¿”å›žFooterType@Overridepublic int getItemViewType(int position) &#123; //å¦‚æžœæ²¡æœ‰headeræ²¡æœ‰footerç›´æŽ¥è¿”å›ž if (!isHasHeader() &amp;&amp; !isHasFooter()) return datas.get(position).getRvType(); //æœ‰headerä¸”ä½ç½®0 if (isHasHeader() &amp;&amp; position == 0) return TYPE_HEADER; //posè¶…å‡º if (isHasFooter() &amp;&amp; position == getItemCount() - 1) return TYPE_FOOTER; //å¦‚æžœæœ‰header,ä¸‹æ ‡å‡ä¸€ä¸ª if (isHasHeader()) return datas.get(position - 1).getRvType(); else //æ²¡æœ‰header æŒ‰ç…§åŽŸæ¥çš„ return datas.get(position).getRvType();&#125; æ ¹æ®æ˜¯å¦æœ‰Headerå’ŒFooteråˆ›å»ºHolder123456789101112//æ ¹æ®è¿”å›žçš„ä¸åŒçš„typeä½¿ç”¨HeaderViewå’ŒFooterViewåˆå§‹åŒ–Holder,è‡³æ­¤å·²ç»å¯ä»¥å¯¹LinearLayoutManageræ·»åŠ Headerå’ŒFooter@Overridepublic RvViewHolder onCreateViewHolder(ViewGroup parent, int viewType) &#123; RvViewHolder holder; if (isHasFooter() &amp;&amp; viewType == TYPE_FOOTER) &#123; holder = new RvFooterHolder(mFooterView); &#125; else if (isHasHeader() &amp;&amp; viewType == TYPE_HEADER) &#123; holder = new RvHeaderHolder(mHeaderView); &#125; else &#123; holder = new RvViewHolder(getInflateView(Res4Type.get(viewType).getResId(), return holder;&#125; LinearLayoutManager ç”±äºŽLinearLayoutManageræ˜¯è¿žç»­æŽ’åˆ—çš„ï¼Œæ‰€ä»¥åªéœ€è¦åˆ›å»ºä¸åŒçš„holderå°±å¯ä»¥å®žçŽ°header+footer GridLayoutManager é¦–å…ˆå¦‚ä½•çŸ¥é“æ˜¯å¦æ˜¯GridLayoutManager,é‡å†™onAttachedToRecyclerViewæ–¹æ³•èŽ·å–Manager,è°ƒç”¨gridLayoutManager.setSpanSizeLookupï¼ˆï¼‰æ–¹æ³•ï¼Œè®¾ç½®ä»–è·¨è¶Šçš„å®½åº¦ã€‚ 12345678910111213141516171819202122@Overridepublic void onAttachedToRecyclerView(RecyclerView recyclerView) &#123; super.onAttachedToRecyclerView(recyclerView); Log.e("chendong","onAttachedToRecyclerView"); RecyclerView.LayoutManager layoutManager = recyclerView.getLayoutManager(); if (layoutManager instanceof GridLayoutManager) &#123; final GridLayoutManager gridLayoutManager = (GridLayoutManager) layoutManager; gridLayoutManager.setSpanSizeLookup(new GridLayoutManager.SpanSizeLookup() &#123; @Override public int getSpanSize(int position) &#123; return getItemViewType(position) == TYPE_HEADER || getItemViewType(position) == TYPE_FOOTER ? gridLayoutManager.getSpanCount() : 1; &#125; &#125;); return; &#125; //åˆ¤æ–­æ˜¯ä¸æ˜¯StaggeredGridLayoutManager if(layoutManager instanceof StaggeredGridLayoutManager)&#123; isStaggeredGridLayoutManager = true; &#125;&#125; StaggeredGridLayoutManager ä¸»è¦ä½¿ç”¨StaggeredGridLayoutManager.LayoutParamsçš„ layoutParams.setFullSpan(true);æ–¹æ³•è®¾ç½® 123456789101112131415161718192021222324252627282930@Overridepublic RvViewHolder onCreateViewHolder(ViewGroup parent, int viewType) &#123; RvViewHolder holder; if (isHasFooter() &amp;&amp; viewType == TYPE_FOOTER) &#123; holder = new RvFooterHolder(mFooterView); &#125; else if (isHasHeader() &amp;&amp; viewType == TYPE_HEADER) &#123; holder = new RvHeaderHolder(mHeaderView); &#125; else &#123; holder = new RvViewHolder(getInflateView(Res4Type.get(viewType).getResId(), parent)); if (clickListener != null) &#123; holder.setOnItemClickListener(clickListener); &#125; if (longClickListenter != null) &#123; holder.setOnItemLongClickListener(longClickListenter); &#125; &#125; //å…³é”®ä»£ç  if (isStaggeredGridLayoutManager &amp;&amp; (holder instanceof RvHeaderHolder || holder instanceof RvFooterHolder)) &#123; Log.e("chendong","ç€‘å¸ƒæµè®¾ç½®æ»¡è¡Œ"); StaggeredGridLayoutManager.LayoutParams layoutParams = new StaggeredGridLayoutManager.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT); layoutParams.setFullSpan(true); holder.getParentView().setLayoutParams(layoutParams); &#125; bindListener4View(holder, viewType); return holder;&#125; QuickAdapter æœ€åŽè´´ä¸€ä¸‹æ•´ä¸ªQuickAdapterçš„æºä»£ç ï¼Œæ¶‰åŠç›¸å…³å…·ä½“çš„ç±»å¯ä»¥åŽ»è¿™é‡ŒæŸ¥çœ‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317package com.march.quickrvlibs;import android.content.Context;import android.support.v7.widget.GridLayoutManager;import android.support.v7.widget.RecyclerView;import android.support.v7.widget.StaggeredGridLayoutManager;import android.util.Log;import android.util.SparseArray;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import com.march.quickrvlibs.inter.OnRecyclerItemClickListener;import com.march.quickrvlibs.inter.OnRecyclerItemLongClickListener;import com.march.quickrvlibs.inter.RvQuickInterface;import java.util.Collections;import java.util.List;/** * Created by é™ˆæ ‹ on 15/12/28. * åŠŸèƒ½: */public abstract class RvQuickAdapter&lt;D extends RvQuickInterface&gt; extends RecyclerView.Adapter&lt;RvViewHolder&gt; &#123; protected List&lt;D&gt; datas; protected LayoutInflater mLayoutInflater; protected Context context; protected SparseArray&lt;RvAdapterConfig&gt; Res4Type; private OnRecyclerItemClickListener&lt;RvViewHolder&gt; clickListener; private OnRecyclerItemLongClickListener&lt;RvViewHolder&gt; longClickListenter; private View mHeaderView; private View mFooterView; private int TYPE_HEADER = -1; private int TYPE_FOOTER = -2; private int adapterId;//ä½¿ç”¨æ­¤æ ‡å¿—æ¥åˆ¤æ–­å½“å‰adapterçš„ç±»åž‹ private boolean isStaggeredGridLayoutManager = false; public int getAdapterId() &#123; return adapterId; &#125; /** * è®¾ç½®adapterIdæ ‡ç¤º * @param adapterId adapteræ ‡ç¤º */ public void setAdapterId(int adapterId) &#123; this.adapterId = adapterId; &#125; /** * ä½¿ç”¨æ ‡è®°åˆ¤æ–­,æ˜¯å¦æ˜¯è¯¥adaper * @param adapter adapter * @return boolean */ public boolean isThisAdapter(RvQuickAdapter adapter) &#123; if (adapter == null) &#123; return false; &#125; else if (adapter.getAdapterId() == adapterId) &#123; return true; &#125; return false; &#125; /** * å¤šç±»åž‹é€‚é…,éœ€è¦è°ƒç”¨addType()æ–¹æ³•é…ç½®å‚æ•° * * @param context context * @param datas æ•°æ®æº */ public RvQuickAdapter(Context context, List&lt;D&gt; datas) &#123; this.datas = datas; this.mLayoutInflater = LayoutInflater.from(context); this.context = context; &#125; public RvQuickAdapter(Context context, D[] ds) &#123; Collections.addAll(datas, ds); this.mLayoutInflater = LayoutInflater.from(context); this.context = context; &#125; /** * å•ç±»åž‹é€‚é… * * @param context context * @param datas æ•°æ®æº * @param res layoutèµ„æº */ public RvQuickAdapter(Context context, List&lt;D&gt; datas, int res) &#123; this.datas = datas; this.mLayoutInflater = LayoutInflater.from(context); this.context = context; this.Res4Type = new SparseArray&lt;&gt;(); Res4Type.put(0, new RvAdapterConfig(0, res)); &#125; public RvQuickAdapter(Context context, D[] ds, int res) &#123; Collections.addAll(datas, ds); this.mLayoutInflater = LayoutInflater.from(context); this.context = context; this.Res4Type = new SparseArray&lt;&gt;(); Res4Type.put(0, new RvAdapterConfig(0, res)); &#125; public void setClickListener(OnRecyclerItemClickListener&lt;RvViewHolder&gt; listener) &#123; if (listener != null) &#123; this.clickListener = listener; &#125; &#125; public void setLongClickListener(OnRecyclerItemLongClickListener&lt;RvViewHolder&gt; longClickListenter) &#123; if (longClickListenter != null) &#123; this.longClickListenter = longClickListenter; &#125; &#125; public void addHeader(View mHeaderView) &#123; this.mHeaderView = mHeaderView; &#125; public void addFooter(View mFooterView) &#123; this.mFooterView = mFooterView; &#125; public void addHeader(int mHeaderViewRes) &#123; this.mHeaderView = getInflateView(mHeaderViewRes, null); &#125; public void addFooter(int mFooterViewRes) &#123; this.mFooterView = getInflateView(mFooterViewRes, null); &#125; public View getInflateView(int resId, ViewGroup parent) &#123; return mLayoutInflater.inflate(resId, parent, false); &#125; @Override public RvViewHolder onCreateViewHolder(ViewGroup parent, int viewType) &#123; RvViewHolder holder; if (isHasFooter() &amp;&amp; viewType == TYPE_FOOTER) &#123; holder = new RvFooterHolder(mFooterView); &#125; else if (isHasHeader() &amp;&amp; viewType == TYPE_HEADER) &#123; holder = new RvHeaderHolder(mHeaderView); &#125; else &#123; holder = new RvViewHolder(getInflateView(Res4Type.get(viewType).getResId(), parent)); if (clickListener != null) &#123; holder.setOnItemClickListener(clickListener); &#125; if (longClickListenter != null) &#123; holder.setOnItemLongClickListener(longClickListenter); &#125; &#125; if (isStaggeredGridLayoutManager &amp;&amp; (holder instanceof RvHeaderHolder || holder instanceof RvFooterHolder)) &#123; Log.e("chendong","ç€‘å¸ƒæµè®¾ç½®æ»¡è¡Œ"); StaggeredGridLayoutManager.LayoutParams layoutParams = new StaggeredGridLayoutManager.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT); layoutParams.setFullSpan(true); holder.getParentView().setLayoutParams(layoutParams); &#125; bindListener4View(holder, viewType); return holder; &#125; @Override public void onBindViewHolder(RvViewHolder holder, int position) &#123; if (isHasFooter() &amp;&amp; position == getItemCount() - 1) &#123; bindLisAndData4Footer((RvFooterHolder) holder); &#125; else if (isHasHeader() &amp;&amp; position == 0) &#123; bindLisAndData4Header((RvHeaderHolder) holder); &#125; else &#123; int pos = judgePos(position); bindData4View(holder, datas.get(pos), pos, datas.get(pos).getRvType()); &#125; &#125; @Override public int getItemViewType(int position) &#123; //å¦‚æžœæ²¡æœ‰headeræ²¡æœ‰footerç›´æŽ¥è¿”å›ž if (!isHasHeader() &amp;&amp; !isHasFooter()) return datas.get(position).getRvType(); //æœ‰headerä¸”ä½ç½®0 if (isHasHeader() &amp;&amp; position == 0) return TYPE_HEADER; //posè¶…å‡º if (isHasFooter() &amp;&amp; position == getItemCount() - 1) return TYPE_FOOTER; //å¦‚æžœæœ‰header,ä¸‹æ ‡å‡ä¸€ä¸ª if (isHasHeader()) return datas.get(position - 1).getRvType(); else //æ²¡æœ‰header æŒ‰ç…§åŽŸæ¥çš„ return datas.get(position).getRvType(); &#125; private int judgePos(int pos) &#123; if (isHasHeader()) &#123; return pos - 1; &#125; else &#123; return pos; &#125; &#125; @Override public void onAttachedToRecyclerView(RecyclerView recyclerView) &#123; super.onAttachedToRecyclerView(recyclerView); Log.e("chendong","onAttachedToRecyclerView"); RecyclerView.LayoutManager layoutManager = recyclerView.getLayoutManager(); if (layoutManager instanceof GridLayoutManager) &#123; final GridLayoutManager gridLayoutManager = (GridLayoutManager) layoutManager; gridLayoutManager.setSpanSizeLookup(new GridLayoutManager.SpanSizeLookup() &#123; @Override public int getSpanSize(int position) &#123; return getItemViewType(position) == TYPE_HEADER || getItemViewType(position) == TYPE_FOOTER ? gridLayoutManager.getSpanCount() : 1; &#125; &#125;); return; &#125; if(layoutManager instanceof StaggeredGridLayoutManager)&#123; isStaggeredGridLayoutManager = true; &#125; &#125; /** * ç»‘å®šæ•°æ® * * @param holder ViewHolderæ•°æ®æŒæœ‰è€… * @param data æ•°æ®é›† * @param pos æ•°æ®é›†ä¸­çš„ä½ç½® * @param type type */ public abstract void bindData4View(RvViewHolder holder, D data, int pos, int type); /** * ç»‘å®šç›‘å¬å™¨ * * @param holder ViewHolderæ•°æ®æŒæœ‰è€… * @param type type */ public void bindListener4View(RvViewHolder holder, int type) &#123; &#125; /** * ç»‘å®šheaderçš„æ•°æ® å’Œ ç›‘å¬ * * @param holder header holder */ public void bindLisAndData4Header(RvHeaderHolder holder) &#123; &#125; /** * ç»‘å®šfooterçš„æ•°æ®å’Œç›‘å¬ * * @param holder footer holder */ public void bindLisAndData4Footer(RvFooterHolder holder) &#123; &#125; @Override public int getItemCount() &#123; int pos = datas.size(); if (isHasHeader()) pos++; if (isHasFooter()) pos++; return pos; &#125; public int getHeaderCount() &#123; return isHasHeader() ? 1 : 0; &#125; public int getDataPos(int pos) &#123; return pos - getHeaderCount(); &#125; private boolean isHasHeader() &#123; return mHeaderView != null; &#125; private boolean isHasFooter() &#123; return mFooterView != null; &#125; /** * @param type æ•°æ®çš„ç±»åž‹(å¦‚æžœæœ‰nç§ç±»åž‹,é‚£ä¹ˆtypeçš„å€¼éœ€è¦æ˜¯0 ~ n-1) * @param resId è¯¥ç±»åž‹å¯¹åº”çš„èµ„æºæ–‡ä»¶çš„id * @return QuickTypeAdapter */ public RvQuickAdapter&lt;D&gt; addType(int type, int resId) &#123; if (this.Res4Type == null) this.Res4Type = new SparseArray&lt;&gt;(); this.Res4Type.put(type, new RvAdapterConfig(type, resId)); return this; &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
        <category>Adapter</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Adapter</tag>
        <tag>RecyclerView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ±‰å­—è½¬æ¢æ‹¼éŸ³]]></title>
    <url>%2Farticle%2F1637707051%2F</url>
    <content type="text"><![CDATA[è¿›è¡Œæ±‰å­—çš„å­—ç¬¦ä¸²æ‹¼é…,æ¯”è¾ƒ,æŽ’åºçš„æ—¶å€™ä½¿ç”¨æ±‰å­—å¾ˆä¸æ–¹ä¾¿,è½¬æ¢æˆæ‹¼éŸ³å°±å¯ä»¥è¿›è¡Œé¦–å­—æ¯åŒ¹é…æœç´¢ç­‰å·¥ä½œäº†ã€‚ Apiè°ƒç”¨12345PinyinHelper.get().getPinYin("ä½ å¥½"));PinyinHelper.get().getPinYin("ä½ bSfb");PinyinHelper.get().getPinYin("JHHihubbb"); æ ¸å¿ƒæ–¹æ³•123456789101112131415161718192021//æ ¸å¿ƒæ–¹æ³• /** * å”¯ä¸€å…¬å¼€çš„æ–¹æ³• * * @param input è¾“å…¥çš„æ–‡å­— * @return è¿”å›žçš„æ±‰å­—å°†ä¼šè½¬åŒ–ä¸ºå¤§å†™è‹±æ–‡, å¦‚æžœæ˜¯è‹±æ–‡å°†ä¼šåŽŸæ ·è¿”å›ž */ public String getPinYin(String input) &#123; ArrayList&lt;Token&gt; tokens = get(input); StringBuilder sb = new StringBuilder(); if (tokens != null &amp;&amp; tokens.size() &gt; 0) &#123; for (Token token : tokens) &#123; if (Token.PINYIN == token.type) &#123; sb.append(token.target); &#125; else &#123; sb.append(token.source); &#125; &#125; &#125; return sb.toString(); &#125; é™„æºç ä¸€ä»½123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532package com.march.libs.helper;/** * CdLibsTest com.march.libs.helper * Created by é™ˆæ ‹ on 16/3/28. * åŠŸèƒ½: */import android.text.TextUtils;import android.util.Log;import java.text.Collator;import java.util.ArrayList;import java.util.Locale;public class PinyinHelper &#123; private static final String TAG = "HanziToPinyin"; private static final boolean DEBUG = false; private static final char[] UNIHANS = &#123; '\u963f', '\u54ce', '\u5b89', '\u80ae', '\u51f9', '\u516b', '\u6300', '\u6273', '\u90a6', '\u52f9', '\u9642', '\u5954', '\u4f3b', '\u5c44', '\u8fb9', '\u706c', '\u618b', '\u6c43', '\u51ab', '\u7676', '\u5cec', '\u5693', '\u5072', '\u53c2', '\u4ed3', '\u64a1', '\u518a', '\u5d7e', '\u66fd', '\u66fe', '\u5c64', '\u53c9', '\u8286', '\u8fbf', '\u4f25', '\u6284', '\u8f66', '\u62bb', '\u6c88', '\u6c89', '\u9637', '\u5403', '\u5145', '\u62bd', '\u51fa', '\u6b3b', '\u63e3', '\u5ddb', '\u5205', '\u5439', '\u65fe', '\u9034', '\u5472', '\u5306', '\u51d1', '\u7c97', '\u6c46', '\u5d14', '\u90a8', '\u6413', '\u5491', '\u5446', '\u4e39', '\u5f53', '\u5200', '\u561a', '\u6265', '\u706f', '\u6c10', '\u55f2', '\u7538', '\u5201', '\u7239', '\u4e01', '\u4e1f', '\u4e1c', '\u543a', '\u53be', '\u8011', '\u8968', '\u5428', '\u591a', '\u59b8', '\u8bf6', '\u5940', '\u97a5', '\u513f', '\u53d1', '\u5e06', '\u531a', '\u98de', '\u5206', '\u4e30', '\u8985', '\u4ecf', '\u7d11', '\u4f15', '\u65ee', '\u4f85', '\u7518', '\u5188', '\u768b', '\u6208', '\u7ed9', '\u6839', '\u522f', '\u5de5', '\u52fe', '\u4f30', '\u74dc', '\u4e56', '\u5173', '\u5149', '\u5f52', '\u4e28', '\u5459', '\u54c8', '\u548d', '\u4f44', '\u592f', '\u8320', '\u8bc3', '\u9ed2', '\u62eb', '\u4ea8', '\u5677', '\u53ff', '\u9f41', '\u4e6f', '\u82b1', '\u6000', '\u72bf', '\u5ddf', '\u7070', '\u660f', '\u5419', '\u4e0c', '\u52a0', '\u620b', '\u6c5f', '\u827d', '\u9636', '\u5dfe', '\u5755', '\u5182', '\u4e29', '\u51e5', '\u59e2', '\u5658', '\u519b', '\u5494', '\u5f00', '\u520a', '\u5ffc', '\u5c3b', '\u533c', '\u808e', '\u52a5', '\u7a7a', '\u62a0', '\u625d', '\u5938', '\u84af', '\u5bbd', '\u5321', '\u4e8f', '\u5764', '\u6269', '\u5783', '\u6765', '\u5170', '\u5577', '\u635e', '\u808b', '\u52d2', '\u5d1a', '\u5215', '\u4fe9', '\u5941', '\u826f', '\u64a9', '\u5217', '\u62ce', '\u5222', '\u6e9c', '\u56d6', '\u9f99', '\u779c', '\u565c', '\u5a08', '\u7567', '\u62a1', '\u7f57', '\u5463', '\u5988', '\u57cb', '\u5ada', '\u7264', '\u732b', '\u4e48', '\u5445', '\u95e8', '\u753f', '\u54aa', '\u5b80', '\u55b5', '\u4e5c', '\u6c11', '\u540d', '\u8c2c', '\u6478', '\u54de', '\u6bea', '\u55ef', '\u62cf', '\u8149', '\u56e1', '\u56d4', '\u5b6c', '\u7592', '\u5a1e', '\u6041', '\u80fd', '\u59ae', '\u62c8', '\u5b22', '\u9e1f', '\u634f', '\u56dc', '\u5b81', '\u599e', '\u519c', '\u7fba', '\u5974', '\u597b', '\u759f', '\u9ec1', '\u90cd', '\u5594', '\u8bb4', '\u5991', '\u62cd', '\u7705', '\u4e53', '\u629b', '\u5478', '\u55b7', '\u5309', '\u4e15', '\u56e8', '\u527d', '\u6c15', '\u59d8', '\u4e52', '\u948b', '\u5256', '\u4ec6', '\u4e03', '\u6390', '\u5343', '\u545b', '\u6084', '\u767f', '\u4eb2', '\u72c5', '\u828e', '\u4e18', '\u533a', '\u5cd1', '\u7f3a', '\u590b', '\u5465', '\u7a63', '\u5a06', '\u60f9', '\u4eba', '\u6254', '\u65e5', '\u8338', '\u53b9', '\u909a', '\u633c', '\u5827', '\u5a51', '\u77a4', '\u637c', '\u4ee8', '\u6be2', '\u4e09', '\u6852', '\u63bb', '\u95aa', '\u68ee', '\u50e7', '\u6740', '\u7b5b', '\u5c71', '\u4f24', '\u5f30', '\u5962', '\u7533', '\u8398', '\u6552', '\u5347', '\u5c38', '\u53ce', '\u4e66', '\u5237', '\u8870', '\u95e9', '\u53cc', '\u8c01', '\u542e', '\u8bf4', '\u53b6', '\u5fea', '\u635c', '\u82cf', '\u72fb', '\u590a', '\u5b59', '\u5506', '\u4ed6', '\u56fc', '\u574d', '\u6c64', '\u5932', '\u5fd1', '\u71a5', '\u5254', '\u5929', '\u65eb', '\u5e16', '\u5385', '\u56f2', '\u5077', '\u51f8', '\u6e4d', '\u63a8', '\u541e', '\u4e47', '\u7a75', '\u6b6a', '\u5f2f', '\u5c23', '\u5371', '\u6637', '\u7fc1', '\u631d', '\u4e4c', '\u5915', '\u8672', '\u4eda', '\u4e61', '\u7071', '\u4e9b', '\u5fc3', '\u661f', '\u51f6', '\u4f11', '\u5401', '\u5405', '\u524a', '\u5743', '\u4e2b', '\u6079', '\u592e', '\u5e7a', '\u503b', '\u4e00', '\u56d9', '\u5e94', '\u54df', '\u4f63', '\u4f18', '\u625c', '\u56e6', '\u66f0', '\u6655', '\u7b60', '\u7b7c', '\u5e00', '\u707d', '\u5142', '\u5328', '\u50ae', '\u5219', '\u8d3c', '\u600e', '\u5897', '\u624e', '\u635a', '\u6cbe', '\u5f20', '\u957f', '\u9577', '\u4f4b', '\u8707', '\u8d1e', '\u4e89', '\u4e4b', '\u5cd9', '\u5ea2', '\u4e2d', '\u5dde', '\u6731', '\u6293', '\u62fd', '\u4e13', '\u5986', '\u96b9', '\u5b92', '\u5353', '\u4e72', '\u5b97', '\u90b9', '\u79df', '\u94bb', '\u539c', '\u5c0a', '\u6628', '\u5159', '\u9fc3', '\u9fc4',&#125;; private static final byte[][] PINYINS = &#123; &#123;65, 0, 0, 0, 0, 0&#125;, &#123;65, 73, 0, 0, 0, 0&#125;, &#123;65, 78, 0, 0, 0, 0&#125;, &#123;65, 78, 71, 0, 0, 0&#125;, &#123;65, 79, 0, 0, 0, 0&#125;, &#123;66, 65, 0, 0, 0, 0&#125;, &#123;66, 65, 73, 0, 0, 0&#125;, &#123;66, 65, 78, 0, 0, 0&#125;, &#123;66, 65, 78, 71, 0, 0&#125;, &#123;66, 65, 79, 0, 0, 0&#125;, &#123;66, 69, 73, 0, 0, 0&#125;, &#123;66, 69, 78, 0, 0, 0&#125;, &#123;66, 69, 78, 71, 0, 0&#125;, &#123;66, 73, 0, 0, 0, 0&#125;, &#123;66, 73, 65, 78, 0, 0&#125;, &#123;66, 73, 65, 79, 0, 0&#125;, &#123;66, 73, 69, 0, 0, 0&#125;, &#123;66, 73, 78, 0, 0, 0&#125;, &#123;66, 73, 78, 71, 0, 0&#125;, &#123;66, 79, 0, 0, 0, 0&#125;, &#123;66, 85, 0, 0, 0, 0&#125;, &#123;67, 65, 0, 0, 0, 0&#125;, &#123;67, 65, 73, 0, 0, 0&#125;, &#123;67, 65, 78, 0, 0, 0&#125;, &#123;67, 65, 78, 71, 0, 0&#125;, &#123;67, 65, 79, 0, 0, 0&#125;, &#123;67, 69, 0, 0, 0, 0&#125;, &#123;67, 69, 78, 0, 0, 0&#125;, &#123;67, 69, 78, 71, 0, 0&#125;, &#123;90, 69, 78, 71, 0, 0&#125;, &#123;67, 69, 78, 71, 0, 0&#125;, &#123;67, 72, 65, 0, 0, 0&#125;, &#123;67, 72, 65, 73, 0, 0&#125;, &#123;67, 72, 65, 78, 0, 0&#125;, &#123;67, 72, 65, 78, 71, 0&#125;, &#123;67, 72, 65, 79, 0, 0&#125;, &#123;67, 72, 69, 0, 0, 0&#125;, &#123;67, 72, 69, 78, 0, 0&#125;, &#123;83, 72, 69, 78, 0, 0&#125;, &#123;67, 72, 69, 78, 0, 0&#125;, &#123;67, 72, 69, 78, 71, 0&#125;, &#123;67, 72, 73, 0, 0, 0&#125;, &#123;67, 72, 79, 78, 71, 0&#125;, &#123;67, 72, 79, 85, 0, 0&#125;, &#123;67, 72, 85, 0, 0, 0&#125;, &#123;67, 72, 85, 65, 0, 0&#125;, &#123;67, 72, 85, 65, 73, 0&#125;, &#123;67, 72, 85, 65, 78, 0&#125;, &#123;67, 72, 85, 65, 78, 71&#125;, &#123;67, 72, 85, 73, 0, 0&#125;, &#123;67, 72, 85, 78, 0, 0&#125;, &#123;67, 72, 85, 79, 0, 0&#125;, &#123;67, 73, 0, 0, 0, 0&#125;, &#123;67, 79, 78, 71, 0, 0&#125;, &#123;67, 79, 85, 0, 0, 0&#125;, &#123;67, 85, 0, 0, 0, 0&#125;, &#123;67, 85, 65, 78, 0, 0&#125;, &#123;67, 85, 73, 0, 0, 0&#125;, &#123;67, 85, 78, 0, 0, 0&#125;, &#123;67, 85, 79, 0, 0, 0&#125;, &#123;68, 65, 0, 0, 0, 0&#125;, &#123;68, 65, 73, 0, 0, 0&#125;, &#123;68, 65, 78, 0, 0, 0&#125;, &#123;68, 65, 78, 71, 0, 0&#125;, &#123;68, 65, 79, 0, 0, 0&#125;, &#123;68, 69, 0, 0, 0, 0&#125;, &#123;68, 69, 78, 0, 0, 0&#125;, &#123;68, 69, 78, 71, 0, 0&#125;, &#123;68, 73, 0, 0, 0, 0&#125;, &#123;68, 73, 65, 0, 0, 0&#125;, &#123;68, 73, 65, 78, 0, 0&#125;, &#123;68, 73, 65, 79, 0, 0&#125;, &#123;68, 73, 69, 0, 0, 0&#125;, &#123;68, 73, 78, 71, 0, 0&#125;, &#123;68, 73, 85, 0, 0, 0&#125;, &#123;68, 79, 78, 71, 0, 0&#125;, &#123;68, 79, 85, 0, 0, 0&#125;, &#123;68, 85, 0, 0, 0, 0&#125;, &#123;68, 85, 65, 78, 0, 0&#125;, &#123;68, 85, 73, 0, 0, 0&#125;, &#123;68, 85, 78, 0, 0, 0&#125;, &#123;68, 85, 79, 0, 0, 0&#125;, &#123;69, 0, 0, 0, 0, 0&#125;, &#123;69, 73, 0, 0, 0, 0&#125;, &#123;69, 78, 0, 0, 0, 0&#125;, &#123;69, 78, 71, 0, 0, 0&#125;, &#123;69, 82, 0, 0, 0, 0&#125;, &#123;70, 65, 0, 0, 0, 0&#125;, &#123;70, 65, 78, 0, 0, 0&#125;, &#123;70, 65, 78, 71, 0, 0&#125;, &#123;70, 69, 73, 0, 0, 0&#125;, &#123;70, 69, 78, 0, 0, 0&#125;, &#123;70, 69, 78, 71, 0, 0&#125;, &#123;70, 73, 65, 79, 0, 0&#125;, &#123;70, 79, 0, 0, 0, 0&#125;, &#123;70, 79, 85, 0, 0, 0&#125;, &#123;70, 85, 0, 0, 0, 0&#125;, &#123;71, 65, 0, 0, 0, 0&#125;, &#123;71, 65, 73, 0, 0, 0&#125;, &#123;71, 65, 78, 0, 0, 0&#125;, &#123;71, 65, 78, 71, 0, 0&#125;, &#123;71, 65, 79, 0, 0, 0&#125;, &#123;71, 69, 0, 0, 0, 0&#125;, &#123;71, 69, 73, 0, 0, 0&#125;, &#123;71, 69, 78, 0, 0, 0&#125;, &#123;71, 69, 78, 71, 0, 0&#125;, &#123;71, 79, 78, 71, 0, 0&#125;, &#123;71, 79, 85, 0, 0, 0&#125;, &#123;71, 85, 0, 0, 0, 0&#125;, &#123;71, 85, 65, 0, 0, 0&#125;, &#123;71, 85, 65, 73, 0, 0&#125;, &#123;71, 85, 65, 78, 0, 0&#125;, &#123;71, 85, 65, 78, 71, 0&#125;, &#123;71, 85, 73, 0, 0, 0&#125;, &#123;71, 85, 78, 0, 0, 0&#125;, &#123;71, 85, 79, 0, 0, 0&#125;, &#123;72, 65, 0, 0, 0, 0&#125;, &#123;72, 65, 73, 0, 0, 0&#125;, &#123;72, 65, 78, 0, 0, 0&#125;, &#123;72, 65, 78, 71, 0, 0&#125;, &#123;72, 65, 79, 0, 0, 0&#125;, &#123;72, 69, 0, 0, 0, 0&#125;, &#123;72, 69, 73, 0, 0, 0&#125;, &#123;72, 69, 78, 0, 0, 0&#125;, &#123;72, 69, 78, 71, 0, 0&#125;, &#123;72, 77, 0, 0, 0, 0&#125;, &#123;72, 79, 78, 71, 0, 0&#125;, &#123;72, 79, 85, 0, 0, 0&#125;, &#123;72, 85, 0, 0, 0, 0&#125;, &#123;72, 85, 65, 0, 0, 0&#125;, &#123;72, 85, 65, 73, 0, 0&#125;, &#123;72, 85, 65, 78, 0, 0&#125;, &#123;72, 85, 65, 78, 71, 0&#125;, &#123;72, 85, 73, 0, 0, 0&#125;, &#123;72, 85, 78, 0, 0, 0&#125;, &#123;72, 85, 79, 0, 0, 0&#125;, &#123;74, 73, 0, 0, 0, 0&#125;, &#123;74, 73, 65, 0, 0, 0&#125;, &#123;74, 73, 65, 78, 0, 0&#125;, &#123;74, 73, 65, 78, 71, 0&#125;, &#123;74, 73, 65, 79, 0, 0&#125;, &#123;74, 73, 69, 0, 0, 0&#125;, &#123;74, 73, 78, 0, 0, 0&#125;, &#123;74, 73, 78, 71, 0, 0&#125;, &#123;74, 73, 79, 78, 71, 0&#125;, &#123;74, 73, 85, 0, 0, 0&#125;, &#123;74, 85, 0, 0, 0, 0&#125;, &#123;74, 85, 65, 78, 0, 0&#125;, &#123;74, 85, 69, 0, 0, 0&#125;, &#123;74, 85, 78, 0, 0, 0&#125;, &#123;75, 65, 0, 0, 0, 0&#125;, &#123;75, 65, 73, 0, 0, 0&#125;, &#123;75, 65, 78, 0, 0, 0&#125;, &#123;75, 65, 78, 71, 0, 0&#125;, &#123;75, 65, 79, 0, 0, 0&#125;, &#123;75, 69, 0, 0, 0, 0&#125;, &#123;75, 69, 78, 0, 0, 0&#125;, &#123;75, 69, 78, 71, 0, 0&#125;, &#123;75, 79, 78, 71, 0, 0&#125;, &#123;75, 79, 85, 0, 0, 0&#125;, &#123;75, 85, 0, 0, 0, 0&#125;, &#123;75, 85, 65, 0, 0, 0&#125;, &#123;75, 85, 65, 73, 0, 0&#125;, &#123;75, 85, 65, 78, 0, 0&#125;, &#123;75, 85, 65, 78, 71, 0&#125;, &#123;75, 85, 73, 0, 0, 0&#125;, &#123;75, 85, 78, 0, 0, 0&#125;, &#123;75, 85, 79, 0, 0, 0&#125;, &#123;76, 65, 0, 0, 0, 0&#125;, &#123;76, 65, 73, 0, 0, 0&#125;, &#123;76, 65, 78, 0, 0, 0&#125;, &#123;76, 65, 78, 71, 0, 0&#125;, &#123;76, 65, 79, 0, 0, 0&#125;, &#123;76, 69, 0, 0, 0, 0&#125;, &#123;76, 69, 73, 0, 0, 0&#125;, &#123;76, 69, 78, 71, 0, 0&#125;, &#123;76, 73, 0, 0, 0, 0&#125;, &#123;76, 73, 65, 0, 0, 0&#125;, &#123;76, 73, 65, 78, 0, 0&#125;, &#123;76, 73, 65, 78, 71, 0&#125;, &#123;76, 73, 65, 79, 0, 0&#125;, &#123;76, 73, 69, 0, 0, 0&#125;, &#123;76, 73, 78, 0, 0, 0&#125;, &#123;76, 73, 78, 71, 0, 0&#125;, &#123;76, 73, 85, 0, 0, 0&#125;, &#123;76, 79, 0, 0, 0, 0&#125;, &#123;76, 79, 78, 71, 0, 0&#125;, &#123;76, 79, 85, 0, 0, 0&#125;, &#123;76, 85, 0, 0, 0, 0&#125;, &#123;76, 85, 65, 78, 0, 0&#125;, &#123;76, 85, 69, 0, 0, 0&#125;, &#123;76, 85, 78, 0, 0, 0&#125;, &#123;76, 85, 79, 0, 0, 0&#125;, &#123;77, 0, 0, 0, 0, 0&#125;, &#123;77, 65, 0, 0, 0, 0&#125;, &#123;77, 65, 73, 0, 0, 0&#125;, &#123;77, 65, 78, 0, 0, 0&#125;, &#123;77, 65, 78, 71, 0, 0&#125;, &#123;77, 65, 79, 0, 0, 0&#125;, &#123;77, 69, 0, 0, 0, 0&#125;, &#123;77, 69, 73, 0, 0, 0&#125;, &#123;77, 69, 78, 0, 0, 0&#125;, &#123;77, 69, 78, 71, 0, 0&#125;, &#123;77, 73, 0, 0, 0, 0&#125;, &#123;77, 73, 65, 78, 0, 0&#125;, &#123;77, 73, 65, 79, 0, 0&#125;, &#123;77, 73, 69, 0, 0, 0&#125;, &#123;77, 73, 78, 0, 0, 0&#125;, &#123;77, 73, 78, 71, 0, 0&#125;, &#123;77, 73, 85, 0, 0, 0&#125;, &#123;77, 79, 0, 0, 0, 0&#125;, &#123;77, 79, 85, 0, 0, 0&#125;, &#123;77, 85, 0, 0, 0, 0&#125;, &#123;78, 0, 0, 0, 0, 0&#125;, &#123;78, 65, 0, 0, 0, 0&#125;, &#123;78, 65, 73, 0, 0, 0&#125;, &#123;78, 65, 78, 0, 0, 0&#125;, &#123;78, 65, 78, 71, 0, 0&#125;, &#123;78, 65, 79, 0, 0, 0&#125;, &#123;78, 69, 0, 0, 0, 0&#125;, &#123;78, 69, 73, 0, 0, 0&#125;, &#123;78, 69, 78, 0, 0, 0&#125;, &#123;78, 69, 78, 71, 0, 0&#125;, &#123;78, 73, 0, 0, 0, 0&#125;, &#123;78, 73, 65, 78, 0, 0&#125;, &#123;78, 73, 65, 78, 71, 0&#125;, &#123;78, 73, 65, 79, 0, 0&#125;, &#123;78, 73, 69, 0, 0, 0&#125;, &#123;78, 73, 78, 0, 0, 0&#125;, &#123;78, 73, 78, 71, 0, 0&#125;, &#123;78, 73, 85, 0, 0, 0&#125;, &#123;78, 79, 78, 71, 0, 0&#125;, &#123;78, 79, 85, 0, 0, 0&#125;, &#123;78, 85, 0, 0, 0, 0&#125;, &#123;78, 85, 65, 78, 0, 0&#125;, &#123;78, 85, 69, 0, 0, 0&#125;, &#123;78, 85, 78, 0, 0, 0&#125;, &#123;78, 85, 79, 0, 0, 0&#125;, &#123;79, 0, 0, 0, 0, 0&#125;, &#123;79, 85, 0, 0, 0, 0&#125;, &#123;80, 65, 0, 0, 0, 0&#125;, &#123;80, 65, 73, 0, 0, 0&#125;, &#123;80, 65, 78, 0, 0, 0&#125;, &#123;80, 65, 78, 71, 0, 0&#125;, &#123;80, 65, 79, 0, 0, 0&#125;, &#123;80, 69, 73, 0, 0, 0&#125;, &#123;80, 69, 78, 0, 0, 0&#125;, &#123;80, 69, 78, 71, 0, 0&#125;, &#123;80, 73, 0, 0, 0, 0&#125;, &#123;80, 73, 65, 78, 0, 0&#125;, &#123;80, 73, 65, 79, 0, 0&#125;, &#123;80, 73, 69, 0, 0, 0&#125;, &#123;80, 73, 78, 0, 0, 0&#125;, &#123;80, 73, 78, 71, 0, 0&#125;, &#123;80, 79, 0, 0, 0, 0&#125;, &#123;80, 79, 85, 0, 0, 0&#125;, &#123;80, 85, 0, 0, 0, 0&#125;, &#123;81, 73, 0, 0, 0, 0&#125;, &#123;81, 73, 65, 0, 0, 0&#125;, &#123;81, 73, 65, 78, 0, 0&#125;, &#123;81, 73, 65, 78, 71, 0&#125;, &#123;81, 73, 65, 79, 0, 0&#125;, &#123;81, 73, 69, 0, 0, 0&#125;, &#123;81, 73, 78, 0, 0, 0&#125;, &#123;81, 73, 78, 71, 0, 0&#125;, &#123;81, 73, 79, 78, 71, 0&#125;, &#123;81, 73, 85, 0, 0, 0&#125;, &#123;81, 85, 0, 0, 0, 0&#125;, &#123;81, 85, 65, 78, 0, 0&#125;, &#123;81, 85, 69, 0, 0, 0&#125;, &#123;81, 85, 78, 0, 0, 0&#125;, &#123;82, 65, 78, 0, 0, 0&#125;, &#123;82, 65, 78, 71, 0, 0&#125;, &#123;82, 65, 79, 0, 0, 0&#125;, &#123;82, 69, 0, 0, 0, 0&#125;, &#123;82, 69, 78, 0, 0, 0&#125;, &#123;82, 69, 78, 71, 0, 0&#125;, &#123;82, 73, 0, 0, 0, 0&#125;, &#123;82, 79, 78, 71, 0, 0&#125;, &#123;82, 79, 85, 0, 0, 0&#125;, &#123;82, 85, 0, 0, 0, 0&#125;, &#123;82, 85, 65, 0, 0, 0&#125;, &#123;82, 85, 65, 78, 0, 0&#125;, &#123;82, 85, 73, 0, 0, 0&#125;, &#123;82, 85, 78, 0, 0, 0&#125;, &#123;82, 85, 79, 0, 0, 0&#125;, &#123;83, 65, 0, 0, 0, 0&#125;, &#123;83, 65, 73, 0, 0, 0&#125;, &#123;83, 65, 78, 0, 0, 0&#125;, &#123;83, 65, 78, 71, 0, 0&#125;, &#123;83, 65, 79, 0, 0, 0&#125;, &#123;83, 69, 0, 0, 0, 0&#125;, &#123;83, 69, 78, 0, 0, 0&#125;, &#123;83, 69, 78, 71, 0, 0&#125;, &#123;83, 72, 65, 0, 0, 0&#125;, &#123;83, 72, 65, 73, 0, 0&#125;, &#123;83, 72, 65, 78, 0, 0&#125;, &#123;83, 72, 65, 78, 71, 0&#125;, &#123;83, 72, 65, 79, 0, 0&#125;, &#123;83, 72, 69, 0, 0, 0&#125;, &#123;83, 72, 69, 78, 0, 0&#125;, &#123;88, 73, 78, 0, 0, 0&#125;, &#123;83, 72, 69, 78, 0, 0&#125;, &#123;83, 72, 69, 78, 71, 0&#125;, &#123;83, 72, 73, 0, 0, 0&#125;, &#123;83, 72, 79, 85, 0, 0&#125;, &#123;83, 72, 85, 0, 0, 0&#125;, &#123;83, 72, 85, 65, 0, 0&#125;, &#123;83, 72, 85, 65, 73, 0&#125;, &#123;83, 72, 85, 65, 78, 0&#125;, &#123;83, 72, 85, 65, 78, 71&#125;, &#123;83, 72, 85, 73, 0, 0&#125;, &#123;83, 72, 85, 78, 0, 0&#125;, &#123;83, 72, 85, 79, 0, 0&#125;, &#123;83, 73, 0, 0, 0, 0&#125;, &#123;83, 79, 78, 71, 0, 0&#125;, &#123;83, 79, 85, 0, 0, 0&#125;, &#123;83, 85, 0, 0, 0, 0&#125;, &#123;83, 85, 65, 78, 0, 0&#125;, &#123;83, 85, 73, 0, 0, 0&#125;, &#123;83, 85, 78, 0, 0, 0&#125;, &#123;83, 85, 79, 0, 0, 0&#125;, &#123;84, 65, 0, 0, 0, 0&#125;, &#123;84, 65, 73, 0, 0, 0&#125;, &#123;84, 65, 78, 0, 0, 0&#125;, &#123;84, 65, 78, 71, 0, 0&#125;, &#123;84, 65, 79, 0, 0, 0&#125;, &#123;84, 69, 0, 0, 0, 0&#125;, &#123;84, 69, 78, 71, 0, 0&#125;, &#123;84, 73, 0, 0, 0, 0&#125;, &#123;84, 73, 65, 78, 0, 0&#125;, &#123;84, 73, 65, 79, 0, 0&#125;, &#123;84, 73, 69, 0, 0, 0&#125;, &#123;84, 73, 78, 71, 0, 0&#125;, &#123;84, 79, 78, 71, 0, 0&#125;, &#123;84, 79, 85, 0, 0, 0&#125;, &#123;84, 85, 0, 0, 0, 0&#125;, &#123;84, 85, 65, 78, 0, 0&#125;, &#123;84, 85, 73, 0, 0, 0&#125;, &#123;84, 85, 78, 0, 0, 0&#125;, &#123;84, 85, 79, 0, 0, 0&#125;, &#123;87, 65, 0, 0, 0, 0&#125;, &#123;87, 65, 73, 0, 0, 0&#125;, &#123;87, 65, 78, 0, 0, 0&#125;, &#123;87, 65, 78, 71, 0, 0&#125;, &#123;87, 69, 73, 0, 0, 0&#125;, &#123;87, 69, 78, 0, 0, 0&#125;, &#123;87, 69, 78, 71, 0, 0&#125;, &#123;87, 79, 0, 0, 0, 0&#125;, &#123;87, 85, 0, 0, 0, 0&#125;, &#123;88, 73, 0, 0, 0, 0&#125;, &#123;88, 73, 65, 0, 0, 0&#125;, &#123;88, 73, 65, 78, 0, 0&#125;, &#123;88, 73, 65, 78, 71, 0&#125;, &#123;88, 73, 65, 79, 0, 0&#125;, &#123;88, 73, 69, 0, 0, 0&#125;, &#123;88, 73, 78, 0, 0, 0&#125;, &#123;88, 73, 78, 71, 0, 0&#125;, &#123;88, 73, 79, 78, 71, 0&#125;, &#123;88, 73, 85, 0, 0, 0&#125;, &#123;88, 85, 0, 0, 0, 0&#125;, &#123;88, 85, 65, 78, 0, 0&#125;, &#123;88, 85, 69, 0, 0, 0&#125;, &#123;88, 85, 78, 0, 0, 0&#125;, &#123;89, 65, 0, 0, 0, 0&#125;, &#123;89, 65, 78, 0, 0, 0&#125;, &#123;89, 65, 78, 71, 0, 0&#125;, &#123;89, 65, 79, 0, 0, 0&#125;, &#123;89, 69, 0, 0, 0, 0&#125;, &#123;89, 73, 0, 0, 0, 0&#125;, &#123;89, 73, 78, 0, 0, 0&#125;, &#123;89, 73, 78, 71, 0, 0&#125;, &#123;89, 79, 0, 0, 0, 0&#125;, &#123;89, 79, 78, 71, 0, 0&#125;, &#123;89, 79, 85, 0, 0, 0&#125;, &#123;89, 85, 0, 0, 0, 0&#125;, &#123;89, 85, 65, 78, 0, 0&#125;, &#123;89, 85, 69, 0, 0, 0&#125;, &#123;89, 85, 78, 0, 0, 0&#125;, &#123;74, 85, 78, 0, 0, 0&#125;, &#123;89, 85, 78, 0, 0, 0&#125;, &#123;90, 65, 0, 0, 0, 0&#125;, &#123;90, 65, 73, 0, 0, 0&#125;, &#123;90, 65, 78, 0, 0, 0&#125;, &#123;90, 65, 78, 71, 0, 0&#125;, &#123;90, 65, 79, 0, 0, 0&#125;, &#123;90, 69, 0, 0, 0, 0&#125;, &#123;90, 69, 73, 0, 0, 0&#125;, &#123;90, 69, 78, 0, 0, 0&#125;, &#123;90, 69, 78, 71, 0, 0&#125;, &#123;90, 72, 65, 0, 0, 0&#125;, &#123;90, 72, 65, 73, 0, 0&#125;, &#123;90, 72, 65, 78, 0, 0&#125;, &#123;90, 72, 65, 78, 71, 0&#125;, &#123;67, 72, 65, 78, 71, 0&#125;, &#123;90, 72, 65, 78, 71, 0&#125;, &#123;90, 72, 65, 79, 0, 0&#125;, &#123;90, 72, 69, 0, 0, 0&#125;, &#123;90, 72, 69, 78, 0, 0&#125;, &#123;90, 72, 69, 78, 71, 0&#125;, &#123;90, 72, 73, 0, 0, 0&#125;, &#123;83, 72, 73, 0, 0, 0&#125;, &#123;90, 72, 73, 0, 0, 0&#125;, &#123;90, 72, 79, 78, 71, 0&#125;, &#123;90, 72, 79, 85, 0, 0&#125;, &#123;90, 72, 85, 0, 0, 0&#125;, &#123;90, 72, 85, 65, 0, 0&#125;, &#123;90, 72, 85, 65, 73, 0&#125;, &#123;90, 72, 85, 65, 78, 0&#125;, &#123;90, 72, 85, 65, 78, 71&#125;, &#123;90, 72, 85, 73, 0, 0&#125;, &#123;90, 72, 85, 78, 0, 0&#125;, &#123;90, 72, 85, 79, 0, 0&#125;, &#123;90, 73, 0, 0, 0, 0&#125;, &#123;90, 79, 78, 71, 0, 0&#125;, &#123;90, 79, 85, 0, 0, 0&#125;, &#123;90, 85, 0, 0, 0, 0&#125;, &#123;90, 85, 65, 78, 0, 0&#125;, &#123;90, 85, 73, 0, 0, 0&#125;, &#123;90, 85, 78, 0, 0, 0&#125;, &#123;90, 85, 79, 0, 0, 0&#125;, &#123;0, 0, 0, 0, 0, 0&#125;, &#123;83, 72, 65, 78, 0, 0&#125;, &#123;0, 0, 0, 0, 0, 0&#125;,&#125;; /** * First and last Chinese character with known Pinyin according to zh collation */ private static final String FIRST_PINYIN_UNIHAN = "\u963F"; private static final String LAST_PINYIN_UNIHAN = "\u9FFF"; private static final Collator COLLATOR = Collator.getInstance(Locale.CHINA); private static PinyinHelper sInstance; private final boolean mHasChinaCollator; public static class Token &#123; /** * Separator between target string for each source char */ public static final String SEPARATOR = " "; public static final int LATIN = 1; public static final int PINYIN = 2; public static final int UNKNOWN = 3; public Token() &#123; &#125; public Token(int type, String source, String target) &#123; this.type = type; this.source = source; this.target = target; &#125; /** * Type of this token, ASCII, PINYIN or UNKNOWN. */ public int type; /** * Original string before translation. */ public String source; /** * Translated string of source. For Han, target is corresponding Pinyin. Otherwise target is * original string in source. */ public String target; &#125; protected PinyinHelper(boolean hasChinaCollator) &#123; mHasChinaCollator = hasChinaCollator; &#125; public static PinyinHelper get() &#123; synchronized (PinyinHelper.class) &#123; if (sInstance != null) &#123; return sInstance; &#125; final Locale locale[] = Collator.getAvailableLocales(); for (int i = 0; i &lt; locale.length; i++) &#123; if (locale[i].equals(Locale.CHINA)) &#123; // Do self validation just once. if (DEBUG) &#123; Log.d(TAG, "Self validation. Result: " + doSelfValidation()); &#125; sInstance = new PinyinHelper(true); return sInstance; &#125; &#125; sInstance = new PinyinHelper(true); return sInstance; &#125; &#125; private static boolean doSelfValidation() &#123; char lastChar = UNIHANS[0]; String lastString = Character.toString(lastChar); for (char c : UNIHANS) &#123; if (lastChar == c) &#123; continue; &#125; final String curString = Character.toString(c); int cmp = COLLATOR.compare(lastString, curString); if (cmp &gt;= 0) &#123; return false; &#125; lastString = curString; &#125; return true; &#125; private Token getToken(char character) &#123; Token token = new Token(); final String letter = Character.toString(character); token.source = letter; int offset = -1; int cmp; if (character &lt; 256) &#123; token.type = Token.LATIN; token.target = letter; return token; &#125; else &#123; cmp = COLLATOR.compare(letter, FIRST_PINYIN_UNIHAN); if (cmp &lt; 0) &#123; token.type = Token.UNKNOWN; token.target = letter; return token; &#125; else if (cmp == 0) &#123; token.type = Token.PINYIN; offset = 0; &#125; else &#123; cmp = COLLATOR.compare(letter, LAST_PINYIN_UNIHAN); if (cmp &gt; 0) &#123; token.type = Token.UNKNOWN; token.target = letter; return token; &#125; else if (cmp == 0) &#123; token.type = Token.PINYIN; offset = UNIHANS.length - 1; &#125; &#125; &#125; token.type = Token.PINYIN; if (offset &lt; 0) &#123; int begin = 0; int end = UNIHANS.length - 1; while (begin &lt;= end) &#123; offset = (begin + end) / 2; final String unihan = Character.toString(UNIHANS[offset]); cmp = COLLATOR.compare(letter, unihan); if (cmp == 0) &#123; break; &#125; else if (cmp &gt; 0) &#123; begin = offset + 1; &#125; else &#123; end = offset - 1; &#125; &#125; &#125; if (cmp &lt; 0) &#123; offset--; &#125; StringBuilder pinyin = new StringBuilder(); for (int j = 0; j &lt; PINYINS[offset].length &amp;&amp; PINYINS[offset][j] != 0; j++) &#123; pinyin.append((char) PINYINS[offset][j]); &#125; token.target = pinyin.toString(); if (TextUtils.isEmpty(token.target)) &#123; token.type = Token.UNKNOWN; token.target = token.source; &#125; return token; &#125; private ArrayList&lt;Token&gt; get(final String input) &#123; ArrayList&lt;Token&gt; tokens = new ArrayList&lt;Token&gt;(); if (!mHasChinaCollator || TextUtils.isEmpty(input)) &#123; // return empty tokens. return tokens; &#125; final int inputLength = input.length(); final StringBuilder sb = new StringBuilder(); int tokenType = Token.LATIN; for (int i = 0; i &lt; inputLength; i++) &#123; final char character = input.charAt(i); if (character == ' ') &#123; if (sb.length() &gt; 0) &#123; addToken(sb, tokens, tokenType); &#125; &#125; else if (character &lt; 256) &#123; if (tokenType != Token.LATIN &amp;&amp; sb.length() &gt; 0) &#123; addToken(sb, tokens, tokenType); &#125; tokenType = Token.LATIN; sb.append(character); &#125; else &#123; Token t = getToken(character); if (t.type == Token.PINYIN) &#123; if (sb.length() &gt; 0) &#123; addToken(sb, tokens, tokenType); &#125; tokens.add(t); tokenType = Token.PINYIN; &#125; else &#123; if (tokenType != t.type &amp;&amp; sb.length() &gt; 0) &#123; addToken(sb, tokens, tokenType); &#125; tokenType = t.type; sb.append(character); &#125; &#125; &#125; if (sb.length() &gt; 0) &#123; addToken(sb, tokens, tokenType); &#125; return tokens; &#125; private void addToken( final StringBuilder sb, final ArrayList&lt;Token&gt; tokens, final int tokenType) &#123; String str = sb.toString(); tokens.add(new Token(tokenType, str, str)); sb.setLength(0); &#125; /** * å”¯ä¸€å…¬å¼€çš„æ–¹æ³• * * @param input è¾“å…¥çš„æ–‡å­— * @return è¿”å›žçš„æ±‰å­—å°†ä¼šè½¬åŒ–ä¸ºå¤§å†™è‹±æ–‡, å¦‚æžœæ˜¯è‹±æ–‡å°†ä¼šåŽŸæ ·è¿”å›ž */ public String getPinYin(String input) &#123; ArrayList&lt;Token&gt; tokens = get(input); StringBuilder sb = new StringBuilder(); if (tokens != null &amp;&amp; tokens.size() &gt; 0) &#123; for (Token token : tokens) &#123; if (Token.PINYIN == token.type) &#123; sb.append(token.target); &#125; else &#123; sb.append(token.source); &#125; &#125; &#125; return sb.toString(); &#125;&#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Tools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidç³»ç»Ÿåˆ†äº«çš„æ³¨å†Œå’Œè°ƒèµ·]]></title>
    <url>%2Farticle%2F3733894393%2F</url>
    <content type="text"><![CDATA[ç³»ç»Ÿç›¸å†Œç…§ç‰‡é•¿æŒ‰æ—¶ä¼šå¼¹å‡ºåˆ†äº«å‘é€é€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©åˆ†äº«åˆ°QQï¼Œå¾®ä¿¡ç­‰ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ï¼š å¦‚ä½•å°†è‡ªå·±çš„åº”ç”¨æ³¨å†Œåˆ°ç³»ç»Ÿåˆ†äº«ä¸­ï¼Œä½¿ç”¨æˆ·å¯ä»¥å°†ç…§ç‰‡è§†é¢‘æ–‡ä»¶ç­‰å‘é€åˆ°è‡ªå·±çš„åº”ç”¨ä¸­ã€‚ å¦‚ä½•æŽ¥å—è§£æžç³»ç»Ÿåˆ†äº«å‘é€è¿‡æ¥çš„æ•°æ®ã€‚ å¦‚ä½•å”¤é†’ç³»ç»Ÿåˆ†äº«ï¼Œåˆ†äº«ç…§ç‰‡è§†é¢‘æ–‡ä»¶åˆ°åˆ«çš„åº”ç”¨ã€‚ æ³¨å†Œç³»ç»Ÿçš„åˆ†äº«éœ€è¦åœ¨ AndroidManifest.xml æ–‡ä»¶å£°æ˜Ž &lt;intent-filter&gt;ï¼Œä½¿å¾—ä½ å¯ä»¥åœ¨ç”¨æˆ·ç‚¹å‡»åˆ†äº«/å‘é€æŒ‰é’®æ—¶è°ƒèµ·ä½ çš„åº”ç”¨ï¼Œå°†å›¾ç‰‡å’Œæ–‡å­—ç­‰åˆ†äº«åˆ°ä½ çš„Appã€‚ å…³äºŽ mimeType çš„ç›¸å…³ç±»åž‹ï¼Œè¯·æŸ¥çœ‹ MimeUtils.java æ–‡ä»¶ã€‚ 12345678910111213141516171819&lt;activity android:name=".activity.HandleShareActivity"&gt; &lt;intent-filter&gt; &lt;!--æŽ¥å—å•ä¸ªæ–‡ä»¶åˆ†äº«--&gt; &lt;action android:name="android.intent.action.SEND"/&gt; &lt;!--æŽ¥å—å¤šä¸ªæ–‡ä»¶åˆ†äº«--&gt; &lt;action android:name="android.intent.action.SEND_MULTIPLE"/&gt; &lt;category android:name="android.intent.category.DEFAULT"/&gt; &lt;!--æŽ¥å—å›¾ç‰‡ç±»æ–‡ä»¶åˆ†äº« image/jpeg" "image/bmp" "image/gif" "image/jpg" "image/png"--&gt; &lt;data android:mimeType="image/*"/&gt; &lt;!--æŽ¥å—æ–‡æœ¬åˆ†äº« text/plain--&gt; &lt;data android:mimeType="text/*"/&gt; &lt;!--æŽ¥å—è§†é¢‘åˆ†äº« video/wav video/mp4--&gt; &lt;data android:mimeType="video/*"/&gt; &lt;!--æŽ¥å—å£°éŸ³æ–‡ä»¶åˆ†äº«--&gt; &lt;data android:mimeType="audio/*"/&gt; &lt;!--æŽ¥å—åŽ‹ç¼©æ–‡ä»¶å’Œå…¶ä»–å„ç§æ–‡ä»¶åˆ†äº«--&gt; &lt;data android:mimeType="application/*"/&gt; &lt;/intent-filter&gt;&lt;/activity&gt; æŽ¥å—åˆ†äº«çš„æ•°æ®å½“ç›´æŽ¥é•¿æŒ‰é€‰ä¸­æŸäº›æ–‡æœ¬åˆ†äº«æ—¶æ‹¿åˆ°çš„æ•°æ®æœ‰äº›ä¸ä¸€æ ·ï¼Œæ˜¯å­˜å‚¨åœ¨ Intent.EXTRA_TEXT ä¸­çš„ï¼Œå› æ­¤å•ç‹¬å¤„ç†ä¸€ä¸‹ã€‚ 12345678910111213141516171819/** * å¤„ç†åˆ†äº«é¡µé¢å‘æ¥çš„intent */public static void handleIntent(Activity context) &#123; Intent intent = context.getIntent(); String type = intent.getType(); if (type == null) return; // å½“æ–‡ä»¶æ ¼å¼æ— æ³•è¯†åˆ«æˆ–é€‰æ‹©äº†å¤šç§ç±»åž‹çš„æ–‡ä»¶æ—¶ï¼Œtypeä¼šå˜æˆ */* LogUtils.e("type " + type); //typeå¯èƒ½ä¸ºçš„ç±»åž‹æ˜¯ image/* | video/* | audio/* | text/* | application/* | */* if (type.startsWith("text") &amp;&amp; intent.getStringExtra(Intent.EXTRA_TEXT) != null) &#123; // å½“ç›´æŽ¥é€‰ä¸­æ–‡æœ¬åˆ†äº«æ—¶ï¼Œä¼šå­˜æ”¾åœ¨EXTRA_TEXTé‡Œé¢ï¼Œé€‰æ‹©æ–‡æœ¬æ–‡ä»¶æ—¶ï¼Œä»ç„¶å­˜æ”¾åœ¨EXTRA_STREAMé‡Œé¢ LogUtils.e("èŽ·å–åˆ°åˆ†äº«çš„æ–‡æœ¬ " + intent.getStringExtra(Intent.EXTRA_TEXT)); &#125; else &#123; List&lt;String&gt; sharePaths = getSharePaths(context, intent); LogUtils.e("èŽ·å–åˆ°åˆ†äº«çš„æ–‡ä»¶çš„è·¯å¾„ " + sharePaths.toString()); &#125;&#125; åŒºåˆ†å¤šä¸ªæ–‡ä»¶å’Œå•ä¸ªæ–‡ä»¶åˆ†äº«ï¼ŒèŽ·å–åˆ†äº«è¿‡æ¥çš„è·¯å¾„åˆ—è¡¨ 123456789101112131415161718192021222324252627282930/** * èŽ·å–åˆ†äº«è¿‡æ¥çš„è·¯å¾„ * * @param context ä¸Šä¸‹æ–‡ * @param intent intent * @return è·¯å¾„åˆ—è¡¨ */private static List&lt;String&gt; getSharePaths(Context context, Intent intent) &#123; String action = intent.getAction(); List&lt;String&gt; paths = new ArrayList&lt;&gt;(); // å•ä¸ªæ–‡ä»¶ if (Intent.ACTION_SEND.equals(action)) &#123; Uri imageUri = intent.getParcelableExtra(Intent.EXTRA_STREAM); if (imageUri != null) &#123; String realPathFromURI = getRealPathFromURI(context, imageUri); if (realPathFromURI != null) paths.add(realPathFromURI); &#125; &#125; // å¤šä¸ªæ–‡ä»¶ else if (Intent.ACTION_SEND_MULTIPLE.equals(action)) &#123; ArrayList&lt;Uri&gt; imageUris = intent.getParcelableArrayListExtra(Intent.EXTRA_STREAM); if (imageUris != null) &#123; for (Uri uri : imageUris) &#123; paths.add(getRealPathFromURI(context, uri)); &#125; &#125; &#125; return paths;&#125; å¦‚ä½•ä»Ž uri ä¸­èŽ·å–å­˜å‚¨è·¯å¾„ï¼Œå°† uri è¿›è¡Œè½¬æ¢ã€‚ 123456789101112131415161718192021222324252627/** * ä»ŽurièŽ·å–path * * @param uri uri * @return path */private static String getRealPathFromURI(Context context, Uri uri) &#123; final String scheme = uri.getScheme(); String data = null; if (ContentResolver.SCHEME_FILE.equals(scheme)) &#123; data = uri.getPath(); &#125; else if (ContentResolver.SCHEME_CONTENT.equals(scheme)) &#123; Cursor cursor = context.getContentResolver() .query(uri, new String[]&#123;MediaStore.Images.ImageColumns.DATA&#125; , null, null, null); if (null != cursor) &#123; if (cursor.moveToFirst()) &#123; int index = cursor.getColumnIndex(MediaStore.Images.ImageColumns.DATA) if (index &gt; -1) &#123; data = cursor.getString(index); &#125; &#125; cursor.close(); &#125; &#125; return data;&#125; å”¤é†’ç³»ç»Ÿåˆ†äº«12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152/** * åˆ†äº«æ–‡å­— * * @param context ä¸Šä¸‹æ–‡ * @param title æ–‡å­—æ ‡é¢˜ * @param content æ–‡å­—å†…å®¹ */public static void shareText(Context context, String title, String content) &#123; Intent shareIntent = new Intent(); shareIntent.setAction(Intent.ACTION_SEND); shareIntent.putExtra(Intent.EXTRA_TEXT, content); shareIntent.putExtra(Intent.EXTRA_TITLE, title); shareIntent.setType("text/plain"); //è®¾ç½®åˆ†äº«åˆ—è¡¨çš„æ ‡é¢˜ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½æ˜¾ç¤ºåˆ†äº«åˆ—è¡¨ context.startActivity(Intent.createChooser(shareIntent, "åˆ†äº«åˆ°"));&#125;/** * åˆ†äº«å•å¼ å›¾ç‰‡ * * @param context ä¸Šä¸‹æ–‡ * @param path å›¾ç‰‡çš„è·¯å¾„ */public static void shareImage(Context context, String path) &#123; //ç”±æ–‡ä»¶å¾—åˆ°uri Uri imageUri = Uri.fromFile(new File(path)); Intent shareIntent = new Intent(); shareIntent.setAction(Intent.ACTION_SEND); shareIntent.putExtra(Intent.EXTRA_STREAM, imageUri); shareIntent.setType("image/*"); context.startActivity(Intent.createChooser(shareIntent, "åˆ†äº«åˆ°"));&#125;/** * åˆ†äº«å¤šå¼ å›¾ç‰‡ * * @param context ä¸Šä¸‹æ–‡ * @param paths è·¯å¾„çš„é›†åˆ */public static void shareImages(Context context, List&lt;String&gt; paths) &#123; ArrayList&lt;Uri&gt; uriList = new ArrayList&lt;&gt;(); for (String path : paths) &#123; uriList.add(Uri.fromFile(new File(path))); &#125; Intent shareIntent = new Intent(); shareIntent.setAction(Intent.ACTION_SEND_MULTIPLE); shareIntent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, uriList); shareIntent.setType("image/*"); context.startActivity(Intent.createChooser(shareIntent, "åˆ†äº«åˆ°"));&#125; é™„æºç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141/** * CreateAt : 16/8/13 * Describe : å”¤é†’ç³»ç»Ÿåˆ†äº« * * @author chendong */public class ShareUtils &#123; /** * åˆ†äº«æ–‡å­— * * @param context ä¸Šä¸‹æ–‡ * @param title æ–‡å­—æ ‡é¢˜ * @param content æ–‡å­—å†…å®¹ */ public static void shareText(Context context, String title, String content) &#123; Intent shareIntent = new Intent(); shareIntent.setAction(Intent.ACTION_SEND); shareIntent.putExtra(Intent.EXTRA_TEXT, content); shareIntent.putExtra(Intent.EXTRA_TITLE, title); shareIntent.setType("text/plain"); //è®¾ç½®åˆ†äº«åˆ—è¡¨çš„æ ‡é¢˜ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½æ˜¾ç¤ºåˆ†äº«åˆ—è¡¨ context.startActivity(Intent.createChooser(shareIntent, "åˆ†äº«åˆ°")); &#125; /** * åˆ†äº«å•å¼ å›¾ç‰‡ * * @param context ä¸Šä¸‹æ–‡ * @param path å›¾ç‰‡çš„è·¯å¾„ */ public static void shareImage(Context context, String path) &#123; //ç”±æ–‡ä»¶å¾—åˆ°uri Uri imageUri = Uri.fromFile(new File(path)); Intent shareIntent = new Intent(); shareIntent.setAction(Intent.ACTION_SEND); shareIntent.putExtra(Intent.EXTRA_STREAM, imageUri); shareIntent.setType("image/*"); context.startActivity(Intent.createChooser(shareIntent, "åˆ†äº«åˆ°")); &#125; /** * åˆ†äº«å¤šå¼ å›¾ç‰‡ * * @param context ä¸Šä¸‹æ–‡ * @param paths è·¯å¾„çš„é›†åˆ */ public static void shareImages(Context context, List&lt;String&gt; paths) &#123; ArrayList&lt;Uri&gt; uriList = new ArrayList&lt;&gt;(); for (String path : paths) &#123; uriList.add(Uri.fromFile(new File(path))); &#125; Intent shareIntent = new Intent(); shareIntent.setAction(Intent.ACTION_SEND_MULTIPLE); shareIntent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, uriList); shareIntent.setType("image/*"); context.startActivity(Intent.createChooser(shareIntent, "åˆ†äº«åˆ°")); &#125; /** * å¤„ç†åˆ†äº«é¡µé¢å‘æ¥çš„intent */ public static void handleIntent(Activity context) &#123; Intent intent = context.getIntent(); String type = intent.getType(); if (type == null) return; // å½“æ–‡ä»¶æ ¼å¼æ— æ³•è¯†åˆ«æˆ–é€‰æ‹©äº†å¤šç§ç±»åž‹çš„æ–‡ä»¶æ—¶ï¼Œtypeä¼šå˜æˆ */* LogUtils.e("type " + type); //typeå¯èƒ½ä¸ºçš„ç±»åž‹æ˜¯ image/* | video/* | audio/* | text/* | application/* if (type.startsWith("text") &amp;&amp; intent.getStringExtra(Intent.EXTRA_TEXT) != null) &#123; // å½“ç›´æŽ¥é€‰ä¸­æ–‡æœ¬åˆ†äº«æ—¶ï¼Œä¼šå­˜æ”¾åœ¨EXTRA_TEXTé‡Œé¢ï¼Œé€‰æ‹©æ–‡æœ¬æ–‡ä»¶æ—¶ï¼Œä»ç„¶å­˜æ”¾åœ¨EXTRA_STREAMé‡Œé¢ LogUtils.e("èŽ·å–åˆ°åˆ†äº«çš„æ–‡æœ¬ " + intent.getStringExtra(Intent.EXTRA_TEXT)); &#125; else &#123; List&lt;String&gt; sharePaths = getSharePaths(context, intent); LogUtils.e("èŽ·å–åˆ°åˆ†äº«çš„æ–‡ä»¶çš„è·¯å¾„ " + sharePaths.toString()); &#125; &#125; /** * èŽ·å–åˆ†äº«è¿‡æ¥çš„è·¯å¾„ * * @param context ä¸Šä¸‹æ–‡ * @param intent intent * @return è·¯å¾„åˆ—è¡¨ */ private static List&lt;String&gt; getSharePaths(Context context, Intent intent) &#123; String action = intent.getAction(); List&lt;String&gt; paths = new ArrayList&lt;&gt;(); // å•ä¸ªæ–‡ä»¶ if (Intent.ACTION_SEND.equals(action)) &#123; Uri imageUri = intent.getParcelableExtra(Intent.EXTRA_STREAM); if (imageUri != null) &#123; String realPathFromURI = getRealPathFromURI(context, imageUri); if (realPathFromURI != null) paths.add(realPathFromURI); &#125; &#125; // å¤šä¸ªæ–‡ä»¶ else if (Intent.ACTION_SEND_MULTIPLE.equals(action)) &#123; ArrayList&lt;Uri&gt; imageUris = intent.getParcelableArrayListExtra(Intent.EXTRA_STREAM); if (imageUris != null) &#123; for (Uri uri : imageUris) &#123; paths.add(getRealPathFromURI(context, uri)); &#125; &#125; &#125; return paths; &#125; /** * ä»ŽurièŽ·å–path * * @param uri uri * @return path */ private static String getRealPathFromURI(Context context, Uri uri) &#123; final String scheme = uri.getScheme(); String data = null; if (ContentResolver.SCHEME_FILE.equals(scheme)) &#123; data = uri.getPath(); &#125; else if (ContentResolver.SCHEME_CONTENT.equals(scheme)) &#123; Cursor cursor = context.getContentResolver() .query(uri, new String[]&#123;MediaStore.Images.ImageColumns.DATA&#125; , null, null, null); if (null != cursor) &#123; if (cursor.moveToFirst()) &#123; int index = cursor.getColumnIndex(MediaStore.Images.ImageColumns.DATA); if (index &gt; -1) &#123; data = cursor.getString(index); &#125; &#125; cursor.close(); &#125; &#125; return data; &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰æŽ§ä»¶-ViewPagerå¹¿å‘Šæ¿è½®æ’­]]></title>
    <url>%2Farticle%2F149273814%2F</url>
    <content type="text"><![CDATA[GitHub GitHubåœ°å€ Gradle compile &#39;com.march.billboardview:billboardview:2.0.6-beta4&#39; xml é‡Œé¢ä½¿ç”¨12345678910111213xml é‡Œé¢ä½¿ç”¨&lt;com.march.billboardview.BillBoardView android:id="@+id/billboard" android:layout_width="match_parent" android:layout_height="250dp" board:isAutoRun="true" board:isLoopIt="true" board:intervalTime="2000" /&gt;å±žæ€§ï¼šisAutoRun:æ˜¯ä¸æ˜¯è‡ªåŠ¨æ’­æ”¾ï¼Œä¸éœ€è¦æ»‘åŠ¨ï¼Œé»˜è®¤trueisLoopIt:æ˜¯ä¸æ˜¯æ— é™å¾ªçŽ¯æ’­æ”¾ï¼Œé»˜è®¤æ˜¯trueintervalTime:æ’­æ”¾é—´éš”æ—¶é—´ï¼Œæ¯éš”å¤šé•¿æ—¶é—´èµ°ä¸€é¡µ æž„å»ºå®žä½“12//å®žä½“ç±»å®žçŽ°èŽ·å–urlå’Œtitleçš„æŽ¥å£public class Demo implements BoardConfig&#123;&#125; å®šä¹‰åŠ è½½å·¥å…·1234567//åˆå§‹åŒ–å›¾ç‰‡åŠ è½½çš„å·¥å…·,ä½ å¯ä»¥è‡ªå®šä¹‰ä½¿ç”¨Picassoè¿˜æ˜¯Glideç­‰å›¾ç‰‡åŠ è½½åº“åŠ è½½BillBoard.init(new BillBoard.BillLoadImg() &#123; @Override public void loadImg(Context context, String title, String url, ImageView imageView) &#123; imageView.setImageResource(Integer.parseInt(url)); &#125; &#125;); ä½¿ç”¨SimpleBoardAdapter1234private BillBoardView billBoardView;private SimpleBoardAdapter&lt;Demo&gt; mBoardAdapter;mBoardAdapter = new SimpleBoardAdapter&lt;&gt;(getActivity(), demos);billBoardView.setAdapter(mBoardAdapter); é…ç½®BillBoardView123456789billBoardView .setAdapter(mBoardAdapter) .setSwipeRefreshLayout(sw) .click(new OnBoardClickListener() &#123; @Override public void clickBillBoard(int pos, BoardConfig b) &#123; Log.e(&quot;chendong&quot;, &quot;click pos &quot; + pos + &quot; title is &quot; + b.getTitle()); &#125; &#125;).show(); æ•°æ®æ›´æ–°1mBoardAdapter.notifyDataSetChanged(demos); å¼€æ”¾åœæ­¢å’Œå¼€å§‹æ’­æ”¾çš„æ–¹æ³•12public void startPlay()public void stopPlay() SwipeRefreshLayoutå†²çª å½“ä¸ŽSwipeRefreshLayoutåµŒå¥—ä½¿ç”¨æ—¶ï¼Œè§£å†³SwipeRefreshLayoutå†²çª 1public void setSwipeRefreshLayout(SwipeRefreshLayout sw) è½®æ’­åŠ¨ç”»å’Œæ—¶é—´ ä¸‹é¢æ˜¯å¯é€‰çš„æ’å€¼å™¨,å¯è‡ªå®šä¹‰æ’å€¼å™¨ 12//è®¾ç½®åŠ¨ç”»çš„æ–¹æ³•public BillBoardView setAnimation(int duration, Interpolator interpolator) æ’å€¼å™¨ æè¿° new AccelerateInterpolator() å¼€å§‹æ…¢åŽé¢åŠ é€Ÿ,ç”±äºŽè·ç¦»è¾ƒè¿‘æ•ˆæžœä¸æ˜Žæ˜¾,æœ‰ç‚¹åƒæ˜¯åŒ€é€Ÿ new AccelerateDecelerateInterpolator() ä¸¤å¤´é€Ÿåº¦æ…¢,ä¸­é—´åŠ é€Ÿ,ç”±äºŽè·ç¦»è¾ƒè¿‘æ•ˆæžœä¸æ˜Žæ˜¾,æœ‰ç‚¹åƒæ˜¯åŒ€é€Ÿ new DecelerateInterpolator() å¼€å§‹å¿«åŽé¢æ…¢,ç”±äºŽè·ç¦»è¾ƒè¿‘æ•ˆæžœä¸æ˜Žæ˜¾,æœ‰ç‚¹åƒæ˜¯åŒ€é€Ÿ new BounceInterpolator() åˆ°è¾¾æœ«å°¾è·³è·ƒå¼¹èµ· new AnticipateInterpolator() å…ˆç”©ä¸€ä¸‹åœ¨ç§»åŠ¨ new AnticipateOvershootInterpolator() å…ˆç”©ä¸€ä¸‹åˆ°è¾¾ç»ˆç‚¹åŽè¿‡ç•Œåœ¨åŽé€€ new OvershootInterpolator() è¿‡ç•ŒåŽè¿”å›ž new LinearInterpolator() å¸¸é‡å˜é€Ÿ new LinearOutSlowInInterpolator() å¼€å§‹å¿«åŽé¢æ…¢ å…¶ä»–API12345//BillBoardView//é‡æ–°å®šä¹‰ViewPagerçš„å°†åœpublic void setOnBoardPageChangeListener(OnPageChangeListener onPageChangeListener)//èŽ·å–å†…éƒ¨çš„ViewPagerpublic ViewPager getViewPager() BoardAdapter12345678//ä¸€äº›å˜é‡ï¼Œä½ å¯ä»¥åœ¨å­ç±»ä¸­è®¿é—®protected Context mContext;protected int mLyRes;protected int preIndex = -1;//ä¸Šä¸€ä¸ªè¢«é€‰ä¸­çš„protected List&lt;B&gt; datas;protected boolean isLoop;protected View mRootView;protected BillBoardView mBoardView; åŸºäºŽSimpleBoardAdapter1234567891011121314//ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨å®šä¹‰äº†SimpleBoardAdapter//èŽ·å–TitleViewç”¨äºŽæ”¹å˜å­—ä½“ï¼Œé¢œè‰²ï¼ŒèƒŒæ™¯ï¼Œæ–‡å­—å¤§å°ç­‰public TextView getTitleView()//èŽ·å–åº•éƒ¨Bar,ç”¨äºŽæ”¹å˜èƒŒæ™¯ï¼Œé«˜åº¦ç­‰public ViewGroup getBotLy()//èŽ·å–å¯¼èˆªæ¡public LinearLayout getGuideLy()//è®¾ç½®é€‰ä¸­å’Œæœªé€‰ä¸­çš„èµ„æºpublic void setSelectRes(int selectRes, int unSelectRes)//è®¾ç½®æ ‡é¢˜çš„ä½ç½®POS_LEFT = 0, POS_CENTER = 1, POS_RIGHT = 2public void setTitleGravity(int gravity)//è®¾ç½®å¯¼èˆªæ çš„ä½ç½®POS_LEFT = 0, POS_CENTER = 1, POS_RIGHT = 2public void setGuideLyGravity(int gravity) å¦‚ä½•è‡ªå®šä¹‰Adapter12345678910111213141516171819202122232425262728293031//Adapteråšçš„å·¥ä½œæ˜¯ï¼Œè¦†ç›–åœ¨BillBoardViewä¸Šé¢ï¼Œéšç€BillBoardViewçš„å˜åŒ–ï¼Œä¿®æ”¹UIpublic class MyAdapter extends BoardAdapter&lt;Demo&gt; &#123; public MyAdapter(Context mContext, List&lt;Demo&gt; datas) &#123; super(mContext, datas); &#125; //èµ„æºID.é«˜åº¦å»ºè®®Match_parent @Override protected int getLayoutId() &#123; return 0; &#125; //èŽ·å–æŽ§ä»¶ï¼ŒfindById()æˆ–è€…ä¸€äº›åˆå§‹åŒ–çš„æ“ä½œ @Override protected void initAdapterViews() &#123; &#125; //å½“åˆ’åˆ°posä½ç½®ã€‚æ›´æ”¹ç•Œé¢æ˜¾ç¤º @Override public void changeItemDisplay(int pos, Demo demo) &#123; &#125; //å½“adapterè¿žæŽ¥åˆ°billboardViewæ—¶ï¼Œè§¦å‘ @Override public void onBillBoardViewAttached(BillBoardView billBoardView) &#123; super.onBillBoardViewAttached(billBoardView); &#125;&#125; ä¼˜åŒ– å½“ä½ çš„é¡µé¢é€€å‡ºæ—¶,æš‚å®šè½®æ’­å°†æ˜¯ä¼˜åŒ–çš„ä¸€ä¸ªå¾ˆå¥½é€‰æ‹© 123456789101112131415161718@Overrideprotected void onResume() &#123; super.onResume(); if(billBoardView!=null) billBoardView.startPlay();&#125;@Overrideprotected void onDestroy() &#123; super.onDestroy(); billBoardView.stopPlay();&#125;@Overrideprotected void onPause() &#123; super.onPause(); billBoardView.stopPlay();&#125;]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SwiftåŸºç¡€è¯­æ³•1]]></title>
    <url>%2Farticle%2F1996349588%2F</url>
    <content type="text"><![CDATA[ä»Žä»Šå¤©å¼€å§‹å­¦ä¹ Swiftï¼2016-3-16ï¼› å…ˆå­¦ä¹ ç®€å•è¯­æ³•ï¼Œä¸æ¶‰åŠè¯¦ç»†API Swift 3.0å·²ç»ç§»é™¤i++æ–¹æ³•ï¼Œè¯·ä½¿ç”¨i+=1 å¿«æ·é”®123456//æ ¼å¼åŒ–ä»£ç  ctrl+i//åˆ é™¤ä¸€è¡Œ command+delete//æ³¨é‡Šä¸€è¡Œcommand+/ ä¸€äº›çç¢Ž1234567891011121314151617181920212223242526272829303132//swiftæ˜¯ä¸€é—¨å®‰å…¨çš„è¯­è¨€//ä¸æ”¯æŒéšå¼ç±»åž‹è½¬æ¢//ä¸æ”¯æŒç©ºå€¼ï¼Œnilæ˜¯ä¸€ç§å•ç‹¬çš„ç±»åž‹//æ•°æ®ç±»åž‹åŽé¢å¸¦æœ‰æ•°å­—ï¼Œè¡¨ç¤ºä½¿ç”¨å‡ ä½æ¥è¡¨ç¤ºï¼ŒInt8æœ€å¤§ä¸º127var int8:Int8print(Int8.max)//äºŒè¿›åˆ¶ï¼Œå…«è¿›åˆ¶ï¼Œ16è¿›åˆ¶çš„è¡¨ç¤ºvar two = 0b111var eight = 0o111var sixTeen = 0x111print("\(two) \(eight) \(sixTeen)")//ä¸‹åˆ’çº¿è¡¨ç¤ºå¿½ç•¥,æ›´æ¸…æ™°çš„æ•°æ®å®šä¹‰æ–¹å¼var bigNum = 1_000_000var _ = 100//è½»é‡çº§çš„æ•°æ®èšåˆï¼Œå…ƒç»„ï¼Œå…ƒç»„å¯ä»¥å­˜å‚¨ä»»æ„ç±»åž‹çš„æ•°æ®//æŒ‡å®šç±»åž‹var yuanzu0:(Int,String,Int,String) = (100,"0909",30,"222")print("\(yuanzu0.1)")//ä¸æŒ‡å®šç±»åž‹ï¼Œä½¿ç”¨ä¸‹æ ‡è®¿é—®var yuanzu1 = (100,"0909",30,"222")print("\(yuanzu1.1)")//æ ‡å¿—ä½ï¼Œè®¿é—®var yuanzu2 = (x:100,y:"aaa")print("\(yuanzu2.x)")//è§£åŒ…è®¿é—®ï¼Œä¸å…³å¿ƒçš„æ•°æ®å¯ä»¥ä½¿ç”¨_ä»£æ›¿var (m,_) = yuanzu2print("\(m) ") å¸¸é‡å’Œå˜é‡1234567891011print("hello world");//å¸¸é‡(let)å’Œå˜é‡(var)ï¼Œæœªèµ‹å€¼çš„å˜é‡å¸¸é‡æ˜¾ç¤ºå£°æ˜Žç±»åž‹,èµ‹å€¼çš„å˜é‡å¸¸é‡ä¼šè‡ªåŠ¨æŽ¨æ–­æ•°æ®ç±»åž‹let contast = 1;print(contast)var a:Int//10è¿›åˆ¶a = 1000var str = "this is a str" //ä½¿ç”¨\(å˜é‡å¸¸é‡)å¯ä»¥ç›´æŽ¥æ‰“å°å˜é‡å¸¸é‡å‡ºæ¥var rst = "this is a rst = \(a)"print(rst) ##æ•°ç»„å’Œå­—å…¸123456789101112131415161718192021222324//å®šä¹‰æ•°ç»„ï¼Œä½¿ç”¨ï¼»ï¼½è®¿é—®å…ƒç´ var list = [1,2,3,4,5];print(list);print(list[0]);//å®šä¹‰å­—å…¸ï¼Œä½¿ç”¨keyè®¿é—®var map = ["a":1,"b":2,"c":3];print(map);print(map["a"])print(map["a"]! + 100) //å¦‚æžœåˆ—è¡¨å’Œå­—å…¸çš„ç±»åž‹å¯ä»¥è¢«æŽ¨æ–­å‡ºæ¥ï¼Œå¯ä»¥ä¸ä½¿ç”¨ç±»åž‹ï¼Œä¹Ÿä¸ç”¨å¸¦ï¼ˆï¼‰ï¼Œåœ¨ä¸‹é¢ï¼Œshoplisté¦–å…ˆè¢«å£°æ˜Žä¸ºStringç±»åž‹çš„æ•°ç»„ï¼ŒåŽåˆé‡æ–°èµ‹å€¼ï¼Œæ­¤æ—¶å¯ä»¥æŽ¨æ–­shoplist æ˜¯ï¼»Stringï¼½var shoplist = [String]()shoplist = []//è·Ÿå¸¸é‡å’Œå˜é‡çš„å®šä¹‰ä¸€æ ·ï¼Œå¦‚æžœç±»åž‹å¯ä»¥è¢«æŽ¨æ–­æ—¶ï¼Œå¯ä»¥ä¸ä½¿ç”¨ç±»åž‹å£°æ˜Žï¼Œä¸Šé¢çš„listå’Œmapç±»åž‹å·²ç»å¯ä»¥æŽ¨æ–­ï¼Œå½“å°†å®ƒé‡æ–°æŒ‡å‘ç©ºçš„æ•°ç»„å’Œå­—å…¸list = []map = [:] //å®šä¹‰ç©ºçš„æ•°ç»„å’Œå­—å…¸var emptyList = [String]()var emptyMap = [String:Int]()print(emptyList.count)print(emptyMap.count) æŽ§åˆ¶æµfor1234567891011121314151617181920212223242526let testList = [1,2,3,4,5,6,7,8];//ç®€å•forå¾ªçŽ¯for var i=0;i&lt;8;i+=1 &#123; print("for this is \(testList[i])")&#125;//for in å¾ªçŽ¯//æ³¨æ„è¿™é‡Œçš„xæ˜¯å¸¸é‡ï¼Œä¸èƒ½ä¿®æ”¹å®ƒçš„å€¼ï¼Œæ‰€ä»¥ä¸‹é¢ï¼ˆ1ï¼‰æ˜¯é”™è¯¯çš„for x in testList&#123; print("for in this is \(x)") //(1) x = 1&#125;//éåŽ†å­—å…¸ä¸­çš„æ•°ç»„let map2scan = [ "a":[1,2,3,4,5], "b":["a","b","c"]] for (key,value) in map2scan&#123; print("key is \(key)") for num in value&#123; print("num is \(num)") &#125;&#125; ifå…³é”®å­—123456789101112131415161718//æ¶‰åŠå¯é€‰åž‹çš„æ¦‚å¿µï¼ŒåŽé¢å•ç‹¬ä»‹ç»var optionalStr:String? = "hello"optionalStr = "world"print(optionalStr == nil) var greet = "hey"if let name = optionalStr&#123; greet = "hello \(name)";&#125;print(greet) if(optionalStr != nil)&#123; print("optional str is not nil")&#125;if score &gt;= 10&#123;&#125; switchå…³é”®å­—1234567891011121314151617181920212223242526272829303132333435363738394041//swiftæ”¯æŒä»»æ„æ•°æ®ç±»åž‹çš„switchæ¯”è¾ƒï¼Œä¸ä»…é™äºŽIntå’Œenum//breakè¯­å¥,ä¸éœ€è¦æ˜¾å¼æ·»åŠ ï¼Œé»˜è®¤è¯­å¥åŽé¢éƒ½ä¼šbreak;//defaultè¯­å¥,æ˜¯ä¸å¯ä»¥çœç•¥çš„,é™¤éžæ‰€æœ‰çš„å€¼éƒ½è¢«ç©·ä¸¾å‡ºæ¥äº†ï¼›//fallthroughè¯­å¥ï¼Œå½“æ»¡è¶³æŸä¸ªcaseä¹‹åŽä»æ—§æƒ³ä½¿å®ƒåŒ¹é…ä¸‹ä¸€ä¸ªcaseï¼Œä½¿ç”¨ fallthroughï¼Œåˆ™ä¸ä¼šè¢«æˆªæ–­let vegetable = "red peper"switch vegetable&#123;//å› ä¸ºæ¯ä¸ªcaseä¹‹åŽéƒ½ä¼šæœ‰breakï¼Œæ‰€ä»¥æ¯ä¸ªcaseä¹‹åŽå¿…é¡»è‡³å°‘æœ‰ä¸€è¡Œå¯æ‰§è¡Œè¯­å¥ï¼Œå½“éœ€è¦å¤šä¸ªåŒ¹é…æ—¶ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·case "b","B" print("this is b/B")case "a": print("this is a") fallthroughcase let x where x.hasSuffix("peper"): print("has suffix " + x)default: print("default")&#125;//é«˜çº§ç”¨æ³•//åŒºé—´let num = 100switch num&#123; case 0 ..&lt; 100: print("å°äºŽ100")&#125;//å…ƒç»„let point = (1,1)switch point&#123; case (_,0): print("x aliaxs"); fallthrough case (0,_): print("y aliaxs") fallthrough case (0,0): print("origin point") fallthrough case (-2 ... 2,-2 ... 2): print("near by origin point")&#125; while/repeatâ€¦while1234567891011//while/repeat...whileå¾ªçŽ¯, å½“whileè¯­å¥æˆç«‹æ—¶ï¼Œè¯­å¥ä½“ä¼šæ‰§è¡Œã€‚var num = 0;while num &lt; 100&#123; num+=1&#125;print("while num is \(num)") repeat&#123; num-=1;&#125;while num &gt; 0print("repeat num is \(num)") æ“ä½œç¬¦å¯é€‰å€¼æ“ä½œç¬¦(??)12345//æœ‰ç‚¹ç±»ä¼¼ä¸‰ç›®è¿ç®—ç¬¦,??è¡¨ç¤ºé»˜è®¤å€¼,å½“å‰é¢çš„å€¼ä¸ºç©ºæ—¶å°†ä¼šä½¿ç”¨åŽé¢çš„let nickName?String = "a"let fullName = "b"let name = "hello \(nickName ?? fullName)"print(name) èŒƒå›´æ“ä½œç¬¦(..&gt;ï¼â€¦)1234567891011//æä¾›ä¸€ç§æ›´ç®€å•å®žçŽ°å¾ªçŽ¯çš„æ–¹å¼,...åŒ…å«ä¸Šç•Œ//0 1 2 3for x in 0..&lt;4&#123; print("x is \(x)")&#125;//0 1 2 3 4for x in 0...4&#123; print("x is is \(x)")&#125; å¼ºåˆ¶è§£åŒ…æ“ä½œç¬¦(!)123//å¼ºåˆ¶è§£åŒ… unwrap è§£åŒ…çš„æ¦‚å¿µä¼šåœ¨å¯å˜åž‹ä¸­ä»‹ç»var num = 100var name = "this is " + num! å‡½æ•°å’Œé—­åŒ…ç®€è¿°1å‡½æ•°æ˜¯ä¸€ä¸ªå¯ä»¥è¢«æŠ½å–è°ƒç”¨çš„å°é—­ä»£ç å—ï¼Œæ˜¯å¯ä»¥è¢«ä¼ é€’çš„æ•°æ®ç±»åž‹ ä¸€ä¸ªç®€å•å‡½æ•°123456789//å‡½æ•°ä½¿ç”¨funcå…³é”®å­—å‘½å//ä½¿ç”¨ [å‚æ•°å:å‚æ•°ç±»åž‹] ...çš„æ–¹å¼å®šä¹‰å‚æ•°//è°ƒç”¨å‡½æ•°æ—¶ï¼Œè¦ç”¨ [å‚æ•°å:å€¼] çš„æ–¹å¼ä¼ é€’//func å‡½æ•°åï¼ˆå‚æ•°åˆ—è¡¨ï¼ˆå‚æ•°å:å‚æ•°ç±»åž‹ï¼‰ï¼‰-&gt; è¿”å›žç±»åž‹ &#123;// å‡½æ•°ä½“ï½func firstFun (name:String,pwd:String,newParams:String)-&gt;Bool &#123; print("name is \(name) and pwd is \(pwd)") return true&#125;firstFun("chendong",pwd:"1234567",newParams:"new params"); è¿”å›žå¤šä¸ªå€¼1234567891011121314151617181920//å¯ä»¥ä½¿ç”¨å…ƒç»„è¿”å›žå¤šä¸ªå€¼ï¼Œå®žé™…ä¸Šæ˜¯ä»¥å…ƒç»„ä½œä¸ºå€¼ä¼ é€’çš„æ–¹å¼//ä½¿ç”¨å…ƒç»„å®žçŽ°å¤šä¸ªè¿”å›žå€¼//å…ƒç»„å¯ä»¥ä½¿ç”¨é”®è®¿é—®ï¼Œrst.max,ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹æ ‡è®¿é—®ï¼Œrst.2func getMultiBackFun(scores:[Int])-&gt;(max:Int,min:Int,sum:Int)&#123; var sum = 0 var min = scores[0] var max = scores[0] for score in scores&#123; sum += score; if(score &gt; max)&#123; max = score; &#125; if(score &lt; min)&#123; min = score &#125; &#125; return (max,min,sum)&#125;let rst = getMultiBackFun([4,8,1,7,4,0,6,3,7])print("max is \(rst.max) min is \(rst.min) sum is \(rst.sum) rst.2 is \(rst.2)") å¯å˜é•¿åº¦å‚æ•°å‡½æ•°123456789101112//è·Ÿæ‰€æœ‰çš„è¯­è¨€ä¸€æ ·ï¼Œæ”¯æŒå¯å˜é•¿åº¦å‚æ•°ï¼Œæœ¬è´¨æ˜¯æ•°ç»„çš„ä¼ é€’//ä¸€ä¸ªæ±‚å‡å€¼çš„å‡½æ•°func changeParamFun(params :Int...)-&gt;Void&#123; var sum = 0; for x in params&#123; sum+=x &#125; print("averge is \(sum/(params.count))")&#125; changeParamFun(1,2,3,4)changeParamFun(0,9,8,7) ###å‡½æ•°åµŒå¥—å®šä¹‰1234567891011//å‡½æ•°å¯ä»¥åµŒå¥—å®šä¹‰,è¢«åµŒå¥—çš„å‡½æ•°ä½œç”¨åŸŸæœ‰é™ï¼Œåªèƒ½åœ¨åµŒå¥—å®ƒçš„ï½›ï½ä¸­è¢«è®¿é—®ï¼Œæ¯”å¦‚ä¸‹é¢ï¼ˆ1ï¼‰ä¸­çš„ä»£ç æ˜¯ç¼–è¯‘é”™è¯¯çš„ï¼Œè¢«åµŒå¥—çš„å‡½æ•°å¯ä»¥è®¿é—®å¤–é¢å‡½æ•°çš„å˜é‡æˆ–è€…å…¨å±€å˜é‡ï¼Œfunc aOutFun() -&gt; Void&#123; var num = 100 func aInFun()-&gt;String&#123; return "chendong \(num)" &#125; print(aInFun())&#125;aOutFun()//1 ç¼–è¯‘é”™è¯¯aInFun() å‡½æ•°ä½œä¸ºè¿”å›žå€¼123456789//å‡½æ•°ä½œä¸ºè¿”å›žå€¼,ä¸‹é¢çš„å‡½æ•°è¡¨ç¤ºä¸€ä¸ªæ— å‚å‡½æ•°ï¼Œè¿”å›žå€¼æ˜¯ä¸€ä¸ªï¼ˆå‚æ•°ä¸ºInt,è¿”å›žå€¼æ˜¯Stringçš„ï¼‰å‡½æ•°ç±»åž‹ï¼Œåœ¨å‡½æ•°returnFuncFunä¸­å®šä¹‰å†…åµŒå‡½æ•°å¹¶è¿”å›žï¼Œåœ¨å¤–éƒ¨å¯ä»¥ä½¿ç”¨è¯¥å‡½æ•°func returnFuncFun()-&gt;(Int-&gt;String)&#123; func INTSTRING(num:Int)-&gt;String&#123; return "this num is \(num)" &#125; return INTSTRING&#125;let funINTSTR = returnFuncFun();print("func return is \(funINTSTR(1000))") å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’123456789101112//å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œä¸‹é¢çš„å‡½æ•°è¡¨ç¤ºä¸€ä¸ªå‚æ•°ä¸ºIntç±»åž‹ï¼Œä¸€ä¸ªå‚æ•°ä¸ºï¼ˆInt-&gt;Stringï¼‰çš„å‡½æ•°ç±»åž‹ï¼Œè¿”å›žå€¼Stringfunc funParamFun(num:Int,param : Int -&gt; String)-&gt;String&#123; return "funparamfun + \(param(num))"&#125;func paramFunc(num:Int)-&gt;String&#123; return "paramfunc + \(num)"&#125;print("rst is \(funParamFun(100, param: paramFunc))")//ç»“æžœæ˜¯ rst is funparamfun + paramfunc + 100 åŒ¿åå‡½æ•°é—­åŒ…12345678910111213141516171819//åŒ¿åé—­åŒ…ï¼ˆin å‰é¢æ˜¯å‚æ•°ç±»åž‹ï¼ŒinåŽé¢çš„æ˜¯å‡½æ•°ä½“ï¼‰let numbers = [1,2,3,4,5];let get = numbers.map(&#123; ï¼ˆin å‰é¢æ˜¯å‡½æ•°å‚æ•°å’Œè¿”å›žå€¼ï¼ŒinåŽé¢çš„æ˜¯å‡½æ•°ä½“ï¼‰ (number:Int)-&gt;Int in let rst = number*2; return 3 + rst;&#125;)print("rst is \(get)")//å¦‚æžœä¸€ä¸ªé—­åŒ…çš„ç±»åž‹å·²çŸ¥ï¼Œæ¯”å¦‚ä½œä¸ºä¸€ä¸ªå›žè°ƒå‡½æ•°ï¼Œä½ å¯ä»¥å¿½ç•¥å‚æ•°çš„ç±»åž‹å’Œè¿”å›žå€¼ã€‚å•ä¸ªè¯­å¥é—­åŒ…ä¼šæŠŠå®ƒè¯­å¥çš„å€¼å½“åšç»“æžœè¿”å›ž.numbers.map(&#123; number in number * 3&#125;)//ä½¿ç”¨å‚æ•°ä½ç½®ä»£æŒ‡å‚æ•° numbers.sort(&#123;$0&gt;$1&#125;)let get2 = numbers.map(&#123;$0*2&#125;)print("numbers is \(get2)")]]></content>
      <categories>
        <category>Swift</category>
      </categories>
      <tags>
        <tag>Swift</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨ Mac ä¸‹é…ç½® Gradle å‘½ä»¤]]></title>
    <url>%2Farticle%2F2863351425%2F</url>
    <content type="text"><![CDATA[æŽ¨èé˜…è¯»Mac ä¸‹é…ç½® Sdk,Gradle ç›¸å…³ä¸‹è½½ä¸‹è½½gradle http://gradle.org/downloads/ é…ç½®çŽ¯å¢ƒå˜é‡ æ‰“å¼€.bash-profile 12touch .bash-profileopen -e .bash_profile æ‰“å¼€ bash_profileï¼Œé…ç½®çŽ¯å¢ƒå˜é‡ã€‚ 12345//ä¸ä½¿ç”¨ndkå¯ä»¥ä¸é…ç½®export NDK_PATH=&quot;/Users/Bob_ge/Documents/android_dev/ndk/android-ndk-r10d&quot;export SDK_PATH=&quot;/Users/Bob_ge/Library/Android/sdk/platform-tools&quot;export GRADLE_HOME=&quot;/Users/Bob_ge/Documents/android_dev/gradle/gradle-2.4/bin&quot;export PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/local/ant/bin:/opt/reverse:$&#123;SDK_PATH&#125;:$&#123;NDK_PATH&#125;:$&#123;GRADLE_HOME&#125; æ›´æ–° bash_profile 1source .bash-profile è¾“å…¥adb æ£€æµ‹æ˜¯å¦é…ç½®æ­£ç¡® 1gradle -version]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>DevEnvironment</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°†è‡ªå·±å†™çš„åº“å‘å¸ƒåˆ°Jcenter]]></title>
    <url>%2Farticle%2F3189961703%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•æœ€ç®€å•çš„å°†è‡ªå·±çš„ Library å‘å¸ƒåˆ° jcenterã€‚ 2017.6.16 æ›´æ–°ä¸ºä½¿ç”¨è¿œç¨‹ä¸Šä¼ è„šæœ¬æ‰“åŒ…ä¸Šä¼ ï¼Œç®€åŒ–æ“ä½œæµç¨‹ ä½¿ç”¨ gradle å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ compile å‘½ä»¤ï¼Œä¾èµ– Libraryï¼Œè¿™ç§åšæ³•çš„å¥½å¤„æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†åŽ»å…³æ³¨ä¸€å † jar æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬éœ€è¦å‡çº§ Library æ—¶ï¼Œåªéœ€è¦æ”¹å˜ä¾èµ–çš„ç‰ˆæœ¬å·ï¼Œå°±å¯ä»¥å®Œæˆå‡çº§ã€‚ æˆ‘ä»¬ä¹‹æ‰€ä»¥å¯ä»¥ä½¿ç”¨ä¸€å¥ gradle è„šæœ¬å®Œæˆä¾èµ–çš„ä¸‹è½½ï¼Œå‡çº§ï¼Œæ˜¯å› ä¸ºè¿™äº› Library éƒ½è¢«å­˜å‚¨åœ¨äº†ä¸€ä¸ªå…¬å…±çš„æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ compile å‘½ä»¤å¯ä»¥å”¯ä¸€çš„æ˜ å°„åˆ°æœåŠ¡å™¨å­˜å‚¨çš„ Libraryã€‚ jcenter å°±æ˜¯ä¸€ä¸ªè¿™æ ·çš„æœåŠ¡ï¼ŒAndroidStudio çŽ°åœ¨æ–°å»ºé¡¹ç›®éƒ½ä¼šé»˜è®¤ä¾èµ– repositories {jcenter()}ï¼Œå½“æ‰§è¡Œ compile è„šæœ¬æ—¶ï¼Œå°±ä¼šåŽ» jcenter æ£€æŸ¥å¯¹åº”çš„ Library è¿›è¡Œä¸‹è½½å’Œä¾èµ–ã€‚ è¸©è¿‡çš„å‘ åˆ é™¤ gradle.properties é‡Œé¢ä¼šæœ‰ systemProp.http.proxyHost=127.0.0.1 systemProp.http.proxyPort=1080å­—æ®µï¼Œä½¿ç”¨ä»£ç†å¯èƒ½ä¼šå¯¼è‡´æ— æ³•ä¸Šä¼ å‘å¸ƒã€‚ æ‰“åŒ… javadoc æ—¶ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºä»–ä¼šå°†ä½ æ‰€æœ‰çš„æ³¨é‡Šæ‰“åŒ…è¿›åŽ»ï¼Œå¦‚æžœæ³¨é‡Šå†™çš„ä¸è§„èŒƒå°±ä¼šæŠ¥é”™ï¼Œä¸è¿‡è¿™ä¸ªæ˜¯æœ‰æç¤ºçš„ï¼ŒæŒ‰ç…§æç¤ºæ”¹æŽ‰å°±å¥½äº†ï¼Œæ³¨é‡Šè¦ç¬¦åˆè¦æ±‚ã€‚ å¦‚æžœå‡ºçŽ°äº† gradle commond not found ,è¯´æ˜Žä½ çš„ gradle è·¯å¾„æ²¡æœ‰é…ç½®ï¼Œmacå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« è¿›è¡Œé…ç½®ã€‚ ä½ çš„ library ä¸­çš„ manifest æ–‡ä»¶æœ‰ allowback å±žæ€§æœ€å¥½åˆ æŽ‰ï¼Œ å½“åˆ«äººæˆ–è€…ä½ çš„åˆ«çš„å·¥ç¨‹å¼•ç”¨è¿™ä¸ªåº“æ—¶ï¼Œéœ€è¦è¿›è¡Œ manifest çš„ merge æ“ä½œï¼Œå¦‚æžœæŸäº›å±žæ€§å†²çªäº†ä¼šå¯¼è‡´åˆå¹¶å¤±è´¥ï¼Œå› æ­¤åº“æ–‡ä»¶çš„ manifest æ–‡ä»¶åªä¿ç•™å¿…è¦çš„å±žæ€§ï¼Œå³å¯ã€‚ æ³¨å†Œè´¦å·æˆ‘ä»¬è¦å‘å¸ƒè‡ªå·±çš„åº“åˆ° JCenter,é¦–å…ˆè¦å°†ä»£ç å‘å¸ƒåˆ° maven åº“ï¼Œå®˜æ–¹ç½‘ç«™www.bintray.com ï¼Œè¿›åŽ»ç½‘ç«™æ³¨å†Œç™»å½•å°±å¥½äº†ï¼Œæ³¨å†Œä¹‹åŽå¯ä»¥æ‹¿åˆ°ä½ çš„ç”¨æˆ·åå’Œ apikeyã€‚ apiKey çš„èŽ·å–æ–¹æ³• ï¼&gt; å³ä¸Šè§’ç‚¹å‡»å¤´åƒ ï¼&gt; your profile-&gt; å¤´åƒä¸‹é¢edit -&gt; æœ€ä¸‹é¢çš„ APIkey å°±å¯ä»¥èŽ·å–äº†ï¼ŒåŽé¢æœ‰ç”¨ã€‚ æž„å»ºé¡¹ç›®ä½¿ç”¨ AS å¼€å‘ä½ çš„é¡¹ç›®åº”è¯¥æ˜¯æœ‰å¤šä¸ª module çš„ï¼Œé€šå¸¸ä½ çš„é¡¹ç›®è‡³å°‘åº”è¯¥æœ‰ app è¿™ä¸ª module ï¼Œåˆ›å»ºä¸€ä¸ª library ç±»åž‹çš„ moduleï¼ˆç‚¹å‡»å·¥å…·æ  File - &gt; new moudle -&gt; library,å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªlibrary moudle)ï¼Œå› ä¸ºæˆ‘ä»¬è¦å‘å¸ƒåˆ° maven çš„æ˜¯ä½ çš„ libraryï¼Œæ‰€ä»¥è¿™ä¸ª moudle éœ€è¦æœ‰ã€‚ç„¶åŽä½ åº”è¯¥æŠŠè¿™ä¸ªé¡¹ç›®å‘å¸ƒåˆ° githubä¸ŠåŽ»ï¼ŒåŽç»­éœ€è¦å¡«å†™é¡¹ç›®çš„åœ°å€ï¼Œå½“ç„¶è¿™ä¸æ˜¯å¿…é€‰çš„ã€‚ é…ç½® project/build.gradleé…ç½®è¿™ä¸ªæ–‡ä»¶ä¸»è¦æ˜¯ä¾èµ–ä¸€äº›å¿…è¦çš„æ’ä»¶æ¥å®ŒæˆåŽç»­çš„æ‰“åŒ…ä¸Šä¼ æ“ä½œï¼Œå¯èƒ½å½“ä½ çœ‹åˆ°æ—¶ä¸‹é¢çš„æ’ä»¶ç‰ˆæœ¬å·²ç»ä¸æ˜¯æœ€æ–°çš„äº†ï¼Œä½ å¯ä»¥è‡ªå·±ä¾èµ–æœ€æ–°çš„æ’ä»¶ã€‚ 123456789101112131415161718//æœ€åŽå†™å®Œåº”è¯¥æ˜¯è¿™æ ·çš„buildscript &#123; repositories &#123; jcenter() &#125; dependencies &#123; classpath 'com.android.tools.build:gradle:2.2.3' //ä¸»è¦æ˜¯ä¸‹é¢çš„ä¸¤è¡Œ classpath 'com.jfrog.bintray.gradle:gradle-bintray-plugin:1.0' classpath 'com.github.dcendents:android-maven-gradle-plugin:1.4.1' &#125;&#125;allprojects &#123; repositories &#123; jcenter() &#125;&#125; é…ç½® module/build.gradleéœ€è¦åœ¨ ext{} å†…é…ç½®é¡¹ç›®çš„ç›¸å…³ä¿¡æ¯ï¼Œåœ¨æ¯ä¸ªä¿¡æ¯ä¸Šæˆ‘éƒ½åŠ äº†æ¯”è¾ƒè¯¦ç»†çš„æ³¨é‡Šã€‚ å®Œæ•´çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼Œå¼•ç”¨äº†æˆ‘ git ä¸Šé¢è¿œç¨‹çš„ä¸€ä¸ªä¸Šä¼ è„šæœ¬ï¼Œå½“ç„¶ä½ ä¹Ÿå°†å…¨éƒ¨å†…å®¹å¤åˆ¶åˆ°æœ¬åœ°è¿›è¡Œä¿®æ”¹ï¼Œä½¿ç”¨è¿œç¨‹è„šæœ¬æ˜¯ä¸ºäº†ç®€åŒ–ä¹¦å†™è„šæœ¬çš„æµç¨‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546apply plugin: 'com.android.library'android &#123; ...&#125;dependencies &#123; ...&#125;ext &#123; // é¡¹ç›®çš„ä¸»é¡µ yourSiteUrl = 'https://github.com/chendongMarch/LightAdapterExample' // Gitä»“åº“çš„url yourGitUrl = 'https://github.com/chendongMarch/LightAdapterExample' // issue åœ°å€ YourIssueTrackerUrl = 'https://github.com/chendongMarch/LightAdapterExample/issues' // é¡¹ç›®çš„åç§°ï¼Œå°†ä¼šæ˜¾ç¤ºåœ¨bintray yourProName = 'LightAdapter' // é¡¹ç›®çš„æè¿° yourProDesc = 'Java Recyclerview Library' // bintrayID yourId = 'chendongmarch' // nickName yourName = 'chendong' // email yourEmail = 'helloworld4x@gmial.com' // æœ€åŽç”Ÿæˆä¾èµ– compile 'yourGroup:yourArtifactId:yourVersion' // æœ€åŽç”Ÿæˆä¾èµ– compile 'com.march.lightadapter:lightadapter:1.0.1-beta1' yourGroup = 'com.march.lightadapter' yourArtifactId = 'lightadapter' yourVersion = '1.0.1-beta4' // æ­¤æ–‡ä»¶ä¸­å­˜å‚¨çš„æ˜¯ bintray çš„æ•æ„Ÿä¿¡æ¯ï¼Œç”¨æˆ·åå’Œkey // ä½ éœ€è¦åœ¨è¯¥æ–‡ä»¶ä¸­å¦‚ä¸‹å£°æ˜Ž // bintray.user=xxxx // bintray.apikey=xxxx // ä½ å¯ä»¥ä½¿ç”¨é¡¹ç›®ä¸­çš„ local.properties yourBintrayUserPath = '/Users/march/AndroidRes/file/common_local.properties'&#125;apply from: 'https://raw.githubusercontent.com/chendongMarch/Resource/master/jcenter/bintrayUpload.gradle' éœ€è¦æ³¨æ„çš„ç‚¹ä¸‹é¢é…ç½®çš„ä¸‰ä¸ªå€¼ï¼Œå†³å®šäº†ä½ æœ€åŽç”Ÿæˆçš„ä¾èµ–æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæˆ‘ç”¨æˆ‘çŽ°åœ¨çš„åº“ä¸¾äº†ä¸ªä¾‹å­ï¼Œè¿™ä¸ªæ˜¯å¯ä»¥åŽæœŸä¿®æ”¹çš„ã€‚ 12345// æœ€åŽç”Ÿæˆä¾èµ– compile 'yourGroup:yourArtifactId:yourVersion'// æœ€åŽç”Ÿæˆä¾èµ– compile 'com.march.lightadapter:lightadapter:1.0.1-beta1'yourGroup = 'com.march.lightadapter'yourArtifactId = 'lightadapter'yourVersion = '1.0.1-beta4' ç”¨æˆ·åå’Œ keyï¼Œè¿™äº›æ•æ„Ÿä¿¡æ¯æ˜¯ä¸åº”è¯¥è¢«ä¼ åˆ° git ä¸Šé¢çš„ï¼Œ ä½ åº”è¯¥åœ¨ .gitignore ä¸­é¿å…ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶ï¼Œä¹ æƒ¯çš„åšæ³•ä½ å¯ä»¥å°†è¿™äº›ä¿¡æ¯å†™åœ¨ local.properties ä¸­ï¼Œè·¯å¾„é…ç½®ä¸º yourBintrayUserPath = &#39;local.properties&#39;ï¼Œæˆ‘çš„åšæ³•æ˜¯å†™åœ¨æœ¬åœ°æ–‡ä»¶ä¸­ç„¶åŽä½¿ç”¨ç»å¯¹è·¯å¾„å¼•ç”¨ã€‚ ç„¶åŽä½ åœ¨æ–‡ä»¶ä¸­éœ€è¦æŒ‰ç…§å¦‚ä¸‹æ ¼å¼å£°æ˜Ž bintray.user å’Œ bintray.apikeyï¼› 123456// æ­¤æ–‡ä»¶ä¸­å­˜å‚¨çš„æ˜¯ bintray çš„æ•æ„Ÿä¿¡æ¯ï¼Œç”¨æˆ·åå’Œkey// ä½ éœ€è¦åœ¨è¯¥æ–‡ä»¶ä¸­å¦‚ä¸‹å£°æ˜Ž// bintray.user=xxxx// bintray.apikey=xxxx// ä½ å¯ä»¥ä½¿ç”¨é¡¹ç›®ä¸­çš„ local.propertiesyourBintrayUserPath = '/Users/march/AndroidRes/file/common_local.properties' å‘å¸ƒç±»åº“æˆ‘åœ¨ mac ä¸‹å¼€å‘ï¼Œç›¸å…³å‘½ä»¤å¯èƒ½æœ‰æ‰€å·®å¼‚ã€‚ æ‰“å¼€ terminalï¼Œè¿è¡Œ install å‘½ä»¤ 1./gradlew install æˆåŠŸåŽè¿è¡Œä¸Šä¼ å‘½ä»¤ 1./gradlew bintrayUpload å½“æç¤º Build Success åŽï¼ŒåŽ»ç½‘ç«™æ‰“å¼€æ‰€åœ¨çš„é¡¹ç›®ï¼Œæ³¨æ„å³ä¸Šè§’æœ‰ä¸ªé“¾æŽ¥ï¼Œç±»ä¼¼ https://dl.bintray.com/chendongmarch/mavenï¼Œè¿™æ˜¯ä½  mavenåº“çš„é“¾æŽ¥ï¼Œä¹Ÿå°±æ˜¯ä½ ç§æœ‰çš„ç©ºé—´ã€‚æ³¨æ„å·¦ä¸‹è§’æœ‰ä¸‰ä¸ªå¾ˆå°çš„é€‰é¡¹ mavenã€gradleã€lvyï¼Œç‚¹å‡» gradle å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä¾èµ–åœ°å€ï¼Œè¿™æ˜¯ compile çš„åœ°å€ï¼Œå°±ç®—å¤§åŠŸå‘Šæˆå•¦ã€‚ åœ¨ç§æœ‰ç©ºé—´ä½¿ç”¨ç±»åº“æ­¤æ—¶ä½ å·²ç»å¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»åº“äº†ï¼Œä½†æ˜¯å› ä¸ºä½ çš„ç±»åº“æ²¡æœ‰å‘å¸ƒåˆ°å…±æœ‰ç©ºé—´ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦åœ¨ project/build.gradle å£°æ˜Žä½ çš„ç§æœ‰ç©ºé—´ã€‚ 12345678910111213//åœ¨ project/build.gradle æ–‡ä»¶ä¸­æ·»åŠ ä½ ç§æœ‰ maven ç©ºé—´allprojects &#123; repositories &#123; jcenter() // çŽ°åœ¨ä¹‹æ‰€ä»¥æ·»åŠ è¿™ä¸€å¥æ˜¯å› ä¸ºä½ çš„ç±»åº“åªæ˜¯å‘å¸ƒåˆ°äº†maven // ä½†æ˜¯æ²¡æœ‰å‘å¸ƒåˆ°JCenter // å› æ­¤éœ€è¦å•ç‹¬ä¾èµ–ä½ çš„ç§æœ‰ç©ºé—´çš„åœ°å€ã€‚ maven &#123;url &apos;https://dl.bintray.com/chendongmarch/maven&apos;&#125; &#125;&#125;//åœ¨app/build.gradleæ–‡ä»¶ä¸­ä¾èµ–compile &apos;com.march.lightadapter:lightadapter:1.0.1-beta1&apos; å‘å¸ƒåˆ° jcenterç„¶åŽæˆ‘ä»¬å°†ç±»åº“å‘å¸ƒåˆ°å…¬å…±ç©ºé—´è®©åˆ«äººå¯ä»¥å¿«é€Ÿä½¿ç”¨ï¼Œè¿˜æ˜¯åœ¨ç½‘ç«™æŸ¥çœ‹é¡¹ç›®å³ä¸‹è§’å¯ä»¥çœ‹åˆ° Add to jcenter ç‚¹å‡»ä¹‹åŽå¯ä»¥å¾ˆç®€å•çš„æ·»åŠ ä½ çš„åº“åˆ° JCenter,ä½†æ˜¯å®¡æ ¸éœ€è¦æ—¶é—´ï¼Œç¬¬ä¸€æ¬¡ä¼šæ…¢ä¸€ç‚¹ï¼Œä»¥åŽä¼šå¾ˆå¿«ã€‚ç­‰åˆ°å®¡æ ¸é€šè¿‡ï¼Œå°±å¯ä»¥å°† maven{url=&quot;&quot;} è¿™ä¸€å—åŽ»æŽ‰ï¼Œç›´æŽ¥ compileï¼Œå› ä¸ºå·²ç»å¯ä»¥åœ¨ jcenter æ‰¾åˆ°ä½ çš„ç±»åº“äº†ï¼Œ ä¸éœ€è¦ä½¿ç”¨ç§æœ‰ç©ºé—´äº†ã€‚ åœ¨æœ¬åœ°ç©ºé—´ä½¿ç”¨ç±»åº“å•å•è¿è¡Œ ./gradlew install ä»»åŠ¡ï¼Œ gradle ä¼šåœ¨ maven çš„æœ¬åœ°ä»“åº“ä¸­ç”Ÿæˆå·¥ä»¶ï¼Œåªéœ€å°† mavenLocal æ·»åŠ åˆ° repositoriesï¼Œæˆ‘ä»¬å¯ä»¥åƒå‘å¸ƒåˆ° JCenter ä¸€æ ·å¼•ç”¨è‡ªå·±çš„åº“ï¼Œæ–¹ä¾¿æ‰“åŒ…é‚£äº›å¤šä¸ªé¡¹ç›®å…±äº«åˆä¸æƒ³å‘å¸ƒçš„ç§æœ‰åº“, åœ¨project/build.gradle æ–‡ä»¶æ·»åŠ ä¸‹é¢çš„ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨æœ¬åœ°åº“ï¼Œç±»æ¯”ä¸Šé¢çš„ç§æœ‰ç©ºé—´ï¼Œè¿™ä¸ªåº”è¯¥ç®—æœ¬åœ°ç©ºé—´ã€‚ 123456allprojects &#123; repositories &#123; mavenLocal() jcenter() &#125;&#125; ä¸€äº›ç†è§£æ€»ä½“æ¥è¯´ï¼Œæœ€æœ€é‡è¦çš„æ˜¯æ‰“åŒ…ä¸Šä¼ çš„è„šæœ¬ï¼Œä»–è´Ÿè´£æ‰“åŒ…æºæ–‡ä»¶ï¼Œç”Ÿæˆ aarï¼Œç”Ÿæˆ doc ç„¶åŽä¸Šä¼ åˆ° bintrayï¼Œæˆ‘ä¹‹å‰é‡‡ç”¨è¿‡åˆ«çš„æ–¹å¼æ‰“åŒ…ç±»åº“ï¼Œæœ¬æ–‡ä»‹ç»çš„æ–¹æ³•æœ‰ä¸ªå¾ˆå¤§çš„ä¼˜ç‚¹å°±æ˜¯æŠŠè¿™ä¸ªä»»åŠ¡ç‹¬ç«‹å‡ºæ¥ï¼Œå†™åœ¨ bintrayUpload.gradle æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨è¿œç¨‹è„šæœ¬ï¼Œéœ€è¦æ‰“åŒ…ä¸Šä¼ çš„ library åªéœ€è¦é…ç½®ä¸€ä¸‹ç±»åº“ç›¸å…³ä¿¡æ¯ï¼Œå¼•ç”¨è¿™ä¸ªè„šæœ¬å°±å¯ä»¥ä¸Šä¼ ï¼Œä¸éœ€è¦è¿›è¡Œå¤æ‚çš„é…ç½®ã€‚]]></content>
      <categories>
        <category>Android</category>
        <category>Publish</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Publish</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°†è‡ªå·±å†™çš„åº“å‘å¸ƒåˆ° JitPack]]></title>
    <url>%2Farticle%2F2091453987%2F</url>
    <content type="text"><![CDATA[JitPackä¼˜ç¼º åœ¨ä½¿ç”¨Jcenterå‘å¸ƒåº“ä»£ç æ—¶ï¼Œéœ€è¦å…ˆä¸Šä¼ åˆ°Bintrayç½‘ç«™ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œä¸è¿‡æˆ‘ä¹‹å‰å·²ç»ç»™å‡ºäº†ç®€åŒ–çš„æ–¹æ¡ˆ,æ ¹æ®è¿™ç¯‡æ–‡ç« å‘å¸ƒè‡ªå·±çš„åº“åˆ°JCenterå¯ä»¥å¾ˆå¿«çš„é…ç½®å¥½é¡¹ç›®ã€‚æœ¬æ–‡ä»‹ç»å¦å¤–ä¸€ç§å‘å¸ƒè‡ªå·±çš„åº“ä»£ç çš„æ–¹å¼ï¼Œä½¿ç”¨JitPackå‘å¸ƒä»£ç æ›´ç®€å•ä¸€äº›ã€‚ AndroidStudioåˆ›å»ºé¡¹ç›®æ—¶æ²¡æœ‰é»˜è®¤ç”ŸæˆJitPackçš„ä¾èµ–ï¼Œå½“ä½¿ç”¨åº“æ—¶éœ€è¦æ·»åŠ å¦‚ä¸‹ä¾èµ–1234repositories &#123; jcenter() maven &#123; url &quot;https://jitpack.io&quot; &#125; &#125; åˆ›å»ºå·¥ç¨‹æ–°å»ºLibrary Module,è¿™äº›å°±ä¸ä»”ç»†è¯´äº†ï¼Œå¤§å®¶éƒ½ä¼šï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä½¿ç”¨JCenteræ—¶ï¼Œåº“çš„åå­—æ˜¯è·Ÿä½ çš„Module nameæœ‰å…³çš„ï¼Œä½†æ˜¯JitPackæ˜¯ä¸Žä½ çš„Project nameæœ‰å…³çš„,æ‰€ä»¥ç»™ä½ çš„é¡¹ç›®èµ·ä¸€ä¸ªå¥½åå­—ï¼Œä»–å°†ä½œä¸ºåº“çš„åç§°ã€‚ é…ç½®æ’ä»¶ä¸Žå‘å¸ƒåˆ°JCenterä¸€æ ·ï¼Œéœ€è¦æ’ä»¶,è¿™é‡Œè¯´ä¸€ä¸‹è¿™ä¸ªæ’ä»¶ï¼Œè¯¥æ’ä»¶çš„GitHubåœ°å€ï¼Œåœ¨å‘å¸ƒåˆ°JCenteræ—¶ä¹Ÿç”¨åˆ°äº†è¿™ä¸ªæ’ä»¶ï¼ŒçŽ°åœ¨çš„æœ€æ–°ç‰ˆæœ¬1.4.1ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹ï¼Œç¼–è¯‘ä¸æˆåŠŸï¼Œçœ‹äº†Issues,å¤§æ¦‚æ˜¯å› ä¸ºgradleéœ€è¦æå‡åˆ°2.14.1æ‰å¯ä»¥ï¼Œå…³äºŽè¿™ä¸ªé—®é¢˜å¯ä»¥è‡ªå·±åŽ»æŸ¥ä¸€ä¸‹ï¼Œåƒæˆ‘ä¸‹é¢è¿™æ ·çš„é…ç½®æ˜¯okçš„ï¼Œç‰ˆæœ¬çš„å¯¹åº”å¯ä»¥åŽ»Gitä¸Šçœ‹çœ‹ã€‚12345678910buildscript &#123; repositories &#123; jcenter() mavenCentral() &#125; dependencies &#123; classpath &apos;com.android.tools.build:gradle:2.1.2&apos; classpath &apos;com.github.dcendents:android-maven-gradle-plugin:1.3&apos; &#125;&#125; é…ç½®Moduleçš„build.gradle123456//é»˜è®¤å°±æœ‰çš„apply plugin: &apos;com.android.library&apos;//è¿™ä¸ªè·ŸJcenterä¸€æ ·çš„æ’ä»¶apply plugin: &apos;com.github.dcendents.android-maven&apos;//ä½ çš„Githubç”¨æˆ·åæ›¿æ¢ä¸€ä¸‹group=&apos;com.github.chendongMarch&apos; å‘å¸ƒåˆ°GitHub æŽ¥ä¸‹æ¥å°±åŽ»GitHubä¸Šæ‰“å¼€ä½ çš„é¡¹ç›®ï¼&gt;ç‚¹å‡»releaseï¼&gt;ç‚¹å‡»åˆ›å»ºæ–°çš„releaseç‰ˆæœ¬ï¼&gt;ä¹¦å†™ç‰ˆæœ¬å·å’Œreleaseä¿¡æ¯ï¼&gt;å°±ä¼šçœ‹è§åˆ°æ­¤å°±å®Œæˆäº†å‘å¸ƒã€‚å¦‚ä¸‹ JitPackå‘å¸ƒ æœ€åŽåŽ»JitPack,ä¼šçœ‹è§å¦‚ä¸‹ç•Œé¢,è¾“å…¥ä½ çš„é¡¹ç›®åœ°å€ï¼Œä¼šçœ‹åˆ°ç‰ˆæœ¬å·ï¼Œç‚¹å‡»get itï¼Œä¸‹é¢ä¼šå‡ºçŽ°compileåœ°å€ å®Œæˆ ASä¾èµ– 1compile &apos;com.github.chendongMarch:JitPackLibs:1.0.2&apos;]]></content>
      <categories>
        <category>Android</category>
        <category>Publish</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Publish</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ListView Adapter 4]]></title>
    <url>%2Farticle%2F2414640248%2F</url>
    <content type="text"><![CDATA[GitHubåº“ä»£ç é“¾æŽ¥ Gradlecompile &#39;com.march.adapterlibs:adapterlibs:1.0.6&#39; å‰è¨€ åŸºäºŽå‰ç«¯æ—¶é—´æ€»ç»“çš„EasyAdapterï¼ˆçœ‹åŽŸç†çš„å¯ä»¥çœ‹è¿™äº›åšå®¢ï¼‰é‡æ–°æž„å»ºäº†ä»£ç ï¼ŒåŸºæœ¬æ€æƒ³è¿˜æ˜¯ä¸€æ ·çš„ï¼Œç›®çš„æ˜¯å¯¹å¤–å¼€æ”¾æ›´åŠ ç®€å•çš„API,å…¶ä¸­çš„åŽŸç†ï¼Œæƒ³çŸ¥æ™“çš„å¯ä»¥åŽ»çœ‹æˆ‘ä»¥å‰çš„åšå®¢ã€‚çŽ°åœ¨çš„ç‰ˆæœ¬å·²ç»ä¸Žä»¥å‰çš„ç‰ˆæœ¬ç‹¬ç«‹å¼€äº†ã€‚ å•ç±»åž‹æŠ½è±¡é€‚é…QuickAdapter123456789101112QuickAdapter&lt;Demo&gt; adapter =new QuickAdapter&lt;Demo&gt;(BaseApplication.getInst(), R.layout.item_quickadapter, data) &#123; @Override public void bindData4View(ViewHolder holder, Demo data, int pos) &#123; holder.setText(R.id.item_quickadapter_title, data.getmDemoTitle()); &#125; @Override public void bindListener4View(ViewHolder holder, Demo data, int pos) &#123; //åœ¨è¿™é‡Œç»™å†…éƒ¨æŽ§ä»¶ç»‘å®šç›‘å¬ä¸æ˜¯å¿…é¡»å®žçŽ°çš„ &#125; &#125;; ä½¿ç”¨QuickTypeAdapter QuickTypeAdapterçš„å¸¦layoutèµ„æºå‚æ•°æž„é€ æ–¹æ³•,æ³¨æ„ä¸è¦è°ƒç”¨addTypeäº†,å®žä½“ç±»éœ€è¦å®žçŽ°QuickInterfaceæŽ¥å£ 1234567891011QuickTypeAdapter&lt;Demo&gt; typeAdapter =new QuickTypeAdapter&lt;Demo&gt;(BaseApplication.getInst(), data,R.layout.item_a) &#123; @Override public void bindData4View(ViewHolder holder, Demo data, int type, int pos) &#123; //å•ç±»åž‹,typeä¸€ç›´è¿”å›ž0 &#125; @Override public void bindListener4View(ViewHolder holder, Demo data, int type, int pos) &#123; //åœ¨è¿™é‡Œç»™å†…éƒ¨æŽ§ä»¶ç»‘å®šç›‘å¬ä¸æ˜¯å¿…é¡»å®žçŽ°çš„ &#125;&#125;; å¤šç±»åž‹é€‚é…1234567891011121314151617181920212223//å®žä½“ç±»éœ€è¦å®žçŽ°QuickInterfaceæŽ¥å£QuickTypeAdapter&lt;Demo&gt; typeAdapter = new QuickTypeAdapter&lt;Demo&gt;(BaseApplication.getInst(), data) &#123; @Override public void bindData4View(ViewHolder holder, Demo data, int type, int pos) &#123; switch (type) &#123; case Demo.CODE_DETAIL: holder.setText(R.id.item_quickadapter_type_title, data.getmDemoTitle()); break; case Demo.JUST_TEST: holder.setText(R.id.item_quickadapter_title, data.getmDemoTitle()); break; &#125; &#125; @Override public void bindListener4View(ViewHolder holder, Demo data, int type, int pos) &#123; //åœ¨è¿™é‡Œç»™å†…éƒ¨æŽ§ä»¶ç»‘å®šç›‘å¬ä¸æ˜¯å¿…é¡»å®žçŽ°çš„ &#125; &#125;;//æ·»åŠ æ¯ç§ç±»åž‹çš„xmlæ–‡ä»¶typeAdapter.addType(Demo.CODE_DETAIL, R.layout.item_quickadapter_type) .addType(Demo.JUST_TEST, R.layout.item_quickadapter); åŠ è½½ç½‘ç»œå›¾ç‰‡ å¯ä»¥æå‰åˆ›å»ºå›¾ç‰‡åŠ è½½å·¥å…·,ç„¶åŽè°ƒç”¨ViewHodler.setImg()æ–¹æ³•å¯ä»¥ç›´æŽ¥åŠ è½½ 12345678//ä½ å¯ä»¥åœ¨Activityæˆ–è€…Applicationè°ƒç”¨è¿™æ®µä»£ç è¿›è¡Œå…¨å±€é…ç½®,ç¬¬äºŒæ¬¡è°ƒç”¨ä¼šå°†ä»¥å‰çš„è®¾ç½®è¦†ç›–,æ‰€ä»¥åªéœ€è¦æ‰§è¡Œä¸€æ¬¡Quick.init(new Quick.QuickLoad() &#123; @Override public void load(Context context, String url, ImageView view) &#123; Log.e("chendong","åŠ è½½å›¾ç‰‡"); Glide.with(context).load("http://www.fresco-cn.org/static/fresco-logo.png").into(view); &#125; &#125;); æ›´æ–°ä½¿ç”¨æ–¹æ³•12345678910111213//Demoç±»æ˜¯æˆ‘çš„å®žä½“ç±»//å¦‚æžœä½ ä½¿ç”¨çš„æŽ§ä»¶ViewHolderæ²¡æœ‰ä¸ºä½ é›†æˆ,å¦‚ä½•é¿å…å¼ºè½¬?ä½¿ç”¨æ³›åž‹è§£å†³ holder.&lt;Button&gt;getView(R.id.abc).setText("");//è®¾ç½®ç›‘å¬äº‹ä»¶public ViewHolder setLis(int resId,View.OnClickListener listener,Object tag)//å¸¦æœ‰tagç›‘å¬public ViewHolder setLis(int resId,View.OnClickListener listener)//ä¸å¸¦tagç›‘å¬public ViewHolder setTag(int resId, Object tag)//ç»™æŽ§ä»¶è®¾ç½®tagpublic &lt;T&gt; T getTag(int resId)//ä»ŽViewHolderèŽ·å–tag,åŒ…å«æ³›åž‹,ä½ å¯ä»¥è¿™æ ·holder.&lt;Demo&gt;getTag(R.id.xxx)//å¦‚æžœä½ åœ¨æŽ§ä»¶ä¸­è®¾ç½®äº†tag,å½“ä½ åœ¨é€‚é…å™¨å¤–éƒ¨ä½¿ç”¨tagæ—¶åŠ¡å¿…ä½¿ç”¨æ”¹æ–¹æ³•èŽ·å–,ç”¨æ¥æ›¿ä»£view.getTag()æ–¹æ³•,åŒ…å«æ³›åž‹,ä½ å¯ä»¥è¿™æ ·ç”¨ Quick.&lt;Demo&gt;getTagOutOfAdapter(listView);Quick.getTagOutOfAdapter(View view)]]></content>
      <categories>
        <category>Android</category>
        <category>Adapter</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>ListView</tag>
        <tag>Adapter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨Androidå¹³å°ä¸‹åˆæˆGif]]></title>
    <url>%2Farticle%2F3121499733%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä»‹ç»åœ¨ Android å¹³å°ä¸‹åˆæˆ GIF çš„æ–¹æ³•ï¼ŒæŸ¥é˜…èµ„æ–™çš„è¿‡ç¨‹ä¸­å‘çŽ°å¤§è‡´æœ‰ä¸¤ç§æ–¹æ¡ˆã€‚ ä½¿ç”¨ giflen (ä¸€ä¸ª C çš„åˆæˆ gif çš„åº“) è¿›è¡Œ gif åˆæˆã€‚ ä½¿ç”¨ java å±‚çš„ GifEncoderã€LZWEncoderã€NeuQuant æ¥è¿›è¡Œ gif åˆæˆã€‚ å½“ç„¶äºŒè€…éƒ½æ˜¯åŸºäºŽ LZW ç®—æ³•ï¼Œç®€å•æµ‹è¯•çš„ç»“æžœæ˜¯ï¼Œé€Ÿåº¦ä¸Šå·®ä¸å¤šï¼Œç”±äºŽå¯¹ C ä¸æ˜¯å¾ˆæ“…é•¿ï¼Œå› æ­¤æˆ‘é€‰æ‹©äº† java å±‚è¿›è¡Œåˆæˆçš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸¤ç§æ–¹æ³•é€Ÿåº¦ä¸Šéƒ½æ˜¯ å¾ˆæ…¢å¾ˆæ…¢ ðŸ˜­ã€‚ å› æ­¤æœ¬æ–‡è¿˜å°†ä¼šä½¿ç”¨å¤šçº¿ç¨‹ç‹¬ç«‹ç¼–ç çš„æ–¹æ³•æ¥è¿›è¡Œä¼˜åŒ–ï¼Œæ¯å¸§å›¾ç‰‡å¹¶è¡Œç¼–ç ï¼ŒåŠ å¿«åˆæˆé€Ÿåº¦ï¼ŒçŽ°åœ¨çš„æˆæžœæ˜¯ 600 * 450 çš„å›¾ç‰‡ 20 å¼ çš„è¯ï¼Œæ—¶é—´å¤§çº¦åœ¨ 12s å·¦å³ã€‚ æœ¬æ–‡ç›¸å…³æºç åœ¨ GitHub - GifMaker ä½¿ç”¨ giflen åˆæˆä½¿ç”¨ jni åˆæˆï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥ google ä¸€ä¸‹ giflen è¿™ä¸ªåº“ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç¼–è¯‘å¥½çš„ so å’Œ jar æ–‡ä»¶ï¼Œä»¥åŠç›¸å…³ C æºç ï¼Œå¤‡ä»½åœ¨ GitHub ä¸Šï¼Œæœ‰éœ€è¦çš„åŒå­¦å¯ä»¥ç›´æŽ¥ä¸‹è½½ä½¿ç”¨ã€‚ç»è¿‡æˆ‘çš„ç®€å•å°è¯•å‘çŽ°ï¼Œä½¿ç”¨ so åˆæˆçš„é€Ÿåº¦å’Œ java åˆæˆçš„é€Ÿåº¦å·®ä¸å¤šï¼Œéƒ½æ˜¯æ…¢çš„è¦æ­»â€¦ ä¼˜åŒ–åŽçš„ java åˆæˆåŽŸå§‹çš„åˆæˆæ–¹æ³•ï¼ŒçœŸçš„æ…¢â€¦ç‰¹åˆ«æ…¢ï¼Œç®€ç›´ä¸èƒ½å¿ã€‚ åŽŸå§‹çš„åˆæˆæ–¹æ³•æ˜¯å°†æ¯ä¸€ä¸ª Bitmap ä½¿ç”¨ LZWEncoder è¿›è¡Œç¼–ç ï¼Œç”±äºŽæ˜¯ä¸€ä¸ªä¸²è¡Œçš„é€»è¾‘ï¼ŒåŽé¢çš„å›¾ç‰‡éœ€è¦ç­‰å¾…å‰é¢çš„ç¼–ç å®Œæˆæ‰å¯ä»¥ç»§ç»­ä¸‹ä¸€å¼ ç¼–ç ï¼Œä¼˜åŒ–åŽçš„é€»è¾‘æ˜¯å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ¯å¼ å›¾ç‰‡ç‹¬ç«‹ç¼–ç ï¼Œæœ€åŽåœ¨æ‰€æœ‰å›¾ç‰‡ç¼–ç å®Œæˆä¹‹åŽè¾“å‡ºæµåˆå¹¶ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œå°±å®Œæˆäº† gif çš„åˆæˆã€‚ ç¼ºç‚¹ï¼šå¤§é‡çš„ Bitmap æŒæœ‰åœ¨å†…å­˜ä¸­å¹¶è¡Œç¼–ç ï¼Œå¯èƒ½ä¼š OOMï¼Œä¸è¿‡æˆ‘æµ‹è¯• 20 å¼  450 * 600 çš„å›¾ç‰‡ï¼Œæš‚æ—¶æ²¡æœ‰å‡ºçŽ°é—®é¢˜ã€‚åˆæˆçš„å›¾ç‰‡è¦æ±‚å®½é«˜åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œå½“ç„¶ä½¿ç”¨å®½é«˜ä¸ä¸€è‡´çš„å›¾ç‰‡ä¹Ÿä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯ä¼šä¼˜å…ˆä½¿ç”¨ç¬¬ä¸€å¼ çš„å›¾ç‰‡çš„å®½é«˜ä½œä¸º gif çš„å®½é«˜ï¼Œå‡ºæ¥çš„å›¾ç‰‡å°±æœ‰äº›å°´å°¬ï¼Œå› æ­¤å›¾ç‰‡çš„è½¬æ¢å’Œå¤„ç†éœ€è¦åœ¨å¤–é¢å®Œæˆã€‚ ç®€å•æ¼”ç¤º12345678910111213private void composeGif(List&lt;Bitmap&gt; bitmaps) &#123; String absolutePath = new File(Environment.getExternalStorageDirectory() , System.currentTimeMillis() + ".gif").getAbsolutePath(); new GifMaker(100, mExecutorService) .makeGifInThread(bitmaps, absolutePath, new GifMaker.OnGifMakerListener() &#123; @Override public void onMakeGifSucceed(String outPath) &#123; if (!isFinishing()) &#123; GlideUtils.with(mActivity, outPath).into(mImageView); &#125; &#125; &#125;);&#125; çœ‹ä¸€ä¸‹è¾“å‡ºçš„ç»“æžœï¼Œ20 å¼ å¤§çº¦ç»´æŒåœ¨ 12s å·¦å³ 123456789101112131415161718192021I/GifMaker: å®Œæˆç¬¬10å¸§,è€—æ—¶:9.594 s - bitmap [600,450]I/GifMaker: å®Œæˆç¬¬11å¸§,è€—æ—¶:9.774 s - bitmap [600,450]I/GifMaker: å®Œæˆç¬¬18å¸§,è€—æ—¶:9.880 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬9å¸§,è€—æ—¶:10.41 s - bitmap [600,450]I/GifMaker: å®Œæˆç¬¬17å¸§,è€—æ—¶:10.145 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬16å¸§,è€—æ—¶:10.331 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬6å¸§,è€—æ—¶:10.586 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬5å¸§,è€—æ—¶:10.557 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬8å¸§,è€—æ—¶:10.701 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬15å¸§,è€—æ—¶:10.715 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬4å¸§,è€—æ—¶:10.736 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬1å¸§,è€—æ—¶:10.835 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬19å¸§,è€—æ—¶:10.842 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬13å¸§,è€—æ—¶:10.940 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬0å¸§,è€—æ—¶:10.944 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬14å¸§,è€—æ—¶:10.967 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬3å¸§,è€—æ—¶:10.989 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬12å¸§,è€—æ—¶:10.994 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬2å¸§,è€—æ—¶:10.994 s - bitmap [450,600]I/GifMaker: å®Œæˆç¬¬7å¸§,è€—æ—¶:11.148 s - bitmap [450,600]I/GifMaker: åˆæˆå®Œæˆ,è€—æ—¶:11.167 s]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidç‰©ç†æŒ‰é”®åŠç‰©ç†è¿žæŽ¥]]></title>
    <url>%2Farticle%2F4013192295%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» Android æ‰‹æœºç‰©ç†æŒ‰é”®è§¦å‘ç›‘å¬ï¼Œä»¥åŠå¤–æŽ¥è“ç‰™ï¼Œè€³æœºç­‰è®¾å¤‡çš„æ£€æµ‹ã€‚ äº‹ä»¶åˆ†å‘ æ‹¦æˆªæŒ‰é”®æŒ‰ä¸‹æŠ¬èµ·æ—¶çš„äº‹ä»¶åˆ†å‘ 12345678@Override public boolean dispatchKeyEvent(KeyEvent event) &#123; //å¦‚æžœæ˜¯é•¿æŒ‰äº‹ä»¶äº¤ç»™onKeyLongPresså¤„ç† if (event.getRepeatCount() &gt; 0) return onKeyLongPress(event.getKeyCode(), event); return super.dispatchKeyEvent(event); &#125; è¿”å›žæŒ‰é”®12345//è¿”å›žé”®çš„ç›‘å¬å¾ˆå¸¸è§ï¼Œandroidæä¾›äº†ç®€ä¾¿çš„æ–¹æ³•@Overridepublic void onBackPressed() &#123; finishThisPage();&#125; æŒ‰é”®æŒ‰ä¸‹äº‹ä»¶å¤„ç† (éŸ³é‡ï¼Œè€³æœºæŒ‰é”®ï¼Œbacké”®) 123456789101112131415161718192021222324//homeé”®å’Œpoweré”®æ²¡æœ‰ç›‘å¬åˆ°//æˆ‘å½“æ—¶éœ€è¦çš„æ˜¯éŸ³é‡é”®å’Œè€³æœºæŒ‰é”®å¯ä»¥æ‹ç…§ï¼Œæ˜¯å¯ä»¥ç›‘å¬åˆ°çš„@Override public boolean onKeyDown(int keyCode, KeyEvent event) &#123; L.info(event.toString()); switch (keyCode) &#123; case KeyEvent.KEYCODE_VOLUME_DOWN: L.info("KEYCODE_VOLUME_DOWN-éŸ³é‡é”®å‡å°å£°éŸ³"); return true; case KeyEvent.KEYCODE_VOLUME_UP: L.info("KEYCODE_VOLUME_UP-éŸ³é‡é”®å¢žåŠ å£°éŸ³"); return true; case KeyEvent.KEYCODE_VOLUME_MUTE: L.info("KEYCODE_VOLUME_MUTE-éŸ³é‡é”®é™éŸ³"); return true; case KeyEvent.KEYCODE_HEADSETHOOK: L.info("KEYCODE_HEADSETHOOK-è€³æœºçº¿æŒ‰é”®"); return true; case KeyEvent.KEYCODE_BACK: L.info("KEYCODE_BACK-è¿”å›žé”®"); return true; &#125; return super.onKeyDown(keyCode, event); &#125; å…¶ä»–äº‹ä»¶1234567891011121314151617181920212223242526272829303132// ä½¿ç”¨å¿«æ·é”®å¯ä»¥å¿«é€Ÿé€‰ä¸­èœå•ä¸­çš„æŸä¸€é¡¹ï¼Œåœ¨Androidæ²¡æœ‰ä»€ä¹ˆåµç”¨@Override public boolean onCreateOptionsMenu(Menu menu) &#123; MenuItem add = menu.add(""); add.setShortcut('A','A'); return super.onCreateOptionsMenu(menu); &#125;@Override public boolean onKeyShortcut(int keyCode, KeyEvent event) &#123; L.info("onKeyShortcut " + event.toString()); return super.onKeyShortcut(keyCode, event); &#125;@Override public boolean onKeyLongPress(int keyCode, KeyEvent event) &#123; L.info("onKeyLongPress " + event.toString()); return super.onKeyLongPress(keyCode, event); &#125; //æš‚æ—¶æ²¡æœ‰ç”¨åˆ°ï¼Œç½‘ä¸Šæœ‰è¯´åœ¨æ‰‹å†™å’Œæ±‰å­—è¾“å…¥æ—¶ä¼šè§¦å‘@Override public boolean onKeyMultiple(int keyCode, int repeatCount, KeyEvent event) &#123; L.info("onKeyMultiple " + event.toString()); return super.onKeyMultiple(keyCode, repeatCount, event); &#125;//æŒ‰é”®æŠ¬èµ·æ—¶ä¼šè§¦å‘@Override public boolean onKeyUp(int keyCode, KeyEvent event) &#123; L.info("onKeyUp " + event.toString()); return super.onKeyUp(keyCode, event); &#125; å¤–è®¾ç›‘æµ‹ æ£€æµ‹è€³æœºçº¿ï¼Œè“ç‰™è€³æœºæ˜¯å¦è¿žæŽ¥ 1234567891011121314151617181920212223242526272829303132private boolean checkControlIsConnected() &#123; //æ£€æµ‹è€³æœºçº¿æ˜¯å¦è¿žæŽ¥ AudioManager am = (AudioManager) getSystemService(AUDIO_SERVICE); //è¿™ä¸ªæ–¹æ³•å·²ç»è¿‡æ—¶ï¼Œapiä»‹ç»ä»…ä»…ç”¨æ¥æ£€æµ‹æ˜¯å¦è¿žæŽ¥ï¼Œå¯ä»¥æ³¨å†Œå¹¿æ’­æŽ¥æ”¶è€…æŽ¥å—è€³æœºæ’æ‹”çš„å¹¿æ’­ if (am.isWiredHeadsetOn()) &#123; //è€³æœºæ’å…¥ return true; &#125; //æ£€æµ‹è“ç‰™è®¾å¤‡æ˜¯å¦è¿žæŽ¥ BluetoothAdapter ba = BluetoothAdapter.getDefaultAdapter(); //è“ç‰™é€‚é…å™¨æ˜¯å¦å­˜åœ¨ï¼Œå³æ˜¯å¦å‘ç”Ÿäº†é”™è¯¯ if (ba == null || !ba.isEnabled()) &#123; //è“ç‰™ä¸å¯ç”¨ return false; &#125; else if (ba.isEnabled()) &#123; Set&lt;BluetoothDevice&gt; bondedDevices = ba.getBondedDevices(); if (bondedDevices == null || bondedDevices.size() &lt;= 0) &#123; //å½“å‰æ²¡æœ‰è®¾å¤‡è¿žæŽ¥ return false; &#125; else &#123; for (BluetoothDevice d : bondedDevices) &#123; if (d.getBondState() == BluetoothDevice.BOND_BONDED) &#123; //å½“å‰æœ‰è®¾å¤‡æŽ¥å…¥å¹¶å¤„äºŽè¿žæŽ¥çŠ¶æ€ return true; &#125; &#125; &#125; &#125; return false; &#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Pythonå¼€å‘-1-åŸºç¡€]]></title>
    <url>%2Farticle%2F1811789999%2F</url>
    <content type="text"><![CDATA[å‰è¨€ æˆ‘ä½¿ç”¨çš„Pycharmç¼–è¯‘å™¨ï¼Œåˆšå¼€å§‹å°±é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸èƒ½è¾“å…¥ä¸­æ–‡ï¼Œè§£å†³åŠžæ³•å°±æ˜¯åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ ä»£ç #-*- coding:utf8 -*- Pythonäº¤äº’12345678910111213141516171819# ä½¿ç”¨pythonäº¤äº’æ¨¡å¼# åœ¨å‘½ä»¤è¡Œç•Œé¢è¾“å…¥ï½€pythonï½€è¿›å…¥äº¤äº’æ¨¡å¼# ï½€help()ï½€è¿›å…¥å¸®åŠ©æ¨¡å¼# å°è¯•ï½€keywordsï½€èŽ·å–å…³é”®å­—å¸®åŠ©#ï½€help("modules")ï½€æŸ¥çœ‹modules# ï½€quitï½€ é€€å‡ºå¸®åŠ©æ¨¡å¼#dir(object) å®ƒè¿”å›žä¼ é€’ç»™å®ƒçš„ä»»ä½•å¯¹è±¡çš„å±žæ€§åç§°ç»è¿‡æŽ’åºçš„åˆ—è¡¨#dir()å½“å‰å€’å…¥çš„æ¨¡å—#ä¸‹é¢ä»¥å†…å»ºå‡½æ•°idä¸ºä¾‹#èŽ·å–æ–‡æ¡£ä»‹ç»,ï½€id.__doc__ï½€#èŽ·å–åç§°,å¹¶ä¸æ˜¯æ‰€æœ‰çš„éƒ½æœ‰`id.__name__`å±žæ€§#`hasattr(dir,'__doc__')`,`getattr(dir,'__doc__')`èŽ·å–ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§#callableå¯è°ƒç”¨æ€§`callable("a")` false,`callable(dir)` true#`isinstance("python", str)`,`issubclass(child.father)` æ•°æ®ç±»åž‹12345678# åˆ—è¡¨(åŒç±»åž‹æ•°æ®æž„æˆçš„æ•°ç»„)list ï¼ ï¼»1ï¼Œ2ï¼Œ3ï¼Œ4ï¼½# å…ƒç»„ï¼ˆæ•°æ®ç±»åž‹å¯ä»¥ä¸åŒï¼Œç®€å•æ–¹ä¾¿çš„æ•°æ®èšåˆï¼Œç±»ä¼¼ç»“æž„ä½“ï¼‰tuple = (1,"second",1.2)# setï¼ˆæ•°æ®ä¸é‡å¤ï¼Œä½¿ç”¨listæž„å»ºï¼Œæ— åºï¼Œä¸èƒ½ä½¿ç”¨ç´¢å¼•è®¿é—®ï¼‰set = set([1,2,3,4])# å­—å…¸ï¼ˆé”®å€¼å¯¹å­˜å‚¨æ•°æ®ï¼‰dict ï¼ ï½›"a":"b","c":"d"ï½ åŸºç¡€è¯­æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218# æ‰“å°# è‡ªåŠ¨è¿½åŠ æ¢è¡Œç¬¦print "hello world"# å°†ä¸ä¼šæ‰“å°æ¢è¡Œç¬¦å·print "hello world",ï¼ƒ ä½¿ç”¨åŒ¹é…ç¬¦num = 100num2 = 200print "num is %d"%numprint "num is %d,num2 is %d"%(num,num2)# å†…å»ºå‡½æ•°id()å’Œtype()a = 3# èŽ·å–å†…å­˜åœ°å€print "id(a) is ", id(a)# èŽ·å–å˜é‡ç±»åž‹print "type(a) is ", type(a)# è¿ç®—ç¬¦(ä¸¤ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„)# çº§æ•°ä¹˜2çš„3æ¬¡æ–¹print "use ** = ", 2 ** 3# é™¤åŽå–æ•´print "use // = ", 9 // 4# é€»è¾‘è¿ç®— and | or | notif a == 0 and b == 0: a = 2# for in å¾ªçŽ¯for i in [1, 2, 3, 4]: print i,# æ¨¡å—çš„å¯¼å…¥çš„å‡ ç§æ–¹å¼import mathfrom math import powfrom math import pow,absfrom math import *print pow(10, 3)from math import pow as pingfangprint pingfang(10, 3)# èµ‹å€¼# å¤šä¸ªèµ‹å€¼å¯ä»¥ç›´æŽ¥é¡ºåºå†™ï¼Œä¼šæŒ¨ä¸ªè‡ªåŠ¨èµ‹å€¼x, y, z = 1, "abc", [1, 2, 3]print x, y, z# è‡ªåŠ¨åˆ›å»ºå…ƒç»„ï¼Œå°†åŽé¢çš„æ•°æ®,è£…å…¥å…ƒç»„xx = 1, 2, 3, 4, "qqq"print xx# äº¤æ¢æ•°æ®çš„æ–¹å¼yy, zz = 3, 4print yy, zzyy, zz = zz, yyprint yy, zz# é“¾å¼èµ‹å€¼,ä¸¤ä¸ªå˜é‡æŒ‡å‘ç»Ÿä¸€ç©ºé—´,id()ä¸€æ ·çš„m = n = 123print m, nprint m is n# åˆ¤æ–­ç»“æž„xxx = 1if xxx == 1: print "this is test ", 1elif xxx == 2: print "this is test ", 2else: print "this is test ", 100#èŽ·å–æŽ§åˆ¶å°è¾“å…¥inputNum = raw_input()# ä¸‰å…ƒè¿ç®—# A = X if B else Y# å¦‚æžœBä¸ºçœŸ,æ‰§è¡ŒA = X,å¦åˆ™æ‰§è¡ŒA = Ymm, nn = 1, 2rstStr = "abc" if mm &gt; nn else "def"print rstStr# forå¾ªçŽ¯å’Œå†…å»ºå‡½æ•°range(start,stop,step),range(start,stop,1),range(0,stop,1)è¿”å›žçš„æ˜¯æ•°å­—å…ƒç´ çš„åˆ—è¡¨startå¼€å§‹,stopç»“æŸ,æ¯æ¬¡å¢žåŠ stepä¸ªstrx = "abcdefg"for i in range(len(strx)): print strx[i],range(9)range(3, 9)range(3, 9, 4)ï¼ƒ ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡å¯ä»¥ç›´æŽ¥è½¬æ¢ä¸ºåºåˆ—å¯¹è±¡print list(strx)print set(strx)print tuple(strx)# éåŽ†å­—å…¸dictStr = &#123;"a": "b", "c": "d"&#125;# ä¸å»ºè®®ä½¿ç”¨,æ•ˆçŽ‡ç›¸å¯¹ä½Žfor key in dictStr: print "1key value is ", key, dictStr[key]# éåŽ†keyfor key in dictStr.keys(): print "2key value is ", key, dictStr[key] for key, value in dictStr.items(): print "3key value is ", key, value# æ›´ä¼˜for key, value in dictStr.iteritems(): print "4key value is ", key, value # å•ç‹¬å–valueä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ•ˆçŽ‡æ›´é«˜for value in dictStr.values(): print "5value is ", value# å†…å»ºå‡½æ•°zip(),å°†ä¸¤ä¸ªåºåˆ—æ•°æ®ç±»åž‹,æ¯ä¸€é¡¹å–å‡ºæ¥,åˆå¹¶ä¸ºä¸€ä¸ªå…ƒç»„,æž„æˆå…ƒç»„çš„liststr1 = "abcdef"str2 = "12345"print zip(str1, str2, str2)# [('a', '1', '1'), ('b', '2', '2'), ('c', '3', '3'), ('d', '4', '4'), ('e', '5', '5')]# äº¤æ¢key,value,æ¯ä¸ªitemæ˜¯ä¸¤ä¸ªå…ƒç´ çš„tupleçš„listå¯ä»¥ç›´æŽ¥è½¬æ¢ä¸ºdictdict1 = &#123;"a": "1", "b": "2", "c": "3"&#125;print dict(zip(dict1.values(), dict1.keys()))# å†…å»ºå‡½æ•°enumerate()ç”Ÿæˆçš„æ˜¯ï¼ˆitemä¸ºä¸‹æ ‡å’Œå…ƒç´ æž„æˆçš„ä¸¤å…ƒå…ƒç»„ï¼‰çš„å¯è¿­ä»£å¯¹è±¡ï¼Œå¯ä»¥ç›´æŽ¥è½¬æ¢ä¸ºåˆ—è¡¨mList = ["a", "b", "c", "d", "e"]for (i, j) in enumerate(mList): print i, " -- ", jprint list(enumerate(mList, start=1))#[(1, 'a'), (2, 'b'), (3, 'c'), (4, 'd'), (5, 'e')]# æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦,å­—ç¬¦ä¸²æ­£åˆ™åˆ†å‰²originStr = "Do u like Canglaoshi? Canglaoshi is a good teather!"splitStrs = originStr.split(" ")for i, s in enumerate(splitStrs): if "Canglaoshi" in s: splitStrs[i] = "Python"# listè§£æž,åŽ»æŽ‰å…ƒç´ å‰åŽç©ºæ ¼,listè§£æžå¯ä»¥ç®€å•å¿«æ·çš„ä¿®æ”¹æ¯ä¸€ä¸ªå…ƒç´ ï¼Œç”Ÿæˆæ–°çš„listoriginList = [" abc", " vbf ", "rtg "]afterList = [one.strip() for one in originList]print afterList# liståˆ‡ç‰‡[start = 0,stop = len(list),step = 1],ä¸€ä¸ªç®€å•ä»Žlistæå–éƒ¨åˆ†æ•°æ®çš„æ–¹å¼list2cut = [1,2,3,4,5,6,7]listRst = list2cut[0:5:2]print "list2Rst is " ,listRst# ä¸€ä¸ªçŒœæ•°å­—çš„å°ç¨‹åºï¼Œç®€å•ä»‹ç»å¾ªçŽ¯ç»“æž„å’Œåˆ¤æ–­ç»“æž„çš„ç®€å•å®žç”¨import randomnumber = random.randint(1,100)while(True): print "è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—,çŒœæµ‹çº¦å®šçš„æ•°å­—æ˜¯å¤šå°‘?" input = raw_input() if (int)(input) == number: print "æ­£ç¡®!" break elif (int)(input) &lt; number: print "å¤ªå°äº†!" else: print "å¤ªå¤§äº†!"# for... else å’Œ while... else# è·³å‡ºå¾ªçŽ¯ç»“æž„ä¹‹åŽæ‰§è¡Œelseè¯­å¥for i in range(1,100): print i,else: print "end"# è¿­ä»£list2Iter = [1,2,3,4,5,6]iterIt = iter(list2Iter)# è¿™é‡Œä¼šæç¤ºä¸€ä¸ªè­¦å‘Šwhile True: print iterIt.next()# æ–‡ä»¶è¿­ä»£#få…¶å®žæ˜¯ä¸€ä¸ªå¯ä»¥è¿­ä»£çš„å¯¹è±¡,å¯ä»¥ä½¿ç”¨åˆ—è¡¨æ“ä½œlist2File = [line for line in open(fileName)]print "list2File is ",list2File# å¯ä»¥æ›´ç®€å•list2File = list(open(fileName))print "list2File2 is ",list2File æ–‡ä»¶ç®€å•æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455æ–‡ä»¶æ“ä½œfileName = "/Users/march/123.txt"# ä»¥ä¸€ç§æ¨¡å¼æ‰“å¼€æ–‡ä»¶èŽ·å–å¯è¿­ä»£ç´¢å¼•file = open(fileName, "rw")for line in file: print line,file.close()#æ‰“å¼€æ–‡ä»¶çš„æ¨¡å¼r ä»¥è¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¯è¯»å–æ–‡ä»¶ä¿¡æ¯ã€‚w ä»¥å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¯å‘æ–‡ä»¶å†™å…¥ä¿¡æ¯ã€‚å¦‚æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™æ¸…ç©ºè¯¥æ–‡ä»¶ï¼Œå†å†™å…¥æ–°å†…å®¹a ä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼ˆå³ä¸€æ‰“å¼€æ–‡ä»¶ï¼Œæ–‡ä»¶æŒ‡é’ˆè‡ªåŠ¨ç§»åˆ°æ–‡ä»¶æœ«å°¾ï¼‰ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºr+ ä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¯å¯¹æ–‡ä»¶è¿›è¡Œè¯»å’Œå†™æ“ä½œã€‚w+ æ¶ˆé™¤æ–‡ä»¶å†…å®¹ï¼Œç„¶åŽä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚a+ ä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶æŠŠæ–‡ä»¶æŒ‡é’ˆç§»åˆ°æ–‡ä»¶å°¾ã€‚b ä»¥äºŒè¿›åˆ¶æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä»¥æ–‡æœ¬æ¨¡å¼ã€‚è¯¥æ¨¡å¼åªå¯¹ Windows æˆ– Dos æœ‰æ•ˆï¼Œç±» Unix çš„æ–‡ä»¶æ˜¯ç”¨äºŒè¿›åˆ¶æ¨¡å¼è¿›è¡Œæ“ä½œçš„ã€‚# ä¸éœ€è¦å…³é—­çš„å®‰å…¨æ–¹æ³•with open("/Users/march/123.txt", "a") as ff: ff.write("this is new line")# èŽ·å–æ–‡ä»¶çŠ¶æ€import osfileStatus = os.stat(fileName)print fileStatusimport timeprint time.localtime(fileStatus.st_ctime)# æŒ‡å®šsizeæ—¶è¯»å–æŒ‡å®šsizeçš„æ•°æ®,å¦åˆ™è¯»å–å…¨æ–‡ï¼Œä¸‹é¢çš„æ‰€æœ‰æ–¹æ³•éƒ½éµå¾ªè¿™ä¸€è§„åˆ™file = open(fileName)# è¯»å–å­—èŠ‚file.read()file.read(100)# è¯»å–ä¸€è¡Œfile.readline()file.readline(100)# è¯»å–æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨åˆ—è¡¨ä¸­file.readlines()file.readlines(100)# ç§»åŠ¨æŒ‡é’ˆfile.seek(10)# å½“å‰æŒ‡é’ˆçš„ä½ç½®file.tell()# å¦å¤–ä¸€ç§ç®€åŒ–çš„è¯»å–æ–‡ä»¶çš„æ–¹å¼import fileinputfor line in fileinput.input(fileName): print "use fileinput print is " , line åˆ—è¡¨æ“ä½œ12345678910111213141516171819charList = ['1A','2','3','4','5','6','7','8','9','10','11','11']strList = ["1","2","3","4","5","6","7","8","9","10","11","11"]charList.append("new_a")#åœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´ ,æŒ‡å®šä½ç½®ä¹‹åŽçš„å…ƒç´ å‘åŽç§»åŠ¨ä¸€ä¸ª,é•¿åº¦+1charList.insert(1,12)#å½“å‰å…ƒç´ åœ¨åˆ—è¡¨ä¸­çš„ä½ç½®print("pos of 3 ",charList.index("3"))#å½“å‰å…ƒç´ åœ¨åˆ—è¡¨ä¸­å‡ºçŽ°çš„æ¬¡æ•°print("total num of 11 ",charList.count('11'))#å°†å½“å‰å­—ç¬¦ä¸²\åˆ—è¡¨(å¯è¿­ä»£ç±»åž‹çš„æ•°æ®)æ‹†åˆ†æˆå•ä¸ªå­—ç¬¦æ·»åŠ åœ¨æœ«å°¾ï¼Œè¿”å›žå€¼æ˜¯noneprint(charList.extend(strList))#ä»Žæœ«å°¾å¼¹å‡ºä¸€ä¸ªå…ƒç´ ,æˆ–ä»ŽæŒ‡å®šä½ç½®å¼¹å‡º,è¿”å›žå€¼ æ˜¯è¯¥å…ƒç´ print(charList.pop(2))#ç§»é™¤æŒ‡å®šå…ƒç´ ,ä¸èƒ½ä½¿ç”¨ä¸‹æ ‡åšå‚æ•°charList.remove('1A')#åˆ—è¡¨åå‘charList.reverse()#é’ˆå¯¹ç¬¬ä¸€ä¸ªå­—æ¯æˆ–æ•°å­—æŽ’åº,æ›´å¤šå‚æ•°æ¯”è¾ƒå¤æ‚charList.sort()]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidå›¾åƒå¤„ç†ç›¸å…³]]></title>
    <url>%2Farticle%2F2699277879%2F</url>
    <content type="text"><![CDATA[Bitmapå’ŒDrawableè½¬æ¢12345678910111213141516//drawable è½¬ bitmappublic static Bitmap drawableToBitmap(Drawable drawable) &#123; int width = drawable.getIntrinsicWidth(); int height = drawable.getIntrinsicHeight(); Bitmap bitmap = Bitmap.createBitmap(width, height, drawable.getOpacity() != PixelFormat.OPAQUE ? Bitmap.Config.ARGB_8888 : Bitmap.Config.RGB_565); Canvas canvas = new Canvas(bitmap); drawable.setBounds(0, 0, width, height); drawable.draw(canvas); return bitmap; &#125; //bitmap è½¬ drawablepublic static Drawable bitmapToDrawble(Bitmap bitmap,Context mcontext)&#123; Drawable drawable = new BitmapDrawable(mcontext.getResources(), bitmap); return drawable; &#125; èŽ·å–å›¾ç‰‡åˆ›å»ºçš„æ—¶é—´1234567891011121314151617181920212223//æ–‡ä»¶ä¿®æ”¹çš„æ—¶é—´File file = new File("");file.lastModified();//èŽ·å–ç…§ç‰‡æ‹æ‘„çš„æ—¶é—´// MediaStore.Images.Mediaä¸‹é¢æœ‰DATE_TAKEN,DATE_ADD,DATE_MODIFIEDçš„å‚æ•°ï¼Œåˆ†åˆ«æ˜¯ç…§ç‰‡æ‹æ‘„çš„æ—¶é—´ï¼Œæ·»åŠ åˆ°ContentProviderçš„æ—¶é—´ï¼Œæœ€åŽä¿®æ”¹çš„æ—¶é—´ï¼Œç»è¿‡æµ‹è¯•æ˜¾ç¤ºï¼ŒDATE_TAKENè¿™ä¸ªå­—æ®µä¸‹é¢çš„æ—¶é—´æ˜¯æœ€é è°±çš„ï¼Œä¸è¯´ä»–æ˜¯ä¸æ˜¯å‡†ç¡®ï¼Œä½†æ˜¯ç³»ç»Ÿç›¸å†Œä¹Ÿæ˜¯ä½¿ç”¨çš„è¿™ä¸ªæ—¶é—´ä½œä¸ºç…§ç‰‡ä¿¡æ¯ï¼Œäº²æµ‹ã€‚å¦å¤–ï¼Œæœ‰è¶£çš„æ˜¯ï¼Œåªæœ‰DATE_TAKENè¿™ä¸ªå­—æ®µä¸‹æ˜¯æ¯«ç§’çº§çš„ï¼Œå¦å¤–ä¸¤ä¸ªéƒ½æ˜¯ç§’çº§çš„ã€‚public static long getImgCreateTime(Context context, String path) &#123; long createTime = -1; Uri mImageUri = MediaStore.Images.Media.EXTERNAL_CONTENT_URI; ContentResolver mContentResolver = context.getContentResolver(); Cursor mCursor = mContentResolver.query(mImageUri, new String[]&#123;MediaStore.Images.Media.DATE_TAKEN&#125;, MediaStore.Images.Media.DATA + "=?", new String[]&#123;path&#125;, MediaStore.Images.Media.DATE_TAKEN); if (mCursor == null) &#123; return -1; &#125; while (mCursor.moveToNext()) &#123; //èŽ·å–å›¾ç‰‡çš„è·¯å¾„ String str = mCursor.getString(mCursor .getColumnIndex(MediaStore.Images.Media.DATE_TAKEN)); createTime = Long.parseLong(str); &#125; return createTime ; &#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Handleræºç åˆ†æž]]></title>
    <url>%2Farticle%2F541527599%2F</url>
    <content type="text"><![CDATA[Handleræ„æ€æ˜¯å¤„ç†è€…ï¼Œå®ƒæ˜¯androidç‰¹æœ‰çš„ç”¨æ¥æ¶ˆæ¯å¤„ç†çš„ä¸€ä¸ªç±»ã€‚ä½¿ç”¨å®ƒå¯ä»¥è§£å†³å¾ˆå¤šandroidä¸­å¸¸è§çš„é—®é¢˜. Handlerä½“çŽ°çš„æ˜¯ä¸€ç§æ¶ˆæ¯çš„å‘é€ä¸Žå¤„ç†å¼‚æ­¥è¿›è¡Œçš„æœºåˆ¶ï¼Œæ¶ˆæ¯å‘é€æ—¶å³åˆ»è¿”å›žï¼Œå°†æ¶ˆæ¯åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œå¦ä¸€ç«¯looperè´Ÿè´£å¾ªçŽ¯å–å‡ºæ¶ˆæ¯è¿›è¡Œæ“ä½œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯Handlerå¯ä»¥å‘é€Messageä¹Ÿå¯ä»¥å‘é€Runnableå¯¹è±¡ã€‚ä½†æ˜¯æ¶ˆæ¯å¤„ç†å¿…å®šæ˜¯åœ¨Handleræ‰€åœ¨çš„çº¿ç¨‹ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´UIçº¿ç¨‹ä¸­çš„Handlerå‘é€çš„æ¶ˆæ¯ä¹Ÿæ˜¯åœ¨UIçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œæ‰€ä»¥åŒæ ·ä¸èƒ½æ‰§è¡Œè€—æ—¶æ“ä½œã€‚ ä½¿ç”¨åœºæ™¯ï¼š å‘é€å»¶æ—¶æ¶ˆæ¯ï¼Œæ‰§è¡Œå»¶æ—¶ä»»åŠ¡ï¼Œä½¿ç”¨çº¿ç¨‹ç¡çœ çš„æ–¹å¼è¿‡äºŽç²—ç³™ã€‚ã€‚é€šå¸¸æ˜¯ç”¨Handlerå‘é€å»¶æ—¶æ¶ˆæ¯æˆ–è€…ä½¿ç”¨Timeræ¥å®Œæˆå»¶æ—¶æ“ä½œã€‚ åœ¨å­çº¿ç¨‹â€œæ“ä½œâ€UIï¼Œä¼—æ‰€å‘¨çŸ¥å­çº¿ç¨‹æ˜¯ä¸èƒ½æ“ä½œUIçš„ï¼Œæƒ³è¦åœ¨å­çº¿ç¨‹çš„ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åŽæ›´æ”¹UI,å°±éœ€è¦åœ¨å­çº¿ç¨‹å‘ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯è®©ä¸»çº¿ç¨‹æ¥ä¿®æ”¹UIã€‚ ç»“åˆå¼‚æ­¥ä»»åŠ¡å®žçŽ°ä»»åŠ¡å›žè°ƒï¼Œè¿™ä¸ªå®žé™…ä¸Šæ˜¯ç­‰åŒäºŽ2çš„ï¼Œå› ä¸ºå¼‚æ­¥ä»»åŠ¡å†…éƒ¨ä¹Ÿæ˜¯å­çº¿ç¨‹ï¼Œä½¿ç”¨Handler+å¼‚æ­¥ä»»åŠ¡å¯ä»¥å®žçŽ°è¯·æ±‚çš„å›žè°ƒï¼Œä½†æ˜¯é€šå¸¸æˆ‘ä»¬æ›´åŠ åå‘äºŽæŽ¥å£å›žè°ƒçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä¼ é€’Handlerã€‚ åœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨Handler,å¯¹ä»»åŠ¡è¿›è¡Œä¸²è¡ŒåŒ–å¤„ç†ï¼Œå¯ä»¥æ›´åŠ é«˜æ•ˆçš„ç®¡ç†ä»»åŠ¡çš„æ‰§è¡Œã€‚ HandleråŽŸç†å›¾è§£ï¼š Looperç±»ä»‹ç» Looperç±»è´Ÿè´£åœ¨æ¶ˆæ¯é˜Ÿåˆ—çš„å¦ä¸€ç«¯å–å‡ºæ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼ŒHandleré‡‡ç”¨æ¶ˆæ¯çš„å…ˆè¿›å…ˆå‡ºåŽŸåˆ™ã€‚ æˆå‘˜å˜é‡ Looperä¸­çš„æˆå‘˜å˜é‡ThreadLocalï¼Œæä¾›çº¿ç¨‹å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼Œåœ¨æœ¬çº¿ç¨‹å†…éšæ—¶éšåœ°å¯å–ï¼Œéš”ç¦»å…¶ä»–çº¿ç¨‹ã€‚æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œè¿™é‡Œæœ‰å¾ˆå¥½çš„çš„è§£é‡Šï¼Œå¤§å®¶å¯ä»¥åŽ»è†œæ‹œä¸€ä¸‹ã€‚ Looperç±»ä¸­ï¼Œé¦–å…ˆThreadLocalå˜é‡æ˜¯private staticçš„ï¼Œæ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªLooperå¯¹è±¡ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œä½¿ç”¨ThreadLocalæ˜¯ä¸ºäº†å¯¹æ¯ä¸ªçº¿ç¨‹çš„Looperè¿›è¡Œç®¡ç†ã€‚ä½¿ç”¨ThreadLocalå­˜å‚¨Looperå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„éš”ç¦»å…¶ä»–çº¿ç¨‹éšæ—¶å­˜å–æœ¬çº¿ç¨‹çš„Looperå¯¹è±¡ï¼Œç»“åˆåŽé¢çš„ä»£ç ï¼Œå‘çŽ°åˆ›å»ºLooperæ—¶ä¼šä½¿ç”¨å½“å‰çº¿ç¨‹ä¸ºé”®ï¼Œæ–°åˆ›å»ºçš„Looperä¸ºå€¼å­˜æ”¾åˆ°ThreadLocalä¸­ï¼Œprepare()åˆä¼šè¿›è¡Œåˆ¤æ–­æ˜¯å¦å·²ç»åˆ›å»ºäº†è¯¥çº¿ç¨‹çš„Looper,è¿™ä¹ˆè¯´å¯èƒ½æœ‰äº›æŠ½è±¡ï¼Œå»ºè®®çœ‹å®ŒåŽé¢çš„ä»£ç ï¼Œå†å›žæ¥çœ‹è¿™æ®µä¹Ÿè®¸ä¼šæ›´åŠ æ¸…æ™°ä¸€ç‚¹ã€‚ 123456//ThreadLocal.get() will return null unless you've called prepare().static final ThreadLocal&lt;Looper&gt; sThreadLocal = new ThreadLocal&lt;Looper&gt;();private static Looper sMainLooper; // guarded by Looper.classï¼ˆè¢«è¿™ä¸ªç±»ä¿æŠ¤ï¼‰final MessageQueue mQueue;final Thread mThread; æž„é€ æ–¹æ³• æž„é€ æ–¹æ³•,ç§æœ‰åŒ–çš„æž„é€ æ–¹æ³•ï¼Œå¹¶ä¸å…è®¸å¤–éƒ¨è°ƒç”¨ï¼Œåšçš„æ“ä½œæ˜¯åˆ›å»ºä¸€ä¸ªMessageQueueå’Œå°†mThreadå¯¹è±¡æŒ‡å‘äº†æœ¬çº¿ç¨‹ã€‚è¿™é‡Œæœ‰ä¸ªé‡è¦çš„åœ°æ–¹æ˜¯ï¼ŒMessageQueueæ˜¯Looperåˆ›å»ºå¹¶é¦–å…ˆæŒæœ‰çš„ã€‚ 1234private Looper(boolean quitAllowed) &#123; mQueue = new MessageQueue(quitAllowed); mThread = Thread.currentThread();&#125; åœ¨Looperä¹‹ä¸­æœ‰ä¸€ä¸ªprivate static Looper sMainLooper;å˜é‡ï¼Œè¿™ä¸ªå˜é‡ä»£è¡¨ä¸»çº¿ç¨‹ï¼ˆUIï¼‰çš„Looperï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸éœ€è¦åœ¨UIçº¿ç¨‹æ˜¾å¼è°ƒç”¨Looper.prepare()æ–¹æ³•çš„åŽŸå› ï¼Œçœ‹ä¸‹é¢çš„ä»£ç åŠæ³¨é‡Šï¼š 12345678910111213141516171819202122/**//åˆå§‹åŒ–å½“å‰çº¿ç¨‹Looper,å°†å®ƒæ ‡è®°ä¸ºåº”ç”¨çš„ä¸»è¦Looperã€‚åº”ç”¨ç¨‹åºçš„ä¸»Looeræ˜¯AndroidçŽ¯å¢ƒåˆ›å»ºçš„ ,æ‰€ä»¥ä½ åº”è¯¥ä¸éœ€è¦è‡ªå·±è°ƒç”¨è¿™ä¸ªå‡½æ•°* Initialize the current thread as a looper, marking it as an* application's main looper. The main looper for your application* is created by the Android environment, so you should never need* to call this function yourself. See also: &#123;@link #prepare()&#125;*/public static void prepareMainLooper() &#123;//è¿›è¡Œä¸€æ¬¡å‡†å¤‡å¹¶ä¸”æ˜¯ä¸å…è®¸æ‰“æ–­çš„prepare(false);synchronized (Looper.class) &#123; if (sMainLooper != null) &#123; throw new IllegalStateException("The main Looper has already been prepared."); &#125;//èŽ·å–è¿™ä¸ªloopersMainLooper = myLooper();&#125;&#125;//myLooperè¿”å›žçš„æ˜¯æœ¬çº¿ç¨‹çš„Looperpublic static Looper myLooper() &#123;return sThreadLocal.get();&#125; æˆå‘˜æ–¹æ³• prepareæ–¹æ³•,åˆ›å»ºLooperæ”¾å…¥sThreadLocalï¼ŒåŒæ—¶è¦æ±‚æ¯ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªLooperå¯¹è±¡ï¼Œå¤šåˆ›å»ºä¼šæŠ¥å¼‚å¸¸ã€‚ 123456789public static void prepare() &#123;prepare(true);&#125;private static void prepare(boolean quitAllowed) &#123;if (sThreadLocal.get() != null) &#123;throw new RuntimeException("Only one Looper may be created per thread");&#125;sThreadLocal.set(new Looper(quitAllowed));&#125; loopæ–¹æ³•ï¼Œä½¿ç”¨è¯¥æ–¹æ³•å¾ªçŽ¯å–å‡ºMessageQueueçš„æ¶ˆæ¯ã€‚æ­»å¾ªçŽ¯å–å‡ºæ¶ˆæ¯ï¼Œè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œä¹‹åŽï¼ŒåŒæ—¶æ¶ˆæ¯ä¼šè¢«å›žæ”¶æŽ‰ï¼Œä½¿ç”¨è¿™ä¸ªæœºåˆ¶å¯ä»¥è¿›è¡Œæ¶ˆæ¯å¯¹è±¡çš„å¤ç”¨ï¼Œè¿™é‡Œloop()ç»“åˆMessageQueueçš„next()æ–¹æ³•ï¼Œå½¢æˆäº†ä¸€ä¸ªè½®è¯¢çš„è¿‡ç¨‹ï¼Œè¯¦ç»†çš„å†…å®¹ä¼šåœ¨MessageQueueç±»çš„åˆ†æžä¸­æ¥çœ‹ï¼Œåˆ°æ—¶å€™ä¼šè§£é‡Šæ­»å¾ªçŽ¯è½®è¯¢æ¶ˆæ¯çš„æœºåˆ¶ã€‚è¿™é‡Œæœ‰å…¶ä»–å¯¹è±¡çš„éƒ¨åˆ†æ–¹æ³•ï¼Œæš‚ä¸”ä¸åŽ»è€ƒè™‘ï¼Œåšä¸‹æ ‡è®°ï¼Œçœ‹åˆ°Messageçš„æºç è‡ªç„¶å°±ä¼šæ˜Žç™½ã€‚ ###ç•™ä¸‹çš„é—®é¢˜ï¼š Message msg = queue.next();msg.target.dispatchMessage(msg);msg.recycleUnchecked();ç¨åŽæˆ‘ä»¬ä¼šåŽ»è§£å†³ã€‚ 123456789101112131415161718192021222324public static void loop() &#123;final Looper me = myLooper();if (me == null) &#123; throw new RuntimeException("No Looper; Looper.prepare() wasn't called on this thread.");&#125;final MessageQueue queue = me.mQueue;// Make sure the identity of this thread is that of the local process,// and keep track of what that identity token actually is.Binder.clearCallingIdentity();final long ident = Binder.clearCallingIdentity();//æ­»å¾ªçŽ¯å–å‡ºæ¶ˆæ¯ï¼Œè¿›è¡Œå¤„ç†ï¼Œå½“å–ä¸åˆ°æ¶ˆæ¯æ—¶ï¼ŒreturnæŽ‰ï¼Œç­‰å¾…ä¸‹æ¬¡è°ƒç”¨loop(),åŒæ—¶æ¶ˆæ¯ä¼šè¢«å›žæ”¶æŽ‰ï¼Œä½¿ç”¨è¿™ä¸ªæœºåˆ¶å¯ä»¥è¿›è¡Œæ¶ˆæ¯å¯¹è±¡çš„å¤ç”¨ï¼Œè¿™é‡Œæ¶‰åŠäº†Messageå¯¹è±¡çš„éƒ¨åˆ†æ–¹æ³•ï¼Œæš‚ä¸”ä¸åŽ»è€ƒè™‘ï¼Œåšä¸‹æ ‡è®°ï¼Œçœ‹åˆ°Messageçš„æºç è‡ªç„¶å°±ä¼šæ˜Žç™½for (;;) &#123; Message msg = queue.next(); // might block if (msg == null) &#123;// No message indicates that the message queue is quitting. return;&#125;msg.target.dispatchMessage(msg);// Make sure that during the course of dispatching the// identity of the thread wasn't corrupted.final long newIdent = Binder.clearCallingIdentity();msg.recycleUnchecked(); &#125;&#125; Messageç±»æˆå‘˜å˜é‡ Messageç±»ååˆ†ç±»ä¼¼äºŽBeanç±»ï¼Œæ¯•ç«Ÿå®ƒæ˜¯ç”¨æ¥æ‰¿è½½æ¶ˆæ¯çš„ã€‚ what,arg1,arg2,objéƒ½æ˜¯é¢„è®¾å¥½ç”¨æ¥ç››æ”¾ç®€å•æ¶ˆæ¯å†…å®¹çš„å˜é‡ï¼ŒåŽŸæ–‡çš„æ³¨é‡Šä¸­ä½¿ç”¨äº†lower-costè¡¨ç¤ºä½¿ç”¨è¿™äº›å˜é‡å¯ä»¥é™ä½Žå¼€é”€ï¼Œå°±æ˜¯ä¸ç”¨è‡ªå·±åˆ›å»ºç»´æŠ¤è¿™äº›å˜é‡ï¼Œè€Œä¸”æ¶ˆæ¯æ˜¯å¯ä»¥è¢«å¤ç”¨çš„ï¼Œç¡®å®žé™ä½Žäº†å¼€é”€ã€‚ targetå˜é‡ï¼Œæ˜¯ä¸€ä¸ªHandler,åŽé¢çš„ä»£ç ä¸­ä¼šå…·ä½“ä»‹ç»ä»–çš„ä½œç”¨ï¼Œè¿™ä¸ªå˜é‡ä¹Ÿç®—è¿™ä¸ªç±»çš„æ ¸å¿ƒäº†ã€‚ Runnable callback,ä»£è¡¨ä¸€ä¸ªä»»åŠ¡ï¼Œå‰é¢è¯´è¿‡Handlerå¯ä»¥å‘é€ç®€å•æ¶ˆæ¯ä¹Ÿå¯ä»¥å‘é€ä»»åŠ¡ã€‚ Message nextï¼Œä»£è¡¨ä¸‹ä¸€ä¸ªMessageçš„å¼•ç”¨ï¼Œç”±æ­¤å½¢æˆäº†ä¸€ä¸ªé“¾è¡¨çš„ç»“æž„ã€‚ è¿˜æœ‰å¾ˆå¤šå¸¸é‡ï¼Œå˜é‡ä¸åšä¸€ä¸€ä»‹ç»ã€‚ä¸‹é¢æœ‰æ³¨é‡Šï¼Œä¸å¤ªè¯¦ç»†ï¼Œå¤§å®¶å¯ä»¥çœ‹å®ŒåŽé¢çš„å†å›žæ¥çœ‹ä¹Ÿè®¸ä¼šæ›´åŠ æ¸…æ™°ã€‚æ„Ÿå…´è¶£çš„å¯ä»¥ä»”ç»†åŽ»çœ‹æºç æ³¨é‡Šã€‚ 123456789101112131415161718192021public int what;//æ¶ˆæ¯æ ‡ç¤ºpublic int arg1; public int arg2;public Object obj;public Messenger replyTo;public int sendingUid = -1;//æ ‡ç¤ºè¯¥æ¶ˆæ¯æ­£åœ¨ä½¿ç”¨ä¹‹ä¸­static final int FLAG_IN_USE = 1 &lt;&lt; 0;static final int FLAG_ASYNCHRONOUS = 1 &lt;&lt; 1;tatic final int FLAGS_TO_CLEAR_ON_COPY_FROM = FLAG_IN_USE;int flags;long when;Bundle data;Handler target;//Handleré‡ç‚¹å“¦Runnable callback;//ä¸€ä¸ªä»»åŠ¡å¯ä»¥ç”¨æ¥å‘é€ï¼Œç±»ä¼¼äºŽBeançš„ä¸€ä¸ªå±žæ€§Message next;//ä¸‹ä¸€ä¸ªMessageï¼Œç”¨äºŽæž„æˆé“¾è¡¨private static final Object sPoolSync = new Object();//åŒæ­¥å¯¹è±¡private static Message sPool;//é“¾è¡¨æ ¹èŠ‚ç‚¹ï¼Œä»–ç»´æŠ¤äº†ä¸€ä¸ªç©ºçš„Messageé˜Ÿåˆ—ç”¨æ¥å¤ç”¨private static int sPoolSize = 0;//é“¾è¡¨çš„é•¿åº¦private static final int MAX_POOL_SIZE = 50;//é“¾è¡¨æœ€å¤§æ•°é‡private static boolean gCheckRecycle = true; æˆå‘˜æ–¹æ³•obtain() Messageç±»ä¸­å®žçŽ°äº†obtain()çš„8ä¸ªé‡è½½æ–¹æ³•ï¼Œæä¾›äº†å„ç§å„æ ·çš„å‚æ•°ï¼Œä¸ºçš„åªæ˜¯æˆ‘ä»¬åœ¨å¤–éƒ¨ç”¨èµ·æ¥å¥½ç”¨ï¼Œæ‰€ä»¥å¤§å®¶ä½¿ç”¨Messageæ—¶ä¸å¦¨å¤šåŽ»ç”¨ç”¨å…¶ä»–æ–¹æ³•ï¼Œæˆ‘åˆ°çŽ°åœ¨ä¸ºæ­¢ä¸€èˆ¬éƒ½æ˜¯åç”¨å‚æ•°ä¸ºç©ºçš„æ–¹æ³•ï¼Œå…¶ä»–çš„é‡è½½åŸºæœ¬æ²¡çœ‹è¿‡ï¼Œå¦å¤–Handlerä¹Ÿæä¾›äº†å¤§é‡çš„obtainæ–¹æ³•ï¼Œæ˜¯çš„Messageçš„é‡ç”¨å’Œç®¡ç†æ›´åŠ çš„æ–¹ä¾¿äº†ï¼Œæ‰€ä»¥åƒä¸‡ä¸è¦åŽ»new Messageã€‚å…¶ä»–çš„æ–¹æ³•ä¹Ÿä¼šå›žè°ƒç©ºå‚æ–¹æ³•ç„¶åŽè¿›è¡Œä¸€ä¸‹å¤–å›´çš„åˆå§‹åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ç©ºå‚æ–¹æ³•ã€‚ ä»£ç ä¸å¤šï¼Œè§£é‡Šä¸€ä¸‹ï¼Œé¦–å…ˆè¿™ä¸ªå˜é‡sPoolSyncï¼Œçœ‹åå­—å°±çŸ¥é“ä»–æ˜¯ç”¨æ¥åŒæ­¥æ“ä½œçš„ï¼Œç›®çš„æ˜¯å½“ä¸€ä¸ªæ“ä½œåœ¨èŽ·å–Messageæ˜¯è¿›è¡ŒåŒæ­¥æ“ä½œï¼Œé¿å…å…¶ä»–çš„æ“ä½œå†æ¥åˆ›å»ºMessageï¼Œå¦åˆ™ä¼šæ€Žä¹ˆæ ·ï¼ŸMessageæœ¬èº«å½¢æˆäº†ä¸€ä¸ªé“¾è¡¨çš„ç»“æž„ï¼Œä¸è¿›è¡ŒåŒæ­¥å°±ä¼šï¼Œå‡ºçŽ°å¤šä¸ªå¤´ï¼Œæˆ–è€…ä¸€ä¸ªMessageåŽé¢æŽ¥å…¥å¤šä¸ªMessageï¼Œé‚£ä¹ˆåŽæŽ¥å…¥çš„å°±ä¼šè¦†ç›–æŽ‰ï¼Œæ˜¯è¿™æ ·å—ï¼Ÿè¿˜æ˜¯å‡ºé”™è¯¯ã€‚ æŽ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªåˆ¤æ–­ï¼Œæˆ‘ä»¬çœ‹åˆ°sPoolè¿™ä¸ªå˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªMessageå¯¹è±¡ï¼Œç»è¿‡æˆ‘çš„ç ”ç©¶å®ƒæ˜¯è¿™ä¸ªé“¾è¡¨çš„å¤´æŒ‡é’ˆï¼ŒåŒæ—¶sPoolç»´æŠ¤çš„æ˜¯ä¸€ä¸ªæ›¾ç»åˆ›å»ºè¿‡çš„ç©ºçš„å¯å¤ç”¨çš„Messageé˜Ÿåˆ—ï¼Œäº†è§£è¿™ä¸€ç‚¹è‡³å…³é‡è¦ï¼Œè¿™æ˜¯Messageå¯å¤ç”¨çš„å…³é”®ã€‚çœ‹çœ‹ä»–æ˜¯æ€Žä¹ˆæ“ä½œçš„ å¦‚æžœè¿™ä¸ªæ ¹sPoolä¸ºç©ºï¼Œåˆ™è¿”å›žä¸€ä¸ªæ–°çš„Messageï¼ŒMessageçš„æž„é€ æ–¹æ³•æˆ‘çœ‹äº†ï¼Œæ˜¯ä¸ªç©ºçš„ï¼Œæ‰€æœ‰çš„å±žæ€§éƒ½åœ¨å¤–éƒ¨æˆ–è€…å‘é€çš„é‚£ä¸€åˆ»è®¾ç½®ã€‚ å¦‚æžœä¸æ˜¯ç©ºï¼Œé‚£ä¹ˆè¡¨ç¤ºå¯å¤ç”¨Messageé˜Ÿåˆ—å¯ç”¨ï¼Œåˆ™å–å‡ºå¤´éƒ¨çš„MessageMessage m = sPool,åŒæ—¶æŒ‡é’ˆå‘åŽç§»åŠ¨ä¸€ä½sPool = m.next;æ­¤æ—¶mæ˜¯ç­‰äºŽsPoolçš„ï¼Œä»¥æ­¤è¡¨ç¤ºsPoolåŽç§»ä¸€ä½ï¼Œç„¶åŽå°†å–å‡ºçš„Message.nextç½®ä¸ºnullï¼Œå› ä¸ºè¿™ä¸ªæ¶ˆæ¯æ˜¯è¦æ‹¿æ¥å‘é€çš„ï¼Œä»–æ­¤æ—¶å¯æ˜¯æŒ‡å‘çš„å¯å¤ç”¨Messageé˜Ÿåˆ—çš„å¤´ï¼Œæ‰€ä»¥å°†å®ƒçš„nextç½®ä¸ºnullï¼Œä¸ç„¶ä¼šæ€Žä¹ˆæ ·ï¼Ÿæˆ‘ä»¬çœ‹Looperæºç æ—¶ï¼Œå¾ªçŽ¯ä½•æ—¶ç»ˆæ­¢å‘¢ï¼Œå°±æ˜¯åœ¨next==nullæ—¶ç»ˆæ­¢ï¼Œå¦‚æžœä¸ç½®ä¸ºnull,forå¾ªçŽ¯æ˜¯ä¸ä¼šåœæ­¢çš„ï¼Œä¼šæŠŠç©ºçš„Messageé˜Ÿåˆ—éåŽ†ä¸€éã€‚æœ€åŽå¯å¤ç”¨çš„é“¾è¡¨é•¿åº¦å‡ä¸€sPoolSize--; å…¶ä»–çš„obtainæ–¹æ³•æˆ‘ä»¬ä¸å†åŽ»ç ”ç©¶ï¼Œå¤§åŒå°å¼‚å§ã€‚12345678910111213public static Message obtain() &#123; synchronized (sPoolSync) &#123; if (sPool != null) &#123; Message m = sPool; sPool = m.next; m.next = null; m.flags = 0; // clear in-use flag sPoolSize--; return m; &#125; &#125; return new Message();&#125; Messageçš„å›žæ”¶æ–¹æ³• çœ‹ä¸€ä¸‹ä»£ç ï¼Œäº†è§£äº†ä¸Šé¢è¯´çš„æœºåˆ¶ï¼Œè¿™ä¸ªä»£ç ä¸éš¾ç†è§£ã€‚è§£é‡Šä¸€ä¸‹ï¼Œå¦‚ä½•å›žæ”¶ä¸€ä¸ªMessage,è¦æœ‰ä¸€ä¸ªæ¦‚å¿µå°±æ˜¯Messageè°ƒç”¨è¯¥æ–¹æ³•å›žæ”¶çš„æ˜¯è‡ªå·±ï¼Œé¦–å…ˆå°†è‡ªå·±çš„nextæŒ‡å‘sPoolnext = sPool;ä¹Ÿå°±æ˜¯è¯´ã€‚æ­¤æ—¶è‡ªå·±å·²ç»é“¾æŽ¥åˆ°äº†å¯å¤ç”¨çš„Messageé˜Ÿåˆ—å¤´éƒ¨ï¼ˆæ¯æ¬¡éƒ½å«ä»–ã€‚å¯å¤ç”¨çš„Messageé˜Ÿåˆ—ã€‚çœŸéº»çƒ¦ï¼‰ï¼Œç„¶åŽsPool = this;sPoolæŒ‡é’ˆåˆæŒ‡å‘äº† å¯å¤ç”¨çš„Messageé˜Ÿåˆ—å¤´éƒ¨ï¼Œé˜Ÿåˆ—é•¿åº¦++å®Œæˆäº†æ¶ˆæ¯çš„å›žæ”¶ã€‚åœ¨Looperä¸­æåˆ°çš„msg.recycleUnchecked();è¿™ä¸ªæ–¹æ³•å°±æ˜¯åœ¨è¿™é‡Œå®žçŽ°çš„ã€‚ 12345678910 void recycleUnchecked() &#123;.....//è¿™é‡Œè¿›è¡Œäº†å¥½å¤šä»£ç ï¼Œåšäº†ä¸€ä¸ªæ“ä½œï¼Œå°†æˆå‘˜å˜é‡æ¸…ç©ºã€‚ synchronized (sPoolSync) &#123; if (sPoolSize &lt; MAX_POOL_SIZE) &#123; next = sPool; sPool = this; sPoolSize++; &#125; &#125; &#125; ###è¡¥å…… Messageå®žçŽ°äº†ParcelableæŽ¥å£è¡¨æ˜Žå®ƒæ˜¯å¯ä»¥ä¼ è¾“çš„ã€‚ 1public final class Message implements Parcelable &#123;&#125; MessageQueueç±»ä»‹ç» å†…éƒ¨é€šè¿‡é“¾æŽ¥Messageå½¢æˆäº†ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæœ‰ä¸¤ä¸ªæ¯”è¾ƒæ ¸å¿ƒçš„æ–¹æ³•ã€‚boolean enqueueMessage(Message msg, long when){}å’ŒMessage next()æ–¹æ³•ï¼ŒLooperç±»ä¸­é—ç•™çš„ç¬¬äºŒä¸ªé—®é¢˜Message msg = queue.next();ä¼šåœ¨è¿™é‡Œè§£é‡Šã€‚ å…¥é˜Ÿæ–¹æ³• å‰é¢å·´æ‹‰å·´æ‹‰ä¸€é€šåˆ¤æ–­ï¼Œå†…éƒ¨çš„targetä¸èƒ½æ˜¯null,Messageå¯¹è±¡ä¸èƒ½è¢«å ç”¨ï¼Œçº¿ç¨‹ä¸èƒ½é€€å‡ºã€‚ã€‚ã€‚ã€‚ è¿™é‡Œçš„mMessageså˜é‡èµ·åˆ°äº†ä¸ŽMessageä¸­sPoolç›¸åŒçš„ä½œç”¨ï¼Œå®ƒæ˜¯é˜Ÿåˆ—çš„æŒ‡é’ˆï¼ŒæŒ‡å‘æ¶ˆæ¯é˜Ÿåˆ—çš„å¤´ï¼Œåªæ˜¯è¿™é‡Œç»´æŠ¤çš„é˜Ÿåˆ—æ˜¯è¦è¢«å¤„ç†çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚ä½†æ˜¯ç”±äºŽsendMsgDelayæ–¹æ³•çš„å­˜åœ¨ï¼Œå…¥é˜Ÿæ—¶ä¸èƒ½å•çº¯çš„é“¾æŽ¥æ¶ˆæ¯ï¼Œè¿˜éœ€è¦åˆ¤æ–­æ—¶é—´æˆ³ã€‚ if (p == null || when == 0 || when &lt; p.when)è¿™ä¸ªåˆ¤æ–­if(æ˜¯ç¬¬ä¸€ä¸ªæ¶ˆæ¯ ||è¦è¢«å¤„ç†çš„æ—¶é—´æ˜¯0 ||è¦è¢«å¤„ç†çš„æ—¶é—´å°äºŽå½“å‰é˜Ÿåˆ—å¤´æ¶ˆæ¯çš„æ—¶é—´ä¹Ÿå°±æ˜¯å·²ç»åˆ°è¾¾å¤„ç†è¿™ä¸ªæ¶ˆæ¯çš„æ—¶é—´)ï¼Œæ­¤æ—¶å°†ä¼šå°†æ¶ˆæ¯é“¾æŽ¥åœ¨é˜Ÿåˆ—å¤´éƒ¨msg.next = p;ï¼ŒåŒæ—¶æŒ‡é’ˆæŒ‡å‘å®ƒmMessages = msg;,å¹¶ä¸”æ­¤æ¶ˆæ¯æ˜¯ä¸è¦è¢«å”¤é†’çš„needWake = mBlocked;,è¿™ä¸ªæ“ä½œä¸ŽMessageä¸­çš„æ“ä½œååˆ†ç›¸ä¼¼ï¼Œä¸å¤šåšä»‹ç»ã€‚ elseè¯­å¥å—ä¸­è¡¨æ˜Žæ­¤æ¶ˆæ¯æ˜¯ä¸€ä¸ªå»¶æ—¶æ¶ˆæ¯ï¼Œæ­¤æ—¶è¿›è¡Œçš„æ“ä½œæ˜¯é‡‡ç”¨äº†ä¸€ä¸ªforå¾ªçŽ¯ï¼Œå®Œæˆçš„åŠŸèƒ½æ˜¯æ‰¾åˆ°è¿™ä¸ªæ¶ˆæ¯è¢«å¤„ç†çš„æ—¶é—´whenï¼Œå¤§äºŽè¿™ä¸ªæ—¶é—´çš„ç¬¬ä¸€ä¸ªæ¶ˆæ¯ï¼Œå°†å®ƒæ’å…¥åˆ°è¯¥ä½ç½®ã€‚å¦‚æžœæ²¡æœ‰æ‰¾åˆ°ä¼šä¸€ç›´å¾ªçŽ¯ï¼Œæœ€åŽæ‰¾åˆ°preMsgæŒ‡å‘çš„å‰ä¸€ä¸ªæ¶ˆæ¯å’Œp = mMessageæŒ‡å‘çš„åŽä¸€æ¶ˆæ¯ï¼Œè¿›è¡Œé“¾æŽ¥æ“ä½œï¼Œmsg.next = p; prev.next = msg;å°±æ˜¯æ™®é€šçš„é“¾æŽ¥æ“ä½œã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950boolean enqueueMessage(Message msg, long when) &#123;if (msg.target == null) &#123;throw new IllegalArgumentException("Message must have a target.");&#125;if (msg.isInUse()) &#123;throw new IllegalStateException(msg + " This message is already in use.");&#125;synchronized (this) &#123;if (mQuitting) &#123;IllegalStateException e = new IllegalStateException( msg.target + " sending message to a Handler on a dead thread"); Log.w("MessageQueue", e.getMessage(), e);msg.recycle();return false;&#125;//æ ¸å¿ƒæ–¹æ³•ä»Žè¿™é‡Œå¼€å§‹msg.markInUse();msg.when = when;Message p = mMessages;boolean needWake;if (p == null || when == 0 || when &lt; p.when) &#123;// New head, wake up the event queue if blocked.msg.next = p;mMessages = msg;needWake = mBlocked;&#125; else &#123;// Inserted within the middle of the queue. Usually we don't have to wake// up the event queue unless there is a barrier at the head of the queue// and the message is the earliest asynchronous message in the queue.needWake = mBlocked &amp;&amp; p.target == null &amp;&amp; msg.isAsynchronous();Message prev;for (;;) &#123; prev = p; p = p.next; if (p == null || when &lt; p.when) &#123; break; &#125; if (needWake &amp;&amp; p.isAsynchronous()) &#123; needWake = false; &#125;&#125;msg.next = p; // invariant: p == prev.nextprev.next = msg;&#125;// We can assume mPtr != 0 because mQuitting is false.if (needWake) &#123; nativeWake(mPtr);&#125;&#125;return true;&#125; å‡ºé˜Ÿæ–¹æ³• ä¹‹å‰åœ¨Looper.loop()æ–¹æ³•ä¸­çœ‹åˆ°æœ‰è¿™ä¹ˆä¸€æ®µä»£ç ,ç»“åˆMessageQueueçš„å‡ºé˜Ÿæ–¹æ³•ï¼Œå¯ä»¥å‘çŽ°è¿™æ˜¯ä¸€ä¸ªå¾ªçŽ¯è½®è¯¢æ¶ˆæ¯é˜Ÿåˆ—çš„æ“ä½œã€‚åœ¨æ­»å¾ªçŽ¯ä¸­è°ƒç”¨äº†Message msg = queue.next(); // might blockæ–¹æ³•ï¼Œå½“è¿”å›žmsg==nullï¼Œå¾ªçŽ¯ä½“ç»“æŸï¼Œä»€ä¹ˆæ—¶å€™ä¼šç»“æŸï¼Œçœ‹next()æ–¹æ³•ä¸­è¿”å›žnullçš„åªæœ‰ä¸€ç§æƒ…å†µå°±æ˜¯çº¿ç¨‹ç»“æŸæ—¶ï¼Œè¿”å›žnullï¼Œçº¿ç¨‹ç»“æŸï¼Œä»–çš„Looperè‡ªç„¶åº”è¯¥ç»“æŸã€‚ æ­»å¾ªçŽ¯å®žé™…æ˜¯å‘ç”Ÿåœ¨MessageQueueä¸­çš„ï¼Œæˆ‘åœ¨æ³¨é‡Šä¸­å†™äº†è¯´æ˜Žã€‚å…³äºŽMessageQueueçš„å¾ˆå¤šæœ¬åœ°æ–¹æ³•çš„ä»‹ç»ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒè¿™é‡Œ 12345Message msg = queue.next(); // might blockif (msg == null) &#123;// No message indicates that the message queue is quitting.return;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101Message next() &#123;//// Return here if the message loop has already quit and been disposed.// This can happen if the application tries to restart a looper after quit// which is not supported.final long ptr = mPtr;if (ptr == 0) &#123; return null;&#125;int pendingIdleHandlerCount = -1; // -1 only during first iteration//è¶…æ—¶æ—¶é—´int nextPollTimeoutMillis = 0;//å¼€å§‹å¾ªçŽ¯å–å‡ºæ¶ˆæ¯for (;;) &#123; if (nextPollTimeoutMillis != 0) &#123; Binder.flushPendingCommands();&#125;nativePollOnce(ptr, nextPollTimeoutMillis);//æŽ¥ä¸‹æ¥è¿›è¡Œé”å®šï¼Œå¼€å§‹å–å‡ºæ¶ˆæ¯synchronized (this) &#123; // Try to retrieve the next message. Return if found. final long now = SystemClock.uptimeMillis(); Message prevMsg = null; Message msg = mMessages; //å–åˆ°æ¶ˆæ¯æ˜¯ç©ºï¼Œç„¶åŽè¿›è¡Œä¸€ä¸ªå¾ªçŽ¯æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¯ç”¨æ¶ˆæ¯ if (msg != null &amp;&amp; msg.target == null) &#123; // Stalled by a barrier. Find the next asynchronous message in the queue. do &#123; prevMsg = msg; msg = msg.next; &#125; while (msg != null &amp;&amp; !msg.isAsynchronous()); &#125;if (msg != null) &#123; if (now &lt; msg.when) &#123;// Next message is not ready. Set a timeout to wake up when it is ready.//å½“å‰æ—¶é—´æ²¡æœ‰è¾¾åˆ°æ‰§è¡Œè¿™ä¸ªæ¶ˆæ¯çš„æ—¶é—´ã€‚å°†ä¼šè¿›è¡Œè¶…æ—¶ç­‰å¾… nextPollTimeoutMillis = (int) Math.min(msg.when - now, Integer.MAX_VALUE); &#125; else &#123; //å–å‡ºå¤´éƒ¨çš„æ¶ˆæ¯è¿”å›ž // Got a message. mBlocked = false; if (prevMsg != null) &#123; prevMsg.next = msg.next; &#125; else &#123; mMessages = msg.next; &#125; msg.next = null; return msg;&#125;&#125; else &#123; // No more messages. nextPollTimeoutMillis = -1;&#125;// Process the quit message now that all pending messages have been handled.//çº¿ç¨‹ä¸å­˜åœ¨æ—¶è¿”å›žnullï¼Œloop()ä¹Ÿä¼šéšä¹‹ç»“æŸif (mQuitting) &#123; dispose(); return null;&#125;// If first time idle, then get the number of idlers to run.// Idle handles only run if the queue is empty or if the first message// in the queue (possibly a barrier) is due to be handled in the future.if (pendingIdleHandlerCount &lt; 0&amp;&amp; (mMessages == null || now &lt; mMessages.when)) &#123; pendingIdleHandlerCount = mIdleHandlers.size();&#125;//æ­»å¾ªçŽ¯å‘ç”Ÿåœ¨è¿™é‡Œï¼Œå…·ä½“è¿˜æ²¡æœ‰å¾ˆæ˜Žç™½ï¼Œéœ€è¦å†åŽ»ç ”ç©¶if (pendingIdleHandlerCount &lt;= 0) &#123;// No idle handlers to run. Loop and wait some more. mBlocked = true;continue;&#125;if (mPendingIdleHandlers == null) &#123;mPendingIdleHandlers = new IdleHandler[Math.max(pendingIdleHandlerCount, 4)];&#125;mPendingIdleHandlers = mIdleHandlers.toArray(mPendingIdleHandlers);&#125;// Run the idle handlers.// We only ever reach this code block during the first iteration.for (int i = 0; i &lt; pendingIdleHandlerCount; i++) &#123; final IdleHandler idler = mPendingIdleHandlers[i]; mPendingIdleHandlers[i] = null; // release the reference to the handlerboolean keep = false;try &#123; keep = idler.queueIdle();&#125; catch (Throwable t) &#123;Log.wtf("MessageQueue", "IdleHandler threw exception", t);&#125;if (!keep) &#123; synchronized (this) &#123; mIdleHandlers.remove(idler); &#125;&#125;&#125;// Reset the idle handler count to 0 so we do not run them again.pendingIdleHandlerCount = 0;// While calling an idle handler, a new message could have been delivered// so go back and look again for a pending message without waiting.nextPollTimeoutMillis = 0; &#125;&#125; Handlerç±»æˆå‘˜å˜é‡12345678//ä»Žè¿™é‡Œçœ‹å¾—å‡ºHandlerå¾ˆå¥½çš„è¿žæŽ¥äº†Looperå’ŒMessageQueuefinal MessageQueue mQueue;final Looper mLooper;//è¿™æ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œç”¨æ¥å¤„ç†æ¶ˆæ¯ï¼Œä¸‹é¢æ˜¯å…·ä½“å®žçŽ°ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬é€šå¸¸è¦å®žçŽ°çš„æ–¹æ³•ã€‚final Callback mCallback;public interface Callback &#123; public boolean handleMessage(Message msg);&#125; æž„é€ æ–¹æ³• é‡è½½äº†å¤šä¸ªæž„é€ æ–¹æ³•ï¼Œè€è§„çŸ©ï¼Œæˆ‘ä»¬åªçœ‹æ²¡æœ‰æœ€åº•å±‚çš„æž„é€ æ–¹æ³•å’Œæˆ‘ä»¬æœ€å¸¸ç”¨çš„æž„é€ æ–¹æ³• 123456789101112131415161718//å¸¸ç”¨ç©ºå‚æž„é€ æ–¹æ³•public Handler() &#123; this(null, false);&#125;//æ ¹æž„é€ æ–¹æ³•public Handler(Callback callback, boolean async) &#123;//èŽ·å¾—å½“å‰çº¿ç¨‹çš„Looperï¼Œå¤§å®¶è¿˜è®°å¾—Looper.myLooper()æ–¹æ³•å§ï¼Œreturn sThreadLocal.get();mLooper = Looper.myLooper();if (mLooper == null) &#123;//å¿…é¡»å…ˆè°ƒç”¨Looper.prepare()throw new RuntimeException("Can't create handler inside thread that has not called Looper.prepare()");&#125;//æ‹¿åˆ°Looperçš„MessageQueue,è¿™ä¸ªMessageQueueæ˜¯Looperåˆ›å»ºçš„ã€‚mQueue = mLooper.mQueue;//è¿™ä¸ªæ˜¯å›žè°ƒï¼Œç”¨æ¥å¤„ç†æ¶ˆæ¯mCallback = callback;mAsynchronous = async;&#125; æˆå‘˜æ–¹æ³• obtain()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸åšè§£é‡Šï¼Œè¿”å›žçš„æ˜¯Messageçš„obtain()æ–¹æ³•ï¼Œè¯¦ç»†è¯·çœ‹Messageç±»çš„åˆ†æžã€‚ å‘é€æ¶ˆæ¯ï¼Œæˆ‘ä»¬æµè§ˆä¸€ä¸‹æ‰€æœ‰å‘é€æ¶ˆæ¯çš„æ–¹æ³•ã€‚æ–¹æ³•å¾ˆå¤šï¼Œå¤§è‡´çš„æ€æƒ³æ˜¯ï¼Œå¡«å……æ¶ˆæ¯ï¼Œå‘é€æ¶ˆæ¯ï¼Œå¾ˆå¤šæ–¹æ³•éƒ½æ˜¯é‡è½½äº’ç›¸è°ƒç”¨çš„ï¼Œå…³æ³¨æœ€åŽä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒè°ƒç”¨äº†MessageQueueçš„å…¥é˜Ÿæ–¹æ³•ï¼ŒåŒæ—¶å°†msg.targetè®¾ç½®ä¸ºthis,å°†è¿™ä¸ªæ¶ˆæ¯æ’å…¥åˆ°äº†é˜Ÿåˆ—ä¸­ï¼Œä¹Ÿå°±æ˜¯è¢«å‘é€çš„MessageæŒæœ‰å‘é€å®ƒçš„Handlerçš„å¼•ç”¨ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980//ä»¥ä¸‹æ˜¯å„ç§å‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œå¯ä»¥æµè§ˆä¸€ä¸‹ã€‚public final boolean post(Runnable r)&#123; return sendMessageDelayed(getPostMessage(r), 0);&#125;public final boolean postAtTime(Runnable r, long uptimeMillis)&#123; return sendMessageAtTime(getPostMessage(r), uptimeMillis);&#125;public final boolean postAtTime(Runnable r, Object token, long uptimeMillis)&#123; return sendMessageAtTime(getPostMessage(r, token), uptimeMillis);&#125;public final boolean postDelayed(Runnable r, long delayMillis)&#123; return sendMessageDelayed(getPostMessage(r), delayMillis);&#125;public final boolean postAtFrontOfQueue(Runnable r)&#123; return sendMessageAtFrontOfQueue(getPostMessage(r));&#125;public final boolean sendMessage(Message msg)&#123; return sendMessageDelayed(msg, 0);&#125;public final boolean sendEmptyMessage(int what)&#123; return sendEmptyMessageDelayed(what, 0);&#125;public final boolean sendEmptyMessageDelayed(int what, long delayMillis) &#123; Message msg = Message.obtain(); msg.what = what; return sendMessageDelayed(msg, delayMillis);&#125;public final boolean sendEmptyMessageAtTime(int what, long uptimeMillis) &#123; Message msg = Message.obtain(); msg.what = what; return sendMessageAtTime(msg, uptimeMillis);&#125;public final boolean sendMessageDelayed(Message msg, long delayMillis)&#123; if (delayMillis &lt; 0) &#123;delayMillis = 0;&#125; return sendMessageAtTime(msg, SystemClock.uptimeMillis() + delayMillis);&#125;public boolean sendMessageAtTime(Message msg, long uptimeMillis) &#123; MessageQueue queue = mQueue; if (queue == null) &#123; RuntimeException e = new RuntimeException(this + " sendMessageAtTime() called with no mQueue"); Log.w("Looper", e.getMessage(), e); return false; &#125; return enqueueMessage(queue, msg, uptimeMillis);&#125;public final boolean sendMessageAtFrontOfQueue(Message msg) &#123; MessageQueue queue = mQueue; if (queue == null) &#123; RuntimeException e = new RuntimeException(this + " sendMessageAtTime() called with no mQueue"); Log.w("Looper", e.getMessage(), e); return false; &#125; return enqueueMessage(queue, msg, 0);&#125;//è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯å‘é€Runnableä»»åŠ¡æ—¶ä¼šè°ƒç”¨çš„æ–¹æ³•private static Message getPostMessage(Runnable r) &#123; Message m = Message.obtain(); m.callback = r; return m;&#125;private static Message getPostMessage(Runnable r, Object token) &#123; Message m = Message.obtain(); m.obj = token; m.callback = r; return m;&#125;//æ¶ˆæ¯å…¥é˜Ÿï¼ŒåŒæ—¶Messageå°†ä¼šæŒæœ‰å‘é€å®ƒçš„Handlerçš„å¼•ç”¨private boolean enqueueMessage(MessageQueue queue, Message msg, long uptimeMillis) &#123; msg.target = this; if (mAsynchronous) &#123;msg.setAsynchronous(true);&#125; return queue.enqueueMessage(msg, uptimeMillis);&#125; äº‹ä»¶åˆ†å‘ä¸Žå¤„ç† è¿˜è®°å¾—Looperä¸­é—ç•™çš„é—®é¢˜å—ï¼Ÿmsg.target.dispatchMessage(msg);ç»“åˆå‘é€æ¶ˆæ¯çš„æ–¹æ³•ï¼Œå¯ä»¥å¾—å‡ºï¼Œmsg.targetå°±æ˜¯å‘é€å®ƒçš„é‚£ä¸ªHandler,å¤„ç†æ¶ˆæ¯æ—¶è°ƒç”¨dispatchMessageæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„æ–¹æ³•ï¼Œæ‰€ä»¥ï¼ŒMessageæºå¸¦å®ƒçš„å‘é€è€…ï¼Œè°å‘é€çš„æ¶ˆæ¯èª°æ¥å¤„ç†å®ƒã€‚ åˆ†æžä¸€ä¸‹ä¸‹é¢çš„é€»è¾‘ã€‚msg.callbackæ˜¯æ¶ˆæ¯ä¸­åŒ…å«çš„ä»»åŠ¡ï¼Œå¦‚æžœæ˜¯ä¸€ä¸ªä»»åŠ¡çš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆä¸éœ€è¦å¤–éƒ¨å¤„ç†ï¼Œç›´æŽ¥è°ƒç”¨è¯¥Runnableä»»åŠ¡çš„runæ–¹æ³•ï¼Œæ‰€ä»¥è¿˜æ˜¯åœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œï¼Œå¹¶æ²¡æœ‰å¼€å¯æ–°çš„çº¿ç¨‹ï¼Œä¸è¦çœ‹åˆ°Runnableå°±æƒ³åˆ°çº¿ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¥å‰çš„ä¸€ä¸ªè¯¯åŒº ä¸æ˜¯ä¸€ä¸ªRunnableä»»åŠ¡ï¼ŒmCallbackæ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œåœ¨ä»‹ç»æˆå‘˜å˜é‡æ˜¯æåˆ°è¿‡ï¼Œä»–å¯ä»¥é€šè¿‡æž„é€ æ–¹æ³•åœ¨å¤–éƒ¨å®žçŽ°ï¼Œå½“ç„¶ä¸æ˜¯å¿…é¡»å®žçŽ°çš„ï¼Œå¦‚æžœå®žçŽ°äº†è¿™ä¸ªæŽ¥å£ï¼Œé‚£ä¹ˆè°ƒç”¨è¿™ä¸ªæŽ¥å£çš„mCallback.handleMessage(msg)æ–¹æ³•å¤„ç†æ¶ˆæ¯ã€‚ å¦‚æžœæ²¡æœ‰å®žçŽ°è¿™ä¸ªæŽ¥å£ï¼Œåˆ™è°ƒç”¨handleMessage(msg);æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ç©ºçš„ï¼Œéœ€è¦ä½ åœ¨å­ç±»ä¸­é‡è½½ï¼Œå¦‚æžœä½ æ²¡æœ‰é‡è½½ä»–ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚è¿™ç®—æä¾›äº†å¤„ç†æ¶ˆæ¯çš„ä¸¤ç§æ–¹å¼ã€‚ 1234567891011121314151617public void dispatchMessage(Message msg) &#123; if (msg.callback != null) &#123; handleCallback(msg); &#125; else &#123; if (mCallback != null) &#123; if (mCallback.handleMessage(msg)) &#123; return; &#125; &#125; handleMessage(msg); &#125;&#125;private static void handleCallback(Message message) &#123; message.callback.run();&#125;public void handleMessage(Message msg) &#123;&#125; ##æ€»ç»“ çº¿ç¨‹ä¸­Handleræ¶ˆæ¯æœºåˆ¶çš„ä½¿ç”¨,Looperç±»ä¸­ç»™å‡ºäº†å¾ˆå¥½çš„ç¤ºä¾‹ä»£ç ã€‚æ³¨æ„çš„æ˜¯åœ¨éžUIçº¿ç¨‹éœ€è¦æˆ‘ä»¬æ˜¾å¼çš„è°ƒç”¨Looper.prepare(); Looper.loop();æ–¹æ³•æ¥å®Œæˆæ¶ˆæ¯çš„è½®è¯¢ã€‚ 123456789101112class LooperThread extends Thread &#123; public Handler mHandler; public void run() &#123; Looper.prepare(); mHandler = new Handler() &#123; public void handleMessage(Message msg) &#123; // process incoming messages here &#125; &#125;; Looper.loop(); &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>SourceCode</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ListView Adapter 3]]></title>
    <url>%2Farticle%2F294185431%2F</url>
    <content type="text"><![CDATA[å‰è¨€ ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•è¿›è¡Œåˆ†ç±»é€‚é…ï¼Œè™½ç„¶æ¯”è¾ƒå®Œç¾Žçš„å®žçŽ°äº†åˆ†ç±»é€‚é…ä»¥åŠå¤ç”¨ï¼Œä½†æ˜¯ä»£ç ç›¸å½“ç¹çï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§ç±»åž‹æ—¶å·²ç»å‡ºçŽ°äº†å¤šå±‚ifåµŒå¥—ï¼Œå¦‚æžœæœ‰ä¸‰å››ç§ç±»åž‹ï¼Œä¼°è®¡è‡ªå·±éƒ½è¦è½¬æ™•äº†ï¼Œè€Œä¸”å°±åƒæˆ‘ä»¬å¯¹å•ç±»åž‹é€‚é…å™¨æŠ½è±¡æ—¶åšçš„ï¼Œé¿å…é‡å¤ä»£ç ï¼å¦‚æžœæ²¡çœ‹è¿‡ä¸Šä¸€ç¯‡ï¼Œå»ºè®®æµè§ˆä¸€ä¸‹ï¼Œè¿™é‡Œå†™çš„å¾ˆå¤šéƒ½æ˜¯åŸºäºŽç¬¬ä¸€ç¯‡çš„ã€‚ æŠ½è±¡ViewHolder12345678910111213141516171819202122232425public static class MultiViewHolder extends ViewHolder&#123; /** * SparseArray */ private SparseArray&lt;View&gt; cacheViews; private View itemView; public MultiViewHolder(View itemView, int viewCount) &#123; super(); this.itemView = itemView; cacheViews = new SparseArray&lt;View&gt;(viewCount); &#125; @Override public View getView(int resId) &#123; View v = cacheViews.get(resId); if (v == null) &#123; v = itemView.findViewById(resId); if (v != null) &#123; cacheViews.put(resId, v); &#125; &#125; return v; &#125;&#125; ä½¿ç”¨æŽ¥å£èŽ·å–å¯¹è±¡çš„ç±»åž‹ æˆ‘ä»¬åœ¨åˆ†ç±»é€‚é…çš„æ—¶å€™ä¸å¯é¿å…çš„è¦èŽ·å¾—æ•°æ®çš„å¯¹è±¡ï¼Œä»¥æ­¤ä½œä¸ºæ ¹æ®è£…è½½ä¸åŒçš„å¸ƒå±€æ–‡ä»¶. 123456789/** 1. æŽ¥å£ï¼Œåˆ†ç±»é€‚é…çš„å¯¹è±¡éœ€è¦å®žçŽ°çš„æŽ¥å£ï¼Œç›®çš„æ˜¯çº¦æŸå®žä½“ç±»å®žçŽ°getTypeæ–¹æ³• 2. 3. @author chendong 4. */public interface MultiEasyAdapterInterface &#123; public int getType();&#125; æŠ½è±¡åˆ†ç±»é€‚é…å™¨ æˆ‘ä»¬éœ€è¦é¿å…åœ¨å­ç±»ä¸­é¿å…é‡å¤ç¼–ç ï¼ŒåŒæ—¶åœ¨å­ç±»å®žçŽ°è‡ªå·±çš„æ–¹æ³•ï¼Œä½¿ç”¨æŠ½è±¡çˆ¶ç±»ã€‚ æˆ‘ä»¬ä¸äº†è§£ä¼ é€’è¿›æ¥çš„æ•°æ®æ˜¯ä»€ä¹ˆç±»åž‹ï¼Œä½¿ç”¨æ³›åž‹ã€‚ æˆ‘ä»¬éœ€è¦é™åˆ¶ä¼ è¿›æ¥çš„æ•°æ®å¿…é¡»å®žçŽ°èŽ·å¾—èŽ·å¾—å­ç±»çš„æ–¹æ³•ï¼Œæ‰€ä»¥å¿…é¡»è¦æ±‚æ•°æ®å®žçŽ°MultiEasyAdapterInterfaceæŽ¥å£ï¼Œä½¿ç”¨æ³›åž‹é™å®šç¬¦ç¡®å®šä¸Šé™ã€‚ 12public abstract class MultiEasyAdapter&lt;T extends MultiEasyAdapterInterface&gt; extends BaseAdapter &#123;&#125; æˆå‘˜å˜é‡12private LayoutInflater layoutInflater;private List&lt;T&gt; datas; åˆ†æžä¸€ä¸‹å…¶ä»–æˆå‘˜ï¼Œæ ¹æ®ä¸Šä¸€ç¯‡ä¼ ç»Ÿåˆ†ç±»é€‚é…çš„å†™æ³•ï¼Œæˆ‘ä»¬å§‘ä¸”å¿½ç•¥ç±»åž‹çš„å·®å¼‚ æ¯ä¸ªç±»åž‹éœ€è¦ä¸€ä¸ªå¸ƒå±€èµ„æºæ–‡ä»¶id æ¯ä¸ªç±»åž‹å¸ƒå±€æ–‡ä»¶ä¸­å­—UIæŽ§ä»¶çš„ä¸ªæ•°ï¼ˆç”¨æ¥ä¼˜åŒ–ï¼‰ æ¯ä¸ªç±»åž‹ä¸€ä¸ªå”¯ä¸€çš„é”®å€¼ï¼ˆç”¨æ¥è§£å†³å¤ç”¨Itemç©ºæŒ‡é’ˆçš„é—®é¢˜ï¼‰ æˆ‘ä»¬ç”¨ä¸€ä¸ªå®žä½“ç±»å­˜å‚¨è¿™äº›ä¿¡æ¯ 123456789101112131415161718192021222324252627282930** * å­˜å‚¨ç±»åž‹ä¿¡æ¯çš„å®žä½“ç±» * * @author chendong * @åŠŸèƒ½ï¼šåˆ†ç±»é€‚é…å™¨é…ç½®ä¿¡æ¯å®žä½“ç±» */public class MultiEasyAdapterEntity &#123; /** * @param type * itemç±»åž‹ï¼Œintç±»åž‹å˜é‡ï¼ŒItemæ˜¯ä»€ä¹ˆç±»åž‹çš„å°±å¡«å†™ä»€ä¹ˆç±»åž‹ * @param resId * èµ„æºidï¼Œå¯¹åº”ç±»åž‹çš„èµ„æºidï¼Œä½ éœ€è¦è£…è½½çš„èµ„æºæ–‡ä»¶çš„ID * @param viewCount * èµ„æºæ–‡ä»¶ä¸­å¯¹åº”çš„éœ€è¦èŽ·å–çš„è§†å›¾çš„ä¸ªæ•° */ public MultiEasyAdapterEntity(int type, int resId, int viewCount) &#123; super(); this.resId = resId; this.viewCount = viewCount; &#125; private int type; private int resId; private int viewCount; public MultiEasyAdapterEntity() &#123; super(); &#125;&#125; å¯èƒ½æœ‰ç‚¹ç¹çï¼Œtypeå’ŒviewCount å¯ä»¥çœç•¥æŽ‰ï¼ŒåŠ å…¥typeæ˜¯ä¸ºäº†æ›´çµæ´»çš„èŽ·å¾—æ•°æ®ç±»åž‹ï¼ŒviewCountåˆ™æ˜¯ä¸ºäº†ä¼˜åŒ–SparseArray,ç»¼ä¸Šç¬¬ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼Œå°±æ˜¯ä½¿ç”¨typeä½œä¸ºé”®ï¼ŒMultiEasyAdapterEntityä½œä¸ºå€¼çš„ä¸€ä¸ªSparseArrayï¼Œä»–çš„ä½œç”¨å°±æ˜¯å­˜å‚¨ä¸åŒç±»åž‹çš„æ•°æ®é€‚é…æ—¶éœ€è¦çš„é…ç½®ä¿¡æ¯ï¼Œæœ‰ç‚¹ç±»ä¼¼é…ç½®æ–‡ä»¶çš„æ„æ€ã€‚ 1private SparseArray&lt;MultiEasyAdapterEntity&gt; Res4Type; å®Œå–„ä»£ç  ç»“åˆåˆ†ç±»é€‚é…çš„æ–¹æ³•ï¼Œå˜é‡æˆ‘ä»¬å·²ç»å­˜å‚¨åˆ°äº†SparseArrayä¸­ï¼Œæ‰€ä»¥ä»£ç å°±å¾ˆæ¸…æ™°äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100/** * version 2&lt;br/&gt;æ³¨æ„äº‹é¡¹ï¼šç±»åž‹æ•°ä¸ºnæ—¶ï¼Œé‚£ä¹ˆå®šä¹‰çš„ç±»åž‹å¿…é¡»åœ¨0-n-1ä¹‹é—´ï¼Œè¿™æ˜¯ä½¿ç”¨listviewè‡ªå¸¦ç¼“å­˜çš„è¦æ±‚ã€‚ * æŠ½è±¡é€‚é…å™¨å‡çº§ç‰ˆï¼Œå¯ä»¥è¿›è¡Œåˆ†ç±»é€‚é…ï¼Œä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†è®¾ç½®itemæ˜¾ç¤ºå†…å®¹çš„éƒ¨åˆ†æŠ½è±¡åˆ°äº†ç±»å¤–&lt;br/&gt; * @param &lt;T&gt; &lt;br/&gt;å¿…é¡»å®žçŽ°MultiEasyAdapterInterfaceæŽ¥å£&#123;@link MultiEasyAdapterInterface&#125;&lt;br/&gt; * @author chendong */public abstract class MultiEasyAdapter&lt;T extends MultiEasyAdapterInterface&gt; extends BaseAdapter &#123; private LayoutInflater layoutInflater; private List&lt;T&gt; datas; private SparseArray&lt;MultiEasyAdapterEntity&gt; Res4Type; private Context context; /** * @param context ä¸Šä¸‹æ–‡å¯¹è±¡ * @param datas æ•°æ®é›† * @param Res4Type èµ„æºé…ç½®æ–‡ä»¶&#123;@link MultiEasyAdapterEntity&#125;this is like a config entity */ public MultiEasyAdapter(Context context, List&lt;T&gt; datas, SparseArray&lt;MultiEasyAdapterEntity&gt; Res4Type) &#123; super(); this.layoutInflater = LayoutInflater.from(context); this.datas = datas; this.Res4Type = Res4Type; this.context = context; &#125; protected Context getContext()&#123; return context; &#125; protected List&lt;T&gt; getDatas()&#123; return datas; &#125; public void swapData(List&lt;T&gt; datas)&#123; this.datas = datas; notifyDataSetChanged(); &#125; @Override public int getViewTypeCount() &#123; return Res4Type.size(); &#125; @Override public int getItemViewType(int position) &#123; return datas.get(position).getType(); &#125; public int getCount() &#123; return datas.size(); &#125; public Object getItem(int position) &#123; return datas.get(position); &#125; public long getItemId(int position) &#123; return position; &#125; public View getView(int position, View convertView, ViewGroup parent) &#123; ViewHolder holder = null; /* get the type*/ int type = datas.get(position).getType(); if (convertView == null) &#123; int resId = Res4Type.get(type).getResId(); convertView = layoutInflater.inflate(resId, parent, false); holder = new ViewHolder(convertView, Res4Type.get(type) .getViewCount()); convertView.setTag(holder); bindListener4View(holder,datas.get(position), type, position); &#125; else &#123; holder = (ViewHolder) convertView.getTag(); &#125; bindData4View(holder,datas.get(position), type, position); return convertView; &#125; /** * ç»‘å®šæ•°æ® * bind data * * @param holder the viewholder * @param type data&apos;s type * @param data data */ public abstract void bindData4View(ViewHolder holder, T data, int type,int pos); /** * ç»‘å®šç›‘å¬ * bind listener * * @param holder the viewholder * @param type data&apos;s type * @param pos position */ public abstract void bindListener4View(ViewHolder holder, T data, int type,int pos);&#125; æµ‹è¯•1234567891011121314151617181920212223242526272829303132333435363738listview = (ListView) findViewById(R.id.listview); list = new ArrayList&lt;Student&gt;(); for (int i = 0; i &lt; 20; i++) &#123; if (i % 5 == 0) list.add(new Student(&quot;name&quot; + i, &quot;age&quot; + i, &quot;sex&quot;, 3)); else list.add(new Student(&quot;name&quot; + i, &quot;age&quot; + i, &quot;sex&quot;, i % 2 == 0 ? 1 : 2)); &#125; SparseArray&lt;MultiEasyAdapterEntity&gt; sparseArray = new SparseArray&lt;MultiEasyAdapterEntity&gt;( 3); sparseArray.put(1, new MultiEasyAdapterEntity(1, R.layout.item_type1, 4)); sparseArray.put(2, new MultiEasyAdapterEntity(2, R.layout.item_type2, 4)); sparseArray.put(3, new MultiEasyAdapterEntity(3, R.layout.item_type3, 4)); listview.setAdapter(new MultiEasyAdapter&lt;Student&gt;( getApplicationContext(), list, sparseArray) &#123; @Override public void bindData4View(ViewHolder holder, Student data, int type) &#123; ((TextView) holder.getView(R.id.tv_name)).setText(data .getName()); ((TextView) holder.getView(R.id.tv_sex)).setText(data.getSex()); ((TextView) holder.getView(R.id.tv_age)).setText(data.getAge() + &quot;&quot;); if (type == 3) ((TextView) holder.getView(R.id.tv_type)).setText(data .getType()+&quot;&quot;); &#125;@Override public void bindListener4View(ViewHolder holder, Student data, int type) &#123; //ç»‘å®šç›‘å¬äº‹ä»¶ &#125; &#125;); æ•ˆæžœ å¤§å®¶å¯ä»¥çœ‹åˆ°ä¸‰ä¸­å¸ƒå±€é€‚é…çš„æ²¡æœ‰é—®é¢˜ï¼Œåªæœ‰è“è‰²èƒŒæ™¯çš„å¸ƒå±€æ˜¾ç¤ºäº†type,ä»–æ˜¯ç±»åž‹3çš„æ•°æ®]]></content>
      <categories>
        <category>Android</category>
        <category>Adapter</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>ListView</tag>
        <tag>Adapter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ArrayListæºç åˆ†æž]]></title>
    <url>%2Farticle%2F1697740661%2F</url>
    <content type="text"><![CDATA[å¼€å§‹çœ‹æºä»£ç äº†æ‰çŸ¥é“androidå’Œjavaçš„æºä»£ç æœ‰å¥½å¤šå‡ºå…¥ï¼Œæˆ‘æŠŠjavaå’Œandroidæºç æ¯”è¾ƒäº†ä¸€ä¸‹ï¼Œç›¸ä¼¼çš„è¿˜æ˜¯å¤šçš„ã€‚æˆ‘æ˜¯ä»¥androidæºç ä¸ºä¸»ï¼Œå› ä¸ºæ„Ÿè§‰androidæ¯”è¾ƒç¹çï¼Œä¸åŒçš„åœ°æ–¹ä¼šè´´javaçš„ä»£ç å¯¹æ¯”ã€‚ javaçœŸçš„è®¾è®¡çš„å¾ˆå¥½ï¼Œå¾ˆå¤šç±»å†…éƒ¨å®žçŽ°å·®åˆ«å¾ˆå¤§ï¼Œä½†æ˜¯åœ¨å¤–éƒ¨çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚LinkedListå’ŒArrayList,è®¾è®¡è‰¯å¥½çš„APIä½¿æˆ‘ä»¬ä¸éœ€è¦åŽ»å…³æ³¨å†…éƒ¨çš„å®žçŽ°ï¼Œä¸¾ä¸ªä¾‹å­è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç»³å­ï¼Œä»–å¯ä»¥æ˜¯çœŸä¸åˆ¶æˆçš„ï¼Œé‚£ä¹ˆå®ƒæ¯”è¾ƒåšå›ºï¼Œä¹Ÿå¯ä»¥æ˜¯ç‰›çš®åˆ¶æˆçš„ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥ä¸æ€•æ°´ï¼Œä½†æ˜¯å¯¹ä½¿ç”¨ç»³å­çš„äººæ¥è¯´ï¼Œä»–å£°æ˜Žè‡ªå·±éœ€è¦çš„ç»³å­éœ€è¦å…·æœ‰ä»€ä¹ˆæ ·çš„ç‰¹æ€§ï¼Œä½†æ˜¯ä»–å´ä¸çŸ¥é“çœŸä¸çš„éœ€è¦ä»€ä¹ˆå·¥è‰ºï¼Œç‰›çš®çš„åˆéœ€è¦ä»€ä¹ˆå·¥è‰ºã€‚æˆ‘ä»¬ç¨‹åºå‘˜å°±æ˜¯ä½¿ç”¨ç»³å­çš„äººï¼Œå„ç§å„æ ·çš„Listå°±æ˜¯ç»³å­ï¼Œè™½ç„¶å†…éƒ¨å®žçŽ°å¤§ç›¸å¾„åº­ï¼Œä½†æ˜¯éƒ½å¯¹å¤–å¼€æ”¾äº†ä¸€æ¡ç»³å­çš„å¤–è¡¨ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥æžä¸ºæ–¹ä¾¿çš„ä½¿ç”¨å®ƒï¼Œè¿™ä½“çŽ°äº†é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³ï¼Œä¹Ÿå¯ä»¥ä½¿javaç¨‹åºå‘˜æ›´åŠ ä¸“æ³¨çš„å®žçŽ°åŠŸèƒ½è€Œä¸å°½é‡å°‘çš„å…³å¿ƒé€»è¾‘å’Œç®—æ³•ã€‚ ArrayListç±» ArrayListå†…éƒ¨åŸºäºŽæ•°ç»„å®žçŽ°,ç»§æ‰¿äº†AbstractListç±»ï¼Œå®žçŽ°äº†CloneableæŽ¥å£è¡¨ç¤ºå…¶å¯è¢«å…‹éš†å¤åˆ¶ï¼Œå®žçŽ°äº†SerializableæŽ¥å£è¡¨ç¤ºå…¶å¯è¢«åºåˆ—åŒ–ï¼Œå®žçŽ°äº†RandomAccessæŽ¥å£ï¼Œè¡¨ç¤ºå…¶å¯å¿«é€Ÿéšæœºè®¿é—®ï¼ˆä½†æ˜¯è¿™ä¸ªæŽ¥å£æ˜¯ç©ºçš„ï¼Œåªæ˜¯è¡¨ç¤ºå®ƒå…·æœ‰è¿™æ ·çš„ç‰¹æ€§ï¼‰ã€‚1public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements Cloneable, Serializable, RandomAccess&#123;&#125; ä¸€äº›å¸¸é‡å’Œæˆå‘˜ androidä¸­æä¾›äº†æœ€å°å®¹é‡ï¼Œjavaä¸­å¹¶æ²¡æœ‰è¿™ä¸ªæˆå‘˜ï¼Œè€Œæ˜¯ä½¿ç”¨äº†10è¿™ä¸ªæ•°å­—ä½œä¸ºåˆå§‹å®¹é‡ã€‚ 1234567//anrdroidæºç //æœ€å°å®¹é‡private static final int MIN_CAPACITY_INCREMENT = 12;//å…ƒç´ æ•°é‡int size;//å¯¹è±¡æ•°ç»„ï¼Œtransientè¡¨ç¤ºåœ¨åºåˆ—åŒ–æ—¶å®ƒä¼šè¢«å¿½ç•¥ã€‚ã€‚å•¥æ„æ€ï¼Ÿtransient Object[] array; åˆå§‹åŒ–æŒ‡å®šåˆå§‹å®¹é‡æž„é€  é¦–å…ˆå®¹é‡å¤§äºŽ0ï¼Œå¦‚æžœå®¹é‡==0ä¼šä½¿ç”¨EmptyArray.OBJECTæ¥åˆå§‹åŒ–ï¼Œåœ¨androidçš„æºç é‡Œé¢é“¾æŽ¥ä¸åˆ°EmptyArrayè¿™ä¸ªç±»ï¼ŒåŽ»äº†è¿™ä¸ªç½‘ç«™çœ‹åˆ°äº†æºç ï¼ŒEmptyArray.OBJECTæ˜¯ä¸€ä¸ªå®¹é‡æ˜¯0çš„æ•°ç»„ã€‚æ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœæŒ‡å®šå®¹é‡==0åˆ™åˆ›å»ºä¸€ä¸ªå®¹é‡æ˜¯0çš„å¯¹è±¡æ•°ç»„ï¼Œåä¹‹åˆ›å»ºä¸€ä¸ªæŒ‡å®šå®¹é‡å¤§å°çš„æ•°ç»„ã€‚(javaä¸­æ²¡æœ‰åšè¿™ä¸ªåˆ¤æ–­ï¼Œæœ¬æ¥è¿™ä¸ªåˆ¤æ–­å°±ä»€ä¹ˆç”¨) 1234567//android æºç public ArrayList(int capacity) &#123; if (capacity &lt; 0) &#123; throw new IllegalArgumentException("capacity &lt; 0: " + capacity); &#125; array = (capacity == 0 ? EmptyArray.OBJECT : new Object[capacity]); &#125; æ— å‚æž„é€ å‡½æ•° åŒä¸Šï¼Œåˆå§‹å®¹é‡æ˜¯0ã€‚ä½†æ˜¯javaæºç ä¸­åˆå§‹å®¹é‡æ˜¯10ã€‚ 12345678//android æºç  public ArrayList() &#123; array = EmptyArray.OBJECT; &#125; //javaæºç  public ArrayList() &#123;this(10); &#125; åˆå§‹åŒ–æ—¶æ‹·è´é›†åˆ ä¸»è¦çš„æ“ä½œæ˜¯åˆ¤æ–­æ˜¯ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œå¦‚æžœæ˜¯ç›´æŽ¥å†…éƒ¨æ•°ç»„ç›´æŽ¥æŒ‡å‘ï¼Œå¦‚æžœä¸æ˜¯è¿›è¡Œä¸€æ¬¡æ‹·è´ï¼Œjavaä¸­æ‰€æœ‰ç±»éƒ½ç»§æ‰¿è‡ªObjectã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢åŸºæœ¬æ•°æ®ç±»åž‹å—ï¼Ÿï¼ˆ&lt;-è¿™æ˜¯æˆ‘ä¸æ‡‚çš„åœ°æ–¹ï¼‰ç”¨çš„æ–¹æ³•ä¸ä¸€æ ·ï¼Œjavaä»£ç æ›´å°‘ä¸€ç‚¹ã€‚ System.arraycopy()æ–¹æ³•æ˜¯nativeä¿®é¥°çš„ï¼Œä½¿ç”¨Cå®žçŽ°çš„åº•å±‚æ–¹æ³•ã€‚ Arrays.copyOf()å‡½æ•°å†…éƒ¨ä¹Ÿä½¿ç”¨äº†System.arraycopy()æ–¹æ³•ã€‚ å°±æ˜¯æˆ‘ä¸æ‡‚çš„é‚£ä¸ªåœ°æ–¹äº†,æ„Ÿè§‰ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥è§£å†³ä¸æ˜¯å¯¹è±¡æ•°ç»„çš„é—®é¢˜ï¼Œä½†æ˜¯ä¸æ‡‚è¿™ä¸ªåˆ¤æ–­æ˜¯ä¸ºäº†ä»€ä¹ˆï¼ŒSystem.arraycopyåˆæ˜¯å¦‚ä½•å†…éƒ¨å®žçŽ°çš„ã€‚ 1234//android æºç if (a.getClass() != Object[].class) &#123;System.arraycopy(a, 0, newArray, 0, a.length);&#125; 1234567891011121314//android æºç public ArrayList(Collection&lt;? extends E&gt; collection) &#123; if (collection == null) &#123; throw new NullPointerException("collection == null"); &#125; Object[] a = collection.toArray(); if (a.getClass() != Object[].class) &#123; Object[] newArray = new Object[a.length]; System.arraycopy(a, 0, newArray, 0, a.length); a = newArray; &#125; array = a; size = a.length;&#125; 12345678//javaæºç public ArrayList(Collection&lt;? extends E&gt; c) &#123; elementData = c.toArray(); size = elementData.length; // c.toArray might (incorrectly) not return Object[] (see 6260652) if (elementData.getClass() != Object[].class) elementData = Arrays.copyOf(elementData, size, Object[].class);&#125; Addæ–¹æ³•Androidä¸­çš„å®žçŽ°123456789101112131415161718192021222324252627282930313233343536@Override public boolean add(E object) &#123; Object[] a = array; int s = size; if (s == a.length) &#123; Object[] newArray = new Object[s + (s &lt; (MIN_CAPACITY_INCREMENT / 2) ? MIN_CAPACITY_INCREMENT : s &gt;&gt; 1)]; System.arraycopy(a, 0, newArray, 0, s); array = a = newArray; &#125; a[s] = object; size = s + 1; modCount++; return true; &#125; @Override public void add(int index, E object) &#123; Object[] a = array; int s = size; if (index &gt; s || index &lt; 0) &#123; throwIndexOutOfBoundsException(index, s); &#125; if (s &lt; a.length) &#123; System.arraycopy(a, index, a, index + 1, s - index); &#125; else &#123; // assert s == a.length; Object[] newArray = new Object[newCapacity(s)]; System.arraycopy(a, 0, newArray, 0, index); System.arraycopy(a, index, newArray, index + 1, s - index); array = a = newArray; &#125; a[index] = object; size = s + 1; modCount++; &#125; Javaä¸­çš„å®žçŽ° è·ŸandroidåŸºæœ¬ä¸€æ ·çš„ï¼Œä¹‹æ‰€ä»¥ä»£ç ç®€å•äº†ï¼Œæ˜¯å› ä¸ºjavaå°†åˆ¤æ–­æ‰©å®¹çš„æ“ä½œæ”¾åœ¨äº†æ–¹æ³•å®žçŽ°ï¼Œä½†æ˜¯androdåªæ˜¯å°†è®¡ç®—æ–°å®¹é‡çš„æ–¹æ³•æå–å‡ºæ¥äº†ã€‚ 123456789101112131415public boolean add(E e) &#123; ensureCapacity(size + 1); // Increments modCount!! elementData[size++] = e; return true; &#125;public void add(int index, E element) &#123; if (index &gt; size || index &lt; 0) throw new IndexOutOfBoundsException( "Index: "+index+", Size: "+size); ensureCapacity(size+1); // Increments modCount!! System.arraycopy(elementData, index, elementData, index + 1, size - index); elementData[index] = element; size++; &#125; æ ¸å¿ƒä»£ç åˆ†æž è§£é‡Šä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œåœ¨javaä¸­ä¹Ÿæ˜¯å¦‚æ­¤å®žçŽ°çš„åªæ˜¯æå–åˆ°äº†æ–¹æ³•ä¸­ï¼Œä¼šåœ¨ä¸‹é¢çš„æ‰©å®¹æœºåˆ¶ä¸­è¯´æ˜Žã€‚ é¦–å…ˆæœ€åŽéƒ½è¿›è¡Œäº†ä¸€ä¸ªèµ‹å€¼æ“ä½œa[index] = object;å‰é¢çš„ä»£ç çš„å·¥ä½œå°±æ˜¯å°†è¿™ä¸ªä½ç½®ç©ºå‡ºæ¥ã€‚ä»£ç 5 å¦‚æžœå½“å‰çš„sizeæ²¡æœ‰è¶…è¿‡length,åˆ™å°†indexä½ç½®ä¹‹åŽçš„ä½ç½®å‘åŽç§»åŠ¨ä¸€ä½ï¼Œå°†indexä½ç½®ç©ºå‡ºæ¥ï¼ˆä»£ç 1ï¼‰ï¼Œå¦‚æžœè¶…è¿‡é•¿åº¦äº†ï¼Œåˆ™è¿›è¡Œä¸€æ¬¡æ‰©å®¹ï¼ˆä»£ç 2ï¼‰ï¼Œå°†æ•°æ®æ‹·è´åˆ°æ–°æ•°ç»„ï¼ˆä»£ç 3ï¼‰ï¼Œå†å°†æ•°ç»„åŽç§»ä¸€ä½ï¼ˆä»£ç 4ï¼‰ å®ƒæ˜¯æ€Žä¹ˆç§»åŠ¨çš„å‘¢ï¼ŸSystem.arraycopy(a, index, newArray, index + 1, s - index)äº†è§£å‚æ•°çš„å«ä¹‰ï¼ˆsrc,æºæ•°ç»„ä¸­å¼€å§‹å¤åˆ¶çš„ä½ç½®ï¼Œdest,ç›®æ ‡æ•°ç»„å¼€å§‹ç²˜è´´çš„ä½ç½®ï¼Œå¤åˆ¶çš„é•¿åº¦ï¼‰ï¼Œè¿™æ ·å°±æ˜Žç™½äº†ï¼ŒåŒ…æ‹¬ä»£ç 1æ˜¯ä¸€æ ·çš„æ„æ€ï¼Œaæ•°ç»„å’ŒnewArrayæ•°ç»„æ˜¯ç›¸åŒçš„ï¼Œå°†aä¸­indexå¼€å§‹çš„æ•°æ®å¤åˆ¶åˆ°newArrayä¸­index+1å¼€å§‹çš„ä½ç½®ï¼Œç„¶åŽå¤åˆ¶çš„é•¿åº¦æ˜¯s-index,åˆšå¥½indexä½ç½®è¢«ç©ºå‡ºæ¥äº†ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ•°æ®a={21ï¼Œ22ï¼Œ23ï¼Œ25ï¼Œ26}ï¼ŒnewArray={21ï¼Œ22ï¼Œ23ï¼Œ25ï¼Œ26},éœ€è¦åœ¨3çš„ä½ç½®æ’å…¥ä¸€ä¸ª24ï¼Œåˆ™å°†3å¼€å§‹çš„size-index(5-3=2)é•¿åº¦çš„æ•°ç»„ä¹Ÿå°±æ˜¯25ï¼Œ26ï¼Œå¤åˆ¶åˆ°newArrayä¸­index+1(3+1=4)å¼€å§‹çš„ä½ç½®ï¼Œå¾—åˆ°æ–°æ•°ç»„21ï¼Œ22ï¼Œ23ï¼Œç©ºï¼Œ25ï¼Œ26ï¼Œç„¶åŽarray[3]=24; 123456789101112Object[] a = array;int s = size;if (s &lt; a.length) &#123;System.arraycopy(a, index, a, index + 1, s - index);//---1&#125; else &#123; Object[] newArray = new Object[newCapacity(s)];//---2System.arraycopy(a, 0, newArray, 0, index);//---3System.arraycopy(a, index, newArray, index + 1, s - index);//---4array = a = newArray;&#125;a[index] = object;//5size = s + 1; æ‰©å®¹æœºåˆ¶ å•ç‹¬æ‹¿å‡ºæ¥æ˜¯å› ä¸ºandroidå’Œjavaæ‰©å®¹æœºåˆ¶ç¨æœ‰ä¸åŒ Androidä¸­çš„å®žçŽ° æ‰©å®¹æ—¶ï¼Œå¦‚æžœå½“å‰å®¹é‡å°äºŽ6åˆ™è®©å…¶ç­‰äºŽ12ï¼Œå¦åˆ™æ‰©å¤§ä¸ºåŽŸæ¥çš„ä¸¤å€ã€‚ 12345678private static int newCapacity(int currentCapacity) &#123;int increment = (currentCapacity &lt; (MIN_CAPACITY_INCREMENT / 2) ?MIN_CAPACITY_INCREMENT : currentCapacity &gt;&gt; 1);return currentCapacity + increment;&#125;//è¿™åªæ˜¯è®¡ç®—äº†æ–°çš„å®¹é‡ï¼ŒçœŸæ­£çš„æ‰©å®¹å¦‚æ­¤å®žçŽ°Object[] newArray = new Object[newCapacity(s)];System.arraycopy(a, 0, newArray, 0, index); javaä¸­çš„å®žçŽ°, javaä¸­æ•°ç»„æ‹·è´éƒ½æ˜¯ç”¨Arrays.copyOf()æ–¹æ³•çš„ï¼ŒåŸºæœ¬åŽŸç†ç›¸åŒã€‚ å¯ä»¥å‘çŽ°javaæ‰©å®¹å°†å®¹é‡æ‰©å¤§åˆ°äº†åŽŸæ¥å®¹é‡çš„1.5å€ã€‚ è¿™é‡Œæœ‰ä¸€è¡Œä»£ç ,çœ‹æ³¨é‡Šçš„æ„æ€æ˜¯è¿™ä¸ªæ–¹æ³•æ›´åŠ ä¼˜åŒ–äº†ï¼Œè°ƒçš®çš„ç¨‹åºå‘˜a.å¤§æ„æ˜¯minCapacity é€šå¸¸æ›´åŠ é€¼è¿‘size. 1if (newCapacity &lt; minCapacity) newCapacity = minCapacity; 123456789101112public void ensureCapacity(int minCapacity) &#123; modCount++; int oldCapacity = elementData.length; if (minCapacity &gt; oldCapacity) &#123; Object oldData[] = elementData; int newCapacity = (oldCapacity * 3)/2 + 1; if (newCapacity &lt; minCapacity) newCapacity = minCapacity; // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity); &#125;&#125; ç»¼ä¸Š å°±æ˜¯æ ¸å¿ƒæ–¹æ³•äº†å§ï¼Œå·²ç»å¯ä»¥äº†è§£åˆ°å®ƒåŸºæœ¬çš„åŽŸç†ï¼Œå½“ç„¶è¿˜æœ‰indexOf(),contains(),remove(),writeObject(),readObject(),å†…éƒ¨è¿­ä»£å™¨çš„å®žçŽ°ï¼ŒtoArray()çš„å®žçŽ°ï¼Œset(),addAll()â€¦..å…¶ä¸­çš„åŽŸç†ä¸Žä¸Šé¢æåˆ°çš„å¾ˆå¤šéƒ½æ˜¯ç›¸åŒçš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œäº†è§£ï¼Œè¿™é‡Œä¸ä»‹ç»äº†ï¼ŒåŽé¢æœ‰æ—¶é—´å†è´´ä¸€ä¸‹å§ã€‚]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>SourceCode</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ListView Adapter 2]]></title>
    <url>%2Farticle%2F1720703307%2F</url>
    <content type="text"><![CDATA[å‰è¨€ åœ¨ä½¿ç”¨é€‚é…å™¨ä¸ºListViewå¡«å……æ•°æ®æ—¶ï¼Œæ•°æ®ç±»åž‹å¾€å¾€ä¸æ˜¯å•ä¸€çš„ï¼Œå•ä¸€çš„æ•°æ®æ˜¾ç¤ºå¤ªå•è°ƒï¼Œå¯¹æ•°æ®æ ¼å¼è¦æ±‚ä¹Ÿæ¯”è¾ƒé«˜ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¾€å¾€ä½¿ç”¨ç½‘ç»œè¯·æ±‚èŽ·å–jsonæ•°æ®ç„¶åŽå°†å…¶æ˜¾ç¤ºåœ¨Itemä¸­ï¼Œæ­¤æ—¶èŽ·å–çš„æ•°æ®ç±»åž‹å¯èƒ½ä¼šæœ‰ä¸¤åˆ°ä¸‰ç§æ ¼å¼ï¼Œæ­¤æ—¶å°±ç”¨åˆ°äº†åˆ†ç±»é€‚é…ï¼Œä½¿ç”¨åˆ†ç±»é€‚é…å¯ä»¥æ›´åŠ å‹å¥½æ˜¾ç¤ºListViewã€‚ æ—¢ç„¶éœ€è¦åˆ†ç±»é€‚é…ï¼Œæˆ‘ä»¬å°±å¿…é¡»æ‹¿åˆ°æ•°æ®çš„ç±»åž‹ï¼Œä½ çš„æ•°æ®ä¹Ÿå°±å¿…é¡»ç›´æŽ¥æˆ–è€…é—´æŽ¥çš„å®žçŽ°èŽ·å–ç±»åž‹çš„æ–¹æ³•ï¼Œå…¶å®žListViewä¸­å·²ç»åŒ…å«äº†è¿™ä¸ªèŽ·å–ç±»åž‹çš„æ–¹æ³•ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå·±çš„èŽ·å–ç±»åž‹çš„æ–¹æ³•ã€‚ 12345678910//é‡å†™ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼Œlistviewåœ¨å†…éƒ¨ä¼šå‡†å¤‡getViewTypeCount()ä¸ªç¼“å†²åŒºï¼Œç”¨æ¥å¤ç”¨åŒç§ç±»åž‹çš„View,ä¸åŒç±»åž‹çš„Viewä¸ä¼šå‡ºçŽ°å¤ç”¨é”™è¯¯ã€‚@Overridepublic int getItemViewType(int position) &#123; int type = Integer.parseInt(newsEntities.get(position).getType()); return type;&#125;@Overridepublic int getViewTypeCount() &#123; return count;&#125; è¿›è¡Œåˆ†ç±»é€‚é…12345678910111213141516171819202122232425262728293031323334public View getView(int position, View convertView, ViewGroup parent) &#123; if (getItemViewType(position) == 1) &#123; ViewHolderVertical holder = null; if (convertView == null) &#123; convertView = layoutInflater.inflate( R.layout.item_firstpagelist_vertical, parent, false); holder = new ViewHolderVertical(); holder.iv = (ImageView) convertView .findViewById(R.id.item_firstpagelist_vertical_iv); //èŽ·å–å…¶ä»–çš„æŽ§ä»¶.... convertView.setTag(holder); &#125; else &#123; holder = (ViewHolderVertical) convertView.getTag(); &#125; NewsEntity entity = newsEntities.get(position); //ä¸ºæŽ§ä»¶è®¾ç½®æ˜¾ç¤ºçš„æ•°æ®.... &#125; else &#123; ViewHolder holder = null; if (convertView == null) &#123; convertView = layoutInflater.inflate( R.layout.item_firstpagelist_horizontal, parent, false); holder = new ViewHolder(); holder.iv = (ImageView) convertView .findViewById(R.id.item_firstpagelist_iv); //èŽ·å–å…¶ä»–çš„æŽ§ä»¶.... convertView.setTag(holder); &#125; else &#123; holder = (ViewHolder) convertView.getTag(); &#125; NewsEntity entity = newsEntities.get(position); //ä¸ºæŽ§ä»¶è®¾ç½®æ˜¾ç¤ºçš„æ•°æ®.... &#125; return convertView; &#125;]]></content>
      <categories>
        <category>Android</category>
        <category>Adapter</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>ListView</tag>
        <tag>Adapter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HashMapæºç åˆ†æž]]></title>
    <url>%2Farticle%2F1753510098%2F</url>
    <content type="text"><![CDATA[å¯¹HashMapæºç çš„ç®€å•åˆ†æž å‰è¨€ åŸºæœ¬çš„æ•°æ®ç»“æž„æœ‰ï¼Œæ•°ç»„ï¼Œé“¾è¡¨ï¼Œæ ‘ï¼Œå›¾ã€‚ æ•°ç»„çš„ç‰¹ç‚¹æ˜¯é•¿åº¦å›ºå®šï¼Œç©ºé—´è¿žç»­ï¼Œå ç”¨å†…å­˜å¾ˆå¤§ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯O(n),ä½†æ˜¯å¯»å€å®¹æ˜“ï¼Œæ—¶é—´å¤æ‚åº¦O(1).æ€»ç»“ï¼šå¯»å€å®¹æ˜“ï¼Œæ’å…¥åˆ é™¤å›°éš¾ã€‚ é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯é•¿åº¦å¯å˜ï¼Œå­˜å‚¨ç©ºé—´ç¦»æ•£ï¼Œå ç”¨å†…å­˜å°ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯O(1),ä½†æ˜¯å¯»å€å›°éš¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n).æ€»ç»“ï¼šå¯»å€å›°éš¾ï¼Œæ’å…¥åˆ é™¤å®¹æ˜“ã€‚ å“ˆå¸Œè¡¨åŸºäºŽæ•°ç»„ç»“æž„ï¼Œé‡‡ç”¨é”®å€¼çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œæ’å…¥åˆ é™¤å®¹æ˜“ï¼Œå¯»å€æ˜¯æ ¹æ®é”®å€¼ç›´æŽ¥æŸ¥æ‰¾æ•°æ®ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(1)ï¼Œä½†æ˜¯ä½¿ç”¨å“ˆå¸Œå€¼å­˜å‚¨æ•°æ®æ€»ä¼šå‡ºçŽ°å“ˆå¸Œå†²çªï¼Œè§£å†³å“ˆå¸Œå†²çªçš„æ–¹æ³•ä¸»è¦æœ‰ï¼Œå¼€æ”¾å®šå€æ³•ï¼ˆå†æ•£åˆ—ï¼‰ï¼Œå†å“ˆå¸Œæ³•ï¼Œé“¾åœ°å€æ³•ï¼ˆæ‹‰é“¾æ³•ï¼‰ï¼Œå»ºç«‹å…¬å…±æº¢å‡ºåŒºã€‚ ç¼ºç‚¹ï¼šå­˜å‚¨ç©ºé—´å¡«æ»¡æ—¶éœ€è¦å°†å…¶å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ç»“æž„ä¸­ï¼Œå¹¶è¿›è¡Œå†å“ˆå¸Œè®¡ç®—ï¼Œè¿™æ˜¯å“ˆå¸Œè¡¨å†…å­˜å ç”¨çš„æš´æ¶¨ç‚¹ï¼Œè¿™æ˜¯åŸºäºŽæ•°ç»„ç»“æž„çš„ä¸€ä¸ªç¼ºç‚¹ã€‚ å“ˆå¸Œè¡¨ä¸èƒ½ä»¥ä¸€ç§ç‰¹å®šçš„é¡ºåºéåŽ†æ•°æ®ç»“æž„ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œå¦‚æžœéœ€è¦æŒ‰åºå­˜å‚¨ï¼Œä½¿ç”¨å“ˆå¸Œè¡¨å¹¶ä¸åˆé€‚ ä»‹ç» HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„HashTableæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ HashMapå°±æ˜¯åŸºäºŽé“¾åœ°å€æ³•å®žçŽ°çš„æ•°æ®å­˜å‚¨ã€‚ä¹Ÿå°±æ˜¯é“¾è¡¨çš„æ•°ç»„ã€‚ HashMapå…è®¸é”® å€¼ ä¸ºnullã€‚HashTableæ˜¯ä¸å…è®¸çš„ã€‚ åœ¨Androidå’ŒJavaé‡Œé¢å¯¹HashMapçš„å®žçŽ°ï¼Œç¨æœ‰ä¸åŒï¼Œå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºæ˜¯æˆ‘çš„jdkæœ‰é—®é¢˜ã€‚ åœ¨HashMapçš„åŸºç¡€æ•°ç»„ä¸­ï¼Œæ¯ä¸€ä¸ªæ•°ç»„é¡¹ç§°ä¹‹ä¸ºä¸€ä¸ªæ¡¶ï¼ŒHashMapå°±æ˜¯åŸºäºŽè¿™ç§æ¡¶+é“¾è¡¨çš„ç»“æž„ã€‚ å­˜å‚¨æ–¹å¼ï¼Œä½¿ç”¨keyå€¼å–å“ˆå¸Œï¼Œä¸€èˆ¬çš„ç®—æ³•æ˜¯hash(key)/lenèŽ·å¾—ä»–å­˜æ”¾ä½ç½®çš„ä¸‹æ ‡ï¼Œè¿™æ ·å°±å°†keyä¸Žä¸‹æ ‡å¯¹åº”èµ·æ¥ã€‚ å­˜å‚¨çš„æ•°æ®ç»“æž„ æ€»ç»“æ¥è¯´ï¼ŒHashMapå°±æ˜¯æ•°ç»„+å†…éƒ¨ç±»ï¼ˆEntryï¼‰å®žçŽ°ï¼ŒEntryä¸­å…·æœ‰ä¸‹ä¸€ä¸ªEntryçš„å¼•ç”¨ï¼Œç”±æ­¤æž„æˆäº†é“¾è¡¨çš„ç»“æž„ã€‚ä¹‹å‰çœ‹è¿‡æœ‰äººä»‹ç»è¯´æ˜¯Set+é™æ€å†…éƒ¨ç±»ï¼Œå…¶å®žå¹¶ä¸æ˜¯ã€‚ç¬¬ä¸€è¡Œçš„ä»£ç æ˜¯ç”¨æ¥å¯¹HashMapè¿›è¡Œæ“ä½œæ—¶ä½¿ç”¨çš„å˜é‡ï¼Œæ¯”å¦‚è¿­ä»£HashMapæ‰€æœ‰çš„å­é¡¹ï¼Œæ·»åŠ ä¸€ä¸ªEntrySetåˆ°HashMapä¸­ï¼Œåˆ é™¤ï¼Œä¿®æ”¹ã€‚ã€‚ã€‚ã€‚ 12private transient Set&lt;Entry&lt;K, V&gt;&gt; entrySet;transient HashMapEntry&lt;K, V&gt;[] table; HashMapEntry HashMapä¸­æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å­˜å‚¨ç»“æž„HashMapEntry,ç”¨æ¥ä¿å­˜é”®å€¼å¯¹ï¼Œå’Œä¸‹ä¸€ä¸ªEntryçš„å¼•ç”¨ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªé“¾è¡¨ç»“æž„ã€‚ åœ¨Javaä¸­ï¼Œè¿™ä¸ªé™æ€å†…éƒ¨ç±»å«Entry,åœ¨androidä¸­å«HashMapEntryï¼Œåœ¨åŠŸèƒ½ä¸Šåº”è¯¥æ˜¯ç›¸ä¼¼çš„ã€‚æ˜¯ä¸€ä¸ªå­˜å‚¨æ•°æ®çš„åŸºç¡€bean,å…³æ³¨ä¸€ä¸‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839static class HashMapEntry&lt;K, V&gt; implements Entry&lt;K, V&gt; &#123; final K key; V value; final int hash; HashMapEntry&lt;K, V&gt; next; HashMapEntry(K key, V value, int hash, HashMapEntry&lt;K, V&gt; next) &#123; this.key = key; this.value = value; this.hash = hash; this.next = next; &#125; public final K getKey() &#123; return key; &#125; public final V getValue() &#123; return value; &#125; public final V setValue(V value) &#123; V oldValue = this.value; this.value = value; return oldValue; &#125; @Override public final boolean equals(Object o) &#123; if (!(o instanceof Entry)) &#123; return false; &#125; Entry&lt;?, ?&gt; e = (Entry&lt;?, ?&gt;) o; return Objects.equal(e.getKey(), key) &amp;&amp; Objects.equal(e.getValue(), value); &#125; @Override public final int hashCode() &#123; return (key == null ? 0 : key.hashCode()) ^ (value == null ? 0 : value.hashCode()); &#125; @Override public final String toString() &#123; return key + "=" + value; &#125;&#125; å“ˆå¸Œå€¼çš„è®¡ç®— å­˜å‚¨æ•°æ®æ˜¯æ ¹æ®keyçš„å“ˆå¸Œå€¼æ¥å­˜å‚¨çš„ï¼Œç±»ä¼¼è¿™æ ·çš„æ–¹æ³•hash(key.hashcode()) Javaå’ŒAndroidä¸­å¯¹æ±‚å“ˆå¸Œå€¼çš„æ“ä½œç›¸ä¼¼ä½†æ˜¯å“ˆå¸Œç®—æ³•ä¸åŒï¼Œå½“è¿›è¡Œå­˜å–æ“ä½œæ—¶ï¼Œkeyéƒ½éœ€è¦ä½¿ç”¨è¿™ä¸ªç®—æ³•è¿›è¡Œä¸­è½¬ã€‚ åœ¨Androidä¸­ä½¿ç”¨çš„æ˜¯Collectionsç±»ä¸‹çš„é™æ€æ–¹æ³•åŠè¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œä½†æ˜¯è¿™é‡Œçš„hæ˜¯keyçš„hashcode(),çœ‹æ³¨é‡Šä½¿ç”¨çš„æ˜¯Wang/Jenkinså“ˆå¸Œç®—æ³•çš„å˜ä½“,æºä»£ç ï¼š 1234567891011//javaå®žçŽ°private static int secondaryHash(int h) &#123; // Spread bits to regularize both segment and index locations, // using variant of single-word Wang/Jenkins hash. h += (h &lt;&lt; 15) ^ 0xffffcd7d; h ^= (h &gt;&gt;&gt; 10); h += (h &lt;&lt; 3); h ^= (h &gt;&gt;&gt; 6); h += (h &lt;&lt; 2) + (h &lt;&lt; 14); return h ^ (h &gt;&gt;&gt; 16);&#125; 12345678//androidå®žçŽ°static int hash(int h) &#123; // This function ensures that hashCodes that differ only by // constant multiples at each bit position have a bounded // number of collisions (approximately 8 at default load factor). h ^= (h &gt;&gt;&gt; 20) ^ (h &gt;&gt;&gt; 12); return h ^ (h &gt;&gt;&gt; 7) ^ (h &gt;&gt;&gt; 4); &#125; putæ–¹æ³• æ£€æŸ¥é”®å€¼æ˜¯å¦ä¸ºç©ºï¼Œnullæ—¶å°†å­˜å‚¨åˆ°forNullEntryæ‰€åœ¨çš„é“¾è¡¨ä¸­ã€‚ èŽ·å–å“ˆå¸Œå€¼ä¹‹åŽèŽ·å¾—ä¸‹æ ‡ç´¢å¼•ï¼Œæ£€æŸ¥keyæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œæ˜¯åˆ™æ›¿æ¢ï¼Œå¦åˆ™æ·»åŠ åˆ°å½“å‰é“¾è¡¨ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯è¿™æ ·çš„ï¼Œå‡ ä¸ªä¸åŒçš„ç‚¹ putForNullKey(value)æ–¹æ³•ï¼Œåœ¨Androidå’ŒJavaä¸­éƒ½æœ‰å®žçŽ°ï¼Œå½“é”®å€¼ä¸ºnullæ—¶ï¼Œåˆ†é…ä¸€ä¸ªæ•°ç»„çš„ä¸€é¡¹ï¼Œè¿™ä¸ªæ•°ç»„æŒ‡å‘key == null çš„Entry ä¸€ä¸ªä¸åŒç‚¹ï¼ŒJavaä¸­æ˜¯åœ¨æ·»åŠ Entryä¹‹åŽé‡æ–°è®¡ç®—å®¹é‡ï¼Œè€ŒAndroidæ˜¯åœ¨AddNewEntryä¹‹å‰è¿›è¡Œã€‚ æ‰©å®¹çš„æ–¹æ³•éƒ½æ˜¯æ‰©å¤§ä¸ºåŽŸæ¥çš„ä¸¤å€ã€‚ åœ¨Androidä¸­çš„å®žçŽ°åŸºæœ¬ç±»ä¼¼ï¼Œä½¿ç”¨Collectionsé™æ€æ–¹æ³•è¿›è¡ŒäºŒæ¬¡å“ˆå¸Œè®¡ç®—ï¼Œè®¡ç®—ä¸‹è¡¨ç´¢å¼• 123456789101112131415161718192021222324252627282930313233//åœ¨javaä¸­çš„å®žçŽ°ä»£ç :public V put(K key, V value) &#123; if (key == null) return putForNullKey(value); int hash = hash(key.hashCode()); //è®¡ç®—hashå€¼ï¼Œä½¿ç”¨indexForï¼ˆï¼‰è¿™ä¸ªå‡½æ•°èŽ·å¾—è¯¥å“ˆå¸Œå€¼å¯¹åº”æ•°ç»„ä¸‹æ ‡ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°å¯¹åº”çš„é‚£ä¸ªé“¾è¡¨ã€‚ int i = indexFor(hash, table.length ); for (Entry&lt;K,V&gt; e = table [i]; e != null; e = e.next) &#123; Object k; //å…³æ³¨è¿™éƒ¨åˆ†ä»£ç æ˜¯æ›¿æ¢æŽ‰å·²ç»å­˜åœ¨çš„keyå¯¹åº”çš„value if (e.hash == hash &amp;&amp; ((k = e.key ) == key || key.equals(k))) &#123; V oldValue = e. value; e. value = value; e.recordAccess( this); return oldValue; &#125; &#125; modCount++; addEntry(hash, key, value, i); return null ; &#125; //è§£é‡Šä¸€ä¸‹è¿™éƒ¨åˆ†ä»£ç ï¼Œåšçš„æ“ä½œå°±æ˜¯å°†æ–°æ·»åŠ çš„Entryæ”¾åœ¨é“¾è¡¨çš„å¤´éƒ¨ï¼Œè€ŒåŽŸæ¥çš„é“¾è¡¨ä¼šæŽ¥åœ¨è¿™ä¸ªæ–°çš„EntryåŽé¢ã€‚void addEntry(int hash, K key, V value, int bucketIndex) &#123;//æ³¨æ„è¿™é‡Œçš„bucketIndexæ˜¯ä¸Šä¸€ä¸ªå‡½æ•°å¾—åˆ°çš„æ•°ç»„ä¸‹æ ‡ã€‚å–åˆ°è¯¥æ•°ç»„é¡¹é“¾æŽ¥çš„Entryç»™äº†ä¸´æ—¶å˜é‡eEntry&lt;K,V&gt; e = table [bucketIndex];//æ–°å»ºäº†ä¸€ä¸ªEntryå°†å…¶é“¾æŽ¥åˆ°äº†æ•°ç»„é¡¹ä¸Šï¼Œç„¶åŽæŠŠeç»™äº†æ–°çš„Entryçš„Next,ä¹Ÿå°±æ˜¯åŽé¢çš„é“¾è¡¨é‡æ–°é“¾æŽ¥åˆ°äº†æ–°çš„EntryåŽé¢ï¼Œè€Œæ–°çš„Entryä½œä¸ºäº†è¯¥é“¾è¡¨çš„ç¬¬ä¸€é¡¹ã€‚table[bucketIndex] = new Entry&lt;K,V&gt;(hash, key, value, e);//æ·»åŠ ä¹‹åŽé‡æ–°è®¡ç®—å®¹é‡ã€‚if (size ++ &gt;= threshold) resize(2 * table.length );&#125; 12345678910111213141516171819202122232425262728293031//androidä¸­çš„å®žçŽ°@Override public V put(K key, V value) &#123; if (key == null) &#123; return putValueForNullKey(value); &#125; int hash = Collections.secondaryHash(key); HashMapEntry&lt;K, V&gt;[] tab = table; int index = hash &amp; (tab.length - 1); for (HashMapEntry&lt;K, V&gt; e = tab[index]; e != null; e = e.next) &#123; if (e.hash == hash &amp;&amp; key.equals(e.key)) &#123; preModify(e); V oldValue = e.value; e.value = value; return oldValue; &#125; &#125; // No entry for (non-null) key is present; create one modCount++; //æ³¨æ„è¿™é‡Œæ˜¯å…ˆè¿›è¡Œæ‰©å®¹åŽè¿›è¡Œæ·»åŠ çš„ if (size++ &gt; threshold) &#123; tab = doubleCapacity(); index = hash &amp; (tab.length - 1); &#125; addNewEntry(key, value, hash, index); return null;&#125;//Androidæ·»åŠ ä»£ç å°±æ›´ç®€å•äº†ï¼Œä¸è¿‡ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæ“ä½œä¸Žjavaä¸­æ˜¯ä¸€æ ·çš„ã€‚ä¸è¿‡æ–¹æ³•å¾ˆå·§//å¦™ï¼Œç®€åŒ–äº†ä»£ç ï¼Œè®©æˆ‘æƒ³èµ·äº†InputStream is = new FileInputStream("path")is = new BufferedInputStream(is)`void addNewEntry(K key, V value, int hash, int index) &#123;table[index] = new HashMapEntry&lt;K, V&gt;(key, value, hash, table[index]);&#125; getæ–¹æ³• åŒæ ·çš„èŽ·å–hashcode,å†å“ˆå¸Œè®¡ç®—å“ˆå¸Œå€¼ï¼ŒèŽ·å¾—ä¸‹æ ‡ç´¢å¼•ï¼Œå¾—åˆ°å¯¹åº”é“¾è¡¨ï¼ŒéåŽ†é“¾è¡¨å¾—åˆ°ç»“æžœï¼Œåœ¨Javaå’ŒAndroidä¸­å®žçŽ°å¤§åŒå°å¼‚. 1234567891011121314//javaä¸­çš„å®žçŽ°public V get(Object key) &#123; if (key == null) return getForNullKey(); int hash = hash(key.hashCode()); for (Entry&lt;K,V&gt; e = table [indexFor(hash, table.length )]; e != null; e = e. next) &#123; Object k; if (e.hash == hash &amp;&amp; ((k = e.key) == key || key.equals(k))) return e.value ; &#125; return null; &#125; 123456789101112131415161718//Androidä¸­çš„å®žçŽ°public V get(Object key) &#123; if (key == null) &#123; HashMapEntry&lt;K, V&gt; e = entryForNullKey; return e == null ? null : e.value; &#125; int hash = Collections.secondaryHash(key); HashMapEntry&lt;K, V&gt;[] tab = table; for (HashMapEntry&lt;K, V&gt; e = tab[hash &amp; (tab.length - 1)]; e != null; e = e.next) &#123; K eKey = e.key; if (eKey == key || (e.hash == hash &amp;&amp; key.equals(eKey))) &#123; return e.value; &#125; &#125; return null;&#125; åˆå§‹åŒ– åœ¨Javaå’ŒAndroidä¸­HashMapçš„åˆå§‹åŒ–ç•¥æœ‰ä¸åŒ,Androidä¸­åˆå§‹å®¹é‡æ˜¯2ï¼ŒJavaä¸­åˆå§‹å®¹é‡æ˜¯16ã€‚ Javaå®žçŽ° Javaä¸­çš„åˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­æ˜¯å­¦ä¹ Javaæ¯”è¾ƒç»å…¸çš„å†…å®¹ï¼Œçœ‹ä¸€ä¸‹Javaä¸­HashMapçš„é»˜è®¤æž„é€ æ–¹æ³• 123456789static final int DEFAULT_INITIAL_CAPACITY = 16;static final float DEFAULT_LOAD_FACTOR = 0.75f;public HashMap() &#123;//é»˜è®¤çš„æž„é€ æ–¹æ³•ä¼šåˆå§‹åŒ–ä¸€ä¸ªå®¹é‡æ˜¯16ï¼Œè´Ÿè½½å› å­0.75çš„HashMap,thresholdæœ‰é˜ˆå€¼çš„æ„æ€ï¼Œå°±æ˜¯å½“å‰å®¹é‡å¯ä»¥æ‰¿å—çš„è´Ÿè½½,å½“è¶…è¿‡è¿™ä¸ªè´Ÿè½½æ—¶å°±ä¼šè¿›è¡Œæ‰©å®¹ã€‚this.loadFactor = DEFAULT_LOAD_FACTOR;threshold = (int )(DEFAULT_INITIAL_CAPACITY * DEFAULT_LOAD_FACTOR );table = new Entry[DEFAULT_INITIAL_CAPACITY];init();&#125; å¸¦æœ‰å‚æ•°çš„æž„é€ æ–¹æ³•å®žçŽ° 12345678910111213141516171819202122232425262728293031323334//æŒ‡å®šå®¹é‡å’Œè´Ÿè½½å› å­æ—¶ä¼šæ£€æŸ¥å®¹é‡å’Œè´Ÿè½½å› å­çš„å€¼æ˜¯ä¸æ˜¯æœ‰é—®é¢˜//ç„¶åŽä¼šè¿›è¡Œä¸€ä¸ªä½è¿ç®—ç®—æ³•èŽ·å¾—-ã€‹å¤§äºŽå½“å‰è¦æ±‚çš„å®¹é‡çš„-ã€‹æœ€å°çš„2çš„å¹‚//ï¼ˆä¹Ÿå°±æ˜¯å¦‚æžœæ˜¯7--ã€‹8å¦‚æžœæ˜¯9--ã€‹16ï¼‰public HashMap(int initialCapacity, float loadFactor) &#123;if (initialCapacity &lt; 0)throw new IllegalArgumentException("Illegal initial capacity: " +initialCapacity);if (initialCapacity &gt; MAXIMUM_CAPACITY)initialCapacity = MAXIMUM_CAPACITY;if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))throw new IllegalArgumentException("Illegal load factor: " +loadFactor);// Find a power of 2 &gt;= initialCapacity//ç®—æ³•åŽŸç†ï¼šcapacityåˆå§‹ä¸º1ï¼Œå½“capacityå°äºŽinitialCapacityæ—¶å·¦ç§»ä¸€ä½ï¼Œå°±æ˜¯*2,ç›´åˆ°æ‰¾åˆ°å¤§äºŽå½“å‰è¦æ±‚çš„å®¹é‡æœ€å°çš„2çš„å¹‚int capacity = 1;while (capacity &lt; initialCapacity)capacity &lt;&lt;= 1;this.loadFactor = loadFactor;threshold = (int )(capacity * loadFactor);table = new Entry[capacity];init();&#125;//å®¹é‡å¢žåŠ ï¼Œtransfer(newTable);ä¼šå°†åŽŸæ¥çš„æ•°æ®å†å“ˆå¸Œé‡æ–°æ”¾å…¥æ•°æ®void resize(int newCapacity) &#123; Entry[] oldTable = table; int oldCapacity = oldTable.length ; if (oldCapacity == MAXIMUM_CAPACITY) &#123; threshold = Integer.MAX_VALUE; return; &#125; Entry[] newTable = new Entry[newCapacity]; transfer(newTable); table = newTable; threshold = (int)(newCapacity * loadFactor); &#125; åœ¨Androidä¸­çš„å®žçŽ°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495//é»˜è®¤çš„åˆå§‹æœ€å°å®¹é‡æ˜¯4ï¼Œä¸€ä¸ªé™æ€çš„åˆå§‹æ•°ç»„çš„å®¹é‡æ˜¯æœ€å°å®¹é‡æ— ç¬¦å·å³ç§»1ä½ï¼Œä¹Ÿå°±æ˜¯2ï¼Œé»˜è®¤æž„é€ æ—¶ï¼Œä¼šå°†è¯¥é™æ€æ•°ç»„äº¤ç»™table,è¿™é‡Œæœ‰ä¸€è¡Œæºç çš„æ³¨é‡Šï¼ˆ Forces first put invocation to replace EMPTY_TABLEï¼‰ï¼Œæ„æ€æ˜¯æ ¹æ®ç¬¬ä¸€æ¬¡putæ–¹æ³•åŠ å…¥çš„æ•°é‡æ¥æ‰©å……æ•°ç»„ï¼Œæ­¤æ—¶è´Ÿè½½å®¹é‡æ˜¯-1ï¼Œæ·»åŠ æ—¶ä¼šç«‹åˆ»æ‰©å……å®¹é‡ï¼Œè¿™å¯èƒ½ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆAndroidä¸­æ·»åŠ å…ƒç´ æ˜¯å…ˆæ£€æŸ¥æ‰©å……å®¹é‡å†æ·»åŠ çš„åŽŸå› ã€‚ã€‚åœ¨putæ—¶ç¬¬ä¸€æ¬¡ç™¾åˆ†ç™¾æ£€æµ‹åˆ°å®¹é‡ä¸å¤Ÿï¼Œæ­¤æ—¶è¿›è¡Œä¸€æ¬¡doubleCapacity()å°†å®¹é‡åŠ å€ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¼šè°ƒç”¨private static final int MINIMUM_CAPACITY = 4;private static final Entry[] EMPTY_TABLE = new HashMapEntry[MINIMUM_CAPACITY &gt;&gt;&gt; 1];public HashMap() &#123; table = (HashMapEntry&lt;K, V&gt;[]) EMPTY_TABLE; threshold = -1; // Forces first put invocation to replace EMPTY_TABLE&#125;//å®¹é‡å¢žé•¿æˆ–åˆå§‹åŒ–æ—¶ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œé‡ç½®é˜ˆå€¼ï¼Œä¸ŽJavaç¨æœ‰ä¸åŒï¼Œä½¿ç”¨å›ºå®šçš„å®¹é‡çš„3/4æ¥ä½œä¸ºé˜ˆå€¼ï¼ŒJavaä¸­è¿˜è¦æ¯”è¾ƒå®¹é‡çš„å¤§å°ï¼Œå–Math.min(å®¹é‡ï¼Œ)private HashMapEntry&lt;K, V&gt;[] doubleCapacity() &#123; HashMapEntry&lt;K, V&gt;[] oldTable = table; int oldCapacity = oldTable.length; if (oldCapacity == MAXIMUM_CAPACITY) &#123; return oldTable; &#125; int newCapacity = oldCapacity * 2; HashMapEntry&lt;K, V&gt;[] newTable = makeTable(newCapacity); if (size == 0) &#123; return newTable; &#125; for (int j = 0; j &lt; oldCapacity; j++) &#123; /* * Rehash the bucket using the minimum number of field writes. * This is the most subtle and delicate code in the class. */ HashMapEntry&lt;K, V&gt; e = oldTable[j]; if (e == null) &#123; continue; &#125; int highBit = e.hash &amp; oldCapacity; HashMapEntry&lt;K, V&gt; broken = null; newTable[j | highBit] = e; for (HashMapEntry&lt;K, V&gt; n = e.next; n != null; e = n, n = n.next) &#123; int nextHighBit = n.hash &amp; oldCapacity; if (nextHighBit != highBit) &#123; if (broken == null) newTable[j | nextHighBit] = n; else broken.next = n; broken = e; highBit = nextHighBit; &#125; &#125; if (broken != null) broken.next = null; &#125; return newTable;&#125;private HashMapEntry&lt;K, V&gt;[] makeTable(int newCapacity) &#123; @SuppressWarnings("unchecked") HashMapEntry&lt;K, V&gt;[] newTable = (HashMapEntry&lt;K, V&gt;[]) new HashMapEntry[newCapacity]; table = newTable; //é˜ˆå€¼æ—¶æ˜¯å®¹é‡çš„3/4,ä½¿ç”¨äº†ä½è¿ç®— threshold = (newCapacity &gt;&gt; 1) + (newCapacity &gt;&gt; 2); // 3/4 capacity return newTable;&#125;//åŒæ ·çš„æ£€æŸ¥æœºåˆ¶ï¼Œç„¶åŽä½¿ç”¨äº†ä¸€ä¸ªæ–¹æ³•ï¼Œåˆæ˜¯Collectionsç±»ä¸­çš„æ–¹æ³•Collections.roundUpToPowerOfTwo(capacity);ï¼Œä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œå°†å®¹é‡ä¿®æ”¹ä¸ºå¤§äºŽè¾“å…¥å®¹é‡çš„æœ€å°çš„2çš„å¹‚ã€‚ä½†æ˜¯ä½¿ç”¨äºŒè¿›åˆ¶å®žçŽ°ï¼Œä¼šä¸ä¼šæ›´ç‰›é€¼ä¸€ç‚¹ã€‚public HashMap(int capacity) &#123; if (capacity &lt; 0) &#123; throw new IllegalArgumentException("Capacity: " + capacity); &#125; if (capacity == 0) &#123; @SuppressWarnings("unchecked") HashMapEntry&lt;K, V&gt;[] tab = (HashMapEntry&lt;K, V&gt;[]) EMPTY_TABLE; table = tab; threshold = -1; // Forces first put() to replace EMPTY_TABLE return; &#125; if (capacity &lt; MINIMUM_CAPACITY) &#123; capacity = MINIMUM_CAPACITY; &#125; else if (capacity &gt; MAXIMUM_CAPACITY) &#123; capacity = MAXIMUM_CAPACITY; &#125; else &#123; capacity = Collections.roundUpToPowerOfTwo(capacity); &#125; makeTable(capacity);&#125;//çœ‹ä¸æ‡‚å•Šï¼Œåº”è¯¥æ”¶è—ä¸€ä¸‹å…³äºŽäºŒè¿›åˆ¶çš„ç®—æ³•ï¼Œé«˜å¤§ä¸Šçš„åˆ«äººéƒ½çœ‹ä¸æ‡‚public static int roundUpToPowerOfTwo(int i) &#123; i--; // If input is a power of two, shift its high-order bit right. // "Smear" the high-order bit all the way to the right. i |= i &gt;&gt;&gt; 1; i |= i &gt;&gt;&gt; 2; i |= i &gt;&gt;&gt; 4; i |= i &gt;&gt;&gt; 8; i |= i &gt;&gt;&gt; 16; return i + 1;&#125; æ›´å¤š JDK1.8åœ¨å®¹é‡è¿‡å¤§æ—¶ä½¿ç”¨çº¢é»‘æ ‘å­˜å‚¨æ•°æ®ï¼Œäº‹ä»¶å¤æ‚åº¦O(logn),å¯¹äºŽçº¢é»‘æ ‘ä¸æ˜¯å¾ˆäº†è§£ï¼Œç®—æ³•å¾ˆèœï¼Œæš‚æ—¶æ”¾æ”¾å§ã€‚ é˜ˆå€¼ = å®¹é‡ è´Ÿè½½å› å­ï¼Œå½“å®¹é‡è¶…è¿‡é˜ˆå€¼æ—¶ä¼šè¿›è¡Œæ‰©å®¹å’Œå†æ•£åˆ—ï¼Œæ­¤æ—¶æ˜¯hashmapçš„å†…å­˜å ç”¨çš„å¢žé•¿ç‚¹ï¼Œæ‰©å®¹ä¼šå°†å®¹é‡æ‰©å¤§ä¸ºåŽŸæ¥çš„ä¸¤å€ç„¶åŽå°†æ•°æ®æ‹·è´åˆ°æ–°çš„åŒºåŸŸè¿›è¡Œå†æ•£åˆ—ã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ä¸å¤ªæ‡‚ï¼šHashMapæ‰©å®¹ï¼Œæ¯æ¬¡æ·»åŠ ä¸€ä¸ªå…ƒç´ size++,å½“size&gt;é˜ˆå€¼ï¼ˆå®¹é‡è´Ÿè½½å› å­ï¼‰æ—¶è¿›è¡Œæ‰©å®¹ï¼Œä½†æ˜¯HashMapæ˜¯åŸºäºŽæ•°ç»„+é“¾è¡¨çš„ï¼Œæ·»åŠ çš„å…ƒç´ ä¸ä¸€å®šé›†ä¸­åˆ°ä¸€ä¸ªæ•°ç»„é¡¹ã€‚ä¸¾ä¸ªä¾‹å­è¯´ï¼Œå½“ä¸€ä¸ªhashmapå®¹é‡æ˜¯16ï¼Œé˜ˆå€¼å°±æ˜¯12ï¼Œæ­¤æ—¶æ·»åŠ çš„å…ƒç´ å¦‚æžœæœ‰12ä¸ªäº†ï¼Œä½†æ˜¯å´åªæ˜¯é›†ä¸­åœ¨æŸå‡ ä¸ªæ•°ç»„é¡¹æ‰€åœ¨ çš„é“¾è¡¨ä¸­ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿›è¡Œæ‰©å®¹åˆé€‚å—ï¼Ÿæš‚æ—¶åˆç†çš„è§£é‡Šæ˜¯hashï¼ˆï¼‰ç®—æ³•å¯ä»¥å¾ˆå¥½çš„å°†æ•°æ®åˆ†æ•£åœ¨æ‰€æœ‰çš„æ•°ç»„é¡¹ä¸­ï¼Œé‚£ä¹ˆè¿™ç§æ¯”è¾ƒä¹Ÿæ˜¯æ¯”è¾ƒåˆç†çš„ã€‚ ä¸ºä»€ä¹ˆè¦å°†åˆå§‹å®¹é‡è®¡ç®—å¾—åˆ°å¤§äºŽè¯¥å®¹é‡çš„æœ€å°çš„2çš„å¹‚ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªä»£ç int index = hash &amp; (tab.length - 1);åœ¨javaä¸­æœ‰ç›¸åŒçš„è®¾è®¡æ˜¯ä¸€ä¸ªå‡½æ•°indexfor(int hash)åœ¨è®¡ç®—hashcodeå¯¹åº”çš„æ•°ç»„ä¸‹æ ‡æ—¶ä½¿ç”¨hash&amp;len-1ä»£æ›¿äº†hash%lenï¼Œåªæœ‰åœ¨lenæ˜¯2çš„å¹‚æ—¶ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æ‰æ˜¯ç­‰ä»·ä¸ç­‰æ•ˆçš„ã€‚å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œä¸¾ä¸ªä¾‹å­ï¼šlenæ˜¯16æ—¶ï¼ŒäºŒè¿›åˆ¶10000ï¼Œlen-1æ˜¯01111ï¼Œå¦‚æžœå¾—åˆ°çš„hashå°äºŽ16æ—¶ï¼Œæ¯”å¦‚æ˜¯3å§ï¼Œè¿›è¡Œ&amp;è¿ç®—01111&amp;00011å¾—åˆ°çš„ç»“æžœæ˜¯3ï¼Œä¹Ÿå°±æ˜¯æœ¬èº«ã€‚ç¡®å®žç­‰ä»·äºŽ3%16ï¼Œå†æ¯”å¦‚å¤§äºŽ16ï¼Œæ˜¯19å§ï¼Œå†å¤§ä¹Ÿæ˜¯ä¸€ä¸ªæ„æ€ï¼Œä¹Ÿå°±æ˜¯01111&amp;10011å¾—åˆ°çš„ç»“æžœæ˜¯3ï¼Œç­‰ä»·äºŽ19%16ï¼Œå³æ•°ç¬¬5ä½ä»¥ä¸Šçš„1éƒ½è¢«è¿‡æ»¤æŽ‰äº†ï¼Œè¯´è¿™ä¹ˆå¤šåªæ˜¯è§£é‡Šä¸€ä¸‹ç¡®å®žhash&amp;len-1ç­‰ä»·äºŽhash%lenï¼Œä½†æ˜¯ä½¿ç”¨ä½è¿ç®—æ•ˆçŽ‡ä¼šå¤§å¤§æé«˜ï¼Œåœ¨æºç ä¸­ä½è¿ç®—éšå¤„å¯è§ã€‚ps:æˆ‘æ€»è§‰çš„è¿˜æœ‰åˆ«çš„ä½œç”¨ï¼Œä½†æ˜¯æ²¡æœ‰äº†è§£åˆ°ã€‚]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>SourceCode</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ListView Adapter 1]]></title>
    <url>%2Farticle%2F4287006971%2F</url>
    <content type="text"><![CDATA[å‰è¨€ ä»‹ç»ä¸€ä¸‹é€‚é…å™¨çš„æŠ½è±¡ï¼Œåœ¨æˆ‘ä»¬åšé¡¹ç›®çš„æ—¶å€™ä¼šæœ‰å¾ˆå¤šå¾ˆå¤šåœ°æ–¹ä½¿ç”¨ListViewï¼Œä¹Ÿå°±æ„å‘³ç€éœ€è¦å†™å¾ˆå¤šå¾ˆå¤šçš„é€‚é…å™¨ï¼Œå½“æˆ‘ä»¬å†™çš„é¡¹ç›®å¾ˆå¤§æ—¶å°±ä¼šå¾ˆçƒ¦å¾ˆçƒ¦ï¼Œæ¯æ¬¡éƒ½è¦å†™åŒæ ·çš„ä»£ç ç‰‡å®žçŽ°ç±»ä¼¼çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æœ‰å¿…è¦å¯¹ä¼ ç»Ÿçš„é€‚é…å™¨æŠ½è±¡ä¸€ä¸‹ã€‚ ä¼ ç»Ÿé€‚é…å™¨çš„ä¼˜åŒ–å†™æ³• æ ¸å¿ƒä»£ç å°±æ˜¯getVIew()æ–¹æ³•ï¼Œåœ¨é‡Œé¢æˆ‘ä»¬è¿›è¡ŒItemçš„å¤ç”¨ï¼Œè€Œç›¸å¯¹äºŽå…¶ä»–æ–¹æ³•å°±ä¼šæ˜¾å¾—å¾ˆå¤šä½™ï¼Œå› ä¸ºæ¯ä¸ªé€‚é…å™¨éƒ½åœ¨é‡å¤ç›¸åŒçš„ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364public class FirstpageGridAdapter extends BaseAdapter &#123; /* gridviewæ•°æ® */ private String[] choices = new String[] &#123; &quot;æ–°æˆ¿&quot;, &quot;äºŒæ‰‹æˆ¿&quot;, &quot;ç§Ÿæˆ¿&quot;, &quot;èµ„è®¯&quot;, &quot;æ‰“æŠ˜ä¼˜æƒ &quot;, &quot;æœ€æ–°å¼€ç›˜&quot;, &quot;æˆ¿è´·è®¡ç®—&quot;, &quot;æ›´å¤š&quot; &#125;; private int[] images = new int[] &#123; R.drawable.selector_xinfang, R.drawable.selector_ershou, R.drawable.selector_zufang, R.drawable.selector_zixun, R.drawable.selector_youhui, R.drawable.selector_kaipan, R.drawable.selector_calculator, R.drawable.selector_more &#125;; private LayoutInflater layoutInflater; private onClickChildIbListener listener; public FirstpageGridAdapter(Context context, onClickChildIbListener listener) &#123; super(); this.layoutInflater = LayoutInflater.from(context); this.listener = listener; &#125; public interface onClickChildIbListener &#123; public void clickChild(int pos,View view); &#125; public int getCount() &#123; return choices.length; &#125; public Object getItem(int position) &#123; return choices[position]; &#125; public long getItemId(int position) &#123; return position; &#125; public View getView(int position, View convertView, ViewGroup parent) &#123; ViewHolder holder = null; if (convertView == null) &#123; holder = new ViewHolder(); convertView = layoutInflater.inflate(R.layout.item_main_grid, parent, false); holder.ib = (ImageButton) convertView .findViewById(R.id.item_main_grid_ib); holder.tv = (TextView) convertView .findViewById(R.id.item_main_grid_tv); convertView.setTag(holder); &#125; else &#123; holder = (ViewHolder) convertView.getTag(); &#125; holder.ib.setBackgroundResource(images[position]); holder.tv.setText(choices[position]); final int pos = position; holder.ib.setOnClickListener(new OnClickListener() &#123; public void onClick(View v) &#123; listener.clickChild(pos,v); &#125; &#125;); return convertView; &#125; private class ViewHolder &#123; ImageButton ib; TextView tv; &#125;&#125; æŠ½è±¡ViewHolder æˆ‘ä»¬å¯ä»¥åˆ†æžä¸€ä¸‹ViewHolderç±»ï¼Œå®ƒç»´æŠ¤ä¸€ä¸ªItemçš„ä¸€ç»„UIç»„ä»¶ï¼Œå¦‚æžœæˆ‘ä»¬è¦ä½¿ç”¨ä½¿ç”¨é€šç”¨çš„ViewHolderå°±ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œä½ ä¸çŸ¥é“ä¸åŒçš„å¸ƒå±€æœ‰ä»€ä¹ˆç»„ä»¶åœ¨é‡Œé¢ï¼Œå¦‚ä½•ç»´æŠ¤ä¸€ç»„UIå‘¢ï¼Œæ•°ç»„ï¼Ÿé“¾è¡¨ï¼Ÿæˆ–è€…Map?å½“æŸ¥æ‰¾Viewæ—¶æˆ‘ä»¬ä½¿ç”¨idæ¥è¿›è¡ŒæŸ¥æ‰¾ï¼Œé‚£ä¹ˆæƒ³åœ¨ViewHolderä¸­æŸ¥æ‰¾Viewå°±éœ€è¦ä½¿ç”¨idä½œä¸ºé”®ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨SparseArrayï¼Œä¹Ÿå°±æ˜¯ç¨€ç–æ•°ç»„ï¼Œä»€ä¹ˆæ˜¯ç¨€ç–æ•°ç»„ï¼Œä½¿ç”¨idï¼ˆå¤§æ•´æ•°ï¼‰ä½œä¸ºé”®å€¼å­˜å‚¨æ•°æ®ä¼šé€ æˆå¤§å¤šæ•°çš„æœªè¢«ä½¿ç”¨ï¼Œå¦‚æžœä½¿ç”¨ä¸€èˆ¬çš„è¡¨å­˜å‚¨ä¼šé€ æˆå¾ˆå¤§çš„æµªè´¹ï¼Œç¨€ç–æ•°ç»„å¯¹æ•°ç»„è¿›è¡Œäº†åŽ‹ç¼©ï¼ŒèŠ‚çº¦äº†å¾ˆå¤§ç©ºé—´ï¼Œè¯¦è§è¿™é‡Œ 1private SparseArray&lt;View&gt; cacheViews; ä½¿ç”¨ç¨€ç–æ•°ç»„å­˜å‚¨UIæŽ§ä»¶ä»¥åŽæˆ‘ä»¬éœ€è¦ä¸€ä¸ªèŽ·å–UIæŽ§ä»¶çš„æ–¹æ³•ï¼Œæ–¹æ³•å¾ˆæ¸…æ™°çš„ï¼ŒitemViewæ˜¯ä¼ é€’è¿›æ¥çš„çˆ¶æŽ§ä»¶ï¼Œå°±æ˜¯convertViewä»Žä¸­æ ¹æ®idèŽ·å–æŽ§ä»¶ 1234567891011@Override public View getView(int resId) &#123; View v = cacheViews.get(resId); if (v == null) &#123; v = itemView.findViewById(resId); if (v != null) &#123; cacheViews.put(resId, v); &#125; &#125; return v; &#125; ViewHolderå®Œæ•´ä»£ç ï¼Œè¿™é‡Œä¼ å…¥äº†ä¸€ä¸ªviewCount,ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå°±åƒArrayListä¸€æ ·ï¼Œä¸å®šä¹‰ç©ºé—´å¤§å°æ—¶åˆå§‹å®¹é‡16ï¼Œè¶…å‡ºç©ºé—´å¤§å°æ—¶æ¯æ¬¡å¢žåŠ 25ï¼Œä½†å°±æ˜¯åˆå§‹å®¹é‡çš„16å¯¹äºŽæˆ‘ä»¬æ¥è¯´å·²ç»æ˜¯æµªè´¹äº†ï¼Œä¸€ä¸ªItemä¸å¯èƒ½æœ‰16ä¸ªæŽ§ä»¶é‚£ä¹ˆå¤šã€‚æŒ‡å®šå¤§å°æé«˜å†…å­˜ä½¿ç”¨ã€‚ 12345678910111213141516171819202122232425262728293031/** * * @author chendong * ç”¨æ¥å®žçŽ°å¤ç”¨åŠ è½½çš„å•ç±»åž‹ViewHolder * */ public static class SingleViewHolder&#123; /** * ä½¿ç”¨SparseArray */ private SparseArray&lt;View&gt; cacheViews; private View itemView; public SingleViewHolder(View itemView, int viewCount) &#123; super(); this.itemView = itemView; cacheViews = new SparseArray&lt;View&gt;(viewCount); &#125; @Override public View getView(int resId) &#123; View v = cacheViews.get(resId); if (v == null) &#123; v = itemView.findViewById(resId); if (v != null) &#123; cacheViews.put(resId, v); &#125; &#125; return v; &#125; &#125; æŠ½è±¡é€‚é…å™¨ ä¼ ç»Ÿçš„é€‚é…å™¨æœ‰å¤ªå¤šçš„é‡å¤ä»£ç éœ€è¦ç¼–å†™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé‡å¤çš„ä»£ç åœ¨çˆ¶ç±»ä¸­ç¼–å†™å¥½ï¼Œä½¿å¾—å­ç±»å¯ä»¥ç›´æŽ¥å¤ç”¨ï¼Œï¼ä½¿ç”¨æŠ½è±¡çˆ¶ç±» çˆ¶ç±»çš„getView()æ–¹æ³•ä¸­ä½¿ç”¨äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½¿ç”¨äº†ä¸€ä¸ªè®¾è®¡æ¨¡å¼æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†æ–¹æ³•çš„å®žçŽ°æŽ¨è¿Ÿåˆ°äº†å­ç±»ä¸­ æ³›åž‹ï¼Œä¼ é€’çš„æ•°æ®ç±»åž‹æ˜¯ä¸ç¡®å®šçš„ï¼Œä½¿ç”¨æ³›åž‹å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ³›åž‹çš„ä½¿ç”¨ä¸äº†è§£çš„å»ºè®®æœä¸€ä¸‹ï¼ŒåŽé¢æ·±å…¥çš„ä»‹ç»ä¼šä½¿ç”¨æ›´å¤æ‚çš„æ³›åž‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576/** 1. æŠ½è±¡é€‚é…å™¨ï¼Œä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†è®¾ç½®itemæ˜¾ç¤ºå†…å®¹çš„éƒ¨åˆ†æŠ½è±¡åˆ°äº†ç±»å¤– è¿™æ˜¯å•ç±»åž‹çš„æŠ½è±¡é€‚é… 2. 3. @author chendong 4. 5. @param &lt;T&gt; 6. æ³›åž‹ */public abstract class SingleEasyAdapter&lt;T&gt; extends BaseAdapter &#123; private LayoutInflater layoutInflater; private int resId; private List&lt;T&gt; datas; private int viewCount = 5; /** * @param context * ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå»ºè®®ä½¿ç”¨getApplicationContext(); * @param resId * itemå¸ƒå±€id * @param datas * æ•°æ®é›† * @param viewCount * itemä¸­çš„viewä¸ªæ•°ï¼Œç”¨æ¥ä¼˜åŒ–SparseArray&lt;View&gt; */ public SingleEasyAdapter(Context context, int resId, List&lt;T&gt; datas, int viewCount) &#123; super(); this.layoutInflater = LayoutInflater.from(context); this.resId = resId; this.datas = datas; this.viewCount = viewCount; &#125; public int getCount() &#123; return datas.size(); &#125; public Object getItem(int position) &#123; return datas.get(position); &#125; public long getItemId(int position) &#123; return position; &#125; public View getView(int position, View convertView, ViewGroup parent) &#123; ViewHolder holder = null; if (convertView == null) &#123; convertView = layoutInflater.inflate(resId, parent, false); holder = new ViewHolder(convertView, viewCount); convertView.setTag(holder); //åœ¨è¿™é‡Œç»‘å®šç›‘å¬ï¼Œé¿å…é‡å¤ç»‘å®šã€‚ bindListener4View(holder, datas.get(position), position); &#125; else &#123; holder = (ViewHolder) convertView.getTag(); &#125; bindData4View(holder, datas.get(position), position); return convertView; &#125; /** * ç»‘å®šæ•°æ® * * @param holder * @param data */ public abstract void bindData4View(ViewHolder holder, T data, int pos); /** * ç»‘å®šç›‘å¬ * * @param holder * @param pos */ public abstract void bindListener4View(ViewHolder holder, T data, int pos); &#125; å®Œæ•´ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * æŠ½è±¡é€‚é…å™¨ï¼Œä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†è®¾ç½®itemæ˜¾ç¤ºå†…å®¹çš„éƒ¨åˆ†æŠ½è±¡åˆ°äº†ç±»å¤– è¿™æ˜¯å•ç±»åž‹çš„æŠ½è±¡é€‚é… * * @param &lt;T&gt; æ³›åž‹ * @author chendong */public abstract class SingleEasyAdapter&lt;T&gt; extends BaseAdapter &#123; private LayoutInflater layoutInflater; private int resId; private List&lt;T&gt; datas; private int viewCount = 5; private Context context; /** * @param context ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå»ºè®®ä½¿ç”¨getApplicationContext(); * @param resId itemå¸ƒå±€id * @param datas æ•°æ®é›† * @param viewCount itemä¸­çš„viewä¸ªæ•°ï¼Œç”¨æ¥ä¼˜åŒ–SparseArray&lt;View&gt; */ public SingleEasyAdapter(Context context, int resId, List&lt;T&gt; datas, int viewCount) &#123; super(); this.layoutInflater = LayoutInflater.from(context); this.resId = resId; this.datas = datas; this.viewCount = viewCount; this.context = context; &#125; public Context getContext() &#123; return this.context; &#125; public List&lt;T&gt; getData() &#123; return datas; &#125; public void swapData(List&lt;T&gt; datas) &#123; this.datas = datas; notifyDataSetChanged(); &#125; public int getCount() &#123; return datas.size(); &#125; public Object getItem(int position) &#123; return datas.get(position); &#125; public long getItemId(int position) &#123; return position; &#125; public View getView(int position, View convertView, ViewGroup parent) &#123; ViewHolder holder = null; if (convertView == null) &#123; convertView = layoutInflater.inflate(resId, parent, false); holder = new ViewHolder(convertView, viewCount); convertView.setTag(holder); //åœ¨è¿™é‡Œç»‘å®šç›‘å¬ bindListener4View(holder, datas.get(position), position); &#125; else &#123; holder = (ViewHolder) convertView.getTag(); &#125; bindData4View(holder, datas.get(position), position); return convertView; &#125; /** * ç»‘å®šæ•°æ® * * @param holder * @param data */ public abstract void bindData4View(ViewHolder holder, T data, int pos); /** * ç»‘å®šç›‘å¬ * * @param holder * @param pos */ public abstract void bindListener4View(ViewHolder holder, T data, int pos);&#125; æµ‹è¯•123456789101112131415161718192021222324listview = (ListView) findViewById(R.id.listview); list = new ArrayList&lt;Student&gt;(); for (int i = 0; i &lt; 20; i++) &#123; if (i % 5 == 0) list.add(new Student(&quot;name&quot; + i, &quot;age&quot; + i, &quot;sex&quot;, 3)); else list.add(new Student(&quot;name&quot; + i, &quot;age&quot; + i, &quot;sex&quot;, i % 2 == 0 ? 1 : 2)); &#125; listview.setAdapter(new SingleEasyAdapter&lt;Student&gt;( getApplicationContext(), R.layout.item_type1, list, 4) &#123; @Override public void bindData4View(SingleViewHolder holder, Student dataï¼Œint pos) &#123; ((TextView)holder.getView(R.id.tv_name)).setText(data.getName()); //æ­¤å¤„çœç•¥è‹¥å¹²ä»£ç  &#125;@Override public void bindListener4View(SingleViewHolder holder, Student dataï¼Œint pos) &#123; //æ­¤å¤„çœç•¥è‹¥å¹²ä»£ç  &#125; &#125;); æ•ˆæžœ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªç”¨äº†å¾ˆå°‘çš„ä»£ç å°±å®Œæˆäº†åŠŸèƒ½ï¼Œè€Œä¸”å¾ˆæ¸…æ™°ï¼Œç®€å•åœ°é€‚é…ä¸éœ€è¦åˆ›å»ºé€‚é…å™¨ç±»äº†ï¼Œä½¿ç”¨åŒ¿åçš„ä¹Ÿå¾ˆå¿«å°±å¯ä»¥å®žçŽ°ã€‚æ¼”ç¤ºæœ‰ç‚¹ä¸‘ï¼ŒåŸºæœ¬éƒ½å®žçŽ°äº†ã€‚ æ€»ç»“ å°†é€‚é…å™¨æŠ½è±¡å‡ºæ¥ä½œä¸ºä¸€ä¸ªç±»åº“ï¼Œå†ä½¿ç”¨çš„æ—¶å€™å°±ä¼šç®€å•å¾ˆå¤šå¾ˆå¤šï¼Œå½“ç„¶å¦‚æžœä½ çš„é€‚é…å™¨æ•°æ®å¾ˆå¤æ‚ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ç»§æ‰¿æŠ½è±¡çˆ¶ç±»ç”Ÿæˆè‡ªå·±çš„ç±»ã€‚!]]></content>
      <categories>
        <category>Android</category>
        <category>Adapter</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>ListView</tag>
        <tag>Adapter</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RecyclerView]]></title>
    <url>%2Farticle%2F2021227864%2F</url>
    <content type="text"><![CDATA[RecycerView æ˜¯ç±»ä¼¼äºŽ ListView å’Œ GridView çš„æŽ§ä»¶ï¼Œå¯ä»¥ä½¿ç”¨åˆ—è¡¨çš„å½¢å¼å±•ç¤ºæ•°æ®ï¼Œä½¿ç”¨ä¸åŒçš„ LayoutManager æ¥å®žçŽ°å•åˆ—ï¼Œç½‘æ ¼ï¼Œç€‘å¸ƒæµç­‰å±•ç¤ºæ•ˆæžœã€‚ç›¸æ¯”åŽŸæ¥çš„åˆ—è¡¨æŽ§ä»¶è¦å¼ºå¤§çš„å¤šã€‚ LayoutManager åœ¨ä»£ç ä¸­è®¾ç½®LayoutManagerï¼Œéœ€è¦åœ¨è®¾ç½®adapterä¹‹å‰è®¾ç½®LayoutManager 12345678RecyclerView.LayoutManager layoutManager = null;//çº¿æ€§å¸ƒå±€ï¼Œç¬¬äºŒä¸ªå‚æ•°æ”¯æŒæ°´å¹³åž‚ç›´ä¸¤ç§æ–¹å‘ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ç”¨æ¥è®¾ç½®æ˜¯å¦åå‘æ˜¾ç¤ºlayoutManager = new LinearLayoutManager(this, LinearLayoutManager.HORIZONTAL, false);//ç½‘æ ¼å¸ƒå±€ï¼Œç¬¬äºŒä¸ªå‚æ•°è®¾ç½®åˆ—æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ”¯æŒæ°´å¹³åž‚ç›´ä¸¤ç§æ–¹å‘ï¼Œç¬¬å››ä¸ªå‚æ•°ç”¨æ¥è®¾ç½®æ˜¯å¦åå‘æ˜¾ç¤ºlayoutManager = new GridLayoutManager(this,3,GridLayoutManager.HORIZONTAL,false);//ç€‘å¸ƒæµå¸ƒå±€ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®åˆ—æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ”¯æŒæ°´å¹³åž‚ç›´ä¸¤ç§æ–¹å‘ layoutManager = new StaggeredGridLayoutManager(3,StaggeredGridLayoutManager.VERTICAL);recyclerView.setLayoutManager(layoutManager); ViewHolder ç»§æ‰¿Recycler.ViewHolderå®žçŽ°è‡ªå®šä¹‰ViewHolder 1234567891011121314151617//è¿™é‡Œåªæ˜¯å®žçŽ°ç®€å•çš„åŠŸèƒ½ï¼Œæ—¨åœ¨ä»‹ç»äº†è§£RecyclerViewçš„ä½¿ç”¨ã€‚//éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒRecyclerViewå¹¶æ²¡æœ‰å®žçŽ°OnItemClickListeneräº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ— æ³•ç›´æŽ¥èŽ·å¾—Itemçš„ç‚¹å‡»äº‹ä»¶ã€‚//é‡‡ç”¨çš„æ–¹æ³•æ˜¯åœ¨æœ€å¤–å±‚çš„çˆ¶å¸ƒå±€æ·»åŠ ç‚¹å‡»äº‹ä»¶æ¥æ¨¡æ‹ŸItemç‚¹å‡»ã€‚//getAdapterPosition();å‡½æ•°èŽ·å–å½“å‰Itemåœ¨Adapterä¸­çš„ä½ç½®//getLayoutPosition());å‡½æ•°èŽ·å¾—å½“å‰Itemåœ¨å¸ƒå±€ä¸­çš„ä½ç½®class CustomViewHolder extends RecyclerView.ViewHolder &#123; TextView tv; public CustomViewHolder (View itemView) &#123; super(itemView); tv = (TextView) itemView.findViewById(R.id.test_tv); itemView.setOnClickListener(new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; Log.i("chendong", "ç‚¹å‡»äº†item" + getAdapterPosition() + " layout --"+getLayoutPosition()); &#125; &#125;); &#125; &#125; Adapter ç»§æ‰¿Recycler.Adapterå®žçŽ°é€‚é…å™¨ 123456789101112131415161718192021222324252627282930class ContentAdapter extends RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt; &#123; public ContentAdapter() &#123; //åœ¨è¿™é‡ŒèŽ·å¾—éœ€è¦çš„å‚æ•° &#125; @Override public int getItemViewType(int position) &#123; //èŽ·å–æ•°æ®çš„ç±»åž‹ï¼Œç”¨äºŽå¤šç±»åž‹é€‚é… &#125; @Override public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup parent, int viewType) &#123; //èŽ·å–å¯¹åº”ç±»åž‹çš„ViewHolder,åŠ è½½ä¸åŒçš„å¸ƒå±€ï¼Œç±»ä¼¼ListViewä¸­getViewï¼ˆï¼‰çš„ä»£ç ï¼Œç¤ºä¾‹ä»£ç ï¼š View view = getLayoutInflater().inflate(R.layout.test, parent, false); return new CustomViewHolder(view); &#125; @Override public void onBindViewHolder(RecyclerView.ViewHolder holder, int position) &#123; //å‘ViewHolderä¸­çš„æŽ§ä»¶ç»‘å®šæ•°æ®,è¿™é‡Œç”¨çš„æ˜¯å¼ºè½¬ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³›åž‹ç›´æŽ¥ç”ŸæˆCustomViewHolderï¼Œä½†æ˜¯å¤šç±»åž‹é€‚é…æ—¶è¿˜æ˜¯éœ€è¦å¼ºè½¬ã€‚ CustomViewHolder temp = (CustomViewHolder)holder; holder.tv.setText("a"); &#125; @Override public int getItemCount() &#123; //èŽ·å–Itemä¸ªæ•° return 0; &#125; &#125; æ•°æ®æ›´æ–°1234567891011121314151617//ç±»ä¼¼ListViewçš„æ•°æ®æ›´æ–°ï¼Œä½†æ˜¯å¼€æ”¾äº†æ›´å¤šæ–¹æ³•ï¼Œç”±äºŽRecyclerViewç»§æ‰¿è‡ªViewGroupï¼Œå¯ä»¥è½»æ¾å®žçŽ°å¯¹å…¶ä¸­æ¯ä¸€ä¸ªæŽ§ä»¶çš„æ“ä½œï¼Œè€Œä¸ç”¨æ›´æ–°æ•´ä¸ªåˆ—è¡¨ã€‚//èˆ’å¿ƒåˆ—è¡¨adapter.notifyDataSetChanged();//åˆ é™¤æŸä¸€ä½ç½®çš„Itemadapter.notifyItemRemoved(0);//ä¿®æ”¹æŸä¸€ä½ç½®çš„Itemadapter.notifyItemChanged(0);//å‘æŸä¸€ä½ç½®æŽºå…¥Itemadapter.notifyItemInserted(0);//å°†pos1çš„Itemç§»åŠ¨åˆ°pos2adapter.notifyItemMoved(0,1);//é€šçŸ¥éƒ¨åˆ†Itemæ”¹å˜adapter.notifyItemRangeChanged(0,4);//å‘0-4çš„ä½ç½®æ’å…¥æ•°æ®adapter.notifyItemRangeInserted(0,4);//ç§»é™¤0-4çš„æ•°æ®adapter.notifyItemRangeRemoved(0,4); åˆ†å‰²çº¿ RecyclerViewæä¾›äº†æ’å…¥åˆ†éš”çº¿çš„æ–¹æ³•ï¼Œä½†æ˜¯æ˜¯ä¸ªæŠ½è±¡ç±»ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±é‡å†™ï¼Œå¹¶ä¸”æ²¡æœ‰å®žçŽ°å¥½çš„é»˜è®¤åˆ†éš”çº¿ã€‚1234567891011121314151617recyclerView.addItemDecoration(new RecyclerView.ItemDecoration() &#123;//onDrawæ–¹æ³•å…ˆäºŽç»˜åˆ¶Item @Override public void onDraw(Canvas c, RecyclerView parent, RecyclerView.State state) &#123; super.onDraw(c, parent, state); &#125;//onDrawOveråœ¨ç»˜åˆ¶Itemä¹‹åŽï¼Œä¸€èˆ¬æˆ‘ä»¬é€‰æ‹©å¤å†™å…¶ä¸­ä¸€ä¸ªå³å¯ã€‚ @Override public void onDrawOver(Canvas c, RecyclerView parent, RecyclerView.State state) &#123; super.onDrawOver(c, parent, state); &#125;//getItemOffsets å¯ä»¥é€šè¿‡outRect.set()ä¸ºæ¯ä¸ªItemè®¾ç½®ä¸€å®šçš„åç§»é‡ï¼Œä¸»è¦ç”¨äºŽç»˜åˆ¶ @Override public void getItemOffsets(Rect outRect, View view, RecyclerView parent, RecyclerView.State state) &#123; super.getItemOffsets(outRect, view, parent, state); &#125; &#125;); åŠ¨ç”»æ•ˆæžœ RecyclerViewä¸ºæ•°æ®çš„æ›´æ–°å¢žåŠ äº†åŠ¨ç”»æ•ˆæžœ,å¹¶ä¸”æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„åŠ¨ç”»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®žçŽ°ItemAnimatorå®žçŽ°è‡ªå·±çš„åŠ¨ç”»æ•ˆæžœã€‚ 1recyclerView.setItemAnimator(new DefaultItemAnimator()); æ€»ç»“ RecyclerViewé‡‡ç”¨æ’æ‹”å¼çš„æ•°æ®å¡«å……ï¼Œæä¾›äº†æ›´åŠ å¼ºå¤§çš„æ˜¾ç¤ºæ•ˆæžœï¼Œå¯ä»¥è½»æ¾å®žçŽ°ï¼Œå„ä¸ªæ–¹å‘çš„ListView,GridView,ç€‘å¸ƒæµæ•ˆæžœï¼Œç®€å•æ–¹ä¾¿ã€‚ä½†åœ¨è¿›è¡Œå¤šç±»åž‹åˆ†ç±»é€‚é…æ—¶éœ€è¦åˆ›å»ºå¤§é‡çš„ViewHolderï¼Œéœ€è¦æˆ‘ä»¬è¿›ä¸€æ­¥å–å°è£…å’Œå®Œå–„ã€‚]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰æŽ§ä»¶â€”ç»§æ‰¿ViewGroup]]></title>
    <url>%2Farticle%2F844112004%2F</url>
    <content type="text"><![CDATA[å‰è¨€ ç»§æ‰¿ViewGroupæ˜¯è‡ªå®šä¹‰æŽ§ä»¶çš„ä¸€èˆ¬æ–¹æ³•ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©éœ€è¦ç»§æ‰¿çš„ViewGroupçš„å­ç±»ï¼Œæœ¬ç« å°†ä½¿ç”¨çº¯ä»£ç æ·»åŠ æŽ§ä»¶,æ–¹å¼ç¡®å®žä¸ç›´è§‚ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥ç»ƒä¹ ä½¿ç”¨ä»£ç æ“ä½œæŽ§ä»¶çš„æ–¹æ³•ï¼Œæ¯•ç«Ÿä¸æ˜¯æ‰€æœ‰çš„ä»£ç éƒ½å¯ä»¥ç”¨xmlæ–‡ä»¶ä»£æ›¿ã€‚ æ¡ˆä¾‹ä»‹ç» è¿™æ¬¡çš„ç›®çš„å®žçŽ°ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„ç»„åˆæŽ§ä»¶ï¼Œå‡ºçŽ°è¿™ç§éœ€æ±‚æ˜¯å› ä¸ºéœ€è¦åœ¨ä¸€ä¸ªListViewä¸­æ·»åŠ ä¸€ä¸ªç±»ä¼¼ListViewçš„éƒ¨åˆ†ï¼Œä½†æ˜¯æ•°é‡å¾ˆå°‘ï¼Œå¯ä»¥ä¸éœ€è¦ä½¿ç”¨ListView,è€Œæ˜¯ä½¿ç”¨åŠ¨æ€æ·»åŠ æŽ§ä»¶çš„æ–¹å¼ã€‚ ä»£ç  å®Œå…¨ä½¿ç”¨ä»£ç æ¥å†™æŽ§ä»¶ï¼Œæ²¡æœ‰xmlå¸ƒå±€ï¼Œè°ƒè¯•çš„æ—¶å€™æ˜¯ä¸ªå¤§é—®é¢˜ï¼Œå†™çš„ä»£ç å¾€å¾€ä¸èƒ½å®žæ—¶çš„æ˜¾ç¤ºåœ¨é¢„è§ˆç•Œé¢ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181public class SpecialItemView extends RelativeLayout &#123; //åˆ†æžè¯¥å¸ƒå±€å®šä¹‰ä»¥ä¸‹ç»„ä»¶ //å›¾ç‰‡ private ImageView imgIcon; //æ ‡é¢˜ private TextView txtTitle; //å­æ ‡é¢˜ private TextView txtSubTitle; //ä¸“è¾‘æ•°é‡ private TextView txtNum; //å³è¾¹æ›´å¤šæŒ‰é’® private ImageButton ibArrow; //ä¸‹æ–¹æ¨ªçº¿ï¼Œå› ä¸ºæœ€åŽä¸€è¡Œæ˜¯ä¸æ˜¾ç¤ºæ¨ªçº¿çš„ private ImageView ivLine; /** * ä»£ç ä¸­newæ—¶ä½¿ç”¨ * * @param context */ public SpecialItemView(Context context) &#123; this(context, null); &#125; /** * åœ¨xmlæ–‡ä»¶ä¸­ä½¿ç”¨ * * @param context * @param attrs */ public SpecialItemView(Context context, AttributeSet attrs) &#123; super(context, attrs); init(context, attrs); &#125; /** * åˆå§‹åŒ– * * @param context * @param attributeSet */ private void init(Context context, AttributeSet attributeSet) &#123; //èŽ·å–å±å¹•å®½åº¦ int width = context.getResources().getDisplayMetrics().widthPixels; //è®¾ç½®å½“å‰æŽ§ä»¶çš„padding this.setPadding(6,10,6,10); //åˆå§‹åŒ–æŽ§ä»¶ imgIcon = new ImageView(context); //LayoutParamså¯¹è±¡ç”¨æ¥æŽ§åˆ¶æŽ§ä»¶åœ¨ViewGroupä¸­æ˜¾ç¤ºçš„æ ·å­ RelativeLayout.LayoutParams layoutParams = new LayoutParams((int) (width*0.2),(int) (width*0.2)); //åž‚ç›´å±…ä¸­ç›¸å½“äºŽlayout_centervertical=true layoutParams.addRule(CENTER_VERTICAL); //é…ç½®æŽ§ä»¶ imgIcon.setScaleType(ImageView.ScaleType.CENTER_CROP); imgIcon.setLayoutParams(layoutParams); //ç›¸å½“äºŽandroid:id imgIcon.setId(R.id.sp_item_icon); imgIcon.setImageResource(R.mipmap.finding_zone_img); //æ·»åŠ æŽ§ä»¶åˆ°ViewGroup addView(imgIcon); //é™¤äº†å¯ä»¥è®¾ç½®ä¸ºå…·ä½“çš„æ•°å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¸¸é‡ï¼Œç›¸å½“äºŽxmlæ–‡ä»¶ä¸­ä½¿ç”¨androidï¼šlayout_width = "wrap_content" layoutParams = new LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT); //å·¦è¾¹margin layoutParams.leftMargin = 20; //ç›¸å½“äºŽandroid:aligntop="R.id.sp_item_icon" layoutParams.addRule(ALIGN_TOP, R.id.sp_item_icon); layoutParams.addRule(RIGHT_OF, R.id.sp_item_icon); //ä»¥ä¸‹æ˜¯textviewçš„è®¾ç½® txtTitle.setText("æ ‡é¢˜"); txtTitle = new TextView(context); txtTitle.setId(R.id.sp_item_title); txtTitle.setTextSize(TypedValue.COMPLEX_UNIT_SP,18); txtTitle.setTextColor(Color.BLACK); txtTitle.setLayoutParams(layoutParams); txtTitle.setSingleLine(); txtTitle.setEllipsize(TextUtils.TruncateAt.END); addView(txtTitle); txtSubTitle = new TextView(context); txtSubTitle.setId(R.id.sp_item_subtitle); layoutParams = new LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT); //todo sp2dp layoutParams.addRule(CENTER_VERTICAL); layoutParams.addRule(ALIGN_LEFT, R.id.sp_item_title); txtSubTitle.setText("å­—æ ‡é¢˜"); //todo sp2dp txtSubTitle.setTextSize(TypedValue.COMPLEX_UNIT_SP, 16); txtSubTitle.setTextColor(Color.GRAY); txtSubTitle.setLayoutParams(layoutParams); txtSubTitle.setPadding(0,0,16,0); txtSubTitle.setSingleLine(); txtSubTitle.setEllipsize(TextUtils.TruncateAt.END); addView(txtSubTitle); txtNum = new TextView(context); txtNum.setId(R.id.sp_item_subtitle); layoutParams = new LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT); //todo sp2dp layoutParams.addRule(ALIGN_LEFT, R.id.sp_item_title); layoutParams.addRule(ALIGN_BOTTOM, R.id.sp_item_icon); txtNum.setText("å…±æœ‰å‡ å¼ ä¸“è¾‘"); //todo sp2dp txtNum.setTextSize(TypedValue.COMPLEX_UNIT_SP, 16); txtNum.setTextColor(Color.GRAY); txtNum.setLayoutParams(layoutParams); txtNum.setSingleLine(); txtNum.setEllipsize(TextUtils.TruncateAt.END); txtNum.setGravity(CENTER_VERTICAL); //å›¾æ ‡å¿…é¡»ç»è¿‡setbounds Drawable leftD = ContextCompat.getDrawable(getContext(), R.mipmap.finding_album_img); leftD.setBounds(0, 0, 20, 0); txtNum.setCompoundDrawablesWithIntrinsicBounds(leftD, null, null, null); txtNum.setId(R.id.sp_item_num); addView(txtNum); ibArrow = new ImageButton(context); ibArrow.setId(R.id.sp_item_subtitle); layoutParams = new LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT); //todo sp2dp layoutParams.addRule(CENTER_VERTICAL); layoutParams.addRule(ALIGN_PARENT_RIGHT); //todo sp2dp layoutParams.rightMargin = 16; ibArrow.setBackgroundResource(R.drawable.selector_more); //todo sp2dp ibArrow.setLayoutParams(layoutParams); addView(ibArrow); ivLine = new ImageView(context); layoutParams = new LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,1); layoutParams.addRule(ALIGN_LEFT,R.id.sp_item_title); layoutParams.addRule(BELOW,R.id.sp_item_num); //todo sp2dp layoutParams.topMargin=10; ivLine.setLayoutParams(layoutParams); ivLine.setBackgroundResource(R.drawable.shape_line); addView(ivLine); &#125; public void setTitle(String txt)&#123; txtTitle.setText(txt==null?"":txt); &#125; public void setSubTitle(String txt)&#123; txtSubTitle.setText(txt==null?"":txt); &#125; public void setNum(String txt)&#123; txtNum.setText(txt==null?"":txt); &#125; public void setShowLine(int xx)&#123; ivLine.setVisibility(xx); &#125; public void setImg(String url)&#123; Picasso.with(getContext()).load(url).into(imgIcon); &#125; public ImageView getImgIcon()&#123; return imgIcon; &#125; public ImageButton getImgArrow()&#123; return ibArrow; &#125; private OnMoreClick onMoreClick; public //ä½¿ç”¨æŽ¥å£å°†ibArrowç‚¹å‡»äº‹ä»¶ä¼ é€’å‡ºåŽ» public interface OnMoreClick&#123; void click(); &#125;&#125; åœ¨xmlæ–‡ä»¶ä¸­ä½¿ç”¨1234&lt;com.march.himalayasfm.app.widgets.SpecialItemView android:layout_width="match_parent" android:layout_height="wrap_content" /&gt;]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CardView]]></title>
    <url>%2Farticle%2F2807458501%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä»‹ç» CardView çš„ç”¨æ³• compile &#39;com.android.support:cardview-v7:21.+ xmlæ–‡ä»¶1234567891011121314&lt;android.support.v7.widget.CardViewandroid:layout_marginTop="20dp" android:layout_width="wrap_content"android:layout_height="wrap_content"app:cardCornerRadius="10dp"app:cardElevation="5dp"app:contentPadding="10dp" app:cardPreventCornerOverlap="true"&gt;&lt;ImageView android:scaleType="centerCrop"android:src="@mipmap/test" android:layout_width="match_parent" android:layout_height="wrap_content"/&gt;&lt;/android.support.v7.widget.CardView&gt; å‡ ä¸ªå±žæ€§å€¼1234567891011121314app:cardElevation=&quot;5dp&quot;//é˜´å½±app:cardElevation é˜´å½±çš„å¤§å°app:cardMaxElevation é˜´å½±æœ€å¤§é«˜åº¦app:cardBackgroundColor å¡ç‰‡çš„èƒŒæ™¯è‰²app:cardCornerRadius å¡ç‰‡çš„åœ†è§’å¤§å°app:contentPadding å¡ç‰‡å†…å®¹äºŽè¾¹è·çš„é—´éš”app:contentPaddingBottomapp:contentPaddingTopapp:contentPaddingLeftapp:contentPaddingRightapp:contentPaddingStartapp:contentPaddingEndapp:cardUseCompatPadding è®¾ç½®å†…è¾¹è·ï¼ŒV21+çš„ç‰ˆæœ¬å’Œä¹‹å‰çš„ç‰ˆæœ¬ä»æ—§å…·æœ‰ä¸€æ ·çš„è®¡ç®—æ–¹å¼app:cardPreventConrerOverlap åœ¨V20å’Œä¹‹å‰çš„ç‰ˆæœ¬ä¸­æ·»åŠ å†…è¾¹è·ï¼Œè¿™ä¸ªå±žæ€§ä¸ºäº†é˜²æ­¢å†…å®¹å’Œè¾¹è§’çš„é‡å ]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ADBå‘½ä»¤å¤§å…¨]]></title>
    <url>%2Farticle%2F4015034291%2F</url>
    <content type="text"><![CDATA[ADBï¼Œå³ Android Debug Bridgeï¼Œå®ƒæ˜¯ Android å¼€å‘/æµ‹è¯•äººå‘˜ä¸å¯æ›¿ä»£çš„å¼ºå¤§å·¥å…·ï¼Œä¹Ÿæ˜¯ Android è®¾å¤‡çŽ©å®¶çš„å¥½çŽ©å…·ã€‚ æŒç»­æ›´æ–°ä¸­ï¼Œæ¬¢è¿Žæ PR å’Œ Issue è¡¥å……æŒ‡æ­£ï¼Œè§‰å¾—æœ‰ç”¨çš„å¯ä»¥å°† æ­¤ GitHub ä»“åº“ Star æ”¶è—å¤‡ç”¨ã€‚ æ³¨ï¼šæœ‰éƒ¨åˆ†å‘½ä»¤çš„æ”¯æŒæƒ…å†µå¯èƒ½ä¸Ž Android ç³»ç»Ÿç‰ˆæœ¬åŠå®šåˆ¶ ROM çš„å®žçŽ°æœ‰å…³ã€‚ åŸºæœ¬ç”¨æ³• å‘½ä»¤è¯­æ³• ä¸ºå‘½ä»¤æŒ‡å®šç›®æ ‡è®¾å¤‡ å¯åŠ¨/åœæ­¢ æŸ¥çœ‹ adb ç‰ˆæœ¬ ä»¥ root æƒé™è¿è¡Œ adbd æŒ‡å®š adb server çš„ç½‘ç»œç«¯å£ è®¾å¤‡è¿žæŽ¥ç®¡ç† æŸ¥è¯¢å·²è¿žæŽ¥è®¾å¤‡/æ¨¡æ‹Ÿå™¨ USB è¿žæŽ¥ æ— çº¿è¿žæŽ¥ï¼ˆéœ€è¦å€ŸåŠ© USB çº¿ï¼‰ æ— çº¿è¿žæŽ¥ï¼ˆæ— éœ€å€ŸåŠ© USB çº¿ï¼‰ åº”ç”¨ç®¡ç† æŸ¥çœ‹åº”ç”¨åˆ—è¡¨ æ‰€æœ‰åº”ç”¨ ç³»ç»Ÿåº”ç”¨ ç¬¬ä¸‰æ–¹åº”ç”¨ åŒ…ååŒ…å«æŸå­—ç¬¦ä¸²çš„åº”ç”¨ å®‰è£… APK å¸è½½åº”ç”¨ æ¸…é™¤åº”ç”¨æ•°æ®ä¸Žç¼“å­˜ æŸ¥çœ‹å‰å° Activity ä¸Žåº”ç”¨äº¤äº’ è°ƒèµ· Activity è°ƒèµ· Service å‘é€å¹¿æ’­ å¼ºåˆ¶åœæ­¢åº”ç”¨ æ–‡ä»¶ç®¡ç† å¤åˆ¶è®¾å¤‡é‡Œçš„æ–‡ä»¶åˆ°ç”µè„‘ å¤åˆ¶ç”µè„‘é‡Œçš„æ–‡ä»¶åˆ°è®¾å¤‡ æ¨¡æ‹ŸæŒ‰é”®/è¾“å…¥ ç”µæºé”® èœå•é”® HOME é”® è¿”å›žé”® éŸ³é‡æŽ§åˆ¶ åª’ä½“æŽ§åˆ¶ ç‚¹äº®/ç†„ç­å±å¹• æ»‘åŠ¨è§£é” è¾“å…¥æ–‡æœ¬ æŸ¥çœ‹æ—¥å¿— Android æ—¥å¿— æŒ‰çº§åˆ«è¿‡æ»¤æ—¥å¿— æŒ‰ tag å’Œçº§åˆ«è¿‡æ»¤æ—¥å¿— æ—¥å¿—æ ¼å¼ æ¸…ç©ºæ—¥å¿— å†…æ ¸æ—¥å¿— æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯ åž‹å· ç”µæ± çŠ¶å†µ å±å¹•åˆ†è¾¨çŽ‡ å±å¹•å¯†åº¦ æ˜¾ç¤ºå±å‚æ•° android_id IMEI Android ç³»ç»Ÿç‰ˆæœ¬ Mac åœ°å€ CPU ä¿¡æ¯ å†…å­˜ä¿¡æ¯ æ›´å¤šç¡¬ä»¶ä¸Žç³»ç»Ÿå±žæ€§ å®žç”¨åŠŸèƒ½ å±å¹•æˆªå›¾ å½•åˆ¶å±å¹• é‡æ–°æŒ‚è½½ system åˆ†åŒºä¸ºå¯å†™ æŸ¥çœ‹è¿žæŽ¥è¿‡çš„ WiFi å¯†ç  è®¾ç½®ç³»ç»Ÿæ—¥æœŸå’Œæ—¶é—´ é‡å¯æ‰‹æœº æ£€æµ‹è®¾å¤‡æ˜¯å¦å·² root ä½¿ç”¨ Monkey è¿›è¡ŒåŽ‹åŠ›æµ‹è¯• å¼€å¯/å…³é—­ WiFi åˆ·æœºç›¸å…³å‘½ä»¤ é‡å¯åˆ° Recovery æ¨¡å¼ ä»Ž Recovery é‡å¯åˆ° Android é‡å¯åˆ° Fastboot æ¨¡å¼ é€šè¿‡ sideload æ›´æ–°ç³»ç»Ÿ æ›´å¤š adb shell å‘½ä»¤ æŸ¥çœ‹è¿›ç¨‹ æŸ¥çœ‹å®žæ—¶èµ„æºå ç”¨æƒ…å†µ å…¶å®ƒ adb çš„éžå®˜æ–¹å®žçŽ° è‡´è°¢ å‚è€ƒé“¾æŽ¥ åŸºæœ¬ç”¨æ³•å‘½ä»¤è¯­æ³•adb å‘½ä»¤çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š 1adb [-d|-e|-s &lt;serialNumber&gt;] &lt;command&gt; å¦‚æžœåªæœ‰ä¸€ä¸ªè®¾å¤‡/æ¨¡æ‹Ÿå™¨è¿žæŽ¥æ—¶ï¼Œå¯ä»¥çœç•¥æŽ‰ [-d|-e|-s &lt;serialNumber&gt;] è¿™ä¸€éƒ¨åˆ†ï¼Œç›´æŽ¥ä½¿ç”¨ adb &lt;command&gt;ã€‚ ä¸ºå‘½ä»¤æŒ‡å®šç›®æ ‡è®¾å¤‡å¦‚æžœæœ‰å¤šä¸ªè®¾å¤‡/æ¨¡æ‹Ÿå™¨è¿žæŽ¥ï¼Œåˆ™éœ€è¦ä¸ºå‘½ä»¤æŒ‡å®šç›®æ ‡è®¾å¤‡ã€‚ å‚æ•° å«ä¹‰ -d æŒ‡å®šå½“å‰å”¯ä¸€é€šè¿‡ USB è¿žæŽ¥çš„ Android è®¾å¤‡ä¸ºå‘½ä»¤ç›®æ ‡ -e æŒ‡å®šå½“å‰å”¯ä¸€è¿è¡Œçš„æ¨¡æ‹Ÿå™¨ä¸ºå‘½ä»¤ç›®æ ‡ -s &lt;serialNumber&gt; æŒ‡å®šç›¸åº” serialNumber å·çš„è®¾å¤‡/æ¨¡æ‹Ÿå™¨ä¸ºå‘½ä»¤ç›®æ ‡ åœ¨å¤šä¸ªè®¾å¤‡/æ¨¡æ‹Ÿå™¨è¿žæŽ¥çš„æƒ…å†µä¸‹è¾ƒå¸¸ç”¨çš„æ˜¯ -s &lt;serialNumber&gt; å‚æ•°ï¼ŒserialNumber å¯ä»¥é€šè¿‡ adb devices å‘½ä»¤èŽ·å–ã€‚å¦‚ï¼š 12345$ adb devicesList of devices attachedcf264b8f deviceemulator-5554 device è¾“å‡ºé‡Œçš„ cf264b8f å’Œ emulator-5554 å³ä¸º serialNumberã€‚æ¯”å¦‚è¿™æ—¶æƒ³æŒ‡å®š cf264b8f è¿™ä¸ªè®¾å¤‡æ¥è¿è¡Œ adb å‘½ä»¤èŽ·å–å±å¹•åˆ†è¾¨çŽ‡ï¼š 1adb -s cf264b8f shell wm size é‡åˆ°å¤šè®¾å¤‡/æ¨¡æ‹Ÿå™¨çš„æƒ…å†µå‡ä½¿ç”¨è¿™å‡ ä¸ªå‚æ•°ä¸ºå‘½ä»¤æŒ‡å®šç›®æ ‡è®¾å¤‡ï¼Œä¸‹æ–‡ä¸­ä¸ºç®€åŒ–æè¿°ï¼Œä¸å†é‡å¤ã€‚ å¯åŠ¨/åœæ­¢å¯åŠ¨ adb server å‘½ä»¤ï¼š 1adb start-server ï¼ˆä¸€èˆ¬æ— éœ€æ‰‹åŠ¨æ‰§è¡Œæ­¤å‘½ä»¤ï¼Œåœ¨è¿è¡Œ adb å‘½ä»¤æ—¶è‹¥å‘çŽ° adb server æ²¡æœ‰å¯åŠ¨ä¼šè‡ªåŠ¨è°ƒèµ·ã€‚ï¼‰ åœæ­¢ adb server å‘½ä»¤ï¼š 1adb kill-server æŸ¥çœ‹ adb ç‰ˆæœ¬å‘½ä»¤ï¼š 1adb version ç¤ºä¾‹è¾“å‡ºï¼š 12Android Debug Bridge version 1.0.36Revision 8f855a3d9b35-android ä»¥ root æƒé™è¿è¡Œ adbdadb çš„è¿è¡ŒåŽŸç†æ˜¯ PC ç«¯çš„ adb server ä¸Žæ‰‹æœºç«¯çš„å®ˆæŠ¤è¿›ç¨‹ adbd å»ºç«‹è¿žæŽ¥ï¼Œç„¶åŽ PC ç«¯çš„ adb client é€šè¿‡ adb server è½¬å‘å‘½ä»¤ï¼Œadbd æŽ¥æ”¶å‘½ä»¤åŽè§£æžè¿è¡Œã€‚ æ‰€ä»¥å¦‚æžœ adbd ä»¥æ™®é€šæƒé™æ‰§è¡Œï¼Œæœ‰äº›éœ€è¦ root æƒé™æ‰èƒ½æ‰§è¡Œçš„å‘½ä»¤æ— æ³•ç›´æŽ¥ç”¨ adb xxx æ‰§è¡Œã€‚è¿™æ—¶å¯ä»¥ adb shell ç„¶åŽ su åŽæ‰§è¡Œå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥è®© adbd ä»¥ root æƒé™æ‰§è¡Œï¼Œè¿™ä¸ªå°±èƒ½éšæ„æ‰§è¡Œé«˜æƒé™å‘½ä»¤äº†ã€‚ å‘½ä»¤ï¼š 1adb root æ­£å¸¸è¾“å‡ºï¼š 1restarting adbd as root çŽ°åœ¨å†è¿è¡Œ adb shellï¼Œçœ‹çœ‹å‘½ä»¤è¡Œæç¤ºç¬¦æ˜¯ä¸æ˜¯å˜æˆ # äº†ï¼Ÿ æœ‰äº›æ‰‹æœº root åŽä¹Ÿæ— æ³•é€šè¿‡ adb root å‘½ä»¤è®© adbd ä»¥ root æƒé™æ‰§è¡Œï¼Œæ¯”å¦‚ä¸‰æ˜Ÿçš„éƒ¨åˆ†æœºåž‹ï¼Œä¼šæç¤º adbd cannot run as root in production buildsï¼Œæ­¤æ—¶å¯ä»¥å…ˆå®‰è£… adbd Insecureï¼Œç„¶åŽ adb root è¯•è¯•ã€‚ ç›¸åº”åœ°ï¼Œå¦‚æžœè¦æ¢å¤ adbd ä¸ºéž root æƒé™çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ adb unroot å‘½ä»¤ã€‚ æŒ‡å®š adb server çš„ç½‘ç»œç«¯å£å‘½ä»¤ï¼š 1adb -P &lt;port&gt; start-server é»˜è®¤ç«¯å£ä¸º 5037ã€‚ è®¾å¤‡è¿žæŽ¥ç®¡ç†æŸ¥è¯¢å·²è¿žæŽ¥è®¾å¤‡/æ¨¡æ‹Ÿå™¨å‘½ä»¤ï¼š 1adb devices è¾“å‡ºç¤ºä¾‹ï¼š 123List of devices attachedcf264b8f deviceemulator-5554 device è¾“å‡ºæ ¼å¼ä¸º [serialNumber] [state]ï¼ŒserialNumber å³æˆ‘ä»¬å¸¸è¯´çš„ SNï¼Œstate æœ‰å¦‚ä¸‹å‡ ç§ï¼š offline â€”â€” è¡¨ç¤ºè®¾å¤‡æœªè¿žæŽ¥æˆåŠŸæˆ–æ— å“åº”ã€‚ device â€”â€” è®¾å¤‡å·²è¿žæŽ¥ã€‚æ³¨æ„è¿™ä¸ªçŠ¶æ€å¹¶ä¸èƒ½æ ‡è¯† Android ç³»ç»Ÿå·²ç»å®Œå…¨å¯åŠ¨å’Œå¯æ“ä½œï¼Œåœ¨è®¾å¤‡å¯åŠ¨è¿‡ç¨‹ä¸­è®¾å¤‡å®žä¾‹å°±å¯è¿žæŽ¥åˆ° adbï¼Œä½†å¯åŠ¨å®Œæ¯•åŽç³»ç»Ÿæ‰å¤„äºŽå¯æ“ä½œçŠ¶æ€ã€‚ no device â€”â€” æ²¡æœ‰è®¾å¤‡/æ¨¡æ‹Ÿå™¨è¿žæŽ¥ã€‚ ä»¥ä¸Šè¾“å‡ºæ˜¾ç¤ºå½“å‰å·²ç»è¿žæŽ¥äº†ä¸¤å°è®¾å¤‡/æ¨¡æ‹Ÿå™¨ï¼Œcf264b8f ä¸Ž emulator-5554 åˆ†åˆ«æ˜¯å®ƒä»¬çš„ SNã€‚ä»Ž emulator-5554 è¿™ä¸ªåå­—å¯ä»¥çœ‹å‡ºå®ƒæ˜¯ä¸€ä¸ª Android æ¨¡æ‹Ÿå™¨ã€‚ å¸¸è§å¼‚å¸¸è¾“å‡ºï¼š æ²¡æœ‰è®¾å¤‡/æ¨¡æ‹Ÿå™¨è¿žæŽ¥æˆåŠŸã€‚ 1List of devices attached è®¾å¤‡/æ¨¡æ‹Ÿå™¨æœªè¿žæŽ¥åˆ° adb æˆ–æ— å“åº”ã€‚ 12List of devices attachedcf264b8f offline USB è¿žæŽ¥é€šè¿‡ USB è¿žæŽ¥æ¥æ­£å¸¸ä½¿ç”¨ adb éœ€è¦ä¿è¯å‡ ç‚¹ï¼š ç¡¬ä»¶çŠ¶æ€æ­£å¸¸ã€‚ åŒ…æ‹¬ Android è®¾å¤‡å¤„äºŽæ­£å¸¸å¼€æœºçŠ¶æ€ï¼ŒUSB è¿žæŽ¥çº¿å’Œå„ç§æŽ¥å£å®Œå¥½ã€‚ Android è®¾å¤‡çš„å¼€å‘è€…é€‰é¡¹å’Œ USB è°ƒè¯•æ¨¡å¼å·²å¼€å¯ã€‚ å¯ä»¥åˆ°ã€Œè®¾ç½®ã€-ã€Œå¼€å‘è€…é€‰é¡¹ã€-ã€ŒAndroid è°ƒè¯•ã€æŸ¥çœ‹ã€‚ å¦‚æžœåœ¨è®¾ç½®é‡Œæ‰¾ä¸åˆ°å¼€å‘è€…é€‰é¡¹ï¼Œé‚£éœ€è¦é€šè¿‡ä¸€ä¸ªå½©è›‹æ¥è®©å®ƒæ˜¾ç¤ºå‡ºæ¥ï¼šåœ¨ã€Œè®¾ç½®ã€-ã€Œå…³äºŽæ‰‹æœºã€è¿žç»­ç‚¹å‡»ã€Œç‰ˆæœ¬å·ã€7 æ¬¡ã€‚ è®¾å¤‡é©±åŠ¨çŠ¶æ€æ­£å¸¸ã€‚ è¿™ä¸€ç‚¹è²Œä¼¼åœ¨ Linux å’Œ Mac OS X ä¸‹ä¸ç”¨æ“å¿ƒï¼Œåœ¨ Windows ä¸‹æœ‰å¯èƒ½é‡åˆ°éœ€è¦å®‰è£…é©±åŠ¨çš„æƒ…å†µï¼Œç¡®è®¤è¿™ä¸€ç‚¹å¯ä»¥å³é”®ã€Œè®¡ç®—æœºã€-ã€Œå±žæ€§ã€ï¼Œåˆ°ã€Œè®¾å¤‡ç®¡ç†å™¨ã€é‡ŒæŸ¥çœ‹ç›¸å…³è®¾å¤‡ä¸Šæ˜¯å¦æœ‰é»„è‰²æ„Ÿå¹å·æˆ–é—®å·ï¼Œå¦‚æžœæ²¡æœ‰å°±è¯´æ˜Žé©±åŠ¨çŠ¶æ€å·²ç»å¥½äº†ã€‚å¦åˆ™å¯ä»¥ä¸‹è½½ä¸€ä¸ªæ‰‹æœºåŠ©æ‰‹ç±»ç¨‹åºæ¥å®‰è£…é©±åŠ¨å…ˆã€‚ é€šè¿‡ USB çº¿è¿žæŽ¥å¥½ç”µè„‘å’Œè®¾å¤‡åŽç¡®è®¤çŠ¶æ€ã€‚ 1adb devices å¦‚æžœèƒ½çœ‹åˆ° 1xxxxxx device è¯´æ˜Žè¿žæŽ¥æˆåŠŸã€‚ æ— çº¿è¿žæŽ¥ï¼ˆéœ€è¦å€ŸåŠ© USB çº¿ï¼‰é™¤äº†å¯ä»¥é€šè¿‡ USB è¿žæŽ¥è®¾å¤‡ä¸Žç”µè„‘æ¥ä½¿ç”¨ adbï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ— çº¿è¿žæŽ¥â€”â€”è™½ç„¶è¿žæŽ¥è¿‡ç¨‹ä¸­ä¹Ÿæœ‰éœ€è¦ä½¿ç”¨ USB çš„æ­¥éª¤ï¼Œä½†æ˜¯è¿žæŽ¥æˆåŠŸä¹‹åŽä½ çš„è®¾å¤‡å°±å¯ä»¥åœ¨ä¸€å®šèŒƒå›´å†…æ‘†è„± USB è¿žæŽ¥çº¿çš„é™åˆ¶å•¦ï¼ æ“ä½œæ­¥éª¤ï¼š å°† Android è®¾å¤‡ä¸Žè¦è¿è¡Œ adb çš„ç”µè„‘è¿žæŽ¥åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œæ¯”å¦‚è¿žåˆ°åŒä¸€ä¸ª WiFiã€‚ å°†è®¾å¤‡ä¸Žç”µè„‘é€šè¿‡ USB çº¿è¿žæŽ¥ã€‚ åº”ç¡®ä¿è¿žæŽ¥æˆåŠŸï¼ˆå¯è¿è¡Œ adb devices çœ‹æ˜¯å¦èƒ½åˆ—å‡ºè¯¥è®¾å¤‡ï¼‰ã€‚ è®©è®¾å¤‡åœ¨ 5555 ç«¯å£ç›‘å¬ TCP/IP è¿žæŽ¥ï¼š 1adb tcpip 5555 æ–­å¼€ USB è¿žæŽ¥ã€‚ æ‰¾åˆ°è®¾å¤‡çš„ IP åœ°å€ã€‚ ä¸€èˆ¬èƒ½åœ¨ã€Œè®¾ç½®ã€-ã€Œå…³äºŽæ‰‹æœºã€-ã€ŒçŠ¶æ€ä¿¡æ¯ã€-ã€ŒIPåœ°å€ã€æ‰¾åˆ°ã€‚ é€šè¿‡ IP åœ°å€è¿žæŽ¥è®¾å¤‡ã€‚ 1adb connect &lt;device-ip-address&gt; è¿™é‡Œçš„ &lt;device-ip-address&gt; å°±æ˜¯ä¸Šä¸€æ­¥ä¸­æ‰¾åˆ°çš„è®¾å¤‡ IP åœ°å€ã€‚ ç¡®è®¤è¿žæŽ¥çŠ¶æ€ã€‚ 1adb devices å¦‚æžœèƒ½çœ‹åˆ° 1&lt;device-ip-address&gt;:5555 device è¯´æ˜Žè¿žæŽ¥æˆåŠŸã€‚ å¦‚æžœè¿žæŽ¥ä¸äº†ï¼Œè¯·ç¡®è®¤ Android è®¾å¤‡ä¸Žç”µè„‘æ˜¯è¿žæŽ¥åˆ°äº†åŒä¸€ä¸ª WiFiï¼Œç„¶åŽå†æ¬¡æ‰§è¡Œ adb connect &lt;device-ip-address&gt; é‚£ä¸€æ­¥ï¼› å¦‚æžœè¿˜æ˜¯ä¸è¡Œçš„è¯ï¼Œé€šè¿‡ adb kill-server é‡æ–°å¯åŠ¨ adb ç„¶åŽä»Žå¤´å†æ¥ä¸€æ¬¡è¯•è¯•ã€‚ æ–­å¼€æ— çº¿è¿žæŽ¥ å‘½ä»¤ï¼š 1adb disconnect &lt;device-ip-address&gt; æ— çº¿è¿žæŽ¥ï¼ˆæ— éœ€å€ŸåŠ© USB çº¿ï¼‰æ³¨ï¼šéœ€è¦ root æƒé™ã€‚ ä¸Šä¸€èŠ‚ã€Œæ— çº¿è¿žæŽ¥ï¼ˆéœ€è¦å€ŸåŠ© USB çº¿ï¼‰ã€æ˜¯å®˜æ–¹æ–‡æ¡£é‡Œä»‹ç»çš„æ–¹æ³•ï¼Œéœ€è¦å€ŸåŠ©äºŽ USB æ•°æ®çº¿æ¥å®žçŽ°æ— çº¿è¿žæŽ¥ã€‚ æ—¢ç„¶æˆ‘ä»¬æƒ³è¦å®žçŽ°æ— çº¿è¿žæŽ¥ï¼Œé‚£èƒ½ä¸èƒ½æ‰€æœ‰æ­¥éª¤ä¸‹æ¥éƒ½æ˜¯æ— çº¿çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯èƒ½çš„ã€‚ åœ¨ Android è®¾å¤‡ä¸Šå®‰è£…ä¸€ä¸ªç»ˆç«¯æ¨¡æ‹Ÿå™¨ã€‚ å·²ç»å®‰è£…è¿‡çš„è®¾å¤‡å¯ä»¥è·³è¿‡æ­¤æ­¥ã€‚æˆ‘ä½¿ç”¨çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ä¸‹è½½åœ°å€æ˜¯ï¼šTerminal Emulator for Android Downloads å°† Android è®¾å¤‡ä¸Žè¦è¿è¡Œ adb çš„ç”µè„‘è¿žæŽ¥åˆ°åŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œæ¯”å¦‚è¿žåˆ°åŒä¸€ä¸ª WiFiã€‚ æ‰“å¼€ Android è®¾å¤‡ä¸Šçš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œåœ¨é‡Œé¢ä¾æ¬¡è¿è¡Œå‘½ä»¤ï¼š 12susetprop service.adb.tcp.port 5555 æ‰¾åˆ° Android è®¾å¤‡çš„ IP åœ°å€ã€‚ ä¸€èˆ¬èƒ½åœ¨ã€Œè®¾ç½®ã€-ã€Œå…³äºŽæ‰‹æœºã€-ã€ŒçŠ¶æ€ä¿¡æ¯ã€-ã€ŒIPåœ°å€ã€æ‰¾åˆ°ã€‚ åœ¨ç”µè„‘ä¸Šé€šè¿‡ adb å’Œ IP åœ°å€è¿žæŽ¥ Android è®¾å¤‡ã€‚ 1adb connect &lt;device-ip-address&gt; è¿™é‡Œçš„ &lt;device-ip-address&gt; å°±æ˜¯ä¸Šä¸€æ­¥ä¸­æ‰¾åˆ°çš„è®¾å¤‡ IP åœ°å€ã€‚ å¦‚æžœèƒ½çœ‹åˆ° connected to &lt;device-ip-address&gt;:5555 è¿™æ ·çš„è¾“å‡ºåˆ™è¡¨ç¤ºè¿žæŽ¥æˆåŠŸã€‚ åº”ç”¨ç®¡ç†æŸ¥çœ‹åº”ç”¨åˆ—è¡¨æŸ¥çœ‹åº”ç”¨åˆ—è¡¨çš„åŸºæœ¬å‘½ä»¤æ ¼å¼æ˜¯ 1adb shell pm list packages [-f] [-d] [-e] [-s] [-3] [-i] [-u] [--user USER_ID] [FILTER] å³åœ¨ adb shell pm list packages çš„åŸºç¡€ä¸Šå¯ä»¥åŠ ä¸€äº›å‚æ•°è¿›è¡Œè¿‡æ»¤æŸ¥çœ‹ä¸åŒçš„åˆ—è¡¨ï¼Œæ”¯æŒçš„è¿‡æ»¤å‚æ•°å¦‚ä¸‹ï¼š å‚æ•° æ˜¾ç¤ºåˆ—è¡¨ æ—  æ‰€æœ‰åº”ç”¨ -f æ˜¾ç¤ºåº”ç”¨å…³è”çš„ apk æ–‡ä»¶ -d åªæ˜¾ç¤º disabled çš„åº”ç”¨ -e åªæ˜¾ç¤º enabled çš„åº”ç”¨ -s åªæ˜¾ç¤ºç³»ç»Ÿåº”ç”¨ -3 åªæ˜¾ç¤ºç¬¬ä¸‰æ–¹åº”ç”¨ -i æ˜¾ç¤ºåº”ç”¨çš„ installer -u åŒ…å«å·²å¸è½½åº”ç”¨ &lt;FILTER&gt; åŒ…ååŒ…å« &lt;FILTER&gt; å­—ç¬¦ä¸² æ‰€æœ‰åº”ç”¨å‘½ä»¤ï¼š 1adb shell pm list packages è¾“å‡ºç¤ºä¾‹ï¼š 12345678910111213package:com.android.smoketestpackage:com.example.android.livecubespackage:com.android.providers.telephonypackage:com.google.android.googlequicksearchboxpackage:com.android.providers.calendarpackage:com.android.providers.mediapackage:com.android.protipspackage:com.android.documentsuipackage:com.android.gallerypackage:com.android.externalstorage...// other packages here... ç³»ç»Ÿåº”ç”¨å‘½ä»¤ï¼š 1adb shell pm list packages -s ç¬¬ä¸‰æ–¹åº”ç”¨å‘½ä»¤ï¼š 1adb shell pm list packages -3 åŒ…ååŒ…å«æŸå­—ç¬¦ä¸²çš„åº”ç”¨æ¯”å¦‚è¦æŸ¥çœ‹åŒ…ååŒ…å«å­—ç¬¦ä¸² mazhuang çš„åº”ç”¨åˆ—è¡¨ï¼Œå‘½ä»¤ï¼š 1adb shell pm list packages mazhuang å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ grep æ¥è¿‡æ»¤ï¼š 1adb shell pm list packages | grep mazhuang å®‰è£… APKå‘½ä»¤æ ¼å¼ï¼š 1adb install [-lrtsdg] &lt;path_to_apk&gt; å‚æ•°ï¼š adb install åŽé¢å¯ä»¥è·Ÿä¸€äº›å¯é€‰å‚æ•°æ¥æŽ§åˆ¶å®‰è£… APK çš„è¡Œä¸ºï¼Œå¯ç”¨å‚æ•°åŠå«ä¹‰å¦‚ä¸‹ï¼š å‚æ•° å«ä¹‰ -l å°†åº”ç”¨å®‰è£…åˆ°ä¿æŠ¤ç›®å½• /mnt/asec -r å…è®¸è¦†ç›–å®‰è£… -t å…è®¸å®‰è£… AndroidManifest.xml é‡Œ application æŒ‡å®š android:testOnly=&quot;true&quot; çš„åº”ç”¨ -s å°†åº”ç”¨å®‰è£…åˆ° sdcard -d å…è®¸é™çº§è¦†ç›–å®‰è£… -g æŽˆäºˆæ‰€æœ‰è¿è¡Œæ—¶æƒé™ è¿è¡Œå‘½ä»¤åŽå¦‚æžœè§åˆ°ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºï¼ˆçŠ¶æ€ä¸º Successï¼‰ä»£è¡¨å®‰è£…æˆåŠŸï¼š 123[100%] /data/local/tmp/1.apk pkg: /data/local/tmp/1.apkSuccess ä¸Šé¢æ˜¯å½“å‰æœ€æ–°ç‰ˆ v1.0.36 çš„ adb çš„è¾“å‡ºï¼Œä¼šæ˜¾ç¤º push apk æ–‡ä»¶åˆ°æ‰‹æœºçš„è¿›åº¦ç™¾åˆ†æ¯”ã€‚ ä½¿ç”¨æ—§ç‰ˆæœ¬ adb çš„è¾“å‡ºåˆ™æ˜¯è¿™æ ·çš„ï¼š 12312040 KB/s (22205609 bytes in 1.801s) pkg: /data/local/tmp/SogouInput_android_v8.3_sweb.apkSuccess è€Œå¦‚æžœçŠ¶æ€ä¸º Failure åˆ™è¡¨ç¤ºå®‰è£…å¤±è´¥ï¼Œæ¯”å¦‚ï¼š 123[100%] /data/local/tmp/map-20160831.apk pkg: /data/local/tmp/map-20160831.apkFailure [INSTALL_FAILED_ALREADY_EXISTS] å¸¸è§å®‰è£…å¤±è´¥è¾“å‡ºä»£ç ã€å«ä¹‰åŠå¯èƒ½çš„è§£å†³åŠžæ³•å¦‚ä¸‹ï¼š è¾“å‡º å«ä¹‰ è§£å†³åŠžæ³• INSTALL_FAILED_ALREADY_EXISTS åº”ç”¨å·²ç»å­˜åœ¨ ä½¿ç”¨ -r å‚æ•° INSTALL_FAILED_INVALID_APK æ— æ•ˆçš„ APK æ–‡ä»¶ INSTALL_FAILED_INVALID_URI æ— æ•ˆçš„ APK æ–‡ä»¶å ç¡®ä¿ APK æ–‡ä»¶åé‡Œæ— ä¸­æ–‡ INSTALL_FAILED_INSUFFICIENT_STORAGE ç©ºé—´ä¸è¶³ æ¸…ç†ç©ºé—´ INSTALL_FAILED_DUPLICATE_PACKAGE å·²ç»å­˜åœ¨åŒåç¨‹åº INSTALL_FAILED_NO_SHARED_USER è¯·æ±‚çš„å…±äº«ç”¨æˆ·ä¸å­˜åœ¨ INSTALL_FAILED_UPDATE_INCOMPATIBLE å·²ç»å®‰è£…è¿‡ç­¾åä¸ä¸€æ ·çš„åŒååº”ç”¨ï¼Œä¸”æ•°æ®æ²¡æœ‰ç§»é™¤ INSTALL_FAILED_SHARED_USER_INCOMPATIBLE è¯·æ±‚çš„å…±äº«ç”¨æˆ·å­˜åœ¨ä½†ç­¾åä¸ä¸€è‡´ INSTALL_FAILED_MISSING_SHARED_LIBRARY å®‰è£…åŒ…ä½¿ç”¨äº†è®¾å¤‡ä¸Šä¸å¯ç”¨çš„å…±äº«åº“ INSTALL_FAILED_REPLACE_COULDNT_DELETE æ›¿æ¢æ—¶æ— æ³•åˆ é™¤ INSTALL_FAILED_DEXOPT dex ä¼˜åŒ–éªŒè¯å¤±è´¥æˆ–ç©ºé—´ä¸è¶³ INSTALL_FAILED_OLDER_SDK è®¾å¤‡ç³»ç»Ÿç‰ˆæœ¬ä½ŽäºŽåº”ç”¨è¦æ±‚ INSTALL_FAILED_CONFLICTING_PROVIDER è®¾å¤‡é‡Œå·²ç»å­˜åœ¨ä¸Žåº”ç”¨é‡ŒåŒåçš„ content provider INSTALL_FAILED_NEWER_SDK è®¾å¤‡ç³»ç»Ÿç‰ˆæœ¬é«˜äºŽåº”ç”¨è¦æ±‚ INSTALL_FAILED_TEST_ONLY åº”ç”¨æ˜¯ test-only çš„ï¼Œä½†å®‰è£…æ—¶æ²¡æœ‰æŒ‡å®š -t å‚æ•° INSTALL_FAILED_CPU_ABI_INCOMPATIBLE åŒ…å«ä¸å…¼å®¹è®¾å¤‡ CPU åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æŽ¥å£çš„ native code INSTALL_FAILED_MISSING_FEATURE åº”ç”¨ä½¿ç”¨äº†è®¾å¤‡ä¸å¯ç”¨çš„åŠŸèƒ½ INSTALL_FAILED_CONTAINER_ERROR sdcard è®¿é—®å¤±è´¥ ç¡®è®¤ sdcard å¯ç”¨ï¼Œæˆ–è€…å®‰è£…åˆ°å†…ç½®å­˜å‚¨ INSTALL_FAILED_INVALID_INSTALL_LOCATION ä¸èƒ½å®‰è£…åˆ°æŒ‡å®šä½ç½® åˆ‡æ¢å®‰è£…ä½ç½®ï¼Œæ·»åŠ æˆ–åˆ é™¤ -s å‚æ•° INSTALL_FAILED_MEDIA_UNAVAILABLE å®‰è£…ä½ç½®ä¸å¯ç”¨ ä¸€èˆ¬ä¸º sdcardï¼Œç¡®è®¤ sdcard å¯ç”¨æˆ–å®‰è£…åˆ°å†…ç½®å­˜å‚¨ INSTALL_FAILED_VERIFICATION_TIMEOUT éªŒè¯å®‰è£…åŒ…è¶…æ—¶ INSTALL_FAILED_VERIFICATION_FAILURE éªŒè¯å®‰è£…åŒ…å¤±è´¥ INSTALL_FAILED_PACKAGE_CHANGED åº”ç”¨ä¸Žè°ƒç”¨ç¨‹åºæœŸæœ›çš„ä¸ä¸€è‡´ INSTALL_FAILED_UID_CHANGED ä»¥å‰å®‰è£…è¿‡è¯¥åº”ç”¨ï¼Œä¸Žæœ¬æ¬¡åˆ†é…çš„ UID ä¸ä¸€è‡´ æ¸…é™¤ä»¥å‰å®‰è£…è¿‡çš„æ®‹ç•™æ–‡ä»¶ INSTALL_FAILED_VERSION_DOWNGRADE å·²ç»å®‰è£…äº†è¯¥åº”ç”¨æ›´é«˜ç‰ˆæœ¬ ä½¿ç”¨ -d å‚æ•° INSTALL_FAILED_PERMISSION_MODEL_DOWNGRADE å·²å®‰è£… target SDK æ”¯æŒè¿è¡Œæ—¶æƒé™çš„åŒååº”ç”¨ï¼Œè¦å®‰è£…çš„ç‰ˆæœ¬ä¸æ”¯æŒè¿è¡Œæ—¶æƒé™ INSTALL_PARSE_FAILED_NOT_APK æŒ‡å®šè·¯å¾„ä¸æ˜¯æ–‡ä»¶ï¼Œæˆ–ä¸æ˜¯ä»¥ .apk ç»“å°¾ INSTALL_PARSE_FAILED_BAD_MANIFEST æ— æ³•è§£æžçš„ AndroidManifest.xml æ–‡ä»¶ INSTALL_PARSE_FAILED_UNEXPECTED_EXCEPTION è§£æžå™¨é‡åˆ°å¼‚å¸¸ INSTALL_PARSE_FAILED_NO_CERTIFICATES å®‰è£…åŒ…æ²¡æœ‰ç­¾å INSTALL_PARSE_FAILED_INCONSISTENT_CERTIFICATES å·²å®‰è£…è¯¥åº”ç”¨ï¼Œä¸”ç­¾åä¸Ž APK æ–‡ä»¶ä¸ä¸€è‡´ å…ˆå¸è½½è®¾å¤‡ä¸Šçš„è¯¥åº”ç”¨ï¼Œå†å®‰è£… INSTALL_PARSE_FAILED_CERTIFICATE_ENCODING è§£æž APK æ–‡ä»¶æ—¶é‡åˆ° CertificateEncodingException INSTALL_PARSE_FAILED_BAD_PACKAGE_NAME manifest æ–‡ä»¶é‡Œæ²¡æœ‰æˆ–è€…ä½¿ç”¨äº†æ— æ•ˆçš„åŒ…å INSTALL_PARSE_FAILED_BAD_SHARED_USER_ID manifest æ–‡ä»¶é‡ŒæŒ‡å®šäº†æ— æ•ˆçš„å…±äº«ç”¨æˆ· ID INSTALL_PARSE_FAILED_MANIFEST_MALFORMED è§£æž manifest æ–‡ä»¶æ—¶é‡åˆ°ç»“æž„æ€§é”™è¯¯ INSTALL_PARSE_FAILED_MANIFEST_EMPTY åœ¨ manifest æ–‡ä»¶é‡Œæ‰¾ä¸åˆ°æ‰¾å¯æ“ä½œæ ‡ç­¾ï¼ˆinstrumentation æˆ– applicationï¼‰ INSTALL_FAILED_INTERNAL_ERROR å› ç³»ç»Ÿé—®é¢˜å®‰è£…å¤±è´¥ INSTALL_FAILED_USER_RESTRICTED ç”¨æˆ·è¢«é™åˆ¶å®‰è£…åº”ç”¨ INSTALL_FAILED_DUPLICATE_PERMISSION åº”ç”¨å°è¯•å®šä¹‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æƒé™åç§° INSTALL_FAILED_NO_MATCHING_ABIS åº”ç”¨åŒ…å«è®¾å¤‡çš„åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æŽ¥å£ä¸æ”¯æŒçš„ native code INSTALL_CANCELED_BY_USER åº”ç”¨å®‰è£…éœ€è¦åœ¨è®¾å¤‡ä¸Šç¡®è®¤ï¼Œä½†æœªæ“ä½œè®¾å¤‡æˆ–ç‚¹äº†å–æ¶ˆ åœ¨è®¾å¤‡ä¸ŠåŒæ„å®‰è£… INSTALL_FAILED_ACWF_INCOMPATIBLE åº”ç”¨ç¨‹åºä¸Žè®¾å¤‡ä¸å…¼å®¹ does not contain AndroidManifest.xml æ— æ•ˆçš„ APK æ–‡ä»¶ is not a valid zip file æ— æ•ˆçš„ APK æ–‡ä»¶ Offline è®¾å¤‡æœªè¿žæŽ¥æˆåŠŸ å…ˆå°†è®¾å¤‡ä¸Ž adb è¿žæŽ¥æˆåŠŸ unauthorized è®¾å¤‡æœªæŽˆæƒå…è®¸è°ƒè¯• error: device not found æ²¡æœ‰è¿žæŽ¥æˆåŠŸçš„è®¾å¤‡ å…ˆå°†è®¾å¤‡ä¸Ž adb è¿žæŽ¥æˆåŠŸ protocol failure è®¾å¤‡å·²æ–­å¼€è¿žæŽ¥ å…ˆå°†è®¾å¤‡ä¸Ž adb è¿žæŽ¥æˆåŠŸ Unknown option: -s Android 2.2 ä»¥ä¸‹ä¸æ”¯æŒå®‰è£…åˆ° sdcard ä¸ä½¿ç”¨ -s å‚æ•° No space left on devicerm ç©ºé—´ä¸è¶³ æ¸…ç†ç©ºé—´ Permission denied â€¦ sdcard â€¦ sdcard ä¸å¯ç”¨ å‚è€ƒï¼šPackageManager.java adb install å†…éƒ¨åŽŸç†ç®€ä»‹ adb install å®žé™…æ˜¯åˆ†ä¸‰æ­¥å®Œæˆï¼š push apk æ–‡ä»¶åˆ° /data/local/tmpã€‚ è°ƒç”¨ pm install å®‰è£…ã€‚ åˆ é™¤ /data/local/tmp ä¸‹çš„å¯¹åº” apk æ–‡ä»¶ã€‚ æ‰€ä»¥ï¼Œå¿…è¦çš„æ—¶å€™ä¹Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªæ­¥éª¤ï¼Œæ‰‹åŠ¨åˆ†æ­¥æ‰§è¡Œå®‰è£…è¿‡ç¨‹ã€‚ å¸è½½åº”ç”¨å‘½ä»¤ï¼š 1adb uninstall [-k] &lt;packagename&gt; &lt;packagename&gt; è¡¨ç¤ºåº”ç”¨çš„åŒ…åï¼Œ-k å‚æ•°å¯é€‰ï¼Œè¡¨ç¤ºå¸è½½åº”ç”¨ä½†ä¿ç•™æ•°æ®å’Œç¼“å­˜ç›®å½•ã€‚ å‘½ä»¤ç¤ºä¾‹ï¼š 1adb uninstall com.qihoo360.mobilesafe è¡¨ç¤ºå¸è½½ 360 æ‰‹æœºå«å£«ã€‚ æ¸…é™¤åº”ç”¨æ•°æ®ä¸Žç¼“å­˜å‘½ä»¤ï¼š 1adb shell pm clear &lt;packagename&gt; &lt;packagename&gt; è¡¨ç¤ºåº”ç”¨ååŒ…ï¼Œè¿™æ¡å‘½ä»¤çš„æ•ˆæžœç›¸å½“äºŽåœ¨è®¾ç½®é‡Œçš„åº”ç”¨ä¿¡æ¯ç•Œé¢ç‚¹å‡»äº†ã€Œæ¸…é™¤ç¼“å­˜ã€å’Œã€Œæ¸…é™¤æ•°æ®ã€ã€‚ å‘½ä»¤ç¤ºä¾‹ï¼š 1adb shell pm clear com.qihoo360.mobilesafe è¡¨ç¤ºæ¸…é™¤ 360 æ‰‹æœºå«å£«çš„æ•°æ®å’Œç¼“å­˜ã€‚ æŸ¥çœ‹å‰å° Activityå‘½ä»¤ï¼š 1adb shell dumpsys activity activities | grep mFocusedActivity è¾“å‡ºç¤ºä¾‹ï¼š 1mFocusedActivity: ActivityRecord&#123;8079d7e u0 com.cyanogenmod.trebuchet/com.android.launcher3.Launcher t42&#125; å…¶ä¸­çš„ com.cyanogenmod.trebuchet/com.android.launcher3.Launcher å°±æ˜¯å½“å‰å¤„äºŽå‰å°çš„ Activityã€‚ ä¸Žåº”ç”¨äº¤äº’ä¸»è¦æ˜¯ä½¿ç”¨ am &lt;command&gt; å‘½ä»¤ï¼Œå¸¸ç”¨çš„ &lt;command&gt; å¦‚ä¸‹ï¼š command ç”¨é€” start [options] &lt;INTENT&gt; å¯åŠ¨ &lt;INTENT&gt; æŒ‡å®šçš„ Activity startservice [options] &lt;INTENT&gt; å¯åŠ¨ &lt;INTENT&gt; æŒ‡å®šçš„ Service broadcast [options] &lt;INTENT&gt; å‘é€ &lt;INTENT&gt; æŒ‡å®šçš„å¹¿æ’­ force-stop &lt;packagename&gt; åœæ­¢ &lt;packagename&gt; ç›¸å…³çš„è¿›ç¨‹ &lt;INTENT&gt; å‚æ•°å¾ˆçµæ´»ï¼Œå’Œå†™ Android ç¨‹åºæ—¶ä»£ç é‡Œçš„ Intent ç›¸å¯¹åº”ã€‚ ç”¨äºŽå†³å®š intent å¯¹è±¡çš„é€‰é¡¹å¦‚ä¸‹ï¼š å‚æ•° å«ä¹‰ -a &lt;ACTION&gt; æŒ‡å®š actionï¼Œæ¯”å¦‚ android.intent.action.VIEW -c &lt;CATEGORY&gt; æŒ‡å®š categoryï¼Œæ¯”å¦‚ android.intent.category.APP_CONTACTS -n &lt;COMPONENT&gt; æŒ‡å®šå®Œæ•´ component åï¼Œç”¨äºŽæ˜Žç¡®æŒ‡å®šå¯åŠ¨å“ªä¸ª Activityï¼Œå¦‚ com.example.app/.ExampleActivity &lt;INTENT&gt; é‡Œè¿˜èƒ½å¸¦æ•°æ®ï¼Œå°±åƒå†™ä»£ç æ—¶çš„ Bundle ä¸€æ ·ï¼š å‚æ•° å«ä¹‰ --esn &lt;EXTRA_KEY&gt; null å€¼ï¼ˆåªæœ‰ key åï¼‰ `-e â€“es ` string å€¼ --ez &lt;EXTRA_KEY&gt; &lt;EXTRA_BOOLEAN_VALUE&gt; boolean å€¼ --ei &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt; integer å€¼ --el &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt; long å€¼ --ef &lt;EXTRA_KEY&gt; &lt;EXTRA_FLOAT_VALUE&gt; float å€¼ --eu &lt;EXTRA_KEY&gt; &lt;EXTRA_URI_VALUE&gt; URI --ecn &lt;EXTRA_KEY&gt; &lt;EXTRA_COMPONENT_NAME_VALUE&gt; component name --eia &lt;EXTRA_KEY&gt; &lt;EXTRA_INT_VALUE&gt;[,&lt;EXTRA_INT_VALUE...] integer æ•°ç»„ --ela &lt;EXTRA_KEY&gt; &lt;EXTRA_LONG_VALUE&gt;[,&lt;EXTRA_LONG_VALUE...] long æ•°ç»„ è°ƒèµ· Activityå‘½ä»¤æ ¼å¼ï¼š 1adb shell am start [options] &lt;INTENT&gt; ä¾‹å¦‚ï¼š 1adb shell am start -n com.tencent.mm/.ui.LauncherUI è¡¨ç¤ºè°ƒèµ·å¾®ä¿¡ä¸»ç•Œé¢ã€‚ 1adb shell am start -n org.mazhuang.boottimemeasure/.MainActivity --es "toast" "hello, world" è¡¨ç¤ºè°ƒèµ· org.mazhuang.boottimemeasure/.MainActivity å¹¶ä¼ ç»™å®ƒ string æ•°æ®é”®å€¼å¯¹ toast - hello, worldã€‚ è°ƒèµ· Serviceå‘½ä»¤æ ¼å¼ï¼š 1adb shell am startservice [options] &lt;INTENT&gt; ä¾‹å¦‚ï¼š 1adb shell am startservice -n com.tencent.mm/.plugin.accountsync.model.AccountAuthenticatorService è¡¨ç¤ºè°ƒèµ·å¾®ä¿¡çš„æŸ Serviceã€‚ å‘é€å¹¿æ’­å‘½ä»¤æ ¼å¼ï¼š 1adb shell am broadcast [options] &lt;INTENT&gt; ä¾‹å¦‚ï¼š 1adb shell am broadcast -a android.intent.action.BOOT_COMPLETED -n org.mazhuang.boottimemeasure/.BootCompletedReceiver è¡¨ç¤ºå‘ org.mazhuang.boottimemeasure/.BootCompletedReceiver å‘é€ä¸€ä¸ª BOOT_COMPLETED å¹¿æ’­ï¼Œè¿™ç±»ç”¨æ³•åœ¨æµ‹è¯•çš„æ—¶å€™å¾ˆå®žç”¨ï¼Œæ¯”å¦‚æŸä¸ªå¹¿æ’­çš„åœºæ™¯å¾ˆéš¾åˆ¶é€ ï¼Œå¯ä»¥è€ƒè™‘é€šè¿‡è¿™ç§æ–¹å¼æ¥å‘é€å¹¿æ’­ã€‚ å¼ºåˆ¶åœæ­¢åº”ç”¨å‘½ä»¤ï¼š 1adb shell am force-stop &lt;packagename&gt; å‘½ä»¤ç¤ºä¾‹ï¼š 1adb shell am force-stop com.qihoo360.mobilesafe è¡¨ç¤ºåœæ­¢ 360 å®‰å…¨å«å£«çš„ä¸€åˆ‡è¿›ç¨‹ä¸ŽæœåŠ¡ã€‚ æ–‡ä»¶ç®¡ç†å¤åˆ¶è®¾å¤‡é‡Œçš„æ–‡ä»¶åˆ°ç”µè„‘å‘½ä»¤ï¼š 1adb pull &lt;è®¾å¤‡é‡Œçš„æ–‡ä»¶è·¯å¾„&gt; [ç”µè„‘ä¸Šçš„ç›®å½•] å…¶ä¸­ ç”µè„‘ä¸Šçš„ç›®å½• å‚æ•°å¯ä»¥çœç•¥ï¼Œé»˜è®¤å¤åˆ¶åˆ°å½“å‰ç›®å½•ã€‚ ä¾‹ï¼š 1adb pull /sdcard/sr.mp4 ~/tmp/ å°æŠ€å·§ï¼šè®¾å¤‡ä¸Šçš„æ–‡ä»¶è·¯å¾„å¯èƒ½éœ€è¦ root æƒé™æ‰èƒ½è®¿é—®ï¼Œå¦‚æžœä½ çš„è®¾å¤‡å·²ç» root è¿‡ï¼Œå¯ä»¥å…ˆä½¿ç”¨ adb shell å’Œ su å‘½ä»¤åœ¨ adb shell é‡ŒèŽ·å– root æƒé™åŽï¼Œå…ˆ cp /path/on/device /sdcard/filename å°†æ–‡ä»¶å¤åˆ¶åˆ° sdcardï¼Œç„¶åŽ adb pull /sdcard/filename /path/on/pcã€‚ å¤åˆ¶ç”µè„‘é‡Œçš„æ–‡ä»¶åˆ°è®¾å¤‡å‘½ä»¤ï¼š 1adb push &lt;ç”µè„‘ä¸Šçš„æ–‡ä»¶è·¯å¾„&gt; &lt;è®¾å¤‡é‡Œçš„ç›®å½•&gt; ä¾‹ï¼š 1adb push ~/sr.mp4 /sdcard/ å°æŠ€å·§ï¼šè®¾å¤‡ä¸Šçš„æ–‡ä»¶è·¯å¾„æ™®é€šæƒé™å¯èƒ½æ— æ³•ç›´æŽ¥å†™å…¥ï¼Œå¦‚æžœä½ çš„è®¾å¤‡å·²ç» root è¿‡ï¼Œå¯ä»¥å…ˆ adb push /path/on/pc /sdcard/filenameï¼Œç„¶åŽ adb shell å’Œ su åœ¨ adb shell é‡ŒèŽ·å– root æƒé™åŽï¼Œcp /sdcard/filename /path/on/deviceã€‚ æ¨¡æ‹ŸæŒ‰é”®/è¾“å…¥åœ¨ adb shell é‡Œæœ‰ä¸ªå¾ˆå®žç”¨çš„å‘½ä»¤å« inputï¼Œé€šè¿‡å®ƒå¯ä»¥åšä¸€äº›æœ‰è¶£çš„äº‹æƒ…ã€‚ input å‘½ä»¤çš„å®Œæ•´ help ä¿¡æ¯å¦‚ä¸‹ï¼š 12345678910111213141516171819202122Usage: input [&lt;source&gt;] &lt;command&gt; [&lt;arg&gt;...]The sources are: mouse keyboard joystick touchnavigation touchpad trackball stylus dpad gesture touchscreen gamepadThe commands and default sources are: text &lt;string&gt; (Default: touchscreen) keyevent [--longpress] &lt;key code number or name&gt; ... (Default: keyboard) tap &lt;x&gt; &lt;y&gt; (Default: touchscreen) swipe &lt;x1&gt; &lt;y1&gt; &lt;x2&gt; &lt;y2&gt; [duration(ms)] (Default: touchscreen) press (Default: trackball) roll &lt;dx&gt; &lt;dy&gt; (Default: trackball) æ¯”å¦‚ä½¿ç”¨ adb shell input keyevent &lt;keycode&gt; å‘½ä»¤ï¼Œä¸åŒçš„ keycode èƒ½å®žçŽ°ä¸åŒçš„åŠŸèƒ½ï¼Œå®Œæ•´çš„ keycode åˆ—è¡¨è¯¦è§ KeyEventï¼Œæ‘˜å¼•éƒ¨åˆ†æˆ‘è§‰å¾—æœ‰æ„æ€çš„å¦‚ä¸‹ï¼š keycode å«ä¹‰ 3 HOME é”® 4 è¿”å›žé”® 5 æ‰“å¼€æ‹¨å·åº”ç”¨ 6 æŒ‚æ–­ç”µè¯ 24 å¢žåŠ éŸ³é‡ 25 é™ä½ŽéŸ³é‡ 26 ç”µæºé”® 27 æ‹ç…§ï¼ˆéœ€è¦åœ¨ç›¸æœºåº”ç”¨é‡Œï¼‰ 64 æ‰“å¼€æµè§ˆå™¨ 82 èœå•é”® 85 æ’­æ”¾/æš‚åœ 86 åœæ­¢æ’­æ”¾ 87 æ’­æ”¾ä¸‹ä¸€é¦– 88 æ’­æ”¾ä¸Šä¸€é¦– 122 ç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–æˆ–åˆ—è¡¨é¡¶éƒ¨ 123 ç§»åŠ¨å…‰æ ‡åˆ°è¡Œæœ«æˆ–åˆ—è¡¨åº•éƒ¨ 126 æ¢å¤æ’­æ”¾ 127 æš‚åœæ’­æ”¾ 164 é™éŸ³ 176 æ‰“å¼€ç³»ç»Ÿè®¾ç½® 187 åˆ‡æ¢åº”ç”¨ 207 æ‰“å¼€è”ç³»äºº 208 æ‰“å¼€æ—¥åŽ† 209 æ‰“å¼€éŸ³ä¹ 210 æ‰“å¼€è®¡ç®—å™¨ 220 é™ä½Žå±å¹•äº®åº¦ 221 æé«˜å±å¹•äº®åº¦ 223 ç³»ç»Ÿä¼‘çœ  224 ç‚¹äº®å±å¹• 231 æ‰“å¼€è¯­éŸ³åŠ©æ‰‹ 276 å¦‚æžœæ²¡æœ‰ wakelock åˆ™è®©ç³»ç»Ÿä¼‘çœ  ä¸‹é¢æ˜¯ input å‘½ä»¤çš„ä¸€äº›ç”¨æ³•ä¸¾ä¾‹ã€‚ ç”µæºé”®å‘½ä»¤ï¼š 1adb shell input keyevent 26 æ‰§è¡Œæ•ˆæžœç›¸å½“äºŽæŒ‰ç”µæºé”®ã€‚ èœå•é”®å‘½ä»¤ï¼š 1adb shell input keyevent 82 HOME é”®å‘½ä»¤ï¼š 1adb shell input keyevent 3 è¿”å›žé”®å‘½ä»¤ï¼š 1adb shell input keyevent 4 éŸ³é‡æŽ§åˆ¶å¢žåŠ éŸ³é‡ï¼š 1adb shell input keyevent 24 é™ä½ŽéŸ³é‡ï¼š 1adb shell input keyevent 25 é™éŸ³ï¼š 1adb shell input keyevent 164 åª’ä½“æŽ§åˆ¶æ’­æ”¾/æš‚åœï¼š 1adb shell input keyevent 85 åœæ­¢æ’­æ”¾ï¼š 1adb shell input keyevent 86 æ’­æ”¾ä¸‹ä¸€é¦–ï¼š 1adb shell input keyevent 87 æ’­æ”¾ä¸Šä¸€é¦–ï¼š 1adb shell input keyevent 88 æ¢å¤æ’­æ”¾ï¼š 1adb shell input keyevent 126 æš‚åœæ’­æ”¾ï¼š 1adb shell input keyevent 127 ç‚¹äº®/ç†„ç­å±å¹•å¯ä»¥é€šè¿‡ä¸Šæ–‡è®²è¿°è¿‡çš„æ¨¡æ‹Ÿç”µæºé”®æ¥åˆ‡æ¢ç‚¹äº®å’Œç†„ç­å±å¹•ï¼Œä½†å¦‚æžœæ˜Žç¡®åœ°æƒ³è¦ç‚¹äº®æˆ–è€…ç†„ç­å±å¹•ï¼Œé‚£å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ã€‚ ç‚¹äº®å±å¹•ï¼š 1adb shell input keyevent 224 ç†„ç­å±å¹•ï¼š 1adb shell input keyevent 223 æ»‘åŠ¨è§£é”å¦‚æžœé”å±æ²¡æœ‰å¯†ç ï¼Œæ˜¯é€šè¿‡æ»‘åŠ¨æ‰‹åŠ¿è§£é”ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ input swipe æ¥è§£é”ã€‚ å‘½ä»¤ï¼ˆå‚æ•°ä»¥æœºåž‹ Nexus 5ï¼Œå‘ä¸Šæ»‘åŠ¨æ‰‹åŠ¿è§£é”ä¸¾ä¾‹ï¼‰ï¼š 1adb shell input swipe 300 1000 300 500 å‚æ•° 300 1000 300 500 åˆ†åˆ«è¡¨ç¤ºèµ·å§‹ç‚¹xåæ ‡ èµ·å§‹ç‚¹yåæ ‡ ç»“æŸç‚¹xåæ ‡ ç»“æŸç‚¹yåæ ‡ã€‚ è¾“å…¥æ–‡æœ¬åœ¨ç„¦ç‚¹å¤„äºŽæŸæ–‡æœ¬æ¡†æ—¶ï¼Œå¯ä»¥é€šè¿‡ input å‘½ä»¤æ¥è¾“å…¥æ–‡æœ¬ã€‚ å‘½ä»¤ï¼š 1adb shell input text hello çŽ°åœ¨ hello å‡ºçŽ°åœ¨æ–‡æœ¬æ¡†äº†ã€‚ æŸ¥çœ‹æ—¥å¿—Android ç³»ç»Ÿçš„æ—¥å¿—åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåº•å±‚çš„ Linux å†…æ ¸æ—¥å¿—è¾“å‡ºåˆ° /proc/kmsgï¼ŒAndroid çš„æ—¥å¿—è¾“å‡ºåˆ° /dev/logã€‚ Android æ—¥å¿—å‘½ä»¤æ ¼å¼ï¼š 1[adb] logcat [&lt;option&gt;] ... [&lt;filter-spec&gt;] ... å¸¸ç”¨ç”¨æ³•åˆ—ä¸¾å¦‚ä¸‹ï¼š æŒ‰çº§åˆ«è¿‡æ»¤æ—¥å¿—Android çš„æ—¥å¿—åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªçº§åˆ«ï¼š V â€”â€” Verboseï¼ˆæœ€ä½Žï¼Œè¾“å‡ºå¾—æœ€å¤šï¼‰ D â€”â€” Debug I â€”â€” Info W â€”â€” Warning E â€”â€” Error F â€”â€” Fatal S â€”â€” Silentï¼ˆæœ€é«˜ï¼Œå•¥ä¹Ÿä¸è¾“å‡ºï¼‰ æŒ‰æŸçº§åˆ«è¿‡æ»¤æ—¥å¿—åˆ™ä¼šå°†è¯¥çº§åˆ«åŠä»¥ä¸Šçš„æ—¥å¿—è¾“å‡ºã€‚ æ¯”å¦‚ï¼Œå‘½ä»¤ï¼š 1adb logcat *:W ä¼šå°† Warningã€Errorã€Fatal å’Œ Silent æ—¥å¿—è¾“å‡ºã€‚ æŒ‰ tag å’Œçº§åˆ«è¿‡æ»¤æ—¥å¿—æ¯”å¦‚ï¼Œå‘½ä»¤ï¼š 1adb logcat ActivityManager:I MyApp:D *:S è¡¨ç¤ºè¾“å‡º tag ActivityManager çš„ Info ä»¥ä¸Šçº§åˆ«æ—¥å¿—ï¼Œè¾“å‡º tag MyApp çš„ Debug ä»¥ä¸Šçº§åˆ«æ—¥å¿—ï¼ŒåŠå…¶å®ƒ tag çš„ Silent çº§åˆ«æ—¥å¿—ï¼ˆå³å±è”½å…¶å®ƒ tag æ—¥å¿—ï¼‰ã€‚ æ—¥å¿—æ ¼å¼å¯ä»¥ç”¨ adb logcat -v &lt;format&gt; é€‰é¡¹æŒ‡å®šæ—¥å¿—è¾“å‡ºæ ¼å¼ã€‚ æ—¥å¿—æ”¯æŒæŒ‰ä»¥ä¸‹å‡ ç§ &lt;format&gt;ï¼š brief é»˜è®¤æ ¼å¼ã€‚æ ¼å¼ä¸ºï¼š 1&lt;priority&gt;/&lt;tag&gt;(&lt;pid&gt;): &lt;message&gt; ç¤ºä¾‹ï¼š 1D/HeadsetStateMachine( 1785): Disconnected process message: 10, size: 0 process æ ¼å¼ä¸ºï¼š 1&lt;priority&gt;(&lt;pid&gt;) &lt;message&gt; ç¤ºä¾‹ï¼š 1D( 1785) Disconnected process message: 10, size: 0 (HeadsetStateMachine) tag æ ¼å¼ä¸ºï¼š 1&lt;priority&gt;/&lt;tag&gt;: &lt;message&gt; ç¤ºä¾‹ï¼š 1D/HeadsetStateMachine: Disconnected process message: 10, size: 0 raw æ ¼å¼ä¸ºï¼š 1&lt;message&gt; ç¤ºä¾‹ï¼š 1Disconnected process message: 10, size: 0 time æ ¼å¼ä¸ºï¼š 1&lt;datetime&gt; &lt;priority&gt;/&lt;tag&gt;(&lt;pid&gt;): &lt;message&gt; ç¤ºä¾‹ï¼š 108-28 22:39:39.974 D/HeadsetStateMachine( 1785): Disconnected process message: 10, size: 0 threadtime æ ¼å¼ä¸ºï¼š 1&lt;datetime&gt; &lt;pid&gt; &lt;tid&gt; &lt;priority&gt; &lt;tag&gt;: &lt;message&gt; ç¤ºä¾‹ï¼š 108-28 22:39:39.974 1785 1832 D HeadsetStateMachine: Disconnected process message: 10, size: 0 long æ ¼å¼ä¸ºï¼š 12[ &lt;datetime&gt; &lt;pid&gt;:&lt;tid&gt; &lt;priority&gt;/&lt;tag&gt; ]&lt;message&gt; ç¤ºä¾‹ï¼š 12[ 08-28 22:39:39.974 1785: 1832 D/HeadsetStateMachine ]Disconnected process message: 10, size: 0 æŒ‡å®šæ ¼å¼å¯ä¸Žä¸Šé¢çš„è¿‡æ»¤åŒæ—¶ä½¿ç”¨ã€‚æ¯”å¦‚ï¼š 1adb logcat -v long ActivityManager:I *:S æ¸…ç©ºæ—¥å¿—1adb logcat -c å†…æ ¸æ—¥å¿—å‘½ä»¤ï¼š 1adb shell dmesg è¾“å‡ºç¤ºä¾‹ï¼š 1234567&lt;6&gt;[14201.684016] PM: noirq resume of devices complete after 0.982 msecs&lt;6&gt;[14201.685525] PM: early resume of devices complete after 0.838 msecs&lt;6&gt;[14201.753642] PM: resume of devices complete after 68.106 msecs&lt;4&gt;[14201.755954] Restarting tasks ... done.&lt;6&gt;[14201.771229] PM: suspend exit 2016-08-28 13:31:32.679217193 UTC&lt;6&gt;[14201.872373] PM: suspend entry 2016-08-28 13:31:32.780363596 UTC&lt;6&gt;[14201.872498] PM: Syncing filesystems ... done. ä¸­æ‹¬å·é‡Œçš„ [14201.684016] ä»£è¡¨å†…æ ¸å¼€å§‹å¯åŠ¨åŽçš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚ é€šè¿‡å†…æ ¸æ—¥å¿—æˆ‘ä»¬å¯ä»¥åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚è¡¡é‡å†…æ ¸å¯åŠ¨æ—¶é—´ï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨å®Œæ¯•åŽçš„å†…æ ¸æ—¥å¿—é‡Œæ‰¾åˆ° Freeing init memory é‚£ä¸€è¡Œå‰é¢çš„æ—¶é—´å°±æ˜¯ã€‚ æŸ¥çœ‹è®¾å¤‡ä¿¡æ¯åž‹å·å‘½ä»¤ï¼š 1adb shell getprop ro.product.model è¾“å‡ºç¤ºä¾‹ï¼š 1Nexus 5 ç”µæ± çŠ¶å†µå‘½ä»¤ï¼š 1adb shell dumpsys battery è¾“å…¥ç¤ºä¾‹ï¼š 123456789101112Current Battery Service state: AC powered: false USB powered: true Wireless powered: false status: 2 health: 2 present: true level: 44 scale: 100 voltage: 3872 temperature: 280 technology: Li-poly å…¶ä¸­ scale ä»£è¡¨æœ€å¤§ç”µé‡ï¼Œlevel ä»£è¡¨å½“å‰ç”µé‡ã€‚ä¸Šé¢çš„è¾“å‡ºè¡¨ç¤ºè¿˜å‰©ä¸‹ 44% çš„ç”µé‡ã€‚ å±å¹•åˆ†è¾¨çŽ‡å‘½ä»¤ï¼š 1adb shell wm size è¾“å‡ºç¤ºä¾‹ï¼š 1Physical size: 1080x1920 è¯¥è®¾å¤‡å±å¹•åˆ†è¾¨çŽ‡ä¸º 1080px * 1920pxã€‚ å±å¹•å¯†åº¦å‘½ä»¤ï¼š 1adb shell wm density è¾“å‡ºç¤ºä¾‹ï¼š 1Physical density: 420 è¯¥è®¾å¤‡å±å¹•å¯†åº¦ä¸º 420dpiã€‚ æ˜¾ç¤ºå±å‚æ•°å‘½ä»¤ï¼š 1adb shell dumpsys window displays è¾“å‡ºç¤ºä¾‹ï¼š 1234WINDOW MANAGER DISPLAY CONTENTS (dumpsys window displays) Display: mDisplayId=0 init=1080x1920 420dpi cur=1080x1920 app=1080x1794 rng=1080x1017-1810x1731 deferred=false layoutNeeded=false å…¶ä¸­ mDisplayId ä¸º æ˜¾ç¤ºå±ç¼–å·ï¼Œinit æ˜¯åˆå§‹åˆ†è¾¨çŽ‡å’Œå±å¹•å¯†åº¦ï¼Œapp çš„é«˜åº¦æ¯” init é‡Œçš„è¦å°ï¼Œè¡¨ç¤ºå±å¹•åº•éƒ¨æœ‰è™šæ‹ŸæŒ‰é”®ï¼Œé«˜åº¦ä¸º 1920 - 1794 = 126px åˆ 42dpã€‚ android_idå‘½ä»¤ï¼š 1adb shell settings get secure android_id è¾“å‡ºç¤ºä¾‹ï¼š 151b6be48bac8c569 IMEIåœ¨ Android 4.4 åŠä»¥ä¸‹ç‰ˆæœ¬å¯é€šè¿‡å¦‚ä¸‹å‘½ä»¤èŽ·å– IMEIï¼š 1adb shell dumpsys iphonesubinfo è¾“å‡ºç¤ºä¾‹ï¼š 123Phone Subscriber Info: Phone Type = GSM Device ID = 860955027785041 å…¶ä¸­çš„ Device ID å°±æ˜¯ IMEIã€‚ è€Œåœ¨ Android 5.0 åŠä»¥ä¸Šç‰ˆæœ¬é‡Œè¿™ä¸ªå‘½ä»¤è¾“å‡ºä¸ºç©ºï¼Œå¾—é€šè¿‡å…¶å®ƒæ–¹å¼èŽ·å–äº†ï¼ˆéœ€è¦ root æƒé™ï¼‰ï¼š 123adb shellsuservice call iphonesubinfo 1 è¾“å‡ºç¤ºä¾‹ï¼š 1234Result: Parcel( 0x00000000: 00000000 0000000f 00360038 00390030 '........8.6.0.9.' 0x00000010: 00350035 00320030 00370037 00350038 '5.5.0.2.7.7.8.5.' 0x00000020: 00340030 00000031 '0.4.1... ') æŠŠé‡Œé¢çš„æœ‰æ•ˆå†…å®¹æå–å‡ºæ¥å°±æ˜¯ IMEI äº†ï¼Œæ¯”å¦‚è¿™é‡Œçš„æ˜¯ 860955027785041ã€‚ å‚è€ƒï¼šadb shell dumpsys iphonesubinfo not working since Android 5.0 Lollipop Android ç³»ç»Ÿç‰ˆæœ¬å‘½ä»¤ï¼š 1adb shell getprop ro.build.version.release è¾“å‡ºç¤ºä¾‹ï¼š 15.0.2 Mac åœ°å€å‘½ä»¤ï¼š 1adb shell cat /sys/class/net/wlan0/address è¾“å‡ºç¤ºä¾‹ï¼š 1f8:a9:d0:17:42:4d CPU ä¿¡æ¯å‘½ä»¤ï¼š 1adb shell cat /proc/cpuinfo è¾“å‡ºç¤ºä¾‹ï¼š 1234567891011121314151617181920212223Processor : ARMv7 Processor rev 0 (v7l)processor : 0BogoMIPS : 38.40processor : 1BogoMIPS : 38.40processor : 2BogoMIPS : 38.40processor : 3BogoMIPS : 38.40Features : swp half thumb fastmult vfp edsp neon vfpv3 tls vfpv4 idiva idivtCPU implementer : 0x51CPU architecture: 7CPU variant : 0x2CPU part : 0x06fCPU revision : 0Hardware : Qualcomm MSM 8974 HAMMERHEAD (Flattened Device Tree)Revision : 000bSerial : 0000000000000000 è¿™æ˜¯ Nexus 5 çš„ CPU ä¿¡æ¯ï¼Œæˆ‘ä»¬ä»Žè¾“å‡ºé‡Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨çš„ç¡¬ä»¶æ˜¯ Qualcomm MSM 8974ï¼Œprocessor çš„ç¼–å·æ˜¯ 0 åˆ° 3ï¼Œæ‰€ä»¥å®ƒæ˜¯å››æ ¸çš„ï¼Œé‡‡ç”¨çš„æž¶æž„æ˜¯ ARMv7 Processor rev 0 (v71)ã€‚ å†…å­˜ä¿¡æ¯å‘½ä»¤ï¼š 1adb shell cat /proc/meminfo è¾“å‡ºç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637MemTotal: 1027424 kBMemFree: 486564 kBBuffers: 15224 kBCached: 72464 kBSwapCached: 24152 kBActive: 110572 kBInactive: 259060 kBActive(anon): 79176 kBInactive(anon): 207736 kBActive(file): 31396 kBInactive(file): 51324 kBUnevictable: 3948 kBMlocked: 0 kBHighTotal: 409600 kBHighFree: 132612 kBLowTotal: 617824 kBLowFree: 353952 kBSwapTotal: 262140 kBSwapFree: 207572 kBDirty: 0 kBWriteback: 0 kBAnonPages: 265324 kBMapped: 47072 kBShmem: 1020 kBSlab: 57372 kBSReclaimable: 7692 kBSUnreclaim: 49680 kBKernelStack: 4512 kBPageTables: 5912 kBNFS_Unstable: 0 kBBounce: 0 kBWritebackTmp: 0 kBCommitLimit: 775852 kBCommitted_AS: 13520632 kBVmallocTotal: 385024 kBVmallocUsed: 61004 kBVmallocChunk: 209668 kB å…¶ä¸­ï¼ŒMemTotal å°±æ˜¯è®¾å¤‡çš„æ€»å†…å­˜ï¼ŒMemFree æ˜¯å½“å‰ç©ºé—²å†…å­˜ã€‚ æ›´å¤šç¡¬ä»¶ä¸Žç³»ç»Ÿå±žæ€§è®¾å¤‡çš„æ›´å¤šç¡¬ä»¶ä¸Žç³»ç»Ÿå±žæ€§å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š 1adb shell cat /system/build.prop è¿™ä¼šè¾“å‡ºå¾ˆå¤šä¿¡æ¯ï¼ŒåŒ…æ‹¬å‰é¢å‡ ä¸ªå°èŠ‚æåˆ°çš„ã€Œåž‹å·ã€å’Œã€ŒAndroid ç³»ç»Ÿç‰ˆæœ¬ã€ç­‰ã€‚ è¾“å‡ºé‡Œè¿˜åŒ…æ‹¬ä¸€äº›å…¶å®ƒæœ‰ç”¨çš„ä¿¡æ¯ï¼Œå®ƒä»¬ä¹Ÿå¯é€šè¿‡ adb shell getprop &lt;å±žæ€§å&gt; å‘½ä»¤å•ç‹¬æŸ¥çœ‹ï¼Œåˆ—ä¸¾ä¸€éƒ¨åˆ†å±žæ€§å¦‚ä¸‹ï¼š å±žæ€§å å«ä¹‰ ro.build.version.sdk SDK ç‰ˆæœ¬ ro.build.version.release Android ç³»ç»Ÿç‰ˆæœ¬ ro.build.version.security_patch Android å®‰å…¨è¡¥ä¸ç¨‹åºçº§åˆ« ro.product.model åž‹å· ro.product.brand å“ç‰Œ ro.product.name è®¾å¤‡å ro.product.board å¤„ç†å™¨åž‹å· ro.product.cpu.abilist CPU æ”¯æŒçš„ abi åˆ—è¡¨ persist.sys.isUsbOtgEnabled æ˜¯å¦æ”¯æŒ OTG dalvik.vm.heapsize æ¯ä¸ªåº”ç”¨ç¨‹åºçš„å†…å­˜ä¸Šé™ ro.sf.lcd_density å±å¹•å¯†åº¦ å®žç”¨åŠŸèƒ½å±å¹•æˆªå›¾å‘½ä»¤ï¼š 1adb shell screencap -p /sdcard/sc.png ç„¶åŽå°† png æ–‡ä»¶å¯¼å‡ºåˆ°ç”µè„‘ï¼š 1adb pull /sdcard/sc.png å¯ä»¥ä½¿ç”¨ adb shell screencap -h æŸ¥çœ‹ screencap å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯ä¸¤ä¸ªæœ‰æ„ä¹‰çš„å‚æ•°åŠå«ä¹‰ï¼š å‚æ•° å«ä¹‰ -p æŒ‡å®šä¿å­˜æ–‡ä»¶ä¸º png æ ¼å¼ -d display-id æŒ‡å®šæˆªå›¾çš„æ˜¾ç¤ºå±ç¼–å·ï¼ˆæœ‰å¤šæ˜¾ç¤ºå±çš„æƒ…å†µä¸‹ï¼‰ å®žæµ‹å¦‚æžœæŒ‡å®šæ–‡ä»¶åä»¥ .png ç»“å°¾æ—¶å¯ä»¥çœç•¥ -p å‚æ•°ï¼›å¦åˆ™éœ€è¦ä½¿ç”¨ -p å‚æ•°ã€‚å¦‚æžœä¸æŒ‡å®šæ–‡ä»¶åï¼Œæˆªå›¾æ–‡ä»¶çš„å†…å®¹å°†ç›´æŽ¥è¾“å‡ºåˆ° stdoutã€‚ å½•åˆ¶å±å¹•å½•åˆ¶å±å¹•ä»¥ mp4 æ ¼å¼ä¿å­˜åˆ° /sdcardï¼š 1adb shell screenrecord /sdcard/filename.mp4 éœ€è¦åœæ­¢æ—¶æŒ‰ Ctrl-Cï¼Œé»˜è®¤å½•åˆ¶æ—¶é—´å’Œæœ€é•¿å½•åˆ¶æ—¶é—´éƒ½æ˜¯ 180 ç§’ã€‚ å¦‚æžœéœ€è¦å¯¼å‡ºåˆ°ç”µè„‘ï¼š 1adb pull /sdcard/filename.mp4 å¯ä»¥ä½¿ç”¨ adb shell screenrecord --help æŸ¥çœ‹ screenrecord å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯å¸¸è§å‚æ•°åŠå«ä¹‰ï¼š å‚æ•° å«ä¹‰ â€“size WIDTHxHEIGHT è§†é¢‘çš„å°ºå¯¸ï¼Œæ¯”å¦‚ 1280x720ï¼Œé»˜è®¤æ˜¯å±å¹•åˆ†è¾¨çŽ‡ã€‚ â€“bit-rate RATE è§†é¢‘çš„æ¯”ç‰¹çŽ‡ï¼Œé»˜è®¤æ˜¯ 4Mbpsã€‚ â€“time-limit TIME å½•åˆ¶æ—¶é•¿ï¼Œå•ä½ç§’ã€‚ â€“verbose è¾“å‡ºæ›´å¤šä¿¡æ¯ã€‚ é‡æ–°æŒ‚è½½ system åˆ†åŒºä¸ºå¯å†™æ³¨ï¼šéœ€è¦ root æƒé™ã€‚ /system åˆ†åŒºé»˜è®¤æŒ‚è½½ä¸ºåªè¯»ï¼Œä½†æœ‰äº›æ“ä½œæ¯”å¦‚ç»™ Android ç³»ç»Ÿæ·»åŠ å‘½ä»¤ã€åˆ é™¤è‡ªå¸¦åº”ç”¨ç­‰éœ€è¦å¯¹ /system è¿›è¡Œå†™æ“ä½œï¼Œæ‰€ä»¥éœ€è¦é‡æ–°æŒ‚è½½å®ƒä¸ºå¯è¯»å†™ã€‚ æ­¥éª¤ï¼š è¿›å…¥ shell å¹¶åˆ‡æ¢åˆ° root ç”¨æˆ·æƒé™ã€‚ å‘½ä»¤ï¼š 12adb shellsu æŸ¥çœ‹å½“å‰åˆ†åŒºæŒ‚è½½æƒ…å†µã€‚ å‘½ä»¤ï¼š 1mount è¾“å‡ºç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425rootfs / rootfs ro,relatime 0 0tmpfs /dev tmpfs rw,seclabel,nosuid,relatime,mode=755 0 0devpts /dev/pts devpts rw,seclabel,relatime,mode=600 0 0proc /proc proc rw,relatime 0 0sysfs /sys sysfs rw,seclabel,relatime 0 0selinuxfs /sys/fs/selinux selinuxfs rw,relatime 0 0debugfs /sys/kernel/debug debugfs rw,relatime 0 0none /var tmpfs rw,seclabel,relatime,mode=770,gid=1000 0 0none /acct cgroup rw,relatime,cpuacct 0 0none /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0none /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0tmpfs /mnt/asec tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0tmpfs /mnt/obb tmpfs rw,seclabel,relatime,mode=755,gid=1000 0 0none /dev/memcg cgroup rw,relatime,memory 0 0none /dev/cpuctl cgroup rw,relatime,cpu 0 0none /sys/fs/cgroup tmpfs rw,seclabel,relatime,mode=750,gid=1000 0 0none /sys/fs/cgroup/memory cgroup rw,relatime,memory 0 0none /sys/fs/cgroup/freezer cgroup rw,relatime,freezer 0 0/dev/block/platform/msm_sdcc.1/by-name/system /system ext4 ro,seclabel,relatime,data=ordered 0 0/dev/block/platform/msm_sdcc.1/by-name/userdata /data ext4 rw,seclabel,nosuid,nodev,relatime,noauto_da_alloc,data=ordered 0 0/dev/block/platform/msm_sdcc.1/by-name/cache /cache ext4 rw,seclabel,nosuid,nodev,relatime,data=ordered 0 0/dev/block/platform/msm_sdcc.1/by-name/persist /persist ext4 rw,seclabel,nosuid,nodev,relatime,data=ordered 0 0/dev/block/platform/msm_sdcc.1/by-name/modem /firmware vfat ro,context=u:object_r:firmware_file:s0,relatime,uid=1000,gid=1000,fmask=0337,dmask=0227,codepage=cp437,iocharset=iso8859-1,shortname=lower,errors=remount-ro 0 0/dev/fuse /mnt/shell/emulated fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0/dev/fuse /mnt/shell/emulated/0 fuse rw,nosuid,nodev,relatime,user_id=1023,group_id=1023,default_permissions,allow_other 0 0 æ‰¾åˆ°å…¶ä¸­æˆ‘ä»¬å…³æ³¨çš„å¸¦ /system çš„é‚£ä¸€è¡Œï¼š 1/dev/block/platform/msm_sdcc.1/by-name/system /system ext4 ro,seclabel,relatime,data=ordered 0 0 é‡æ–°æŒ‚è½½ã€‚ å‘½ä»¤ï¼š 1mount -o remount,rw -t yaffs2 /dev/block/platform/msm_sdcc.1/by-name/system /system è¿™é‡Œçš„ /dev/block/platform/msm_sdcc.1/by-name/system å°±æ˜¯æˆ‘ä»¬ä»Žä¸Šä¸€æ­¥çš„è¾“å‡ºé‡Œå¾—åˆ°çš„æ–‡ä»¶è·¯å¾„ã€‚ å¦‚æžœè¾“å‡ºæ²¡æœ‰æç¤ºé”™è¯¯çš„è¯ï¼Œæ“ä½œå°±æˆåŠŸäº†ï¼Œå¯ä»¥å¯¹ /system ä¸‹çš„æ–‡ä»¶ä¸ºæ‰€æ¬²ä¸ºäº†ã€‚ æŸ¥çœ‹è¿žæŽ¥è¿‡çš„ WiFi å¯†ç æ³¨ï¼šéœ€è¦ root æƒé™ã€‚ å‘½ä»¤ï¼š 123adb shellsucat /data/misc/wifi/*.conf è¾“å‡ºç¤ºä¾‹ï¼š 123456789101112131415161718network=&#123; ssid="TP-LINK_9DFC" scan_ssid=1 psk="123456789" key_mgmt=WPA-PSK group=CCMP TKIP auth_alg=OPEN sim_num=1 priority=13893&#125;network=&#123; ssid="TP-LINK_F11E" psk="987654321" key_mgmt=WPA-PSK sim_num=1 priority=17293&#125; ssid å³ä¸ºæˆ‘ä»¬åœ¨ WLAN è®¾ç½®é‡Œçœ‹åˆ°çš„åç§°ï¼Œpsk ä¸ºå¯†ç ï¼Œkey_mgmt ä¸ºå®‰å…¨åŠ å¯†æ–¹å¼ã€‚ è®¾ç½®ç³»ç»Ÿæ—¥æœŸå’Œæ—¶é—´æ³¨ï¼šéœ€è¦ root æƒé™ã€‚ å‘½ä»¤ï¼š 123adb shellsudate -s 20160823.131500 è¡¨ç¤ºå°†ç³»ç»Ÿæ—¥æœŸå’Œæ—¶é—´æ›´æ”¹ä¸º 2016 å¹´ 08 æœˆ 23 æ—¥ 13 ç‚¹ 15 åˆ† 00 ç§’ã€‚ é‡å¯æ‰‹æœºå‘½ä»¤ï¼š 1adb reboot æ£€æµ‹è®¾å¤‡æ˜¯å¦å·² rootå‘½ä»¤ï¼š 12adb shellsu æ­¤æ—¶å‘½ä»¤è¡Œæç¤ºç¬¦æ˜¯ $ åˆ™è¡¨ç¤ºæ²¡æœ‰ root æƒé™ï¼Œæ˜¯ # åˆ™è¡¨ç¤ºå·² rootã€‚ ä½¿ç”¨ Monkey è¿›è¡ŒåŽ‹åŠ›æµ‹è¯•Monkey å¯ä»¥ç”Ÿæˆä¼ªéšæœºç”¨æˆ·äº‹ä»¶æ¥æ¨¡æ‹Ÿå•å‡»ã€è§¦æ‘¸ã€æ‰‹åŠ¿ç­‰æ“ä½œï¼Œå¯ä»¥å¯¹æ­£åœ¨å¼€å‘ä¸­çš„ç¨‹åºè¿›è¡ŒéšæœºåŽ‹åŠ›æµ‹è¯•ã€‚ ç®€å•ç”¨æ³•ï¼š 1adb shell monkey -p &lt;packagename&gt; -v 500 è¡¨ç¤ºå‘ &lt;packagename&gt; æŒ‡å®šçš„åº”ç”¨ç¨‹åºå‘é€ 500 ä¸ªä¼ªéšæœºäº‹ä»¶ã€‚ Monkey çš„è¯¦ç»†ç”¨æ³•å‚è€ƒ å®˜æ–¹æ–‡æ¡£ã€‚ å¼€å¯/å…³é—­ WiFiæ³¨ï¼šéœ€è¦ root æƒé™ã€‚ æœ‰æ—¶éœ€è¦æŽ§åˆ¶è®¾å¤‡çš„ WiFi çŠ¶æ€ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æŒ‡ä»¤å®Œæˆã€‚ å¼€å¯ WiFiï¼š 12adb rootadb shell svc wifi enable å…³é—­ WiFiï¼š 12adb rootadb shell svc wifi disable è‹¥æ‰§è¡ŒæˆåŠŸï¼Œè¾“å‡ºä¸ºç©ºï¼›è‹¥æœªå–å¾— root æƒé™æ‰§è¡Œæ­¤å‘½ä»¤ï¼Œå°†æ‰§è¡Œå¤±è´¥ï¼Œè¾“å‡º Killedã€‚ åˆ·æœºç›¸å…³å‘½ä»¤é‡å¯åˆ° Recovery æ¨¡å¼å‘½ä»¤ï¼š 1adb reboot recovery ä»Ž Recovery é‡å¯åˆ° Androidå‘½ä»¤ï¼š 1adb reboot é‡å¯åˆ° Fastboot æ¨¡å¼å‘½ä»¤ï¼š 1adb reboot bootloader é€šè¿‡ sideload æ›´æ–°ç³»ç»Ÿå¦‚æžœæˆ‘ä»¬ä¸‹è½½äº† Android è®¾å¤‡å¯¹åº”çš„ç³»ç»Ÿæ›´æ–°åŒ…åˆ°ç”µè„‘ä¸Šï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€šè¿‡ adb æ¥å®Œæˆæ›´æ–°ã€‚ ä»¥ Recovery æ¨¡å¼ä¸‹æ›´æ–°ä¸ºä¾‹ï¼š é‡å¯åˆ° Recovery æ¨¡å¼ã€‚ å‘½ä»¤ï¼š 1adb reboot recovery åœ¨è®¾å¤‡çš„ Recovery ç•Œé¢ä¸Šæ“ä½œè¿›å…¥ Apply update-Apply from ADBã€‚ æ³¨ï¼šä¸åŒçš„ Recovery èœå•å¯èƒ½ä¸Žæ­¤æœ‰å·®å¼‚ï¼Œæœ‰çš„æ˜¯ä¸€çº§èœå•å°±æœ‰ Apply update from ADBã€‚ é€šè¿‡ adb ä¸Šä¼ å’Œæ›´æ–°ç³»ç»Ÿã€‚ å‘½ä»¤ï¼š 1adb sideload &lt;path-to-update.zip&gt; æ›´å¤š adb shell å‘½ä»¤Android ç³»ç»Ÿæ˜¯åŸºäºŽ Linux å†…æ ¸çš„ï¼Œæ‰€ä»¥ Linux é‡Œçš„å¾ˆå¤šå‘½ä»¤åœ¨ Android é‡Œä¹Ÿæœ‰ç›¸åŒæˆ–ç±»ä¼¼çš„å®žçŽ°ï¼Œåœ¨ adb shell é‡Œå¯ä»¥è°ƒç”¨ã€‚æœ¬æ–‡æ¡£å‰é¢çš„éƒ¨åˆ†å†…å®¹å·²ç»ç”¨åˆ°äº† adb shell å‘½ä»¤ã€‚ æŸ¥çœ‹è¿›ç¨‹å‘½ä»¤ï¼š 1adb shell ps è¾“å‡ºç¤ºä¾‹ï¼š 12345678USER PID PPID VSIZE RSS WCHAN PC NAMEroot 1 0 8904 788 ffffffff 00000000 S /initroot 2 0 0 0 ffffffff 00000000 S kthreadd...u0_a71 7779 5926 1538748 48896 ffffffff 00000000 S com.sohu.inputmethod.sogou:classicu0_a58 7963 5926 1561916 59568 ffffffff 00000000 S org.mazhuang.boottimemeasure...shell 8750 217 10640 740 00000000 b6f28340 R ps å„åˆ—å«ä¹‰ï¼š åˆ—å å«ä¹‰ USER æ‰€å±žç”¨æˆ· PID è¿›ç¨‹ ID PPID çˆ¶è¿›ç¨‹ ID NAME è¿›ç¨‹å æŸ¥çœ‹å®žæ—¶èµ„æºå ç”¨æƒ…å†µå‘½ä»¤ï¼š 1adb shell top è¾“å‡ºç¤ºä¾‹ï¼š 1234567891011121314User 0%, System 6%, IOW 0%, IRQ 0%User 3 + Nice 0 + Sys 21 + Idle 280 + IOW 0 + IRQ 0 + SIRQ 3 = 307 PID PR CPU% S #THR VSS RSS PCY UID Name 8763 0 3% R 1 10640K 1064K fg shell top 131 0 3% S 1 0K 0K fg root dhd_dpc 6144 0 0% S 115 1682004K 115916K fg system system_server 132 0 0% S 1 0K 0K fg root dhd_rxf 1731 0 0% S 6 20288K 788K fg root /system/bin/mpdecision 217 0 0% S 6 18008K 356K fg shell /sbin/adbd ... 7779 2 0% S 19 1538748K 48896K bg u0_a71 com.sohu.inputmethod.sogou:classic 7963 0 0% S 18 1561916K 59568K fg u0_a58 org.mazhuang.boottimemeasure ... å„åˆ—å«ä¹‰ï¼š åˆ—å å«ä¹‰ PID è¿›ç¨‹ ID PR ä¼˜å…ˆçº§ CPU% å½“å‰çž¬é—´å ç”¨ CPU ç™¾åˆ†æ¯” S è¿›ç¨‹çŠ¶æ€ï¼ˆR=è¿è¡Œï¼ŒS=ç¡çœ ï¼ŒT=è·Ÿè¸ª/åœæ­¢ï¼ŒZ=åƒµå°¸è¿›ç¨‹ï¼‰ #THR çº¿ç¨‹æ•° VSS Virtual Set Size è™šæ‹Ÿè€—ç”¨å†…å­˜ï¼ˆåŒ…å«å…±äº«åº“å ç”¨çš„å†…å­˜ï¼‰ RSS Resident Set Size å®žé™…ä½¿ç”¨ç‰©ç†å†…å­˜ï¼ˆåŒ…å«å…±äº«åº“å ç”¨çš„å†…å­˜ï¼‰ PCY è°ƒåº¦ç­–ç•¥ä¼˜å…ˆçº§ï¼ŒSP_BACKGROUND/SPFOREGROUND UID è¿›ç¨‹æ‰€æœ‰è€…çš„ç”¨æˆ· ID NAME è¿›ç¨‹å top å‘½ä»¤è¿˜æ”¯æŒä¸€äº›å‘½ä»¤è¡Œå‚æ•°ï¼Œè¯¦ç»†ç”¨æ³•å¦‚ä¸‹ï¼š 1234567Usage: top [ -m max_procs ] [ -n iterations ] [ -d delay ] [ -s sort_column ] [ -t ] [ -h ] -m num æœ€å¤šæ˜¾ç¤ºå¤šå°‘ä¸ªè¿›ç¨‹ -n num åˆ·æ–°å¤šå°‘æ¬¡åŽé€€å‡º -d num åˆ·æ–°æ—¶é—´é—´éš”ï¼ˆå•ä½ç§’ï¼Œé»˜è®¤å€¼ 5ï¼‰ -s col æŒ‰æŸåˆ—æŽ’åºï¼ˆå¯ç”¨ col å€¼ï¼šcpu, vss, rss, thrï¼‰ -t æ˜¾ç¤ºçº¿ç¨‹ä¿¡æ¯ -h æ˜¾ç¤ºå¸®åŠ©æ–‡æ¡£ å…¶å®ƒå¦‚ä¸‹æ˜¯å…¶å®ƒå¸¸ç”¨å‘½ä»¤çš„ç®€å•æè¿°ï¼Œå‰æ–‡å·²ç»ä¸“é—¨è®²è¿‡çš„å‘½ä»¤ä¸å†é¢å¤–è¯´æ˜Žï¼š å‘½ä»¤ åŠŸèƒ½ cat æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ cd åˆ‡æ¢ç›®å½• chmod æ”¹å˜æ–‡ä»¶çš„å­˜å–æ¨¡å¼/è®¿é—®æƒé™ df æŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µ grep è¿‡æ»¤è¾“å‡º kill æ€æ­»æŒ‡å®š PID çš„è¿›ç¨‹ ls åˆ—ä¸¾ç›®å½•å†…å®¹ mount æŒ‚è½½ç›®å½•çš„æŸ¥çœ‹å’Œç®¡ç† mv ç§»åŠ¨æˆ–é‡å‘½åæ–‡ä»¶ ps æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ rm åˆ é™¤æ–‡ä»¶ top æŸ¥çœ‹è¿›ç¨‹çš„èµ„æºå ç”¨æƒ…å†µ adb çš„éžå®˜æ–¹å®žçŽ° fb-adb - A better shell for Android devices (for Mac). è‡´è°¢æ„Ÿè°¢æœ‹å‹ä»¬æ— ç§çš„åˆ†äº«ä¸Žè¡¥å……ã€‚ zxning linhua55 codeskyblue seasonyuu fan123199 å‚è€ƒé“¾æŽ¥ Android Debug Bridge ADB Shell Commands logcat Command-line Tool Android ADBå‘½ä»¤å¤§å…¨ adb å‘½ä»¤è¡Œçš„ä½¿ç”¨è®°å½• Android ADBå‘½ä»¤å¤§å…¨(é€šè¿‡ADBå‘½ä»¤æŸ¥çœ‹wifiå¯†ç ã€MACåœ°å€ã€è®¾å¤‡ä¿¡æ¯ã€æ“ä½œæ–‡ä»¶ã€æŸ¥çœ‹æ–‡ä»¶ã€æ—¥å¿—ä¿¡æ¯ã€å¸è½½ã€å¯åŠ¨å’Œå®‰è£…APKç­‰) é‚£äº›åšAndroidå¼€å‘å¿…é¡»çŸ¥é“çš„ADBå‘½ä»¤ adb shell top åƒé«˜æ‰‹ä¸€æ ·ä½¿ç”¨ADBå‘½ä»¤è¡Œï¼ˆ2ï¼‰]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JaveIOæµä¹‹åŽ‹ç¼©æµ(zip,Gzip)]]></title>
    <url>%2Farticle%2F837682646%2F</url>
    <content type="text"><![CDATA[JAVAIOæµæ˜¯javaçš„ä¸€ä¸ªå¾ˆé‡è¦çš„éƒ¨åˆ†ï¼Œæ¸…æ™°æœ‰å¾ˆå¤æ‚ï¼Œå„ç§å„æ ·çš„æµåˆ†ç®¡ä¸åŒçš„åŠŸèƒ½ã€‚æ­£ç¡®ä½¿ç”¨IOæµå¯ä»¥è®©ä½ çš„è¾“å…¥è¾“å‡ºæ•ˆçŽ‡å¢žåŠ ï¼Œè¿™ç¯‡åšå®¢ä¸»è¦è¯´ä¸€ä¸‹åŽ‹ç¼©æµçš„ä½¿ç”¨ï¼Œä½¿ç”¨JAVAå†…ç½®APIåŽ‹ç¼©è§£åŽ‹ç¼©æ–‡ä»¶ã€‚ ZIPåŽ‹ç¼©ä¸»è¦çš„ç”¨åˆ°çš„APIæ˜¯123ZipFileZipInputStreamZipOutputStream å®Œæ•´ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261import java.io.BufferedInputStream;import java.io.BufferedOutputStream;import java.io.Closeable;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.IOException;import java.util.Enumeration;import java.util.zip.ZipEntry;import java.util.zip.ZipException;import java.util.zip.ZipFile;import java.util.zip.ZipInputStream;import java.util.zip.ZipOutputStream;/** * * @author chendong * * &lt;/br&gt;ä½¿ç”¨javaå†…ç½®APIZipFileå®Œæˆå¯¹æ–‡ä»¶çš„åŽ‹ç¼©è§£åŽ‹ç¼©æ“ä½œ * * &lt;/br&gt;æ–‡ä»¶ä¸­å¦‚æžœæœ‰ä¸­æ–‡åç§°åŠ åŽ‹åŽçš„æ–‡ä»¶ä¼šå‡ºçŽ°ä¹±ç ï¼Œä½†æ˜¯è§£åŽ‹ä¹‹åŽåˆokäº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸­æ–‡ * * &lt;/br&gt;æä¾›äº†å¤§æ–‡ä»¶å¼‚æ­¥åŠ åŽ‹è§£åŽ‹çš„æ–¹æ³•ï¼Œä½¿ç”¨å›žè°ƒæ£€æµ‹æ˜¯å¦å®Œæˆ * * &lt;/br&gt;æä¾›å°æ–‡ä»¶åŒæ­¥åŠ åŽ‹è§£åŽ‹æ›´åŠ æ–¹ä¾¿ * */public class ZipUtils &#123; /** * ç”¨äºŽå¤§æ–‡ä»¶åŠ åŽ‹è§£åŽ‹çš„å›žè°ƒç›‘å¬ * * @author chendong * */ public interface OnZipOverListener &#123; void onZipOver(); &#125; public interface OnUnZipOverListener &#123; void onUnZipOver(); &#125; /** * åŽ‹ç¼© &lt;/br&gt;æž„é€ æºæ–‡ä»¶ * * @param src * æºæ–‡ä»¶è·¯å¾„ * @param dest * ç›®æ ‡æ–‡ä»¶è·¯å¾„ * @throws FileNotFoundException */ public static void zip(String src, String dest, OnZipOverListener listener) &#123; File srcFile = new File(src); zip(srcFile, dest, listener); &#125; /** * åŽ‹ç¼© &lt;/br&gt;ç”ŸæˆåŽ‹ç¼©è¾“å‡ºæ–‡ä»¶æµ * * @param srcFile * @param dest * @throws FileNotFoundException */ public static void zip(File srcFile, String dest, OnZipOverListener listener) &#123; ZipOutputStream destOs = null; try &#123; destOs = new ZipOutputStream(new FileOutputStream(dest)); zip(srcFile, destOs, ""); close(destOs); if (listener != null) listener.onZipOver(); &#125; catch (FileNotFoundException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; finally &#123; close(destOs); &#125; &#125; /** * åŽ‹ç¼©,ä½¿ç”¨é€’å½’ &lt;/br&gt;å†™æ–‡ä»¶ &lt;/br&gt;ä¸»è¦æ“ä½œåœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œä½¿ç”¨é€’å½’å¦‚æžœæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå°†å…¶å†™å…¥æµä¸­å¦åˆ™è¿›è¡Œé€’å½’ &lt;/br&gt;ZipEntry * ç±»æ˜¯java.util.zipåŒ…ä¸‹çš„ä¸€ä¸ªç±»ï¼Œ ZipEntry ç±»ç”¨äºŽè¡¨ç¤º ZIP æ–‡ä»¶æ¡ç›®ã€‚ åˆ©ç”¨è¿™ä¸ªç±»åŽ‹ç¼©å’Œè§£åŽ‹zipæ–‡ä»¶ * * @param srcFile * @param destOs * @param string * @throws IOException */ private static void zip(File srcFile, ZipOutputStream destOs, String base) &#123; BufferedInputStream bis = null; try &#123; if (srcFile.isDirectory()) &#123; /* å¦‚æžœæºæ–‡ä»¶æ˜¯ç›®å½• */ File[] files = srcFile.listFiles(); destOs.putNextEntry(new ZipEntry(base + "/")); base = base.length() == 0 ? "" : base + "/"; for (int i = 0; i &lt; files.length; i++) &#123; zip(files[i], destOs, base + files[i].getName()); &#125; &#125; else &#123; /* å¦‚æžœæ˜¯æ–‡ä»¶ */ destOs.putNextEntry(new ZipEntry(base)); bis = new BufferedInputStream(new FileInputStream(srcFile)); byte[] buffer = new byte[1024]; int len = 0; while ((len = bis.read(buffer)) != -1) &#123; destOs.write(buffer, 0, len); &#125; close(bis); &#125; &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; finally &#123; close(bis); &#125; &#125; /** * è§£åŽ‹ * * @param src * æºæ–‡ä»¶ï¼Œéœ€è¦æ˜¯zipæ–‡ä»¶ * @param dest * ç›®æ ‡æ–‡ä»¶ï¼Œ */ public static void unzip(String src, String dest, OnUnZipOverListener listener) &#123; File destFile = new File(dest); /* ç›®æ ‡æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¹‹ */ if (!destFile.exists()) &#123; destFile.mkdirs(); &#125; /* æž„é€ æºæ–‡ä»¶ */ File srcFile = new File(src); if (!srcFile.exists()) &#123; return; &#125; unzip(srcFile, dest, listener); &#125; /** * è§£åŽ‹ * * @param srcFile * @param destFile */ public static void unzip(File srcFile, String dest, OnUnZipOverListener listener) &#123; BufferedInputStream bis = null; BufferedOutputStream bos = null; try &#123; ZipFile srcZipFile = new ZipFile(srcFile); /* èŽ·å¾—zipentryçš„æžšä¸¾ */ Enumeration e = srcZipFile.entries(); ZipEntry entry = null;// ZipInputStream zis = new ZipInputStream(// new FileInputStream(srcFile)); // while((entry=zis.getNextEntry())!=null)&#123; while (e.hasMoreElements()) &#123; entry = (ZipEntry) e.nextElement(); if (entry.toString().equals("/")) &#123; continue; &#125; bis = new BufferedInputStream(srcZipFile.getInputStream(entry)); /* æž„å»ºå¯¹åº”è¾“å‡ºæµ */ bos = new BufferedOutputStream(new FileOutputStream(dest + "/" + entry.getName())); int len = 0; byte[] buffer = new byte[1024]; while ((len = bis.read(buffer)) != -1) &#123; bos.write(buffer, 0, len); &#125; bos.flush(); close(bis); close(bos); &#125; if (listener != null) listener.onUnZipOver(); &#125; catch (ZipException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; finally &#123; close(bis); close(bos); &#125; &#125; /** * åŽ‹ç¼©å•ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶,ä½†æ˜¯ä¸å¯ä»¥åŒæ—¶åŽ‹ç¼©æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ * * @param src * æƒ³è¦åŽ‹ç¼©çš„æ–‡ä»¶è·¯å¾„ï¼Œä¸å¯ä»¥æ˜¯æ–‡ä»¶å¤¹ * @param dest * ç›®æ ‡è·¯å¾„ï¼Œxx.zip */ public static void zipFile(String[] src, String dest, OnZipOverListener listener) &#123; File parent = new File(new File(dest).getParent() + "/temp"); if (!parent.exists()) &#123; parent.mkdirs(); &#125; BufferedInputStream bis = null; BufferedOutputStream bos = null; File file = null; try &#123; int len = 0; byte[] buffer = new byte[1024]; for (String path : src) &#123; file = new File(path); bis = new BufferedInputStream(new FileInputStream(file)); bos = new BufferedOutputStream(new FileOutputStream( parent.getAbsolutePath() + "/" + file.getName())); while ((len = bis.read(buffer)) != -1) &#123; bos.write(buffer, 0, len); &#125; bos.flush(); close(bos); close(bis); &#125; zip(parent, dest, listener); for (File ff : parent.listFiles()) &#123; ff.delete(); &#125; parent.delete(); &#125; catch (FileNotFoundException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; finally &#123; close(bos); close(bis); &#125; &#125; private static void close(Closeable close) &#123; if (close != null) &#123; try &#123; close.close(); &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; &#125; &#125;&#125; GZIPåŽ‹ç¼© è¿™ä¸ªæ²¡å¤ªæžæ‡‚ï¼Œä¸€ç›´åœ¨å¼„åŠ åŽ‹è§£åŽ‹æœ‰ç‚¹çƒ¦äº†ï¼Œæ”¹å¤©å†è¯´å§ï¼Œè´´ä¸€ä¸‹å·²ç»å®žçŽ°çš„ç®€å•åŠŸèƒ½ã€‚å°±æ˜¯åŠ åŽ‹ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ¬èº«GZIPå°±æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡åªèƒ½åŽ‹ç¼©ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åŽ‹ç¼©å¤šä¸ªé—®ä»·çš„æ—¶å€™è¦ä½¿ç”¨tarå…ˆæ‰“åŒ…ï¼Œçœ‹åˆ°ç½‘ä¸Šæœ‰å®žçŽ°è¿™ä¸ªåŠŸèƒ½çš„ï¼Œä½†æ˜¯ä½¿ç”¨çš„é˜¿å¸•å¥‡çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå°±æ²¡åŽ»è¯•,è¿™éƒ¨åˆ†çš„æœ‰ç‚¹ä»“ä¿ƒï¼Œä¸»è¦æ˜¯çƒ¦äº†ï¼Œå†™å®Œè¿™ä¸ªæˆ‘å°±åŽ»çœ‹ç‚¹åˆ«çš„äº†ï¼Œè€çœ‹ä¸€ä¸ªä¸œè¥¿çƒ¦å¾—æ…Œï¼Œæ”¹å¤©ä¼šåœ¨å®Œå–„å§ã€‚ ä»£ç å®žçŽ°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109import java.io.BufferedInputStream;import java.io.BufferedOutputStream;import java.io.Closeable;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.IOException;import java.util.zip.GZIPInputStream;import java.util.zip.GZIPOutputStream;/** * * ä½¿ç”¨javaå†…ç½®APIå®Œæˆæ–‡ä»¶çš„åŠ åŽ‹è§£åŽ‹&lt;/br&gt; * ä½¿ç”¨gzipåŽ‹ç¼©åŽ‹ç¼©æ•ˆæžœæ›´å¥½ï¼Œä½†æ˜¯gzipåŽ‹ç¼©åªèƒ½æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªåŽ‹ç¼©åŒ…åªèƒ½è§£åŽ‹å‡ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥æƒ³åŽ‹ç¼©å¤šä¸ªæ–‡ä»¶æ—¶å°±éœ€è¦å…ˆä½¿ç”¨taråŽ‹æˆä¸€ä¸ªåŒ… * ï¼Œå†ç”¨gzipåŽ‹ç¼© * * @author chendong * */public class GZipUtils &#123; /** * gzipåŽ‹ç¼©ï¼Œå°†ä¸€ä¸ªæ–‡ä»¶åŽ‹ç¼©åˆ°åˆ¶å®šåŒ… * * @param src * @param dest */ public static void gzip(String src) &#123; File srcFile = new File(src); if (!srcFile.exists()) &#123; return; &#125; BufferedInputStream bis = null; GZIPOutputStream gos = null; File destFile = new File(src + ".gz"); try &#123; /* èŽ·å¾—è¾“å…¥æµ */ bis = new BufferedInputStream(new FileInputStream(src)); /* èŽ·å¾—åŽ‹ç¼©è¾“å‡ºæµ */ gos = new GZIPOutputStream(new BufferedOutputStream( new FileOutputStream(destFile))); int len = 0; byte[] buffer = new byte[1024]; while ((len = bis.read(buffer)) != -1) &#123; gos.write(buffer, 0, len); &#125; gos.flush(); &#125; catch (FileNotFoundException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; finally &#123; close(gos); close(bis); &#125; &#125; /** * è§£åŽ‹ * @param src * @param dest */ public static void ungzip(String src, String dest) &#123; File destFile = new File(dest); File srcFile = new File(src); GZIPInputStream gis = null; BufferedOutputStream bos = null; try &#123; if (!destFile.exists()) &#123; destFile.createNewFile(); &#125; if (!srcFile.exists()) &#123; return; &#125; bos = new BufferedOutputStream(new FileOutputStream(destFile)); gis = new GZIPInputStream(new FileInputStream(srcFile)); int len = 0; byte[] buffer = new byte[1024]; while ((len = gis.read(buffer)) != -1) &#123; bos.write(buffer, 0, len); &#125; &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; finally &#123; close(bos); close(gis); &#125; &#125; public static void pack(File files[]) &#123; &#125; private static void close(Closeable close) &#123; if (close != null) &#123; try &#123; close.close(); &#125; catch (IOException e) &#123; // TODO Auto-generated catch block e.printStackTrace(); &#125; &#125; &#125;&#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¿å­˜ç…§ç‰‡å’Œè§†é¢‘åˆ°ç›¸å†Œæ˜¾ç¤º]]></title>
    <url>%2Farticle%2F1969447237%2F</url>
    <content type="text"><![CDATA[ç…§ç‰‡å’Œè§†é¢‘ä¿å­˜åˆ°æœ¬åœ°çš„æ–¹æ³•å¤§è‡´éƒ½æ˜¯é€šè¿‡æµçš„æ–¹å¼å†™å…¥æ–‡ä»¶é‡Œé¢å°±å¯ä»¥è¾¾åˆ°ä¿å­˜åˆ°æ–‡ä»¶å¤¹çš„ç›®çš„ï¼Œä½†æ˜¯ä½ ä¿å­˜åˆ°æ–‡ä»¶å¤¹çš„èµ„æºå´ä¸ä¸€å®šèƒ½å¤Ÿåœ¨ç›¸å†Œæ˜¾ç¤ºå‡ºæ¥ï¼Œåªèƒ½ç¿»çœ‹æ–‡ä»¶ç®¡ç†ã€‚æ€Žä¹ˆèƒ½å¤Ÿå°†ä¿å­˜åˆ°æœ¬åœ°çš„ç…§ç‰‡è§†é¢‘æ˜¾ç¤ºåœ¨ç³»ç»Ÿç›¸å†Œä¸­ï¼Œæœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯å‘é€å¹¿æ’­æ‰«æçš„æ–¹å¼æ¥é€šçŸ¥ç³»ç»Ÿæ‰«ææ–‡ä»¶å¤¹ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼ç»å¸¸ä¸èµ·ä½œç”¨ï¼Œæ ¹æœ¬åŽŸå› åœ¨äºŽï¼Œå‘ç³»ç»Ÿå‘é€å¹¿æ’­æ—¶ç³»ç»Ÿåªä¼šåŽ»æ‰«æç³»ç»Ÿèµ„æºçš„ç›¸å†Œï¼Œå¦‚æžœä½ ä¿å­˜çš„æ–‡ä»¶å¤¹æ˜¯è‡ªå·±å»ºç«‹çš„ï¼Œé‚£ä¹ˆä½ å‘å¹¿æ’­æ—¶ç³»ç»Ÿæ˜¯ä¸ä¼šæ‰«æåˆ°çš„ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæƒ³è¦æ˜¾ç¤ºåœ¨ç›¸å†Œéœ€è¦å°†æ•°æ®æ’å…¥åˆ°ContentProviderä¸­ï¼Œå› æ­¤å¯¹äºŽéžç³»ç»Ÿèƒ½å¤Ÿæ‰«æåˆ°çš„ç›¸å†Œæˆ‘ä»¬ä½¿ç”¨æ‰‹åŠ¨æ’å…¥çš„æ–¹å¼ã€‚ ä¿å­˜åˆ°ç³»ç»Ÿèµ„æºç›¸å†Œç³»ç»Ÿç›¸å†ŒæŒ‡çš„çš„æ˜¯Cameraã€DCIMç­‰ç­‰è¿™äº›ç›®å½•å¯¹åº”çš„ç›¸å†Œï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰«æçš„ç›¸å†Œï¼Œä½†æ˜¯æš‚æ—¶æ²¡æœ‰åŽ»æ•´ç†è¿™äº›ã€‚å¯¹äºŽç³»ç»Ÿç›¸å†Œæ¥è¯´ï¼Œåªéœ€è¦å‘é€å¹¿æ’­è¿›è¡Œæ‰«æå³å¯ï¼Œæ•°æ®ä¼šè‡ªåŠ¨æ·»åŠ åˆ°ContentProviderä¸­ï¼Œå½“ç„¶å¦‚æžœä¸å‘é€å¹¿æ’­ï¼Œåœ¨æ‰‹æœºé‡å¯æˆ–è€…è¿‡ä¸€æ®µæ—¶é—´ä¹‹åŽï¼Œæ‰«ææ“ä½œä»ä¼šå¼€å¯ï¼Œå› æ­¤ç»å¯¹ç»å¯¹ä¸å¯ä»¥è‡ªå·±åŽ»è¿›è¡Œæ’å…¥æ“ä½œï¼Œå¦åˆ™ç›¸å†Œä¸­ä¼šå‡ºçŽ°ä¸¤å¼ ç›¸åŒçš„ç…§ç‰‡ã€‚ 12345678910111213/** * é’ˆå¯¹ç³»ç»Ÿæ–‡å¤¹åªéœ€è¦æ‰«æ,ä¸ç”¨æ’å…¥å†…å®¹æä¾›è€…,ä¸ç„¶ä¼šé‡å¤ * * @param context ä¸Šä¸‹æ–‡ * @param filePath æ–‡ä»¶è·¯å¾„ */private static void scanFile(Context context, String filePath) &#123; if (!checkFile(filePath)) return; Intent intent = new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE); intent.setData(Uri.fromFile(new File(filePath))); context.sendBroadcast(intent);&#125; ä¿å­˜åˆ°éžç³»ç»Ÿèµ„æºç›¸å†Œä¿å­˜åˆ°éžç³»ç»Ÿèµ„æºç›¸å†Œä¸­æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦è¿›è¡ŒContentProviderçš„æ’å…¥æ›´æ–°ï¼Œæ¥è¾¾åˆ°å¯ä»¥åœ¨ç›¸å†Œæ˜¾ç¤ºçš„ç›®çš„ã€‚ åˆå§‹åŒ– ContentValues å…¬å…±å­—æ®µç…§ç‰‡å’Œè§†é¢‘æ˜¯æœ‰ä¸€äº›å…¬å…±å­—æ®µï¼Œå†™ä¸€ä¸ªåˆå§‹åŒ–å…¬å…±å­—æ®µçš„æ–¹æ³•ï¼Œç®€åŒ–MediaStoreå­—æ®µçš„å†™å…¥æ“ä½œã€‚ 12345678910111213141516171819/** * æ’å…¥æ—¶åˆå§‹åŒ–å…¬å…±å­—æ®µ * * @param filePath æ–‡ä»¶ * @param time ms * @return ContentValues */private static ContentValues initCommonContentValues(String filePath, long time) &#123; ContentValues values = new ContentValues(); File saveFile = new File(filePath); long timeMillis = getTimeWrap(time); values.put(MediaStore.MediaColumns.TITLE, saveFile.getName()); values.put(MediaStore.MediaColumns.DISPLAY_NAME, saveFile.getName()); values.put(MediaStore.MediaColumns.DATE_MODIFIED, timeMillis); values.put(MediaStore.MediaColumns.DATE_ADDED, timeMillis); values.put(MediaStore.MediaColumns.DATA, saveFile.getAbsolutePath()); values.put(MediaStore.MediaColumns.SIZE, saveFile.length()); return values;&#125; æ’å…¥ç…§ç‰‡èµ„æºä¿å­˜ç…§ç‰‡åˆ°æœ¬åœ°ï¼Œå¹¶é€šçŸ¥ç›¸å†Œæ˜¾ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æ—¶é—´çš„å•ä½å¿…é¡»æ˜¯ms 123456789101112131415161718192021222324252627/** * ä¿å­˜åˆ°ç…§ç‰‡åˆ°æœ¬åœ°ï¼Œå¹¶æ’å…¥MediaStoreä»¥ä¿è¯ç›¸å†Œå¯ä»¥æŸ¥çœ‹åˆ° * è¿™æ˜¯æ›´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œé˜²æ­¢è¯»å–çš„ç…§ç‰‡èŽ·å–ä¸åˆ°å®½é«˜ * * @param context ä¸Šä¸‹æ–‡ * @param filePath æ–‡ä»¶è·¯å¾„ * @param createTime åˆ›å»ºæ—¶é—´ &lt;=0æ—¶ä¸ºå½“å‰æ—¶é—´ ms * @param width å®½åº¦ * @param height é«˜åº¦ */public static void insertImageToMediaStore(Context context, String filePath, long createTime, int width, int height) &#123; if (!checkFile(filePath)) return; createTime = getTimeWrap(createTime); ContentValues values = initCommonContentValues(filePath, createTime); values.put(MediaStore.Images.ImageColumns.DATE_TAKEN, createTime); values.put(MediaStore.Images.ImageColumns.ORIENTATION, 0); values.put(MediaStore.Images.ImageColumns.ORIENTATION, 0); if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN) &#123; if (width &gt; 0) values.put(MediaStore.Images.ImageColumns.WIDTH, 0); if (height &gt; 0) values.put(MediaStore.Images.ImageColumns.HEIGHT, 0); &#125; values.put(MediaStore.MediaColumns.MIME_TYPE, getPhotoMimeType(filePath)); context.getApplicationContext().getContentResolver() .insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);&#125; æ’å…¥è§†é¢‘èµ„æºä¿å­˜è§†é¢‘åˆ°æœ¬åœ°ï¼Œå¹¶é€šçŸ¥ç›¸å†Œæ˜¾ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æ—¶é—´çš„å•ä½å¿…é¡»æ˜¯ms 123456789101112131415161718192021222324252627/** * ä¿å­˜åˆ°è§†é¢‘åˆ°æœ¬åœ°ï¼Œå¹¶æ’å…¥MediaStoreä»¥ä¿è¯ç›¸å†Œå¯ä»¥æŸ¥çœ‹åˆ° * è¿™æ˜¯æ›´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œé˜²æ­¢è¯»å–çš„è§†é¢‘èŽ·å–ä¸åˆ°å®½é«˜ * * @param context ä¸Šä¸‹æ–‡ * @param filePath æ–‡ä»¶è·¯å¾„ * @param createTime åˆ›å»ºæ—¶é—´ &lt;=0æ—¶ä¸ºå½“å‰æ—¶é—´ ms * @param duration è§†é¢‘é•¿åº¦ ms * @param width å®½åº¦ * @param height é«˜åº¦ */public static void insertVideoToMediaStore(Context context, String filePath, long createTime, int width, int height, long duration) &#123; if (!checkFile(filePath)) return; createTime = getTimeWrap(createTime); ContentValues values = initCommonContentValues(filePath, createTime); values.put(MediaStore.Video.VideoColumns.DATE_TAKEN, createTime); if (duration &gt; 0) values.put(MediaStore.Video.VideoColumns.DURATION, duration); if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN) &#123; if (width &gt; 0) values.put(MediaStore.Video.VideoColumns.WIDTH, width); if (height &gt; 0) values.put(MediaStore.Video.VideoColumns.HEIGHT, height); &#125; values.put(MediaStore.MediaColumns.MIME_TYPE, getVideoMimeType(filePath)); context.getContentResolver().insert(MediaStore.Video.Media.EXTERNAL_CONTENT_URI, values);&#125; æ³¨æ„åœ¨åº”ç”¨è¿‡ç¨‹ä¸­å‘çŽ°ï¼Œvivoæ‰‹æœºå’Œé­…æ—æ‰‹æœºéƒ¨åˆ†æœºåž‹åªæ”¯æŒåœ¨æ–‡ä»¶ç®¡ç†ä¸­æŸ¥çœ‹è§†é¢‘ï¼Œä½¿ç”¨æœ¬æ–‡æè¿°çš„æ–¹æ³•æ·»åŠ åŽæ²¡æœ‰æ•ˆæžœï¼Œç”¨å¾®ä¿¡ä¿å­˜è§†é¢‘è¯•äº†ä¸€ä¸‹åŒæ ·ä¸èƒ½åœ¨ç›¸å†Œä¸­å°†è§†é¢‘æ˜¾ç¤ºå‡ºæ¥ï¼Œåº”è¯¥æ˜¯æ‰‹æœºçš„åŽŸå› ï¼Œç‰¹æ­¤å£°æ˜Žã€‚ é™„æºç è´´ä¸€ä¸‹å·¥å…·ç±»æºä»£ç ï¼Œå¤šäº†ä¸€äº›è¾…åŠ©æ–¹æ³•ï¼Œæ¯”å¦‚èŽ·å–mime_typeçš„å‚æ•°ç­‰æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174/** * CreateAt : 2017/5/24 * Describe : ç›¸å†Œæ›´æ–°é€šçŸ¥å¸®åŠ©ç±» * åˆ›å»ºæ—¶é—´å•ä½ms * è§†é¢‘æ—¶é•¿å•ä½ms * * @author chendong */public class AlbumNotifyHelper &#123; public static final String TAG = AlbumNotifyHelper.class.getSimpleName(); /////////////////////////////////////////////////////////////////////////// // ä¸‹é¢æ˜¯å¯¹å¤–å…¬å¼€çš„é‡è½½çš„æ–¹æ³• /////////////////////////////////////////////////////////////////////////// public static void notifyScanDcim(Context context, String filePath) &#123; scanFile(context, filePath); &#125; public static void insertVideoToMediaStore(Context context, String filePath, long dateTaken, long duration) &#123; insertVideoToMediaStore(context, filePath, dateTaken, 0, 0, duration); &#125; public static void insertVideoToMediaStore(Context context, VideoUtil.VideoInfo videoInfo) &#123; insertVideoToMediaStore(context, videoInfo.originalVideoFilePath, videoInfo.dateTaken, videoInfo.width, videoInfo.height, videoInfo.duringTime); &#125; public static void insertImageToMediaStore(Context context, String filePath, long createTime) &#123; insertImageToMediaStore(context, filePath, createTime, 0, 0); &#125; /////////////////////////////////////////////////////////////////////////// // æ‰«æç³»ç»Ÿç›¸å†Œæ ¸å¿ƒæ–¹æ³• /////////////////////////////////////////////////////////////////////////// /** * é’ˆå¯¹ç³»ç»Ÿæ–‡å¤¹åªéœ€è¦æ‰«æ,ä¸ç”¨æ’å…¥å†…å®¹æä¾›è€…,ä¸ç„¶ä¼šé‡å¤ * * @param context ä¸Šä¸‹æ–‡ * @param filePath æ–‡ä»¶è·¯å¾„ */ public static void scanFile(Context context, String filePath) &#123; if (!checkFile(filePath)) return; Intent intent = new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE); intent.setData(Uri.fromFile(new File(filePath))); context.sendBroadcast(intent); &#125; /////////////////////////////////////////////////////////////////////////// // éžç³»ç»Ÿç›¸å†ŒåƒMediaContentä¸­æ’å…¥æ•°æ®ï¼Œæ ¸å¿ƒæ–¹æ³• /////////////////////////////////////////////////////////////////////////// /** * é’ˆå¯¹éžç³»ç»Ÿæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶,ä½¿ç”¨è¯¥æ–¹æ³• * æ’å…¥æ—¶åˆå§‹åŒ–å…¬å…±å­—æ®µ * * @param filePath æ–‡ä»¶ * @param time ms * @return ContentValues */ private static ContentValues initCommonContentValues(String filePath, long time) &#123; ContentValues values = new ContentValues(); File saveFile = new File(filePath); long timeMillis = getTimeWrap(time); values.put(MediaStore.MediaColumns.TITLE, saveFile.getName()); values.put(MediaStore.MediaColumns.DISPLAY_NAME, saveFile.getName()); values.put(MediaStore.MediaColumns.DATE_MODIFIED, timeMillis); values.put(MediaStore.MediaColumns.DATE_ADDED, timeMillis); values.put(MediaStore.MediaColumns.DATA, saveFile.getAbsolutePath()); values.put(MediaStore.MediaColumns.SIZE, saveFile.length()); return values; &#125; /** * ä¿å­˜åˆ°ç…§ç‰‡åˆ°æœ¬åœ°ï¼Œå¹¶æ’å…¥MediaStoreä»¥ä¿è¯ç›¸å†Œå¯ä»¥æŸ¥çœ‹åˆ°,è¿™æ˜¯æ›´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œé˜²æ­¢è¯»å–çš„ç…§ç‰‡èŽ·å–ä¸åˆ°å®½é«˜ * * @param context ä¸Šä¸‹æ–‡ * @param filePath æ–‡ä»¶è·¯å¾„ * @param createTime åˆ›å»ºæ—¶é—´ &lt;=0æ—¶ä¸ºå½“å‰æ—¶é—´ ms * @param width å®½åº¦ * @param height é«˜åº¦ */ public static void insertImageToMediaStore(Context context, String filePath, long createTime, int width, int height) &#123; if (!checkFile(filePath)) return; createTime = getTimeWrap(createTime); ContentValues values = initCommonContentValues(filePath, createTime); values.put(MediaStore.Images.ImageColumns.DATE_TAKEN, createTime); values.put(MediaStore.Images.ImageColumns.ORIENTATION, 0); values.put(MediaStore.Images.ImageColumns.ORIENTATION, 0); if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN) &#123; if (width &gt; 0) values.put(MediaStore.Images.ImageColumns.WIDTH, 0); if (height &gt; 0) values.put(MediaStore.Images.ImageColumns.HEIGHT, 0); &#125; values.put(MediaStore.MediaColumns.MIME_TYPE, getPhotoMimeType(filePath)); context.getApplicationContext().getContentResolver().insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values); &#125; /** * ä¿å­˜åˆ°è§†é¢‘åˆ°æœ¬åœ°ï¼Œå¹¶æ’å…¥MediaStoreä»¥ä¿è¯ç›¸å†Œå¯ä»¥æŸ¥çœ‹åˆ°,è¿™æ˜¯æ›´ä¼˜åŒ–çš„æ–¹æ³•ï¼Œé˜²æ­¢è¯»å–çš„è§†é¢‘èŽ·å–ä¸åˆ°å®½é«˜ * * @param context ä¸Šä¸‹æ–‡ * @param filePath æ–‡ä»¶è·¯å¾„ * @param createTime åˆ›å»ºæ—¶é—´ &lt;=0æ—¶ä¸ºå½“å‰æ—¶é—´ ms * @param duration è§†é¢‘é•¿åº¦ ms * @param width å®½åº¦ * @param height é«˜åº¦ */ public static void insertVideoToMediaStore(Context context, String filePath, long createTime, int width, int height, long duration) &#123; if (!checkFile(filePath)) return; createTime = getTimeWrap(createTime); ContentValues values = initCommonContentValues(filePath, createTime); values.put(MediaStore.Video.VideoColumns.DATE_TAKEN, createTime); if (duration &gt; 0) values.put(MediaStore.Video.VideoColumns.DURATION, duration); if (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN) &#123; if (width &gt; 0) values.put(MediaStore.Video.VideoColumns.WIDTH, width); if (height &gt; 0) values.put(MediaStore.Video.VideoColumns.HEIGHT, height); &#125; values.put(MediaStore.MediaColumns.MIME_TYPE, getVideoMimeType(filePath)); context.getContentResolver().insert(MediaStore.Video.Media.EXTERNAL_CONTENT_URI, values); &#125; // æ˜¯ä¸æ˜¯ç³»ç»Ÿç›¸å†Œ private static boolean isSystemDcim(String path) &#123; return path.toLowerCase().contains(&quot;dcim&quot;) || path.toLowerCase().contains(&quot;camera&quot;); &#125; // èŽ·å–ç…§ç‰‡çš„mine_type private static String getPhotoMimeType(String path) &#123; String lowerPath = path.toLowerCase(); if (lowerPath.endsWith(&quot;jpg&quot;) || lowerPath.endsWith(&quot;jpeg&quot;)) &#123; return &quot;image/jpeg&quot;; &#125; else if (lowerPath.endsWith(&quot;png&quot;)) &#123; return &quot;image/png&quot;; &#125; else if (lowerPath.endsWith(&quot;gif&quot;)) &#123; return &quot;image/gif&quot;; &#125; return &quot;image/jpeg&quot;; &#125; // èŽ·å–videoçš„mine_type,æš‚æ—¶åªæ”¯æŒmp4,3gp private static String getVideoMimeType(String path) &#123; String lowerPath = path.toLowerCase(); if (lowerPath.endsWith(&quot;mp4&quot;) || lowerPath.endsWith(&quot;mpeg4&quot;)) &#123; return &quot;video/mp4&quot;; &#125; else if (lowerPath.endsWith(&quot;3gp&quot;)) &#123; return &quot;video/3gp&quot;; &#125; return &quot;video/mp4&quot;; &#125; // èŽ·å¾—è½¬åŒ–åŽçš„æ—¶é—´ private static long getTimeWrap(long time) &#123; if (time &lt;= 0) &#123; return System.currentTimeMillis(); &#125; return time; &#125; // æ£€æµ‹æ–‡ä»¶å­˜åœ¨ private static boolean checkFile(String filePath) &#123; boolean result = FileUtil.fileIsExist(filePath); Log.e(TAG, &quot;æ–‡ä»¶ä¸å­˜åœ¨ path = &quot; + filePath); return result; &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰æŽ§ä»¶ä¹å®«æ ¼æ»‘åŠ¨è§£é”]]></title>
    <url>%2Farticle%2F2317215752%2F</url>
    <content type="text"><![CDATA[1. å‰è¨€ æœ€è¿‘æƒ³ç»™è‡ªå·±åšçš„çš„appæ·»åŠ ä¸€ä¸ªæ»‘åŠ¨è§£é”çš„åŠŸèƒ½ï¼Œç”¨çš„æ˜¯ä¹è§†çš„æ‰‹æœºï¼Œå°±æ¨¡ä»¿å®ƒçš„æ•ˆæžœå®žçŽ°. è§†é¢‘æ¼”ç¤ºä¸€ä¸‹æ•ˆæžœ GitHub 2. LockPointå®žä½“ æ¯ä¸ªç‚¹æ˜¯ä¸€ä¸ªå®žä½“ï¼ˆLockPointï¼‰ç”¨æ¥å­˜å‚¨è¿™ä¸ªç‚¹çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç‚¹çš„ç‰©ç†ä½ç½®(x,y)å’Œç‚¹çš„indexä½ç½®(0-8) 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162class LockPoint &#123; // ç‚¹çš„ä½ç½® 0-8 int index; // ç‚¹çš„x,yåæ ‡ float x, y; // æž„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸€ä¸ªç‚¹ LockPoint(int index, float x, float y) &#123; this.index = index; this.x = x; this.y = y; &#125; // æž„é€ æ–¹æ³•ï¼Œä»Žå¦ä¸€ä¸ªç‚¹åˆå§‹åŒ– LockPoint(LockPoint p) &#123; this.x = p.x; this.y = p.y; this.index = p.index; &#125; // é»˜è®¤æž„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºçš„ç‚¹ LockPoint() &#123; this.x = -1; this.y = -1; this.index = -1; &#125; // åˆ¤æ–­è¯¥ç‚¹æ˜¯ä¸æ˜¯ä¸€ä¸ªç©ºçš„ç‚¹ boolean isEmpty() &#123; return this.x == -1 &amp;&amp; this.y == -1; &#125; // é‡æ–°ç»™ä½ç½®èµ‹å€¼ void init(float x, float y) &#123; this.x = x; this.y = y; &#125; // è®¾ç½®ä¸ºå¦ä¸€ç‚¹çš„å€¼ void init(LockPoint p) &#123; this.x = p.x; this.y = p.y; this.index = p.index; &#125; // åˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯ä¸æ˜¯åœ¨è¯¥ç‚¹è§¦æ‘¸èŒƒå›´å†…,touchSensitiveRangeä¸ºè§¦æ‘¸æœ‰æ•ˆåŠå¾„ boolean isTouchIn(float judgeX, float judgeY) &#123; return judgeX &lt; x + touchSensitiveRange &amp;&amp; judgeX &gt; x - touchSensitiveRange &amp;&amp; judgeY &lt; y + touchSensitiveRange &amp;&amp; judgeY &gt; y - touchSensitiveRange; &#125; // é‡å†™equalså’ŒhashCode @Override public boolean equals(Object o) &#123; LockPoint p = (LockPoint) o; return p.x == x &amp;&amp; p.y == y; &#125; @Override public int hashCode() &#123; return 2; &#125; String out(String tag) &#123; return tag + " : x = " + x + " , y = " + y; &#125; &#125; 3. åˆå§‹åŒ– åˆå§‹åŒ–ä¹ä¸ªç‚¹çš„ä½ç½®ï¼Œéœ€è¦æ ¹æ®æŽ§ä»¶çš„å¤§å°åŠ¨æ€è®¡ç®—ï¼Œå› æ­¤åœ¨onMeare()ä¹‹åŽè¿›è¡Œ éœ€æ±‚æ˜¯éœ€è¦å°†ä¹ä¸ªç‚¹æ”¾åœ¨æŽ§ä»¶ä¸­é—´ï¼Œæ¥é€‚åº”æŽ§ä»¶å¤§å°çš„å˜åŒ–ï¼Œé¦–å…ˆç¡®å®šç¬¬ä¸€ä¸ªç‚¹è·ç¦»å·¦è¾¹çš„è·ç¦»startSpaceï¼Œä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦» =ï¼ˆæŽ§ä»¶å®½åº¦ - 2 * startSpaceï¼‰ï¼2 123456789101112int size = getMeasuredWidth(); // å°†å®½é«˜è®¾ç½®ä¸ºä¸€æ ·çš„ï¼Œæ­£æ–¹å½¢ setMeasuredDimension(size, size); // åˆå§‹åŒ–å±å¹•ä¸­çš„ä¹ä¸ªç‚¹çš„ä½ç½®å’Œä¸‹æ ‡ initLockPointArray = new LockPoint[9]; // startSpace ä¸ºè·ç¦»å·¦è¾¹çš„è·ç¦»ï¼Œè®¡ç®—ä¹ä¸ªç‚¹çš„ä½ç½®,ä¿è¯ä¹ä¸ªç‚¹æ”¾åœ¨æŽ§ä»¶ä¸­é—´ if (startSpace == AUTO_START_SPACING) &#123; //é»˜è®¤æ˜¯æŽ§ä»¶çš„1/4 startSpace = size / 4; &#125; // è®¡ç®—æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´çš„é—´éš” internalSpace = (size - 2 * startSpace) / 2; åˆå§‹åŒ–ä¹ä¸ªç‚¹çš„ä½ç½® 12345678// åˆå§‹åŒ–ä¹ä¸ªç‚¹çš„ä½ç½® int index = 0; for (int i = 0; i &lt; 3; i++) &#123; for (int j = 0; j &lt; 3; j++) &#123; initLockPointArray[index] = new LockPoint(index, startSpace + j * internalSpace, startSpace + i * internalSpace); index++; &#125; &#125; onMeasure()å®Œæ•´ä»£ç  123456789101112131415161718192021222324252627282930// onMeasureä¹‹åŽåˆå§‹åŒ–æ•°æ® @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; super.onMeasure(widthMeasureSpec, heightMeasureSpec); int size = getMeasuredWidth(); // å°†å®½é«˜è®¾ç½®ä¸ºä¸€æ ·çš„ï¼Œæ­£æ–¹å½¢ setMeasuredDimension(size, size); // åˆå§‹åŒ–å±å¹•ä¸­çš„ä¹ä¸ªç‚¹çš„ä½ç½®å’Œä¸‹æ ‡ if (initLockPointArray == null) &#123; initLockPointArray = new LockPoint[9]; // startSpace ä¸ºè·ç¦»å·¦è¾¹çš„è·ç¦»ï¼Œè®¡ç®—ä¹ä¸ªç‚¹çš„ä½ç½®æ”¾åœ¨æŽ§ä»¶ä¸­é—´ if (startSpace == AUTO_START_SPACING) &#123; startSpace = size / 4; &#125; // è®¡ç®—æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´çš„é—´éš” internalSpace = (size - 2 * startSpace) / 2; // åˆå§‹åŒ–ä¹ä¸ªç‚¹çš„ä½ç½® int index = 0; for (int i = 0; i &lt; 3; i++) &#123; for (int j = 0; j &lt; 3; j++) &#123; initLockPointArray[index] = new LockPoint(index, startSpace + j * internalSpace, startSpace + i * internalSpace); index++; &#125; &#125; // ä¸ºäº†åœ¨previewæ—¶èƒ½çœ‹åˆ°æ•ˆæžœ if (isInEditMode()) &#123; historyPointList.addAll(Arrays.asList(initLockPointArray)); &#125; &#125; &#125; 4. onDraw ç»˜åˆ¶è¿‡ç¨‹å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ ç»˜åˆ¶ä¹ä¸ªç‚¹ï¼Œè¿™æ˜¯æ¯æ¬¡éƒ½éœ€è¦ç»˜åˆ¶çš„ 1234LockPoint tempPoint;for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; canvas.drawCircle(initLockPointArray[i].x, initLockPointArray[i].y, pointRadius, pointPaint);&#125; ç»˜åˆ¶å·²ç»åˆ’è¿‡çš„ç‚¹ 123456// ç»˜åˆ¶ä¹‹å‰è§¦è¿‡å­˜å‚¨èµ·æ¥çš„çš„ç‚¹,ç»˜åˆ¶ç¬¬iä¸ªç‚¹å’Œi+1ä¸ªç‚¹ä¹‹é—´çš„çº¿ if (historyPointList.size() &gt; 0) &#123; for (int i = 0; i &lt; historyPointList.size() - 1; i++) &#123; canvas.drawLine(historyPointList.get(i).x, historyPointList.get(i).y, historyPointList.get(i + 1).x, historyPointList.get(i + 1).y, linePaint); &#125; &#125; ç»˜åˆ¶è§¦æ‘¸ç‚¹å’Œæœ€åŽä¸€ä¸ªç‚¹çš„è¿žçº¿ 123456// ç”»æœ€åŽä¸€ä¸ªç‚¹å’Œè§¦æ‘¸çš„ç‚¹ä¹‹é—´çš„çº¿ if (currentLockPoint != null &amp;&amp; currentLockPoint.x != -1 &amp;&amp; currentLockPoint.y != -1 &amp;&amp; touchPoint.x != -1 &amp;&amp; touchPoint.y != -1) &#123; canvas.drawLine(currentLockPoint.x, currentLockPoint.y, touchPoint.x, touchPoint.y, linePaint); &#125; 5. äº‹ä»¶å¤„ç† å¯¹ç”¨æˆ·touchäº‹ä»¶è¿›è¡Œå¤„ç† è¦è®°å½•å½“å‰è§¦æ‘¸çš„ç‚¹ï¼Œç”¨äºŽç»˜åˆ¶è·Ÿéšæ‰‹æŒ‡çš„è¿žçº¿ æ£€æµ‹è§¦æ‘¸çš„ç‚¹æ˜¯ä¸æ˜¯åœ¨ä¹ä¸ªç‚¹ä¸­æŸä¸ªç‚¹çš„èŒƒå›´å†…ï¼Œå¦‚æžœæ˜¯çš„è¯è¯¥ç‚¹è¦åŠ å…¥è¢«è§¦æ‘¸ç‚¹çš„åˆ—è¡¨ä¸­ å½“æ‰‹æŒ‡æŠ¬èµ·æ—¶ï¼Œæ¸…é™¤æ•°æ®,æ¢å¤åˆå§‹çŠ¶æ€ 12345678910111213141516171819202122232425262728293031323334353637@Override public boolean onTouchEvent(MotionEvent event) &#123; if (!isEnabled() || isEventOver) return false; int action = MotionEventCompat.getActionMasked(event); switch (action) &#123; // é‡æ–°åˆå§‹åŒ–è§¦æ‘¸ç‚¹ case MotionEvent.ACTION_DOWN: touchPoint.init(event.getX(), event.getY()); break; // ç§»åŠ¨æ—¶æ£€æµ‹æ˜¯å¦åœ¨è§¦æ‘¸èŒƒå›´å†… case MotionEvent.ACTION_MOVE: touchPoint.init(event.getX(), event.getY()); LockPoint tempPoint; for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; if (!historyPointList.contains(tempPoint) &amp;&amp; tempPoint.isTouchIn(event.getX(), event.getY())) &#123; historyPointList.add(new LockPoint(tempPoint)); currentLockPoint.init(tempPoint); break; &#125; &#125; break; // æŠ¬èµ·æ—¶ç»“æŸï¼Œé‡æ–°åˆå§‹åŒ– case MotionEvent.ACTION_UP: case MotionEvent.ACTION_CANCEL: touchPoint.init(-1, -1); currentLockPoint.init(-1, -1); historyPointList.clear(); break; &#125; postInvalidate(); return true; &#125; 6. ä¼˜åŒ–-å¤šç‚¹è§¦æŽ§äº‹ä»¶å¤„ç† ç”¨æˆ·åœ¨è§¦æ‘¸å±å¹•æ—¶å¯èƒ½æœ‰å¤šä¸ªæ‰‹æŒ‡åœ¨æ“ä½œï¼Œä¸Šé¢çš„ä»£ç åœ¨å•æŒ‡æ—¶æ²¡æœ‰é—®é¢˜ï¼Œå…¼å®¹å¤šç‚¹è§¦æŽ§çš„æ€è·¯æ˜¯ï¼š å½“ç”¨æˆ·è§¦å‘downäº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥èŽ·å–åˆ°ä¸€ä¸ªpointerIdï¼Œè¿™ä¸ªidå”¯ä¸€çš„æ ‡å¿—äº†è¿™ä¸ªæŒ‡å¤´ï¼ŒåŽé¢å‘ç”Ÿçš„æ‰€æœ‰äº‹ä»¶éƒ½ä½¿ç”¨ç”¨è¿™ä¸ªpointerIdæ¥èŽ·å–ï¼Œåªå¤„ç†è¿™ä¸ªæŒ‡å¤´çš„äº‹ä»¶ï¼Œé¿å…äº‹ä»¶çš„é”™ä¹±ã€‚ å½“æˆ‘ä»¬å¼€å§‹çš„æ—¶å€™æ ‡å¿—çš„é‚£ä¸ªæ‰‹æŒ‡æŠ¬èµ·æ¥äº†æ€Žä¹ˆåŠžå‘¢ï¼Œä¸¤ä¸ªè§£å†³æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯ç›´æŽ¥ç»“æŸæ•´ä¸ªæµç¨‹ï¼Œç›¸å½“äºŽå•æŒ‡æ—¶æ‰‹æŒ‡æŠ¬èµ·ã€‚ç¬¬äºŒä¸ªæ–¹æ³•å°±æ˜¯è½¬ç§»äº‹ä»¶ï¼Œå½“ä¸€ä¸ªæŒ‡å¤´æŠ¬èµ·æ—¶ï¼Œä»Žè¯¥äº‹ä»¶ä¸­èŽ·å–è¿˜æ²¡æŠ¬èµ·çš„æ‰‹æŒ‡ï¼Œæ›´æ”¹æ ‡å¿—çš„pointerId,äº‹ä»¶å°±è½¬ç§»åˆ°äº†å¦ä¸€ä¸ªæ‰‹æŒ‡ä¸Šï¼Œæˆ‘ä»¬å…³å¿ƒå°±æ˜¯æ–°æ‰‹æŒ‡çš„è§¦æ‘¸å•¦ å…³äºŽå¯¹äºŽäº‹ä»¶è¿›è¡Œå¤„ç†çš„ç›¸å…³æœºåˆ¶å¯ä»¥çœ‹Androidäº‹ä»¶æœºåˆ¶ï¼Œå†™çš„éƒ½æ˜¯æ¯”è¾ƒåŸºæœ¬çš„ä¸œè¥¿ï¼ŒåŽé¢æ…¢æ…¢å®Œå–„ï¼Œä¸è¿‡ç†è§£èŽ·å–å¤šæŒ‡çš„äº‹ä»¶9âƒ£ï¸ç»°ç»°æœ‰ä½™å•¦ è¯ä¸å¤šè¯´ï¼Œä¸Šä»£ç ï¼Œæ¯”è¾ƒéœ€è¦æ³¨æ„çš„åœ°æ–¹æˆ‘éƒ½æ ‡æ³¨åœ¨æ³¨é‡Šä¸­ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273// å¤„ç†è§¦æ‘¸äº‹ä»¶ï¼Œæ”¯æŒå¤šç‚¹è§¦æ‘¸ @Override public boolean onTouchEvent(MotionEvent event) &#123; // fast stop if (!isEnabled() || isEventOver) return false; // pointerIndex æ˜¯äº‹ä»¶çš„åœ¨eventä¸­çš„ä¸‹æ ‡ int pointerIndex; // èŽ·å–äº‹ä»¶æŽ©ç  int action = MotionEventCompat.getActionMasked(event); switch (action) &#123; // é‡æ–°åˆå§‹åŒ–è§¦æ‘¸ç‚¹ case MotionEvent.ACTION_DOWN: // pointerId è®°å½•å½“å‰æ¿€æ´»çš„pointerId activePointerId = event.getPointerId(0); // æ ¹æ®pointerIdæŸ¥æ‰¾äº‹ä»¶åœ¨eventä¸­çš„ä½ç½® pointerIndex = event.findPointerIndex(activePointerId); // æ ¹æ®ä½ç½®èŽ·å–åˆ°å…·ä½“çš„äº‹ä»¶çš„åæ ‡ï¼Œè¿™é‡ŒèŽ·å¾—çš„åæ ‡å°±æ˜¯æˆ‘ä»¬è¦è®°ä½çš„é‚£ä¸ªæŒ‡å¤´çš„åæ ‡ touchPoint.init(event.getX(pointerIndex), event.getY(pointerIndex)); break; case MotionEvent.ACTION_MOVE: // æ‰‹æŒ‡ç§»åŠ¨æ—¶è¿˜æ˜¯æ ¹æ®æ¿€æ´»çš„pointerIdèŽ·å–ä¸‹æ ‡index,æ¥è¿›è¡ŒåŽç»­æ“ä½œï¼Œé¿å…äº‹ä»¶é”™ä¹± pointerIndex = event.findPointerIndex(activePointerId); // pointerIndex &lt; 0è¡¨ç¤ºæ‰‹æŒ‡çš„äº‹ä»¶èŽ·å–ä¸åˆ°äº†ï¼Œç»“æŸå“åº”äº‹ä»¶ if (pointerIndex &lt; 0) &#123; Log.e(TAG, "Got ACTION_MOVE event but have an invalid active pointer id."); cancelLockDraw(); return false; &#125; // æ ¹æ®ç§»åŠ¨çš„ä½ç½®èŽ·å–åæ ‡ï¼Œåˆå§‹åŒ–touchPointçš„å€¼ touchPoint.init(event.getX(pointerIndex), event.getY(pointerIndex)); LockPoint tempPoint; // æ£€ç´¢è§¦æ‘¸ç‚¹æœ‰æ²¡æœ‰åœ¨ä¹ä¸ªç‚¹ä¸­çš„æŸä¸€ä¸ªçš„è§¦æ‘¸èŒƒå›´å†… for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; if (!historyPointList.contains(tempPoint) &amp;&amp; tempPoint.isTouchIn(event.getX(pointerIndex), event.getY(pointerIndex))) &#123; LockPoint centerPoint = findCenterPoint(tempPoint); // ä¼˜åŒ–ï¼ŒæŸ¥æ‰¾ä¸¤ä¸ªç‚¹ä¹‹é—´çš„ç‚¹ï¼ŒåŽé¢ä¼šæœ‰ä»‹ç» if (!centerPoint.isEmpty()) &#123; activePoint(centerPoint); &#125; activePoint(tempPoint); break; &#125; &#125; break; case MotionEventCompat.ACTION_POINTER_UP: // å¤šæŒ‡æ“ä½œä¸­ éž æœ€åŽä¸€ä¸ªæ‰‹æŒ‡æŠ¬èµ·æ—¶è§¦å‘ACTION_POINTER_UPï¼Œæ­¤æ—¶è¦èŽ·å–è¿˜åœ¨å±å¹•ä¸Šçš„å…¶ä»–æ‰‹æŒ‡è½¬ç§»äº‹ä»¶çš„å¯¹è±¡ onSecondaryPointerUp(event); break; case MotionEvent.ACTION_UP: // æœ€åŽçš„æ‰‹æŒ‡æŠ¬èµ·è§¦å‘ ACTION_UP pointerIndex = event.findPointerIndex(activePointerId); if (pointerIndex &lt; 0) &#123; Log.e(TAG, "Got ACTION_UP event but don't have an active pointer id."); activePointerId = INVALID_POINTER; return false; &#125; // å‘å¸ƒç»˜åˆ¶çš„ç»“æžœï¼Œå¯èƒ½æ˜¯ç›‘å¬å›žè°ƒä¹‹ç±»çš„ publishResult(); // ç½®ä¸º-1 activePointerId = INVALID_POINTER; break; case MotionEvent.ACTION_CANCEL: // ç±»ä¼¼up cancelLockDraw(); activePointerId = INVALID_POINTER; break; &#125; postInvalidate(); return true; &#125; è½¬ç§»ç„¦ç‚¹çš„æ–¹æ³•,åœ¨å„ç§æŽ§ä»¶çš„æºä»£ç ä¸­éšå¤„å¯è§ï¼Œæˆ‘ä¹Ÿæ˜¯æ‹·è´å‡ºæ¥ç›´æŽ¥ç”¨çš„ï¼Œé€»è¾‘ä¸æ˜¯å¾ˆå¤æ‚ 123456789101112131415 /** * å½“ä¸€ä¸ªæ‰‹æœºæŠ¬èµ·æ—¶ï¼Œè½¬ç§»ç„¦ç‚¹ * * @param ev äº‹ä»¶ */private void onSecondaryPointerUp(MotionEvent ev) &#123; final int pointerIndex = MotionEventCompat.getActionIndex(ev); final int pointerId = MotionEventCompat.getPointerId(ev, pointerIndex); if (pointerId == activePointerId) &#123; // This was our active pointer going up. Choose a new // active pointer and adjust accordingly. final int newPointerIndex = pointerIndex == 0 ? 1 : 0; activePointerId = MotionEventCompat.getPointerId(ev, newPointerIndex); &#125; &#125; å‘å¸ƒç»“æžœ 123456789101112131415161718192021222324/** * å‘å¸ƒç»˜åˆ¶ç»“æžœ */ private void publishResult() &#123; if (listener != null) &#123; isEventOver = true; StringBuilder sb = new StringBuilder(); for (LockPoint lockPoint : historyPointList) &#123; sb.append(lockPoint.index); &#125; String passWd = sb.toString(); boolean isFinish = listener.onFinish(LockView.this, passWd, passWd.length()); if (isFinish) &#123; // è¾“å…¥åˆæ³• touchPoint.init(currentLockPoint); &#125; else &#123; // è¾“å…¥ä¸åˆæ³• cancelLockDraw(); isEventOver = false; &#125; &#125; else &#123; cancelLockDraw(); &#125; &#125; å›žå¤åˆå§‹çŠ¶æ€,å› ä¸ºåœ¨å¤šå¤„è°ƒç”¨äº†ï¼Œè´´ä¸€ä¸‹ 123456789/** * ç»“æŸç»˜åˆ¶ï¼Œæ¢å¤åˆå§‹çŠ¶æ€ */ private void cancelLockDraw() &#123; touchPoint.init(-1, -1); currentLockPoint.init(-1, -1); historyPointList.clear(); postInvalidate(); &#125; 7. ä¼˜åŒ–-è‡ªåŠ¨æ·»åŠ ä¸¤ç‚¹ä¹‹é—´è¿žçº¿ä¸Šçš„ç‚¹ å½“æ»‘åŠ¨æ—¶è¶Šè¿‡ä¸­é—´çš„ç‚¹ä¹‹é—´è¿žæŽ¥ä¸¤ç«¯ï¼Œè‡ªåŠ¨æŸ¥æ‰¾å’Œæ·»åŠ ä¸¤ç‚¹ä¹‹é—´çš„ç‚¹ï¼Œæ‰‹æœºä¸Šçš„æ»‘åŠ¨è§£é”ä¹Ÿæ˜¯è¿™æ ·çš„é€»è¾‘ï¼Œä¸ç„¶ä¼šå¯¼è‡´å›¾å½¢å¾ˆç¹çï¼Œä¸ç¾Žè§‚è€Œä¸”ä¸ç¬¦åˆå¸¸è§é€»è¾‘ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æžœå½“å‰æ¿€å‘çš„ç‚¹å’Œä¸Šä¸€ä¸ªæ¿€å‘çš„ç‚¹ä¹‹é—´æœ‰æ²¡æœ‰æ¿€å‘çš„ç‚¹ï¼Œé‚£ä¹ˆè‡ªåŠ¨ç»™ä»–æ¿€å‘ã€‚ é¦–å…ˆå¦‚æžœä¸¤ä¸ªç‚¹æ˜¯ç›¸é‚»çš„æˆ–è€…æ˜¯å¯¹è§’çº¿ä¸Šç›¸é‚»ï¼Œé‚£ä¹ˆä¸­é—´ä¸€å®šä¸ä¼šæœ‰ç©ºä¸‹æ¥çš„ç‚¹ï¼Œéœ€è¦æŽ’é™¤è¿™ä¸ªæƒ…å†µ 123456789101112131415161718/** * æ£€æµ‹ç›¸é‚» * * @param p1 ç‚¹1 * @param p2 ç‚¹2 * @return p1å’Œp2æ˜¯å¦ç›¸é‚»ï¼Œæ–œå¯¹è§’ä¹Ÿç®—ç›¸é‚» */ private boolean isAdjacentPoint(LockPoint p1, LockPoint p2) &#123; // internalSpaceæ˜¯åˆå§‹åŒ–æ—¶ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œéƒ½æ˜¯ç®€å•çš„è®¡ç®—å’Œæƒ…å†µç½—åˆ— if ((p1.x == p2.x &amp;&amp; Math.abs(p1.y - p2.y) == internalSpace) || (p1.y == p2.y &amp;&amp; Math.abs(p1.x - p2.x) == internalSpace) || (Math.abs(p1.x - p2.x) == internalSpace &amp;&amp; Math.abs(p1.y - p2.y) == internalSpace)) &#123; Log.e(TAG, "ç›¸é‚»ç‚¹ï¼Œä¸å¤„ç†"); return true; &#125; return false; &#125; ç„¶åŽå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç‚¹ä½äºŽé¦–å°¾ä¸¤ä¸ªæ¿€å‘ç‚¹çš„ä¸­é—´ï¼Œæ€è·¯æ˜¯å½“è¿™ä¸ªç‚¹åœ¨ä¸¤ä¸ªç‚¹çš„è¿žçº¿ä¸Šæ—¶ä¸”ä¸æ˜¯é¦–å°¾ä¸¤ä¸ªç‚¹å°±æ˜¯ä¸­é—´çš„ç‚¹ã€‚åˆ¤æ–­çš„æ ¹æ®æ˜¯æ–œçŽ‡æ˜¯ä¸æ˜¯ç›¸ç­‰ï¼Œå°±æ˜¯åˆä¸­çš„æ•°å­¦é—®é¢˜å•¦ã€‚ 12345678910111213/** * åˆ¤æ–­cç‚¹æ˜¯ä¸æ˜¯åœ¨p1-p2çš„ç›´çº¿ä¸Š * * @param p1 èµ·å§‹ç‚¹ * @param p2 ç»ˆæ­¢ç‚¹ * @param c åˆ¤æ–­çš„ç‚¹ * @return æ˜¯å¦åœ¨è¯¥çº¿ä¸Š */ private boolean isInLine(LockPoint p1, LockPoint p2, LockPoint c) &#123; float k1 = (p1.x - p2.x) * 1f / (p1.y - p2.y); float k2 = (p1.x - c.x) * 1f / (p1.y - c.y); return k1 == k2; &#125; æœ€åŽæ•´åˆä¸€ä¸‹ï¼ŒåŽ»æŽ‰ä¸å¿…è¦çš„åˆ¤æ–­ï¼Œåœ¨touchäº‹ä»¶ä¸­è°ƒç”¨ 123456789101112131415161718192021222324252627282930313233/** * æ£€æµ‹å½“å‰æ¿€æ´»çš„ç‚¹å’Œä¸Šä¸€ä¸ªæ¿€æ´»ç‚¹ä¹‹é—´çš„æ˜¯å¦æœ‰æ²¡æœ‰æ¿€å‘çš„ç‚¹ * * @param activePoint å½“å‰è¢«æ¿€å‘çš„ç‚¹ * @return å½“å‰æ¿€æ´»çš„ç‚¹å’Œä¸Šä¸€ä¸ªæ¿€æ´»ç‚¹ä¹‹é—´çš„æ˜¯å¦æœ‰æ²¡æœ‰æ¿€å‘çš„ç‚¹ï¼Œæ²¡æœ‰è¿”å›žemptyçš„&#123;@link LockPoint#isEmpty()&#125; */ private LockPoint findCenterPoint(LockPoint activePoint) &#123; LockPoint rstPoint = new LockPoint(); // åªæœ‰ä¸€ä¸ªç‚¹ä¸éœ€è¦æ¯”è¾ƒ if (historyPointList.size() &lt; 1) &#123; return rstPoint; &#125; LockPoint tempPoint; // èŽ·å–ä¸Šä¸ªç‚¹ LockPoint preActivePoint = historyPointList.get(historyPointList.size() - 1); // ä¸¤ä¸ªç‚¹æ˜¯ä¸æ˜¯ç›¸é‚»çš„ï¼Œæ˜¯ç›¸é‚»çš„æ˜¯åšå†³ä¸ä¼šä¸­é—´æœ‰ç‚¹è¢«ç©ºå‡ºæ¥çš„ if (isAdjacentPoint(preActivePoint, activePoint)) return rstPoint; for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; // æ²¡æœ‰è¢«è§¦æ‘¸è¿‡ &amp;&amp; ä¸æ˜¯é¦–ç‚¹ &amp;&amp; ä¸æ˜¯å°¾ç‚¹ if (!historyPointList.contains(tempPoint) &amp;&amp; !preActivePoint.equals(tempPoint) &amp;&amp; !activePoint.equals(tempPoint)) &#123; // åœ¨è¿žçº¿ä¸Š if (isInLine(preActivePoint, activePoint, tempPoint)) &#123; Log.e(TAG, "ç‚¹åœ¨çº¿ä¸Š " + tempPoint.out("temp") + " " + preActivePoint.out("pre") + " " + activePoint.out("active")); rstPoint.init(tempPoint); break; &#125; &#125; &#125; return rstPoint; &#125; åœ¨onTouchEventä¸­è°ƒç”¨ 123456LockPoint centerPoint = findCenterPoint(tempPoint); // ä¼˜åŒ–ï¼ŒæŸ¥æ‰¾ä¸¤ä¸ªç‚¹ä¹‹é—´çš„ç‚¹ if (!centerPoint.isEmpty()) &#123; activePoint(centerPoint); &#125; activePoint(tempPoint); 8. ä¼˜åŒ–-ç»™è¢«è§¦æ‘¸çš„ç‚¹æ·»åŠ åŠ¨ç”» å½“æ‰‹æŒ‡è§¦æ‘¸åˆ°ä¸€ä¸ªç‚¹æ—¶ï¼Œæ·»åŠ ä¸€ä¸ªç¼©æ”¾åŠ¨ç”»æ¥åé¦ˆè§¦æ‘¸æ“ä½œ æ€è·¯æ—¶ï¼Œå½“è§¦æ‘¸åˆ°ä¸€ä¸ªç‚¹æ—¶ä½¿ç”¨ValueAnimatorå¼€å¯åŠ¨ç”»ï¼Œä¸æ–­æ”¹å˜åŠå¾„çš„å€¼ï¼Œåœ¨ç»˜åˆ¶æ—¶è¾¾åˆ°å®žçŽ°ç¼©æ”¾çš„æ•ˆæžœ 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * å¼€å§‹ç¼©æ”¾åŠ¨ç”» */ private void startScaleAnimation() &#123; if (mScaleAnimator == null) &#123; mScaleAnimator = ValueAnimator.ofFloat(1f, scaleMax, 1f); mScaleAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123; @Override public void onAnimationUpdate(ValueAnimator animation) &#123; float scale = (float) animation.getAnimatedValue(); // ä¸æ–­æ”¹å˜åŠå¾„çš„å€¼ scalePointRadius = pointRadius * scale; postInvalidate(); &#125; &#125;); mScaleAnimator.addListener(new Animator.AnimatorListener() &#123; @Override public void onAnimationStart(Animator animation) &#123; &#125; @Override public void onAnimationEnd(Animator animation) &#123; // åŠ¨ç”»ç»“æŸåŽåˆå§‹åŒ–å›žæ ‡å‡†åŠå¾„çš„å€¼ scalePointRadius = pointRadius; &#125; @Override public void onAnimationCancel(Animator animation) &#123; &#125; @Override public void onAnimationRepeat(Animator animation) &#123; &#125; &#125;); mScaleAnimator.setDuration(scaleAnimDuration); &#125; if (mScaleAnimator.isRunning()) mScaleAnimator.end(); mScaleAnimator.start(); &#125; åŒæ—¶åœ¨onDraw()æ–¹æ³•ä¸­å¯¹åˆšåˆšè§¦æ‘¸çš„ç‚¹è¦è¿›è¡Œç»˜åˆ¶,æ›´æ”¹onDraw()æ–¹æ³•ä¸­ç»˜åˆ¶ä¹ä¸ªç‚¹çš„éƒ¨åˆ†ï¼Œå¯¹åˆšåˆšè§¦æ‘¸çš„ç‚¹ä½¿ç”¨ç¼©æ”¾åŽçš„åŠå¾„ç»˜åˆ¶ã€‚ 1234567891011// ç»˜åˆ¶ä¹ä¸ªç‚¹ï¼Œå½“åŠ¨ç”»åœ¨æ‰§è¡Œæ—¶è¢«æ¿€æ´»çš„ç‚¹ä¼šè¢«æ”¾å¤§ LockPoint tempPoint; for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; // æœ€åŽè§¦æ‘¸çš„ç‚¹ if (currentLockPoint != null &amp;&amp; currentLockPoint.equals(tempPoint)) &#123; canvas.drawCircle(tempPoint.x, tempPoint.y, scalePointRadius, pointPaint); &#125; else &#123; canvas.drawCircle(tempPoint.x, tempPoint.y, pointRadius, pointPaint); &#125; &#125; 9. å›žè°ƒ ä½¿ç”¨ç›‘å¬å°†ç»“æžœå›žè°ƒç»™ä½¿ç”¨è€…ï¼Œåœ¨ACTION_UPæ—¶å‘å¸ƒç»“æžœ 12345678910111213141516171819202122232425262728293031323334353637public interface OnLockFinishListener &#123; /** * * @param lockView æŽ§ä»¶ * @param passWd å¯†ç  * @param passWsLength å¯†ç é•¿åº¦ * @return å½“è¿”å›žtrueæ—¶ï¼Œç”»é¢å°†ä¼šå®šæ ¼åœ¨ç»˜åˆ¶ç»“æŸåŽçš„çŠ¶æ€ï¼Œæ¯”å¦‚å½“å¯†ç è¾“å…¥æ­£ç¡®çš„æ—¶å€™ * è¿”å›žfalseæ—¶ï¼Œç”»é¢ä¼šé‡æ–°åˆå§‹åŒ–å›žåˆå§‹çŠ¶æ€ï¼Œæ¯”å¦‚å¯†ç é‡æ–°äºŒæ¬¡è¾“å…¥ç¡®è®¤æˆ–è€…å¯†ç é”™è¯¯çš„æ—¶å€™ */ boolean onFinish(LockView lockView, String passWd, int passWsLength); &#125; /** * å‘å¸ƒç»˜åˆ¶ç»“æžœ */ private void publishResult() &#123; if (listener != null) &#123; isEventOver = true; StringBuilder sb = new StringBuilder(); for (LockPoint lockPoint : historyPointList) &#123; sb.append(lockPoint.index); &#125; String passWd = sb.toString(); boolean isFinish = listener.onFinish(LockView.this, passWd, passWd.length()); if (isFinish) &#123; // ç”»é¢å®šæ ¼ touchPoint.init(currentLockPoint); &#125; else &#123; // æ¢å¤åˆå§‹åŒ– cancelLockDraw(); isEventOver = false; &#125; &#125; else &#123; cancelLockDraw(); &#125; &#125; 10. ç»¼ä¸Š è¿˜é—ç•™äº†ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯è‡ªåŠ¨æ·»åŠ ä¸­é—´çš„ç‚¹æ—¶åº”è¯¥ä¹Ÿæ˜¯æœ‰åŠ¨ç”»æ•ˆæžœçš„ï¼Œæš‚æ—¶è¿˜æ²¡åšï¼Œæœ‰ç©ºè¡¥ä¸Šå§ï¼Œå¸Œæœ›å¤§å®¶æŒ‡æ­£ã€‚ 11. å®Œæ•´ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514/** * Project : CdLibsTest * Package : com.march.cdlibstest.widget * CreateAt : 2016/11/26 * Describe : è‡ªå®šä¹‰æŽ§ä»¶å®žçŽ°ä¹å®«æ ¼æ»‘åŠ¨è§£é” * * @author chendong */public class LockView extends View &#123; public static final String TAG = "LOCK_VIEW"; private static final int INVALID_POINTER = -1; private static final int AUTO_START_SPACING = -1; private static final int DEFAULT_MIN_POINT_NUM = 4; // æ¿€æ´»çš„è§¦æ‘¸ç‚¹id private int activePointerId = INVALID_POINTER; // å››è¾¹çš„é—´éš”ï¼Œé»˜è®¤æ˜¯æŽ§ä»¶çš„1ï¼4 private int startSpace; // ä¸¤ç‚¹é—´éš” private int internalSpace; // ç‚¹çš„åŠå¾„ private int pointRadius; // åŠ¨ç”»scaleçš„åŠå¾„ private float scalePointRadius; // è§¦æ‘¸åŠå¾„ï¼Œåœ¨ç‚¹çš„ä¸€å®šèŒƒå›´å†…è§¦å‘ private int touchSensitiveRange; // çº¿å®½åº¦ private int lineWidth; // ç‚¹é¢œè‰² private int pointColor; // çº¿é¢œè‰² private int lineColor; // ç¼©æ”¾çš„å¤§å° private float scaleMax; // åŠ¨ç”»æ—¶é—´ private int scaleAnimDuration = 150; // æœ¬æ¬¡ç»˜åˆ¶ç»“æŸï¼Œè°ƒç”¨init()æ–¹æ³•æ¢å¤åˆå§‹åŒ– private boolean isEventOver = false; class LockPoint &#123; // ç‚¹çš„ä½ç½® 0-8 int index; // ç‚¹çš„x,yåæ ‡ float x, y; // æž„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸€ä¸ªç‚¹ LockPoint(int index, float x, float y) &#123; this.index = index; this.x = x; this.y = y; &#125; // æž„é€ æ–¹æ³•ï¼Œä»Žå¦ä¸€ä¸ªç‚¹åˆå§‹åŒ– LockPoint(LockPoint p) &#123; this.x = p.x; this.y = p.y; this.index = p.index; &#125; // é»˜è®¤æž„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸ºä¸€ä¸ªç©ºçš„ç‚¹ LockPoint() &#123; this.x = -1; this.y = -1; this.index = -1; &#125; // åˆ¤æ–­è¯¥ç‚¹æ˜¯ä¸æ˜¯ä¸€ä¸ªç©ºçš„ç‚¹ boolean isEmpty() &#123; return this.x == -1 &amp;&amp; this.y == -1; &#125; // é‡æ–°ç»™ä½ç½®èµ‹å€¼ void init(float x, float y) &#123; this.x = x; this.y = y; &#125; // è®¾ç½®ä¸ºå¦ä¸€ç‚¹çš„å€¼ void init(LockPoint p) &#123; this.x = p.x; this.y = p.y; this.index = p.index; &#125; // åˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯ä¸æ˜¯åœ¨è¯¥ç‚¹è§¦æ‘¸èŒƒå›´å†…,touchSensitiveRangeä¸ºè§¦æ‘¸æœ‰æ•ˆåŠå¾„ boolean isTouchIn(float judgeX, float judgeY) &#123; return judgeX &lt; x + touchSensitiveRange &amp;&amp; judgeX &gt; x - touchSensitiveRange &amp;&amp; judgeY &lt; y + touchSensitiveRange &amp;&amp; judgeY &gt; y - touchSensitiveRange; &#125; // é‡å†™equalså’ŒhashCode @Override public boolean equals(Object o) &#123; LockPoint p = (LockPoint) o; return p.x == x &amp;&amp; p.y == y; &#125; @Override public int hashCode() &#123; return 2; &#125; String out(String tag) &#123; return tag + " : x = " + x + " , y = " + y; &#125; &#125; // åŠ¨ç”» private ValueAnimator mScaleAnimator; // åˆå§‹åŒ–çš„ä¹ä¸ªç‚¹ private LockPoint[] initLockPointArray; // è§¦æ‘¸è¿‡çš„ç‚¹æ³ªé£™ private List&lt;LockPoint&gt; historyPointList; // è§¦æ‘¸çš„ç‚¹ private LockPoint touchPoint; // å½“å‰æœ€åŽä¸€ä¸ªæ¿€æ´»çš„ç‚¹ private LockPoint currentLockPoint; // ç”»çº¿ private Paint linePaint; // ç”»ç‚¹ private Paint pointPaint; // ç›‘å¬ private OnLockFinishListener listener; public interface OnLockFinishListener &#123; /** * * @param lockView æŽ§ä»¶ * @param passWd å¯†ç  * @param passWsLength å¯†ç é•¿åº¦ * @return å½“è¿”å›žtrueæ—¶ï¼Œç”»é¢å°†ä¼šå®šæ ¼åœ¨ç»˜åˆ¶ç»“æŸåŽçš„çŠ¶æ€ * è¿”å›žfalseæ—¶ï¼Œç”»é¢ä¼šé‡æ–°åˆå§‹åŒ–å›žåˆå§‹çŠ¶æ€ */ boolean onFinish(LockView lockView, String passWd, int passWsLength); &#125; public LockView(Context context) &#123; this(context, null); &#125; public LockView(Context context, AttributeSet attrs) &#123; this(context, attrs, 0); &#125; public LockView(Context context, AttributeSet attrs, int defStyleAttr) &#123; super(context, attrs, defStyleAttr); TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.LockView); float density = getResources().getDisplayMetrics().density; pointRadius = (int) typedArray.getDimension(R.styleable.LockView_lock_pointRadius, (8 * density)); scalePointRadius = pointRadius; touchSensitiveRange = (int) typedArray.getDimension(R.styleable.LockView_lock_touchSensitiveRange, pointRadius * 3); startSpace = (int) typedArray.getDimension(R.styleable.LockView_lock_startSpace, AUTO_START_SPACING); lineWidth = (int) typedArray.getDimension(R.styleable.LockView_lock_lineWidth, (5 * density)); lineColor = typedArray.getColor(R.styleable.LockView_lock_lineColor, Color.WHITE); pointColor = typedArray.getColor(R.styleable.LockView_lock_pointColor, Color.WHITE); scaleAnimDuration = typedArray.getInt(R.styleable.LockView_lock_scaleAnimDuration, 180); scaleMax = typedArray.getFloat(R.styleable.LockView_lock_scaleMax, 2.5f); typedArray.recycle(); historyPointList = new ArrayList&lt;&gt;(); touchPoint = new LockPoint(); currentLockPoint = new LockPoint(); pointPaint = new Paint(); pointPaint.setAntiAlias(true); pointPaint.setColor(pointColor); pointPaint.setStyle(Paint.Style.FILL_AND_STROKE); linePaint = new Paint(); linePaint.setAntiAlias(true); linePaint.setStrokeWidth(lineWidth); linePaint.setColor(lineColor); linePaint.setStyle(Paint.Style.STROKE); &#125; public void setListener(OnLockFinishListener listener) &#123; this.listener = listener; &#125; /** * å¼€å§‹ç¼©æ”¾åŠ¨ç”» */ private void startScaleAnimation() &#123; if (mScaleAnimator == null) &#123; mScaleAnimator = ValueAnimator.ofFloat(1f, scaleMax, 1f); mScaleAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123; @Override public void onAnimationUpdate(ValueAnimator animation) &#123; float scale = (float) animation.getAnimatedValue(); scalePointRadius = pointRadius * scale; postInvalidate(); &#125; &#125;); mScaleAnimator.addListener(new Animator.AnimatorListener() &#123; @Override public void onAnimationStart(Animator animation) &#123; &#125; @Override public void onAnimationEnd(Animator animation) &#123; scalePointRadius = pointRadius; &#125; @Override public void onAnimationCancel(Animator animation) &#123; &#125; @Override public void onAnimationRepeat(Animator animation) &#123; &#125; &#125;); mScaleAnimator.setDuration(scaleAnimDuration); &#125; if (mScaleAnimator.isRunning()) mScaleAnimator.end(); mScaleAnimator.start(); &#125; // å¤„ç†è§¦æ‘¸äº‹ä»¶ï¼Œæ”¯æŒå¤šç‚¹è§¦æ‘¸ @Override public boolean onTouchEvent(MotionEvent event) &#123; // fast stop if (!isEnabled() || isEventOver) return false; // pointerIndex æ˜¯äº‹ä»¶çš„åœ¨eventä¸­çš„ä¸‹æ ‡ int pointerIndex; // èŽ·å–äº‹ä»¶æŽ©ç  int action = MotionEventCompat.getActionMasked(event); switch (action) &#123; // é‡æ–°åˆå§‹åŒ–è§¦æ‘¸ç‚¹ case MotionEvent.ACTION_DOWN: // pointerId è®°å½•å½“å‰æ¿€æ´»çš„pointerId activePointerId = event.getPointerId(0); // æ ¹æ®pointerIdæŸ¥æ‰¾äº‹ä»¶åœ¨eventä¸­çš„ä½ç½® pointerIndex = event.findPointerIndex(activePointerId); // æ ¹æ®ä½ç½®èŽ·å–åˆ°å…·ä½“çš„äº‹ä»¶çš„åæ ‡ï¼Œè¿™é‡ŒèŽ·å¾—çš„åæ ‡å°±æ˜¯æˆ‘ä»¬è¦è®°ä½çš„é‚£ä¸ªæŒ‡å¤´çš„åæ ‡ touchPoint.init(event.getX(pointerIndex), event.getY(pointerIndex)); break; case MotionEvent.ACTION_MOVE: // æ‰‹æŒ‡ç§»åŠ¨æ—¶è¿˜æ˜¯æ ¹æ®æ¿€æ´»çš„pointerIdèŽ·å–ä¸‹æ ‡index,æ¥è¿›è¡ŒåŽç»­æ“ä½œï¼Œé¿å…äº‹ä»¶é”™ä¹± pointerIndex = event.findPointerIndex(activePointerId); // pointerIndex &lt; 0è¡¨ç¤ºæ‰‹æŒ‡çš„äº‹ä»¶èŽ·å–ä¸åˆ°äº†ï¼Œç»“æŸå“åº”äº‹ä»¶ if (pointerIndex &lt; 0) &#123; Log.e(TAG, "Got ACTION_MOVE event but have an invalid active pointer id."); cancelLockDraw(); return false; &#125; // æ ¹æ®ç§»åŠ¨çš„ä½ç½®èŽ·å–åæ ‡ï¼Œåˆå§‹åŒ–touchPointçš„å€¼ touchPoint.init(event.getX(pointerIndex), event.getY(pointerIndex)); LockPoint tempPoint; // æ£€ç´¢è§¦æ‘¸ç‚¹æœ‰æ²¡æœ‰åœ¨ä¹ä¸ªç‚¹ä¸­çš„æŸä¸€ä¸ªçš„è§¦æ‘¸èŒƒå›´å†… for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; if (!historyPointList.contains(tempPoint) &amp;&amp; tempPoint.isTouchIn(event.getX(pointerIndex), event.getY(pointerIndex))) &#123; LockPoint centerPoint = findCenterPoint(tempPoint); if (!centerPoint.isEmpty()) &#123; activePoint(centerPoint); &#125; activePoint(tempPoint); break; &#125; &#125; break; case MotionEventCompat.ACTION_POINTER_UP: // å¤šæŒ‡æ“ä½œä¸­ éž æœ€åŽä¸€ä¸ªæ‰‹æŒ‡æŠ¬èµ·æ—¶è§¦å‘ACTION_POINTER_UPï¼Œæ­¤æ—¶è¦èŽ·å–è¿˜åœ¨å±å¹•ä¸Šçš„å…¶ä»–æ‰‹æŒ‡è½¬ç§»äº‹ä»¶çš„å¯¹è±¡ onSecondaryPointerUp(event); break; case MotionEvent.ACTION_UP: // æœ€åŽçš„æ‰‹æŒ‡æŠ¬èµ·è§¦å‘ ACTION_UP pointerIndex = event.findPointerIndex(activePointerId); if (pointerIndex &lt; 0) &#123; Log.e(TAG, "Got ACTION_UP event but don't have an active pointer id."); activePointerId = INVALID_POINTER; return false; &#125; // å‘å¸ƒç»˜åˆ¶çš„ç»“æžœï¼Œå¯èƒ½æ˜¯ç›‘å¬å›žè°ƒä¹‹ç±»çš„ publishResult(); // ç½®ä¸º-1 activePointerId = INVALID_POINTER; break; case MotionEvent.ACTION_CANCEL: // ç±»ä¼¼up cancelLockDraw(); activePointerId = INVALID_POINTER; break; &#125; postInvalidate(); return true; &#125; /** * å‘å¸ƒç»˜åˆ¶ç»“æžœ */ private void publishResult() &#123; if (listener != null) &#123; isEventOver = true; StringBuilder sb = new StringBuilder(); for (LockPoint lockPoint : historyPointList) &#123; sb.append(lockPoint.index); &#125; String passWd = sb.toString(); boolean isFinish = listener.onFinish(LockView.this, passWd, passWd.length()); if (isFinish) &#123; // è¾“å…¥åˆæ³• touchPoint.init(currentLockPoint); &#125; else &#123; // è¾“å…¥ä¸åˆæ³• cancelLockDraw(); isEventOver = false; &#125; &#125; else &#123; cancelLockDraw(); &#125; &#125; /** * å½“ä¸€ä¸ªæ‰‹æœºæŠ¬èµ·æ—¶ï¼Œè½¬ç§»ç„¦ç‚¹ * * @param ev äº‹ä»¶ */ private void onSecondaryPointerUp(MotionEvent ev) &#123; final int pointerIndex = MotionEventCompat.getActionIndex(ev); final int pointerId = MotionEventCompat.getPointerId(ev, pointerIndex); if (pointerId == activePointerId) &#123; // This was our active pointer going up. Choose a new // active pointer and adjust accordingly. final int newPointerIndex = pointerIndex == 0 ? 1 : 0; activePointerId = MotionEventCompat.getPointerId(ev, newPointerIndex); &#125; &#125; /** * æ£€æµ‹å½“å‰æ¿€æ´»çš„ç‚¹å’Œä¸Šä¸€ä¸ªæ¿€æ´»ç‚¹ä¹‹é—´çš„æ˜¯å¦æœ‰æ²¡æœ‰æ¿€å‘çš„ç‚¹ * * @param activePoint å½“å‰è¢«æ¿€å‘çš„ç‚¹ * @return å½“å‰æ¿€æ´»çš„ç‚¹å’Œä¸Šä¸€ä¸ªæ¿€æ´»ç‚¹ä¹‹é—´çš„æ˜¯å¦æœ‰æ²¡æœ‰æ¿€å‘çš„ç‚¹ï¼Œæ²¡æœ‰è¿”å›žemptyçš„&#123;@link LockPoint#isEmpty()&#125; */ private LockPoint findCenterPoint(LockPoint activePoint) &#123; LockPoint rstPoint = new LockPoint(); // åªæœ‰ä¸€ä¸ªç‚¹ä¸éœ€è¦æ¯”è¾ƒ if (historyPointList.size() &lt; 1) &#123; return rstPoint; &#125; LockPoint tempPoint; // èŽ·å–ä¸Šä¸ªç‚¹ LockPoint preActivePoint = historyPointList.get(historyPointList.size() - 1); // ä¸¤ä¸ªç‚¹æ˜¯ä¸æ˜¯ç›¸é‚»çš„ï¼Œæ˜¯ç›¸é‚»çš„æ˜¯åšå†³ä¸ä¼šä¸­é—´æœ‰ç‚¹è¢«ç©ºå‡ºæ¥çš„ if (isAdjacentPoint(preActivePoint, activePoint)) return rstPoint; for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; // æ²¡æœ‰è¢«è§¦æ‘¸è¿‡ &amp;&amp; ä¸æ˜¯é¦–ç‚¹ &amp;&amp; ä¸æ˜¯å°¾ç‚¹ if (!historyPointList.contains(tempPoint) &amp;&amp; !preActivePoint.equals(tempPoint) &amp;&amp; !activePoint.equals(tempPoint)) &#123; if (isInLine(preActivePoint, activePoint, tempPoint)) &#123; Log.e(TAG, "ç‚¹åœ¨çº¿ä¸Š " + tempPoint.out("temp") + " " + preActivePoint.out("pre") + " " + activePoint.out("active")); rstPoint.init(tempPoint); break; &#125; &#125; &#125; return rstPoint; &#125; /** * æ£€æµ‹ç›¸é‚» * * @param p1 ç‚¹1 * @param p2 ç‚¹2 * @return p1å’Œp2æ˜¯å¦ç›¸é‚»ï¼Œæ–œå¯¹è§’ä¹Ÿç®—ç›¸é‚» */ private boolean isAdjacentPoint(LockPoint p1, LockPoint p2) &#123; if ((p1.x == p2.x &amp;&amp; Math.abs(p1.y - p2.y) == internalSpace) || (p1.y == p2.y &amp;&amp; Math.abs(p1.x - p2.x) == internalSpace) || (Math.abs(p1.x - p2.x) == internalSpace &amp;&amp; Math.abs(p1.y - p2.y) == internalSpace)) &#123; Log.e(TAG, "ç›¸é‚»ç‚¹ï¼Œä¸å¤„ç†"); return true; &#125; return false; &#125; /** * åˆ¤æ–­cç‚¹æ˜¯ä¸æ˜¯åœ¨p1-p2çš„ç›´çº¿ä¸Š * * @param p1 èµ·å§‹ç‚¹ * @param p2 ç»ˆæ­¢ç‚¹ * @param c åˆ¤æ–­çš„ç‚¹ * @return æ˜¯å¦åœ¨è¯¥çº¿ä¸Š */ private boolean isInLine(LockPoint p1, LockPoint p2, LockPoint c) &#123; float k1 = (p1.x - p2.x) * 1f / (p1.y - p2.y); float k2 = (p1.x - c.x) * 1f / (p1.y - c.y); return k1 == k2; &#125; /** * æ¿€æ´»è¯¥ç‚¹ï¼Œè¯¥ç‚¹å°†ä¼šæ·»åŠ åˆ°é€‰ä¸­ç‚¹åˆ—è¡¨ä¸­ï¼Œç„¶åŽæ‰§è¡ŒåŠ¨ç”» * * @param tempPoint è¢«æ¿€æ´»çš„ç‚¹ */ private void activePoint(LockPoint tempPoint) &#123; historyPointList.add(new LockPoint(tempPoint)); currentLockPoint.init(tempPoint); startScaleAnimation(); postInvalidate(); &#125; public void init() &#123; isEventOver = false; cancelLockDraw(); &#125; /** * ç»“æŸç»˜åˆ¶ï¼Œæ¢å¤åˆå§‹çŠ¶æ€ */ private void cancelLockDraw() &#123; touchPoint.init(-1, -1); currentLockPoint.init(-1, -1); historyPointList.clear(); postInvalidate(); &#125; // onMeasureä¹‹åŽåˆå§‹åŒ–æ•°æ® @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; super.onMeasure(widthMeasureSpec, heightMeasureSpec); int size = getMeasuredWidth(); // å°†å®½é«˜è®¾ç½®ä¸ºä¸€æ ·çš„ï¼Œæ­£æ–¹å½¢ setMeasuredDimension(size, size); // åˆå§‹åŒ–å±å¹•ä¸­çš„ä¹ä¸ªç‚¹çš„ä½ç½®å’Œä¸‹æ ‡ if (initLockPointArray == null) &#123; initLockPointArray = new LockPoint[9]; // startSpace ä¸ºè·ç¦»å·¦è¾¹çš„è·ç¦»ï¼Œè®¡ç®—ä¹ä¸ªç‚¹çš„ä½ç½®æ”¾åœ¨æŽ§ä»¶ä¸­é—´ if (startSpace == AUTO_START_SPACING) &#123; startSpace = size / 4; &#125; // è®¡ç®—æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´çš„é—´éš” internalSpace = (size - 2 * startSpace) / 2; // åˆå§‹åŒ–ä¹ä¸ªç‚¹çš„ä½ç½® int index = 0; for (int i = 0; i &lt; 3; i++) &#123; for (int j = 0; j &lt; 3; j++) &#123; initLockPointArray[index] = new LockPoint(index, startSpace + j * internalSpace, startSpace + i * internalSpace); index++; &#125; &#125; // ä¸ºäº†åœ¨previewæ—¶èƒ½çœ‹åˆ°æ•ˆæžœ if (isInEditMode()) &#123; historyPointList.addAll(Arrays.asList(initLockPointArray)); &#125; &#125; &#125; private void log(Object... objs) &#123; StringBuilder sb = new StringBuilder(); for (Object obj : objs) &#123; sb.append(obj.toString()).append(" "); &#125; Log.e(TAG, sb.toString()); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); // fast stop if (initLockPointArray == null) return; log(currentLockPoint.out("current"), touchPoint.out("touch")); // ç”»æœ€åŽä¸€ä¸ªç‚¹å’Œè§¦æ‘¸çš„ç‚¹ä¹‹é—´çš„çº¿ if (currentLockPoint != null &amp;&amp; currentLockPoint.x != -1 &amp;&amp; currentLockPoint.y != -1 &amp;&amp; touchPoint.x != -1 &amp;&amp; touchPoint.y != -1) &#123; canvas.drawLine(currentLockPoint.x, currentLockPoint.y, touchPoint.x, touchPoint.y, linePaint); &#125; // ç»˜åˆ¶ä¹‹å‰è§¦è¿‡å­˜å‚¨èµ·æ¥çš„çš„ç‚¹ if (historyPointList.size() &gt; 0) &#123; for (int i = 0; i &lt; historyPointList.size() - 1; i++) &#123; canvas.drawLine(historyPointList.get(i).x, historyPointList.get(i).y, historyPointList.get(i + 1).x, historyPointList.get(i + 1).y, linePaint); &#125; &#125; // ç»˜åˆ¶ä¹ä¸ªç‚¹ï¼Œå½“åŠ¨ç”»åœ¨æ‰§è¡Œæ—¶è¢«æ¿€æ´»çš„ç‚¹ä¼šè¢«æ”¾å¤§ LockPoint tempPoint; for (int i = 0; i &lt; initLockPointArray.length; i++) &#123; tempPoint = initLockPointArray[i]; if (currentLockPoint != null &amp;&amp; currentLockPoint.equals(tempPoint)) &#123; canvas.drawCircle(tempPoint.x, tempPoint.y, scalePointRadius, pointPaint); &#125; else &#123; canvas.drawCircle(tempPoint.x, tempPoint.y, pointRadius, pointPaint); &#125; &#125; &#125;&#125;]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[DES,AES åŠ å¯†è§£å¯†]]></title>
    <url>%2Farticle%2F3556316359%2F</url>
    <content type="text"><![CDATA[åŠ å¯†è§£å¯†çš„åŽŸç†æ˜¯ä¸ªå¾ˆéº»çƒ¦çš„é—®é¢˜ï¼Œæˆ‘ä¹‹å‰ä¸Šè¿‡ä¸€é—¨è¯¾å«å¯†ç å­¦ï¼Œæœ€åŽä¹Ÿæ²¡æ€Žä¹ˆå­¦æ‡‚ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªæ˜¯ä½¿ç”¨javaä»£ç å®žçŽ°åŠ å¯†è§£å¯†çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯è®¨è®ºä»–çš„åŽŸç†ã€‚ DESç®€å•ä»‹ç» DES(Data Encryption Standard)å³æ•°æ®åŠ å¯†æ ‡å‡†ï¼Œä½¿ç”¨56bitå¯†é’¥ï¼Œå°†64bitçš„æ˜Žæ–‡æ•°æ®å—åŠ å¯†ä¸º64bitå¯†æ–‡ã€‚ DESä½¿ç”¨56bitå¯†é’¥åŠ å¯†ï¼Œç§˜é’¥è¦æ±‚8ä¸ªå­—èŠ‚64bitï¼Œæ¯ä¸ªå­—èŠ‚æœ‰ä¸€ä½æ˜¯å¥‡å¶æ ¡éªŒä½ã€‚ DESåŠ å¯†å¼ºåº¦å°ï¼Œå®¹æ˜“è¢«ç ´è§£ DESåŠ å¯†ä»£ç å®žçŽ°123456789101112131415161718192021222324252627282930313233343536373839404142/** * DESåŠ å¯†è§£å¯† * @param data éœ€è¦åŠ å¯†çš„æ•°æ® * @param key ç§˜é’¥ï¼Œå¿…é¡»æ˜¯8ä¸ªå­—èŠ‚ * @param mode åŠ å¯†æˆ–è€…è§£å¯†æ¨¡å¼ * Cipher.ENCRYPT_MODE * Cipher.DECRYPT_MODE * @return */ public static byte[] DESCrypt(byte[] data, byte[] key, int mode) &#123; byte[] result = null; if (data == null || key == null || data.length &lt;= 0 || key.length &lt;= 0) return null; //DESå¯†ç å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚ï¼Œ64bité•¿åº¦ try &#123; //åˆ›å»ºåŠ å¯†å¼•æ“Ž Cipher cipher = Cipher.getInstance("DES"); //æŒ‡å®š8ä¸ªå­—èŠ‚å¯†ç  DESKeySpec desKeySpec = new DESKeySpec(key); //ç”Ÿæˆå¯†ç å·¥åŽ‚ SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance("DES"); //ç”Ÿæˆå¯†ç  SecretKey secretKey = secretKeyFactory.generateSecret(desKeySpec); //è®¾ç½®æ¨¡å¼ï¼ŒåŠ å¯†è§£å¯† cipher.init(mode, secretKey); //åŠ å¯†ã€‚è®¾ç½®å­—èŠ‚æ•°ç»„ä½œä¸ºå¾…åŠ å¯†å†…å®¹,è¿”å›žå€¼æ˜¯æœ€ç»ˆåŠ å¯†ç»“æžœ result = cipher.doFinal(data); &#125; catch (NoSuchAlgorithmException e) &#123; e.printStackTrace(); &#125; catch (NoSuchPaddingException e) &#123; e.printStackTrace(); &#125; catch (InvalidKeyException e) &#123; e.printStackTrace(); &#125; catch (InvalidKeySpecException e) &#123; e.printStackTrace(); &#125; catch (BadPaddingException e) &#123; e.printStackTrace(); &#125; catch (IllegalBlockSizeException e) &#123; e.printStackTrace(); &#125; return result; &#125; AESç®€å•ä»‹ç» AES(Advanced Encryption Standard)ï¼Œå³ä¸ºé«˜çº§åŠ å¯†æ ‡å‡†ã€‚åœ¨å¯†ç å­¦ä¸­åˆç§°RijndaelåŠ å¯†æ³•ï¼Œæ˜¯ç¾Žå›½è”é‚¦æ”¿åºœé‡‡ç”¨çš„ä¸€ç§åŒºå—åŠ å¯†æ ‡å‡†ã€‚è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŽŸå…ˆçš„DESï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æžä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚AESçš„åŒºå—é•¿åº¦å›ºå®šä¸º128 æ¯”ç‰¹ï¼Œå¯†é’¥é•¿åº¦åˆ™å¯ä»¥æ˜¯128ï¼Œ192æˆ–256æ¯”ç‰¹ï¼› ä½Žå¼ºåº¦åŠ å¯†ä»£ç å®žçŽ°12345678910111213141516171819202122232425262728293031/** * AESä½Žå¼ºåº¦åŠ å¯†è§£å¯† * @param data * @param key * @param mode Cipher.ENCRYPT_MODE * Cipher.DECRYPT_MODE * @return */ public static byte[] AESCrypt(byte[] data,byte[] key,int mode)&#123; byte[] result = null; if (data == null || key == null || data.length &lt;= 0 || key.length &lt;= 0) return null; try &#123; Cipher cipher = Cipher.getInstance("AES"); SecretKeySpec secretKeySpec = new SecretKeySpec(key,"AES"); cipher.init(mode,secretKeySpec); result = cipher.doFinal(data); &#125; catch (NoSuchAlgorithmException e) &#123; e.printStackTrace(); &#125; catch (NoSuchPaddingException e) &#123; e.printStackTrace(); &#125; catch (InvalidKeyException e) &#123; e.printStackTrace(); &#125; catch (BadPaddingException e) &#123; e.printStackTrace(); &#125; catch (IllegalBlockSizeException e) &#123; e.printStackTrace(); &#125; return result; &#125; é«˜å¼ºåº¦åŠ å¯†ï¼Œä½¿ç”¨ivå‚æ•°1234567891011121314151617181920212223242526272829303132333435/** * AESé«˜å¼ºåº¦åŠ å¯† * * @param data * @param key * @param iv ç”¨äºŽAES/CBCã€PKCS5Paddingè¿™ä¸ªå¸¦æœ‰åŠ å¯†æ¨¡å¼çš„ç®—æ³• * @param mode * @return */ public static byte[] AESCrypt(byte[] data, byte[] key, byte[] iv, int mode) &#123; byte[] result = null; if (data == null || key == null || data.length &lt;= 0 || key.length &lt;= 0) return null; try &#123; Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding"); SecretKeySpec secretKeySpec = new SecretKeySpec(key, "AES"); //å‡†å¤‡ivå‚æ•°ï¼Œç”¨äºŽæ”¯æŒCBCæˆ–è€…ECBæ¨¡å¼ IvParameterSpec ivParameterSpec = new IvParameterSpec(iv); cipher.init(mode, secretKeySpec, ivParameterSpec); result = cipher.doFinal(data); &#125; catch (NoSuchAlgorithmException e) &#123; e.printStackTrace(); &#125; catch (NoSuchPaddingException e) &#123; e.printStackTrace(); &#125; catch (InvalidKeyException e) &#123; e.printStackTrace(); &#125; catch (BadPaddingException e) &#123; e.printStackTrace(); &#125; catch (IllegalBlockSizeException e) &#123; e.printStackTrace(); &#125; catch (InvalidAlgorithmParameterException e) &#123; e.printStackTrace(); &#125; return result; &#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[pythonå‘é€get/post/put/deleteè¯·æ±‚]]></title>
    <url>%2Farticle%2F3174426477%2F</url>
    <content type="text"><![CDATA[Getè¯·æ±‚12345# å¦‚æžœæ²¡æœ‰headerå¯ä»¥ä¸ä¼ request = urllib2.Request(reqUrl, reqHeader)# reqTimeOutä¸ºè¶…æ—¶æ—¶é—´ï¼Œä¸è®¾ç½®å¯ä»¥ä¸ä¼ response = urllib2.urlopen(request, reqTimeOut)print respone.read() Postè¯·æ±‚12345# å¦‚æžœæ²¡æœ‰headerå¯ä»¥ä¸ä¼ request = urllib2.Request(reqUrl,reqHeader,postData)# reqTimeOutä¸ºè¶…æ—¶æ—¶é—´ï¼Œä¸è®¾ç½®å¯ä»¥ä¸ä¼ response = urllib2.urlopen(request, reqTimeOut)print respone.read() Putè¯·æ±‚123456# å¦‚æžœæ²¡æœ‰headerå¯ä»¥ä¸ä¼ request = urllib2.Request(reqUrl,reqHeader,postData)# reqTimeOutä¸ºè¶…æ—¶æ—¶é—´ï¼Œä¸è®¾ç½®å¯ä»¥ä¸ä¼ response = urllib2.urlopen(request, reqTimeOut)request.get_method = lambda: 'PUT'print respone.read() Deleteè¯·æ±‚123456# å¦‚æžœæ²¡æœ‰headerå¯ä»¥ä¸ä¼ request = urllib2.Request(reqUrl,reqHeader,postData)# reqTimeOutä¸ºè¶…æ—¶æ—¶é—´ï¼Œä¸è®¾ç½®å¯ä»¥ä¸ä¼ response = urllib2.urlopen(request, reqTimeOut)request.get_method = lambda: 'DELETE'print respone.read() debug12345//ä½¿ç”¨Handleræ‰“å°æ—¥å¿—httpHandler = urllib2.HTTPHandler(debuglevel=1)httpsHandler = urllib2.HTTPSHandler(debuglevel=1)opener = urllib2.build_opener(httpHandler, httpsHandler)urllib2.install_opener(opener) æ€»ç»“ ä¸€ä¸ªé›†åˆäº†å‡ ç§è¯·æ±‚çš„å·¥å…·ç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192# -*-coding:utf-8 -*-import urllib2from httptst.Singleton import singleton__metaclass = type@singletonclass HttpHelper: def __init__(self): pass name = 'http helper' # header __reqHeader = &#123;&#125; # url __reqUrl = '' # time __reqTimeOut = 0 # æž„å»ºGetè¯·æ±‚ def __buildGetRequest(self): if len(self.__reqHeader) == 0: request = urllib2.Request(self.__reqUrl) else: request = urllib2.Request(self.__reqUrl, headers=self.__reqHeader) return request # æž„å»ºpost,put,deleteè¯·æ±‚ def __buildPostPutDeleteRequest(self, postData): if len(self.__reqHeader) == 0: request = urllib2.Request(self.__reqUrl, data=postData) else: request = urllib2.Request(self.__reqUrl, headers=self.__reqHeader, data=postData) return request # æ·»åŠ header def headers(self, headers): self.__reqHeader = headers return self # æ·»åŠ url def url(self, url): print url self.__reqUrl = url return self # æ·»åŠ è¶…æ—¶ def timeOut(self, time): self.__reqTimeOut = time return self # æ˜¯å¦debug def debug(self): httpHandler = urllib2.HTTPHandler(debuglevel=1) httpsHandler = urllib2.HTTPSHandler(debuglevel=1) opener = urllib2.build_opener(httpHandler, httpsHandler) urllib2.install_opener(opener) return self # å¤„ç†response def __handleResponse(self, request, func): try: if self.__reqTimeOut == 0: res = urllib2.urlopen(request) else: res = urllib2.urlopen(request, self.__reqTimeOut) func(res.read()) except urllib2.HTTPError, e: print e.code # getè¯·æ±‚ def get(self, func): request = self.__buildGetRequest() self.__handleResponse(request, func) # postè¯·æ±‚ def post(self, postData, func): request = self.__buildPostPutDeleteRequest(postData=postData) self.__handleResponse(request, func) # putè¯·æ±‚ def put(self, putData, func): request = self.__buildPostPutDeleteRequest(postData=putData) request.get_method = lambda: 'PUT' self.__handleResponse(request, func) # deleteè¯·æ±‚ def delete(self, putData, func): request = self.__buildPostPutDeleteRequest(postData=putData) request.get_method = lambda: 'DELETE' self.__handleResponse(request, func) æµ‹è¯•1234567891011121314def getData(data): print datahttpHelper = HttpHelper()url_baidu = 'http://www.baidu.com'#ç®€å•çš„getè¯·æ±‚httpHelper.url(url=url_baidu).get(func=getData)# postè¯·æ±‚httpHelper.debug() \ .url(url=url_post_pics) \ .headers(headers=getHeader()) \ .post(postData=post_data_pics, func=getData)# postè¯·æ±‚httpHelper.debug().url(url_post_invite_one).headers(getHeader()).post(post_data_invite_one,getData)]]></content>
      <categories>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RSAåŠ å¯†è§£å¯†]]></title>
    <url>%2Farticle%2F1309915903%2F</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯å¯¹ç§°åŠ å¯†ï¼Œä»€ä¹ˆæ˜¯éžå¯¹ç§°åŠ å¯†ï¼Ÿ åŠ å¯†è§£å¯†ä½¿ç”¨åŒæ ·çš„å¯†é’¥ï¼Œåˆ™æ˜¯å¯¹ç§°åŠ å¯†ï¼Œä½¿ç”¨ä¸ä¸€æ ·çš„å¯†é’¥å°±æ˜¯éžå¯¹ç§°åŠ å¯†ï¼ŒRSAå±žäºŽéžå¯¹ç§°åŠ å¯†ã€‚ RSAä¸­æœ‰å…¬é’¥å’Œç§é’¥çš„æ¦‚å¿µï¼Œå…¬é’¥åŠ å¯†ç§é’¥è§£å¯†ï¼Œç§é’¥åŠ å¯†å…¬é’¥è§£å¯†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨RSAå¯¹æ¶ˆæ¯è¿›è¡Œç­¾å ä¸€äº›å¸¸é‡1234567891011121314151617181920212223242526272829/** * åŠ å¯†ç®—æ³•RSA */ public static final String KEY_ALGORITHM = "RSA"; /** * ç­¾åç®—æ³• */ public static final String SIGNATURE_ALGORITHM = "MD5withRSA"; /** * èŽ·å–å…¬é’¥çš„key */ public static final String PUBLIC_KEY = "RSAPublicKey"; /** * èŽ·å–ç§é’¥çš„key */ public static final String PRIVATE_KEY = "RSAPrivateKey"; /** * RSAæœ€å¤§åŠ å¯†æ˜Žæ–‡å¤§å° */ private static final int MAX_ENCRYPT_BLOCK = 117; /** * RSAæœ€å¤§è§£å¯†å¯†æ–‡å¤§å° */ private static final int MAX_DECRYPT_BLOCK = 128; 2.èŽ·å–å¯†é’¥å¯¹ è¿™é‡Œä½¿ç”¨äº†å†…ç½®çš„æ–¹æ³•èŽ·å–ç”Ÿæˆçš„å…¬é’¥ç§é’¥ï¼Œè¿”å›žçš„å¯†é’¥å·²ç»ç»è¿‡äº†Base64ç¼–ç çš„å¤„ç†ï¼Œæ˜¯å¯è§çš„å­—ç¬¦ä¸²ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 /** * &lt;p&gt; * ç”Ÿæˆå¯†é’¥å¯¹(å…¬é’¥å’Œç§é’¥) * &lt;/p&gt; * * @return * @throws Exception */ public static Map&lt;String, Object&gt; getKeyPair(int size) throws Exception &#123; KeyPairGenerator keyPairGen = KeyPairGenerator.getInstance(KEY_ALGORITHM); keyPairGen.initialize(size); KeyPair keyPair = keyPairGen.generateKeyPair(); RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic(); RSAPrivateKey privateKey = (RSAPrivateKey) keyPair.getPrivate(); Map&lt;String, Object&gt; keyMap = new HashMap&lt;String, Object&gt;(2); keyMap.put(PUBLIC_KEY, publicKey); keyMap.put(PRIVATE_KEY, privateKey); return keyMap; &#125;/** * &lt;p&gt; * èŽ·å–ç§é’¥ * &lt;/p&gt; * * @param keyMap å¯†é’¥å¯¹ * @return èŽ·å–çš„keyå·²ç»ç»è¿‡base64ç¼–ç  * @throws Exception */ public static String getPrivateKey(Map&lt;String, Object&gt; keyMap) throws Exception &#123; Key key = (Key) keyMap.get(PRIVATE_KEY); // return Base64Utils.encode(key.getEncoded()); return Base64.encodeToString(key.getEncoded(), Base64.NO_WRAP); &#125; /** * &lt;p&gt; * èŽ·å–å…¬é’¥ * &lt;/p&gt; * * @param keyMap å¯†é’¥å¯¹ * @return èŽ·å–çš„keyå·²ç»ç»è¿‡base64ç¼–ç  * @throws Exception */ public static String getPublicKey(Map&lt;String, Object&gt; keyMap) throws Exception &#123; Key key = (Key) keyMap.get(PUBLIC_KEY); // return Base64Utils.encode(key.getEncoded()); return Base64.encodeToString(key.getEncoded(), Base64.NO_WRAP); &#125;` ç§é’¥åŠ å¯†123456789101112131415161718192021222324252627282930313233343536373839 /** * &lt;p&gt; * ç§é’¥åŠ å¯† * &lt;/p&gt; * * @param data æºæ•°æ® * @param privateKey ç§é’¥(BASE64ç¼–ç ) * @return * @throws Exception */ public static byte[] encryptByPrivateKey(byte[] data, String privateKey) throws Exception &#123;// byte[] keyBytes = Base64Utils.decode(privateKey); byte[] keyBytes = Base64.decode(privateKey, Base64.NO_WRAP); PKCS8EncodedKeySpec pkcs8KeySpec = new PKCS8EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); Key privateK = keyFactory.generatePrivate(pkcs8KeySpec); Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm()); cipher.init(Cipher.ENCRYPT_MODE, privateK); int inputLen = data.length; ByteArrayOutputStream out = new ByteArrayOutputStream(); int offSet = 0; byte[] cache; int i = 0; // å¯¹æ•°æ®åˆ†æ®µåŠ å¯† while (inputLen - offSet &gt; 0) &#123; if (inputLen - offSet &gt; MAX_ENCRYPT_BLOCK) &#123; cache = cipher.doFinal(data, offSet, MAX_ENCRYPT_BLOCK); &#125; else &#123; cache = cipher.doFinal(data, offSet, inputLen - offSet); &#125; out.write(cache, 0, cache.length); i++; offSet = i * MAX_ENCRYPT_BLOCK; &#125; byte[] encryptedData = out.toByteArray(); out.close(); return encryptedData; &#125; å…¬é’¥åŠ å¯†123456789101112131415161718192021222324252627282930313233343536373839/** * &lt;p&gt; * å…¬é’¥åŠ å¯† * &lt;/p&gt; * * @param data æºæ•°æ® * @param publicKey å…¬é’¥(BASE64ç¼–ç ) * @return * @throws Exception */ public static byte[] encryptByPublicKey(byte[] data, String publicKey) throws Exception &#123; byte[] keyBytes = Base64.decode(publicKey, Base64.NO_WRAP); X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); Key publicK = keyFactory.generatePublic(x509KeySpec); // å¯¹æ•°æ®åŠ å¯† Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm()); cipher.init(Cipher.ENCRYPT_MODE, publicK); int inputLen = data.length; ByteArrayOutputStream out = new ByteArrayOutputStream(); int offSet = 0; byte[] cache; int i = 0; // å¯¹æ•°æ®åˆ†æ®µåŠ å¯† while (inputLen - offSet &gt; 0) &#123; if (inputLen - offSet &gt; MAX_ENCRYPT_BLOCK) &#123; cache = cipher.doFinal(data, offSet, MAX_ENCRYPT_BLOCK); &#125; else &#123; cache = cipher.doFinal(data, offSet, inputLen - offSet); &#125; out.write(cache, 0, cache.length); i++; offSet = i * MAX_ENCRYPT_BLOCK; &#125; byte[] encryptedData = out.toByteArray(); out.close(); return encryptedData; &#125; å…¬é’¥è§£å¯†123456789101112131415161718192021222324252627282930313233343536373839/** * &lt;p&gt; * å…¬é’¥è§£å¯† * &lt;/p&gt; * * @param encryptedData å·²åŠ å¯†æ•°æ® * @param publicKey å…¬é’¥(BASE64ç¼–ç ) * @return * @throws Exception */public static byte[] decryptByPublicKey(byte[] encryptedData, String publicKey) throws Exception &#123; byte[] keyBytes = Base64.decode(publicKey, Base64.NO_WRAP); X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); Key publicK = keyFactory.generatePublic(x509KeySpec); Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm()); cipher.init(Cipher.DECRYPT_MODE, publicK); int inputLen = encryptedData.length; ByteArrayOutputStream out = new ByteArrayOutputStream(); int offSet = 0; byte[] cache; int i = 0; // å¯¹æ•°æ®åˆ†æ®µè§£å¯† while (inputLen - offSet &gt; 0) &#123; if (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123; cache = cipher.doFinal(encryptedData, offSet, MAX_DECRYPT_BLOCK); &#125; else &#123; cache = cipher.doFinal(encryptedData, offSet, inputLen - offSet); &#125; out.write(cache, 0, cache.length); i++; offSet = i * MAX_DECRYPT_BLOCK; &#125; byte[] decryptedData = out.toByteArray(); out.close(); return decryptedData;&#125; ç§é’¥è§£å¯†1234567891011121314151617181920212223242526272829303132333435363738/** * &lt;P&gt; * ç§é’¥è§£å¯† * &lt;/p&gt; * * @param encryptedData å·²åŠ å¯†æ•°æ® * @param privateKey ç§é’¥(BASE64ç¼–ç ) * @return * @throws Exception */ public static byte[] decryptByPrivateKey(byte[] encryptedData, String privateKey) throws Exception &#123; byte[] keyBytes = Base64.decode(privateKey, Base64.NO_WRAP); PKCS8EncodedKeySpec pkcs8KeySpec = new PKCS8EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); Key privateK = keyFactory.generatePrivate(pkcs8KeySpec); Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm()); cipher.init(Cipher.DECRYPT_MODE, privateK); int inputLen = encryptedData.length; ByteArrayOutputStream out = new ByteArrayOutputStream(); int offSet = 0; byte[] cache; int i = 0; // å¯¹æ•°æ®åˆ†æ®µè§£å¯† while (inputLen - offSet &gt; 0) &#123; if (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123; cache = cipher.doFinal(encryptedData, offSet, MAX_DECRYPT_BLOCK); &#125; else &#123; cache = cipher.doFinal(encryptedData, offSet, inputLen - offSet); &#125; out.write(cache, 0, cache.length); i++; offSet = i * MAX_DECRYPT_BLOCK; &#125; byte[] decryptedData = out.toByteArray(); out.close(); return decryptedData; &#125; æ¶ˆæ¯ç­¾å123456789101112131415161718192021/** * &lt;p&gt; * ç”¨ç§é’¥å¯¹ä¿¡æ¯ç”Ÿæˆæ•°å­—ç­¾å * &lt;/p&gt; * * @param data å·²åŠ å¯†æ•°æ® * @param privateKey ç§é’¥(BASE64ç¼–ç ) * @return * @throws Exception */public static String sign(byte[] data, String privateKey) throws Exception &#123; byte[] keyBytes = Base64.decode(privateKey, Base64.NO_WRAP); PKCS8EncodedKeySpec pkcs8KeySpec = new PKCS8EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); PrivateKey privateK = keyFactory.generatePrivate(pkcs8KeySpec); Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM); signature.initSign(privateK); signature.update(data); return Base64.encodeToString(signature.sign(), Base64.NO_WRAP);&#125; éªŒè¯ç­¾å12345678910111213141516171819202122/** * &lt;p&gt; * ä½¿ç”¨å…¬é’¥æ ¡éªŒæ•°å­—ç­¾å * &lt;/p&gt; * * @param data å·²åŠ å¯†æ•°æ® * @param publicKey å…¬é’¥(BASE64ç¼–ç ) * @param sign æ•°å­—ç­¾å * @return * @throws Exception */ public static boolean verifySign(byte[] data, String publicKey, String sign) throws Exception &#123; byte[] keyBytes = Base64.decode(publicKey, Base64.NO_WRAP); X509EncodedKeySpec keySpec = new X509EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); PublicKey publicK = keyFactory.generatePublic(keySpec); Signature signature = Signature.getInstance(SIGNATURE_ALGORITHM); signature.initVerify(publicK); signature.update(data); return signature.verify(Base64.decode(sign, Base64.NO_WRAP)); &#125; æŠ½å–å…¬å…±ä»£ç  å¯ä»¥å‘çŽ°æœ‰å¾ˆå¤šé‡å¤ä»£ç ï¼Œè¿™æ ·å†™æ˜¯ä¸ºäº†æ›´åŠ æ¸…æ™°ï¼Œä»£ç æŠ½å–ä¸€ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273/** * * ä½¿ç”¨ç§é’¥æ“ä½œæ—¶ * @param data * @param key * @param mode * @return * @throws Exception */ public static byte[] UsePrivate(byte[] data, String key,int mode) throws Exception &#123; byte[] keyBytes = Base64.decode(key, Base64.NO_WRAP); PKCS8EncodedKeySpec pkcs8KeySpec = new PKCS8EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); Key privateK = keyFactory.generatePrivate(pkcs8KeySpec); Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm()); cipher.init(mode, privateK); int inputLen = data.length; ByteArrayOutputStream out = new ByteArrayOutputStream(); int offSet = 0; byte[] cache; int i = 0; // å¯¹æ•°æ®åˆ†æ®µè§£å¯† while (inputLen - offSet &gt; 0) &#123; if (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123; cache = cipher.doFinal(data, offSet, MAX_DECRYPT_BLOCK); &#125; else &#123; cache = cipher.doFinal(data, offSet, inputLen - offSet); &#125; out.write(cache, 0, cache.length); i++; offSet = i * MAX_DECRYPT_BLOCK; &#125; byte[] decryptedData = out.toByteArray(); out.close(); return decryptedData; &#125; /** * ä½¿ç”¨å…¬é’¥æ“ä½œ * @param data * @param key * @param mode * @return * @throws Exception */ public static byte[] UsePublic(byte[] data, String key,int mode) throws Exception &#123; byte[] keyBytes = Base64.decode(key, Base64.NO_WRAP); X509EncodedKeySpec x509KeySpec = new X509EncodedKeySpec(keyBytes); KeyFactory keyFactory = KeyFactory.getInstance(KEY_ALGORITHM); Key publicK = keyFactory.generatePublic(x509KeySpec); Cipher cipher = Cipher.getInstance(keyFactory.getAlgorithm()); cipher.init(mode, publicK); int inputLen = data.length; ByteArrayOutputStream out = new ByteArrayOutputStream(); int offSet = 0; byte[] cache; int i = 0; // å¯¹æ•°æ®åˆ†æ®µè§£å¯† while (inputLen - offSet &gt; 0) &#123; if (inputLen - offSet &gt; MAX_DECRYPT_BLOCK) &#123; cache = cipher.doFinal(data, offSet, MAX_DECRYPT_BLOCK); &#125; else &#123; cache = cipher.doFinal(data, offSet, inputLen - offSet); &#125; out.write(cache, 0, cache.length); i++; offSet = i * MAX_DECRYPT_BLOCK; &#125; byte[] decryptedData = out.toByteArray(); out.close(); return decryptedData; &#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mac + AndroidStudio å¿«æ·æ“ä½œ]]></title>
    <url>%2Farticle%2F8d16bcb4%2F</url>
    <content type="text"><![CDATA[å¿«æ·é”®å¸¸ç”¨123456789101112131415161718- å¿«é€Ÿæç¤ºalt + Enter- è·³è½¬åˆ°æŸä¸€è¡Œcommand + L- æ•´ç†ä»£ç alt + command + L- é‡å‘½åå˜é‡shift + F6- ä»£ç å¤§å°å†™è½¬æ¢shift + command + u- åˆ—é€‰ä¸­alt + é¼ æ ‡ æå–12345- æå–ä»£ç å—ä¸ºæ–¹æ³•alt + command + M (method)- æå–å±€éƒ¨å˜é‡ä¸ºå…¨å±€å˜é‡alt + command + F (field) æœç´¢ï¼æ›¿æ¢12345678910111213141516- æœç´¢ java æ–‡ä»¶command + O- æœç´¢æ‰€æœ‰æ–‡ä»¶shift + command + O - æ–‡ä»¶å†…æŸ¥æ‰¾æ–‡æœ¬command + F- é¡¹ç›®å†…æŸ¥æ‰¾æ–‡æœ¬shift + command + F- æ–‡ä»¶å†…æ–‡æœ¬æ›¿æ¢command + R- é¡¹ç›®å†…æ–‡æœ¬æ›¿æ¢shift + command + R- search everywhere åŒå‡» shift project æ“ä½œ12345678910- æ‰“å¼€ ProjectStructurecommand + ;(åˆ†å·)- æ‰“å¼€ settingscommand + ,(é€—å·)- è¿è¡Œé¡¹ç›®control + R- è¿è¡Œ freelineshift + command + F10 ä»£ç å¿«æ·ç”¨æ³•é€šç”¨12345678910111213141516171819202122232425User user = new User();// åˆ¤æ–­ä¸ä¸ºç©º; user.nnif (user != null) &#123;&#125;// åˆ¤æ–­ä¸ºç©º; user.nullif (user == null) &#123;&#125;// è¿”å›ž; user.returnreturn user;// instanceof åˆ¤æ–­; user.instList temp = user instanceof List ? ((List) list) : null;// ç”Ÿæˆæ¡ä»¶è¡¨è¾¾å¼; æ¡ä»¶è¡¨è¾¾å¼.if å¦‚è¾“å…¥ 100&gt;10.ifif (100 &gt; 10) &#123; &#125;// ç”Ÿæˆwhileå¾ªçŽ¯; æ¡ä»¶è¡¨è¾¾å¼.while å¦‚è¾“å…¥ 100&gt;10.whilewhile (100 &gt; 10) &#123; &#125; å¿«é€ŸéåŽ†12345678910111213141516List&lt;String&gt; list = new ArrayList&lt;&gt;();// list.forfor (String s : list) &#123; &#125;// list.forifor (int i = 0; i &lt; list.size(); i++) &#123; &#125;// list.forrfor (int i = list.size() - 1; i &gt;= 0; i--) &#123; &#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>DevEnvironment</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TabLayout]]></title>
    <url>%2Farticle%2F1315779230%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç» TabLayout çš„è¯¦ç»†ä½¿ç”¨ï¼ŒæŒç»­å®Œå–„ä¸­â€¦ TabLayout çš„åŸºæœ¬å±žæ€§åŠæ•ˆæžœ TabLayout ä¸Ž ViewPager è”åŠ¨ è‡ªå®šä¹‰ TabLayout çš„ tab æ˜¾ç¤º åŸºæœ¬å±žæ€§ä»‹ç»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;android.support.design.widget.TabLayout android:id="@+id/fragment_discover_tably" android:layout_width="match_parent" android:layout_height="wrap_content"/&gt; 1. tabModeapp:tabMode="fixed|scrollable" tabModeå±žæ€§æœ‰ä¸¤ä¸ªå–å€¼:fixedæ—¶ï¼Œæ‰€æœ‰çš„tabä¼šå±…ä¸­æ˜¾ç¤ºï¼Œæ˜¯ä¸å¯æ»‘åŠ¨çš„ï¼Œscrollableæ—¶ï¼Œæ‰€æœ‰çš„tabä¼šé å·¦æ˜¾ç¤ºï¼Œå½“tabæ•°é‡å¾ˆå¤šæ—¶ï¼Œå°±ä¼šå‘ˆçŽ°æ»‘åŠ¨çš„æ•ˆæžœï¼Œè¿™å¯¹é€‚é…å°å±å¹•æ‰‹æœºè‡³å…³é‡è¦ã€‚2. å¯¼èˆªæ¡çš„é«˜åº¦å’Œé¢œè‰²app:tabIndicatorHeight="3dp"app:tabIndicatorColor="#af00"3. tabçš„å®½åº¦é™åˆ¶å½“æ–‡å­—å¾ˆå°‘æ—¶ä»æ—§ä¸ä¼šå°äºŽtabMinWidthå½“æ–‡å­—è¿‡å¤šæ—¶ï¼Œä¹Ÿä¸ä¼šå°†tabæ’‘çš„è¶…è¿‡tabMaxWidthapp:tabMaxWidth="150dp"app:tabMinWidth="60dp"4. tabè¢«é€‰ä¸­æˆ–æ²¡æœ‰è¢«é€‰ä¸­æ—¶çš„é¢œè‰²app:tabTextColor="@color/black"app:tabSelectedTextColor="@color/colorPrimary"5. æ›´æ”¹Tabä¸Šé¢çš„TextViewçš„è¯¦ç»†æ˜¾ç¤ºapp:tabTextAppearance="@style/TabLayoutStyle"&lt;style name="TabLayoutStyle" parent="TextAppearance.Design.Tab"&gt; &lt;item name="android:textSize"&gt;16sp&lt;/item&gt; &lt;item name="android:textStyle"&gt;normal&lt;/item&gt;&lt;/style&gt;6. èƒŒæ™¯app:tabBackground="@color/transparent"è®¾ç½®tabçš„èƒŒæ™¯é¢œè‰²ï¼Œé»˜è®¤TabLayoutç‚¹å‡»æ—¶æ˜¯æœ‰å…‰æ™•æ•ˆæžœçš„ï¼Œä½¿ç”¨è¯¥å±žæ€§å¯ä»¥åŽ»æŽ‰å…‰æ™•æ•ˆæžœã€‚7. tabé—´éš”é»˜è®¤tabå·¦å³ä¸¤è¾¹æ˜¯æœ‰paddingçš„ï¼Œä½¿ç”¨ä»¥ä¸‹å±žæ€§å¯ä»¥åŽ»æŽ‰paddingï¼Œåªä½¿ç”¨tabPaddingæ˜¯æ²¡æœ‰æ•ˆæžœçš„ï¼Œè¦å…·ä½“åˆ°è®¾ç½®åˆ°å“ªä¸ªpadding app:tabPadding="0dp"app:tabPaddingBottom="0dp"app:tabPaddingEnd="0dp"app:tabPaddingStart="0dp"app:tabPaddingTop="0dp" ä¸Ž ViewPager è”åŠ¨ä½¿ç”¨ TabLayout çš„ setupWithViewPager() æ–¹æ³•ï¼Œå¯ä»¥å®žçŽ°ä¸Ž ViewPager çš„è”åŠ¨ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å†™ ViewPager æ—¶éœ€è¦å®žçŽ° getTitle() æ–¹æ³•ï¼Œç”¨æ¥è®¾ç½® tab çš„æ ‡é¢˜ã€‚åŽŸå…ˆç»™ Tab è®¾ç½®çš„æ ‡é¢˜å°†ä¼šè¢«è¦†ç›–æŽ‰ã€‚ 1tabLy.setupWithViewPager(viewPager); è‡ªå®šä¹‰ Tab æ˜¾ç¤ºé»˜è®¤çš„ TabLayout æ˜¯å¯ä»¥æ˜¾ç¤ºæ–‡å­—å’Œ Icon çš„ï¼Œä½†æ˜¯å®šåˆ¶åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œå¾€å¾€ä¸èƒ½å®žçŽ°é¢„æœŸæ•ˆæžœï¼Œä¸è¿‡å¥½åœ¨ TabLayout å¼€æ”¾äº† setCustomView(childView) è¿™ä¸ª API æ¥æ”¯æŒæˆ‘ä»¬è‡ªå®šä¹‰ TabLayout çš„UIï¼Œå½“ç„¶è‡ªå®šä¹‰æ˜¾ç¤ºä¹‹åŽä¹ŸæŸå¤±äº†åˆ‡æ¢æ—¶é¢œè‰²åˆ‡æ¢ç­‰æ•ˆæžœï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ¥å¤„ç†ï¼Œä¸‹é¢æ˜¯æˆ‘å®šä¹‰äº†ä¸€ä¸ªè¾…åŠ©ç±»ï¼Œä½¿ç”¨ç±»ä¼¼ adapter çš„å½¢å¼æ¥åŠ è½½ TabLayout çš„æ¯ä¸ª tab çš„æ˜¾ç¤ºï¼Œå®žçŽ°è‡ªå®šä¹‰æ•ˆæžœï¼Œä¹Ÿå¯¹é€‰ä¸­äº‹ä»¶ç­‰ä½œäº†ç®€åŒ–æ“ä½œã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194/** * CreateAt : 2017/3/29 * Describe : TabLayouté€‚é…å™¨,å¿«é€Ÿå®žçŽ°TabLayoutè‡ªå®šä¹‰Viewæ•°æ®åŠ è½½ * * @author chendong */public abstract class BaseTabAdapter&lt;T&gt; &#123; public static final String TAG = BaseTabAdapter.class.getSimpleName(); private Context mContext; // è‡ªå®šä¹‰å¸ƒå±€layoutæ–‡ä»¶ private int mResId; // æ•°æ®æº private List&lt;T&gt; mDatas; // å…¨éƒ¨çš„æŽ§ä»¶ï¼Œç”¨æ¥åˆ‡æ¢æ—¶æ”¹å˜æ˜¾ç¤º private List&lt;TabLayoutViewHolder&gt; mTabLayoutViewHolders; // tabLayout private TabLayout mTabLayout; // ç®€åŒ–çš„tabç‚¹å‡»äº‹ä»¶ private OnTabSelectListener&lt;T&gt; mOnTabSelectListener; private boolean mIsReady; /** * Tabé€‰ä¸­çš„æŽ¥å£ * * @param &lt;T&gt; */ public interface OnTabSelectListener&lt;T&gt; &#123; void onSelect(int pos, T data); &#125; protected BaseTabAdapter(Context context, List&lt;T&gt; datas, int resId) &#123; mDatas = datas; mContext = context; mResId = resId; mTabLayoutViewHolders = new ArrayList&lt;&gt;(); &#125; public void attachTabLayout(TabLayout tabLayout) &#123; tabLayout.clearOnTabSelectedListeners(); attachTabLayout(tabLayout, 0); &#125; public void attachTabLayout(TabLayout tabLayout, int posSelect) &#123; mIsReady = false; mTabLayout = tabLayout; // è®¾ç½®å¯¼èˆªæ¡é«˜åº¦=0 tabLayout.setSelectedTabIndicatorHeight(0); tabLayout.addOnTabSelectedListener(new TabLayout.OnTabSelectedListener() &#123; @Override public void onTabSelected(TabLayout.Tab tab) &#123; L.e(TAG, "onTabSelected " + tab.getPosition()); int position = tab.getPosition(); if (mIsReady &amp;&amp; mOnTabSelectListener != null) &#123; mOnTabSelectListener.onSelect(position, mDatas.get(position)); &#125; updateStatus(mTabLayoutViewHolders.get(position), mDatas.get(position), true); &#125; @Override public void onTabUnselected(TabLayout.Tab tab) &#123; L.e(TAG, "onTabUnselected " + tab.getPosition()); updateStatus(mTabLayoutViewHolders.get(tab.getPosition()), mDatas.get(tab.getPosition()), false); &#125; @Override public void onTabReselected(TabLayout.Tab tab) &#123; L.e(TAG, "onTabReselected " + tab.getPosition()); updateStatus(mTabLayoutViewHolders.get(tab.getPosition()), mDatas.get(tab.getPosition()), true); &#125; &#125;); // åˆå§‹åŒ–view,é»˜è®¤åˆå§‹åŒ–ä¸ºå…¨éƒ¨ä¸é€‰ä¸­ View childView; TabLayoutViewHolder holder; TabLayout.Tab tab; for (int i = 0; i &lt; mDatas.size(); i++) &#123; childView = LayoutInflater.from(mContext).inflate(mResId, tabLayout, false); holder = new TabLayoutViewHolder(childView); mTabLayoutViewHolders.add(holder); updateStatus(mTabLayoutViewHolders.get(i), mDatas.get(i), false); tab = tabLayout.newTab().setCustomView(childView); tabLayout.addTab(tab); &#125; // é€‰ä¸­åˆå§‹åŒ–é€‰ä¸­çš„é‚£ä¸ª TabLayout.Tab tabAt = tabLayout.getTabAt(posSelect); if (tabAt != null) &#123; tabAt.select(); if (mOnTabSelectListener != null) &#123; mOnTabSelectListener.onSelect(posSelect, mDatas.get(posSelect)); &#125; &#125; mIsReady = true; &#125; public void notifyItemChanged(int pos) &#123; if (pos &gt;= 0 &amp;&amp; pos &lt; mDatas.size()) &#123; TabLayout.Tab tabAt; tabAt = mTabLayout.getTabAt(pos); updateStatus(mTabLayoutViewHolders.get(pos), mDatas.get(pos), tabAt != null &amp;&amp; tabAt.isSelected()); &#125; &#125; public void notityDataSetChanged() &#123; TabLayout.Tab tabAt; for (int i = 0; i &lt; mDatas.size(); i++) &#123; tabAt = mTabLayout.getTabAt(i); updateStatus(mTabLayoutViewHolders.get(i), mDatas.get(i), tabAt != null &amp;&amp; tabAt.isSelected()); &#125; &#125; /** * æŠ½è±¡æ–¹æ³•ï¼Œæ›´æ–°æŽ§ä»¶çŠ¶æ€æ˜¾ç¤º * * @param holder view holder * @param data æ•°æ® * @param isSelect æ˜¯å¦é€‰ä¸­ */ public abstract void updateStatus(TabLayoutViewHolder holder, T data, boolean isSelect); public void setOnTabSelectListener(OnTabSelectListener&lt;T&gt; onTabSelectListener) &#123; mOnTabSelectListener = onTabSelectListener; &#125; public interface OnBuildTabListener&lt;D&gt; &#123; TabLayout.Tab onBuild(TabLayout.Tab tab, D data); &#125; public static &lt;D&gt; void buildTabLayout(TabLayout tabLayout, List&lt;D&gt; datas, OnBuildTabListener&lt;D&gt; listener) &#123; TabLayout.Tab tab; for (D data : datas) &#123; tab = tabLayout.newTab(); tabLayout.addTab(listener.onBuild(tab, data)); &#125; &#125; /** * å…¬å…±holderï¼Œç”¨æ¥å­˜å‚¨å’Œå¿«é€ŸèŽ·å–æŽ§ä»¶ */ public static class TabLayoutViewHolder &#123; private View parentView; private SparseArray&lt;View&gt; mCacheViews; public View getItemView() &#123; return parentView; &#125; TabLayoutViewHolder(View parentView) &#123; this.parentView = parentView; mCacheViews = new SparseArray&lt;&gt;(); &#125; public &lt;V extends View&gt; V getView(int resId) &#123; V v = (V) mCacheViews.get(resId); if (v == null) &#123; v = (V) parentView.findViewById(resId); if (v != null) &#123; mCacheViews.put(resId, v); &#125; &#125; return v; &#125; &#125; public void setUpViewPager(final ViewPager viewPager) &#123; if (mTabLayout == null) &#123; Log.e("chendong", "TabLayout is null ,invoke attachTabLayout first"); return; &#125; mTabLayout.addOnTabSelectedListener(new MyOnTabSelectedListener() &#123; @Override public void onTabSelected(TabLayout.Tab tab) &#123; if (viewPager != null) viewPager.setCurrentItem(tab.getPosition()); &#125; &#125;); if (viewPager != null) viewPager.addOnPageChangeListener(new MyOnPageChangeListener() &#123; @Override public void onPageSelected(int position) &#123; if (mTabLayout != null) &#123; TabLayout.Tab tabAt = mTabLayout.getTabAt(position); if (tabAt != null) tabAt.select(); &#125; &#125; &#125;); &#125;&#125; how to usage? 123456789101112131415161718BaseTabAdapter&lt;Baby&gt; adapter = new BaseTabAdapter&lt;Baby&gt;(mActivty, babies, R.layout.vip_select_family_baby_item) @Override public void updateStatus(TabLayoutViewHolder holder, Baby data, boolean isSelect) &#123; holder.getView(R.id.parent).getLayoutParams().width = (int) (BaoBaoApplication.DISPLAY_WIDTH / 3f); TextView nameTv = holder.getView(R.id.tv_name); nameTv.setText(data.getBabyName()); holder.getView(R.id.view_line).setBackgroundColor(isSelect ? ContextCompat.getColor(mBaseFragmentActivity, R.color.colorPrimary) : ContextCompat.getColor(mBaseFragmentActivity, R.color.color_EFEFEF)); &#125;&#125;;adapter.setOnTabSelectListener(new BaseTabAdapter.OnTabSelectListener&lt;Baby&gt;() &#123; @Override public void onSelect(int pos, Baby data) &#123; // è¯·æ±‚æ•°æ®ï¼Œå±•ç¤ºæ•°æ® &#125;&#125;);adapter.attachTabLayout(mTabLayout, 1);]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ä¼ ç»ŸAndroidç»„ä»¶å®žçŽ°é«˜æ•ˆæ•°æ®åŠ è½½]]></title>
    <url>%2Farticle%2F3092091804%2F</url>
    <content type="text"><![CDATA[å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç»ä½¿ç”¨ContentProvider + Sqlite + Loaderç­‰Androidçš„åŸºæœ¬ç»„ä»¶å®žçŽ°é«˜å†…èšä½Žè€¦åˆçš„æ•°æ®åŠ è½½çš„æ•°æ®è®¾è®¡æ¨¡å¼ï¼Œè¿™æ˜¯ä¸€ç§ä¼ ç»Ÿè€Œé«˜æ•ˆçš„æ•°æ®åŠ è½½ï¼Œç†Ÿæ‚‰è¿™ç§æ¨¡å¼åŒæ—¶ä¹Ÿæ˜¯å¯¹ContentProviderçš„æ›´å¥½æŽŒæ¡ã€‚ ä¼˜åŠ¿ ContentProviderå¯ä»¥éžå¸¸ç®€å•çš„è°ƒæ•´æ•°æ®æºè€Œä¸å½±å“å…¶ä»–ç¨‹åºã€‚å¤–éƒ¨ç¨‹åºä¸å…³å¿ƒæ•°æ®ï¼Œåªå…³å¿ƒè¿”å›žçš„Cursor.ä¸¾ä¸ªä¾‹å­ï¼ŒContentProvideræŒ‡å‘çš„æ•°æ®åº“å¯ä»¥éšæ—¶æ”¹å˜ä¸ä¼šå½±å“ä½¿ç”¨è€…ï¼ŒåŒæ—¶ContentProviderä¹Ÿå¯ä»¥è¿”å›žç½‘ç»œæ•°æ®ï¼Œä½¿ç”¨è€…åªè¦æ±‚ç»“æžœæ˜¯Cursor,ä½†æ˜¯å¯¹äºŽæ•°æ®æ¥è‡ªå“ªé‡Œå¹¶ä¸å…³å¿ƒï¼Œè¿™æ ·å°±å®žçŽ°äº†æ•°æ®è¯»å–å’Œä½¿ç”¨çš„åˆ†ç¦»ã€‚ æä¾›æ•°æ®å®‰å…¨ä¿æŠ¤ä¸Žæƒé™ç®¡ç†ï¼ŒContentProviderä½¿ç”¨æŽˆæƒæœºåˆ¶ï¼Œå¯¹æ•°æ®åœ¨æ–¹ä¾¿è®¿é—®çš„åŒæ—¶è¿›è¡Œäº†å¾ˆå¥½åœ°ä¿æŠ¤ã€‚ å¼ºå¤§çš„APIæ”¯æŒï¼ŒGoogleå®˜æ–¹æä¾›äº†å¼ºå¤§çš„API. ##Loaderç‰¹ç‚¹ï¼š ä¸ŽActivityç®¡ç†åŒæ­¥ï¼Œä¸ŽActivity/Fragmentç”Ÿå‘½å‘¨æœŸåŒæ­¥ï¼Œåˆ›å»ºä¸Žé”€æ¯éƒ½ä¼šå—åˆ°Activity/Fragmentç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦å†åŽ»è€ƒè™‘ä½•æ—¶åŽ»åŠ è½½æ•°æ®ï¼Œä½¿ç”¨Loaderä¹‹åŽä¼šç»“åˆActivityæˆ–è€…Fragmentçš„ç”Ÿå‘½å‘¨æœŸè‡ªè¡Œè¿›è¡ŒåŠ è½½å’Œæ›´æ–°ã€‚ å†…éƒ¨çº¿ç¨‹å¼‚æ­¥åŠ è½½ï¼Œæˆ‘ä»¬ä¹Ÿå°±ä¸éœ€è¦å†åŽ»å¼€å¯çº¿ç¨‹èŽ·å–æ•°æ®è§£æžæ•°æ®ï¼Œå¤§å¤§å‡å°‘äº†ä»£ç é‡ã€‚ æ•°æ®æºå‘ç”Ÿæ”¹å˜æ—¶å®žæ—¶æ›´æ–°ï¼Œè²Œä¼¼æˆ‘ä»¬è‡ªå·±çš„æ•°æ®æ•°æ®æ˜¯æ— æ³•è‡ªåŠ¨æ›´æ–°çš„ï¼Œä¸è¿‡ä¸è¦ç´§ï¼Œåªéœ€è¦ä¸€è¡Œç®€å•çš„reStartLoaderå°±å¯ä»¥æ‰‹åŠ¨é‡æ–°åŠ è½½ä¸€ä¸‹ã€‚ æ•°æ®åˆ†å±‚ Loader å†™æ“ä½œ ContentProvider SQLite å®šä¹‰å…³ç³»ç±» å®šä¹‰ä¸€ä¸ªå…³ç³»ç±»ï¼Œå£°æ˜Žè¡¨ç»“æž„,Uri,æŽˆæƒ 1234567891011121314151617181920212223242526public class WebContract &#123; public static final String Tb_History = &quot;tb_history&quot;; public static final String Tb_BookMark = &quot;tb_bookmark&quot;; public static final String Authority = &quot;com.march.db_browser&quot;; public static class History implements BaseColumns &#123; //content://com.march.db_browser/tb_history public static final Uri ContentUri = Uri.parse( &quot;content://&quot; + Authority).buildUpon().appendPath(Tb_History).build(); public static final String Link = &quot;link&quot;; public static final String Icon = &quot;icon&quot;; public static final String Title = &quot;title&quot;; public static final String Time = &quot;time&quot;; &#125; public static class BookMark implements BaseColumns &#123; //content://com.march.db_browser/tb_history public static final Uri ContentUri = Uri.parse( &quot;content://&quot; + Authority).buildUpon().appendPath(Tb_BookMark).build(); public static final String Link = &quot;link&quot;; public static final String Icon = &quot;icon&quot;; public static final String Title = &quot;title&quot;; public static final String Time = &quot;time&quot;; &#125;&#125; ç»§æ‰¿ContentProvider å®žçŽ°æ•°æ®æä¾›è€…ï¼Œè®¾å®šå¥½Codeä½œä¸ºè¡¨èµ„æºçš„å”¯ä¸€æ ‡ç¤ºï¼Œä½¿ç”¨UriMacheråŒ¹é… 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889public class WebContentProvider extends ContentProvider &#123;/*ä¸ºå¯ä»¥è®¿é—®çš„æ•°æ®åº“è¡¨èµ„æºå®šä¹‰ä»£å·ï¼ŒåŒºåˆ†å“ªä¸ªè¡¨å¯ä»¥è¢«è®¿é—®*/private static final int CODE_BOOKMARK = 0x1;private static final int CODE_HISTORY = 0x2;/*ä½¿ç”¨UriMacherç”Ÿæˆè®¿é—®çš„Uri*/private static UriMatcher uriMatcher;/*ä½¿ç”¨é™æ€ä»£ç å—åˆå§‹åŒ–UriMacher,æ·»åŠ */static &#123;uriMatcher = new UriMatcher(UriMatcher.NO_MATCH);uriMatcher.addURI(WebContract.Authority, WebContract.Tb_BookMark, CODE_BOOKMARK);uriMatcher.addURI(WebContract.Authority, WebContract.Tb_History, CODE_HISTORY);&#125;private MySqliteOpenHelper mySqliteOpenHelper;private SQLiteDatabase db;@Overridepublic boolean onCreate() &#123;mySqliteOpenHelper = new MySqliteOpenHelper(getContext(), "db_browser", 1);return false;&#125;@Overridepublic Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) &#123;Cursor cursor = null;if (uri != null) &#123;int code = uriMatcher.match(uri);db = mySqliteOpenHelper.getWritableDatabase();switch (code) &#123;case CODE_BOOKMARK:cursor = db.query(WebContract.Tb_BookMark, null, null, null, null, null, null);break;case CODE_HISTORY:cursor = db.query(WebContract.Tb_History, null, null, null, null, null, null);break;&#125;&#125;if (cursor == null) &#123;Log.i("chendong", "cursor is null");&#125; // db.close();//è¯»æ“ä½œä¸èƒ½å…³é—­è¿žæŽ¥ï¼Œå†™æ“ä½œéœ€è¦å…³é—­è¿žæŽ¥return cursor;&#125;@Overridepublic String getType(Uri uri) &#123;return null;&#125;@Overridepublic Uri insert(Uri uri, ContentValues values) &#123;Uri uri_return = null;if (uri != null) &#123;int code = uriMatcher.match(uri);db = mySqliteOpenHelper.getWritableDatabase();long id = -1;switch (code) &#123;case CODE_BOOKMARK:id = db.insert(WebContract.Tb_BookMark, null, values);break;case CODE_HISTORY:id = db.insert(WebContract.Tb_History, null, values);break;&#125;if (id != -1) &#123;uri_return = ContentUris.withAppendedId(uri, id);&#125;db.close();&#125;return uri_return;&#125;@Overridepublic int delete(Uri uri, String selection, String[] selectionArgs) &#123;// Implement this to handle requests to delete one or more rows.throw new UnsupportedOperationException("Not yet implemented");&#125;@Overridepublic int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) &#123;// TODO: Implement this to handle requests to update one or more rows.throw new UnsupportedOperationException("Not yet implemented");&#125;&#125; ä½¿ç”¨LoaderåŠ è½½æ•°æ®``` adapter = new SimpleCursorAdapter(this, R.layout.item_listview, null, new String[]{WebContract.History.Title, WebContract.History.Link}, new int[]{R.id.item_listview_title, R.id.item_listview_url}, SimpleCursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER); listView.setAdapter(adapter); getLoaderManager().initLoader(0x123, bundle, this); //è¿™æ˜¯å®žçŽ°çš„ implements LoaderManager.LoaderCallbacks&lt;Cursor&gt; çš„æ–¹æ³• @Override public Loader&lt;Cursor&gt; onCreateLoader(int id, Bundle args) { int action = args.getInt(&quot;action&quot;); CursorLoader cursorLoader = null; Log.i(&quot;chendong&quot;, &quot;action is &quot; + action); if (action == 0) { //history cursorLoader = new CursorLoader(this, WebContract.History.ContentUri, null, null, null, null); } else { cursorLoader = new CursorLoader(this, WebContract.BookMark.ContentUri, null, null, null, null); } return cursorLoader; } @Override public void onLoadFinished(Loader&lt;Cursor&gt; loader, Cursor data) { Log.i(&quot;chendong&quot;, &quot;get data &quot;); adapter.changeCursor(data); } @Override public void onLoaderReset(Loader&lt;Cursor&gt; loader) { } ä½¿ç”¨ getLoaderManager().restartLoader(0x123, bundle, this); é‡æ–°åŠ è½½æ•°æ®]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidç¼–ç è§£ç åŠå…¶åŽŸç†]]></title>
    <url>%2Farticle%2F438600076%2F</url>
    <content type="text"><![CDATA[å‰è¨€ æœ¬æ–‡ç”¨åˆ°ASCIIè¡¨ï¼ŒBase64å¯¹ç…§è¡¨è¯·è‡ªè¡Œç™¾åº¦ã€‚ æ¦‚å¿µï¼šç¼–ç è§£ç å°±æ˜¯ä½¿ç”¨ç‰¹å®šçš„ç®—æ³•ï¼Œå°†æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå½¢æˆæ•°æ®çš„å¦å¤–ä¸€ç§è¡¨çŽ°å½¢å¼ï¼Œç¼–ç åŽçš„æ•°æ®å¯ä»¥ä½¿ç”¨è§£ç ç®—æ³•è¿˜åŽŸå‡ºåŽŸå§‹æ•°æ®ã€‚ Base64ç®€ä»‹ Base64ç®—æ³•å¯ä»¥å°†ä»»æ„çš„å­—èŠ‚æ•°ç»„æ•°æ®é€šè¿‡ç®—æ³•ç”Ÿæˆåªæœ‰ï¼ˆè‹±æ–‡å¤§å°å†™ï¼Œæ•°å­—ï¼Œ+ï¼Œ/ï¼‰å…±64ç§å­—ç¬¦çš„å­—ç¬¦ä¸²æ•°æ®ï¼›ç›¸å½“äºŽå°†ä»»æ„å†…å®¹è½¬æ¢ä¸ºå¯è§å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ ä¹Ÿå°±æ˜¯å°†ä¸å¯è§çš„æ•°æ®è½¬æ¢ä¸ºASCIIç æ•°æ®ï¼Œä¾¿äºŽåœ¨Jsonå’ŒXmlä¸­ä¼ é€’ã€‚ Base64Api1234567891011121314//å°†å­—èŠ‚æ•°ç»„ç¼–ç ï¼Œè¿”å›žä¸ºStringBase64.encodeToString(byte[] bs,int flag);//å°†å­—èŠ‚æ•°ç»„ç¼–ç ï¼Œè¿”å›žå­—èŠ‚æ•°ç»„Base64.encode(byte[] bs,int flag);//å°†å­—èŠ‚æ•°ç»„æŒ‰æŒ‡å®šä½ç½®éƒ¨åˆ†ç¼–ç ï¼Œè¿”å›žå­—ç¬¦ä¸²Base64.encodeToString(byte[] bs,int offset,int lenth);//å°†å­—èŠ‚æ•°ç»„æŒ‰æŒ‡å®šä½ç½®éƒ¨åˆ†ç¼–ç ï¼Œè¿”å›žå­—èŠ‚æ•°ç»„Base64.encode(byte[] bs,int offset,int lenth);//å°†ç¼–ç åŽçš„å­—ç¬¦ä¸²è§£ç è¿”å›žå­—èŠ‚æ•°ç»„Base64.decode(String str,int flag);//å°†ç¼–ç åŽçš„å­—èŠ‚æ•°ç»„è§£ç è¿”å›žå­—èŠ‚æ•°ç»„Base64.decode(byte[],int flag);//å°†ç¼–ç åŽçš„å­—èŠ‚æ•°ç»„æŒ‰æŒ‡å®šä½ç½®éƒ¨åˆ†è§£ç ï¼Œè¿”å›žå­—èŠ‚æ•°ç»„Base64.decode(byte[] bs,int offset,int len); flagå¸¸é‡1234567891011Base64.CRLF è¿™ä¸ªå‚æ•°æ„æ€æ˜¯Winé£Žæ ¼çš„æ¢è¡Œç¬¦ï¼Œæ„æ€å°±æ˜¯ä½¿ç”¨CR LFè¿™ä¸€å¯¹ä½œä¸ºä¸€è¡Œçš„ç»“å°¾è€Œä¸æ˜¯Unixé£Žæ ¼çš„LFBase64.DEFAULT è¿™ä¸ªå‚æ•°æ˜¯é»˜è®¤ï¼Œä½¿ç”¨é»˜è®¤çš„æ–¹æ³•æ¥åŠ å¯†Base64.NO_PADDING è¿™ä¸ªå‚æ•°æ˜¯ç•¥åŽ»åŠ å¯†å­—ç¬¦ä¸²æœ€åŽçš„â€=â€Base64.NO_WRAP è¿™ä¸ªå‚æ•°æ„æ€æ˜¯ç•¥åŽ»æ‰€æœ‰çš„æ¢è¡Œç¬¦ï¼ˆè®¾ç½®åŽCRLFå°±æ²¡ç”¨äº†ï¼‰Base64.URL_SAFE è¿™ä¸ªå‚æ•°æ„æ€æ˜¯åŠ å¯†æ—¶ä¸ä½¿ç”¨å¯¹URLå’Œæ–‡ä»¶åæœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦æ¥ä½œä¸ºåŠ å¯†å­—ç¬¦ï¼Œå…·ä½“å°±æ˜¯ä»¥-å’Œ_å–ä»£+å’Œ///ä¹ æƒ¯ä¸Šä½¿ç”¨Base64.NO_WRAPï¼Œä½¿ç”¨ä»€ä¹ˆæ–¹å¼ç¼–ç å°±éœ€è¦ä½¿ç”¨ä»€ä¹ˆæ–¹å¼è§£ç ã€‚ Base64åŽŸç† Base64åœ¨ç¼–ç æ—¶æŒ‰ç…§ä¸‰ä¸ªå­—èŠ‚ä¸€ç»„åˆ†ç»„ï¼Œ è¿›è¡Œå¤„ç†ï¼Œæ¯ä¸‰ä¸ªå­—èŠ‚åœ¨ç¼–ç ä¹‹åŽè¢«è½¬æ¢ä¸º4ä¸ªå­—ç¬¦ã€‚ æ¯ä¸ªå­—èŠ‚æœ‰8ä¸ªbit(ä¹Ÿå¿…é¡»æ˜¯è¦æ±‚æœ‰8bitï¼Œæ‰€ä»¥ä¸­æ–‡æ˜¯ä¸å¯ä»¥çš„),ä¸‰ä¸ªå­—èŠ‚å°±æœ‰24ä¸ªbit. ä½†æ˜¯æˆ‘ä»¬åªæœ‰64 ç§å­—ç¬¦é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯Base64çš„å­—ç¬¦æœ€å¤šåªèƒ½ç”¨6bitæ¥è¡¨ç¤ºï¼Œå†å¤§å°±ä¼šè¶…å‡º64çš„èŒƒå›´ï¼Œæ‰€ä»¥ç¼–ç ä»¥åŽæ˜¾ç¤ºçš„å­—ç¬¦å¼€å§‹ä¸¤ä½æ˜¯0. é‚£ä¹ˆåŽŸå…ˆ24bitçš„æ•°æ®è¦æ˜¾ç¤ºåœ¨çŽ°åœ¨æ¯ä¸ªå­—ç¬¦åªæœ‰6bitçš„è¡¨ç¤ºæ–¹æ³•ä¸Šï¼Œå¾ˆæ˜Žæ˜¾éœ€è¦4ä¸ªå­—ç¬¦ï¼ˆ3*8 == 4*6ï¼‰ å½“æ•°æ®é•¿åº¦åœ¨æ— æ³•æ»¡è¶³3çš„å€æ•°çš„æ—¶å€™ä¼šåœ¨æœ«å°¾æ·»åŠ â€œ=â€œå…·ä½“çš„è½¬æ¢æ–¹æ³•ç›´æŽ¥è¯´å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œ å­—ç¬¦ä¸²Base64ç¼–ç è¿‡ç¨‹ å­—ç¬¦ä¸²String str = &quot;0Aa&quot;;é¦–å…ˆï¼ŒåŽŸå…ˆæ¯ä¸ªå­—ç¬¦æ˜¯2ä¸ªå­—èŠ‚16bit,å¯¹äºŽè‹±æ–‡æ¥è¯´å‰8ä¸ªbitæ˜¯0ï¼Œä¹Ÿå°±æ˜¯åªæœ‰8ä¸ªbit,çŽ°åœ¨æ˜¯3ä¸ªå­—ç¬¦ï¼Œ3*8=24ä¸ªbitéœ€è¦æ˜¾ç¤ºã€‚ è½¬æ¢ get 0 A a ASCII 48 65 97 äºŒè¿›åˆ¶è¡¨ç¤º 00110000 01000001 01100001 çŽ°åœ¨æ‹¼å‡‘æˆæ˜¯è¿™æ ·çš„äºŒè¿›åˆ¶ä¸²( 001100 000100 000101 100001)ï¼Œå°†å…¶è½¬åŒ–ä¸ºBase64å¯ä»¥æ˜¾ç¤ºçš„æ¨¡å¼ï¼Œéœ€è¦æ¯æ¬¡å–6ä½ä½œä¸ºä¸€ä¸ªBase64å­—ç¬¦,å‰ä¸¤ä½è¡¥0 get 1 2 3 4 å¼€å§‹ 001100 000100 000101 100001 è½¬åŒ– 00001100 00000100 00000101 00100001 è½¬ä¸º10è¿›åˆ¶ 12 4 5 33 Base64å­—ç¬¦ M E F h äºŒè¿›åˆ¶æ•°ç»„ç¼–ç è¿‡ç¨‹ è¿™ä¸ªä¾‹å­å·²ç»å¾ˆæ¸…æ™°çš„è§£é‡Šäº†Base64çš„ç¼–ç è¿‡ç¨‹ï¼Œç½‘ä¸Šæœ‰äººè‡ªå·±å®žçŽ°äº†Base64ç¼–ç çš„ç±»ï¼Œandroidæºç ä¹Ÿä¸éš¾ï¼Œè¿™æ˜¯ç¼–ç å­—ç¬¦ä¸²çœ‹èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ›´æœ¬è´¨ä¸€ç‚¹ byte[] bs = new byte[]{1,10,20};è¿™æ˜¯ä¸€ä¸ªbyteæ•°ç»„ï¼Œå¤ä¹ ä¸€ä¸‹ï¼Œ1ä¸ªbyteæ˜¯8ä¸ªbit,å¯ä»¥è¡¨ç¤ºçš„èŒƒå›´0-127ä¹‹é—´ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨Base64çš„å‡½æ•°æ—¶ï¼Œæœ¬è´¨ä¹Ÿæ˜¯åœ¨æ“ä½œå­—èŠ‚æ•°ç»„ï¼ŒåŒæ ·çš„åŽŸç† byte 1 10 20 äºŒè¿›åˆ¶è¡¨ç¤º 00000001 00001010 00010100 6ä½ä¸€ç»„ï¼ŒäºŒè¿›åˆ¶ä¸²000000 010000 101000 010100 get 1 2 3 4 å¼€å§‹ 000000 010000 101000 010100 è½¬åŒ– 00000000 00010000 00101000 00010100 è½¬ä¸º10è¿›åˆ¶ 0 16 40 20 Base64å­—ç¬¦ A Q o U Hexç¼–ç ç®€ä»‹ Hexå°±æ˜¯16è¿›åˆ¶ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†å­—èŠ‚æ•°ç»„è½¬åŒ–ä¸º16è¿›åˆ¶ï¼Œç„¶åŽç”¨å­—ç¬¦ä¸²çš„å½¢å¼è¡¨çŽ°å‡ºæ¥ï¼Œæˆ‘ä»¬çŸ¥é“16è¿›åˆ¶çš„å–å€¼èŒƒå›´å°±æ˜¯åœ¨0-fä¹‹é—´ï¼Œè¿™æ ·å°±å¯ä»¥å°†æ— æ³•æ˜¾ç¤ºçš„å­—èŠ‚æ•°ç»„æ•°æ®æ˜¾ç¤ºå‡ºæ¥ã€‚ åŽŸç†æ–¹é¢æ¯”èµ·Base64å°±ç®€å•å¾ˆå¤šäº†ï¼Œä¸€ä¸ª8bitçš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ï¼ˆxxxx xxxxï¼‰,æ¯4ä¸ªbitå¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ª16è¿›åˆ¶è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯8ä¸ªbitä¼šè½¬åŒ–ä¸ºï¼ˆ00-ffï¼‰ä¹‹é—´çš„16è¿›åˆ¶æ•°å­—ã€‚ Hexç¼–ç å®žçŽ°12345678910111213141516171819202122232425262728293031323334/** * å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² * ä¸€ä¸ªå­—èŠ‚å½¢æˆä¸¤ä¸ªå­—ç¬¦ï¼Œæ˜¯åŽŸæ¥æ•°æ®é•¿åº¦çš„ä¸¤å€ * * @param data * @return */ public static String toHex(byte[] data) &#123; String ret = null; //todo å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² if (data != null &amp;&amp; data.length &gt; 0) &#123; StringBuilder sb = new StringBuilder(); for (byte b : data) &#123; //åˆ†åˆ«èŽ·å–é«˜å››ä½å’Œä½Žå››ä½è½¬æ¢ä¸ºå­—ç¬¦ int h = (b &gt;&gt; 4) &amp; 0x0f; int l = b &amp; 0x0f; char ch, cl; if (h &gt; 9) &#123;//0x0a~0x0f ch = (char) ('A' + (h - 10)); &#125; else &#123;//0~9 ch = (char) ('0' + h); &#125; if (l &gt; 9) &#123;//0x0a~0x0f cl = (char) ('A' + (l - 10)); &#125; else &#123;//0~9 cl = (char) ('0' + l); &#125; sb.append(ch).append(cl); &#125; ret = sb.toString(); &#125; return ret; &#125; Hexç¼–ç åŽŸç†åˆ†æž ç®€å•è¯´ä¸€ä¸‹ï¼Œ&amp;è¿ç®—ï¼Œä¸¤è€…éƒ½ä¸º1ç»“æžœæ‰æ˜¯1ï¼Œb&gt;&gt;4&amp;0xfå–å‡ºé«˜å››ä½ï¼Œb&amp;0x0få–å‡ºä½Žå››ä½ï¼Œä¸¾ä¸ªä¾‹å­ï¼š å­—èŠ‚æ˜¯ b = 1010 1111 b&gt;&gt;4 b = 00001010 b&gt;&gt;4&amp;0x0f ä¹Ÿå°±æ˜¯ 00001010&amp;00001111 â€”-&gt; 1010é«˜å››ä½å–å‡ºæ¥äº†ï¼Œå–å¾—ä½Žå››ä½åŽŸç†ä¸€æ ·ã€‚åŽé¢çš„æ“ä½œå°±æ˜¯æ ¹æ®æ•°æ®çš„å¤§å°è½¬æ¢ä¸€ä¸‹æ ¼å¼ï¼Œå› ä¸ºæ‹¿åˆ°çš„æ•°æ®æ˜¯åè¿›åˆ¶çš„é‚£ä¹ˆèŒƒå›´ä¼šåœ¨0-15ä¹‹é—´ï¼Œéœ€è¦è½¬æ¢ä¸º16è¿›åˆ¶çš„0-f. Hexè§£ç å®žçŽ°12345678910111213141516171819202122232425262728293031323334353637383940414243/** * å°†ç¼–ç å­—ç¬¦ä¸²è§£ç ä¸ºå­—èŠ‚æ•°ç»„ * * @param data * @return */ public static byte[] fromHex(String data) &#123; byte[] ret = null; //todo å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ if (data != null) &#123; int len = data.length(); char[] chs = data.toCharArray(); ret = new byte[len/2]; int ih = 0,il=0,v=0,j=0; if (len &gt; 0 &amp;&amp; len % 2 == 0) &#123; for (int i = 0; i &lt; len - 1; i += 2,j++) &#123; char ch = chs[i]; char cl = chs[i+1]; if(ch&gt;=&apos;A&apos;&amp;&amp;ch&lt;=&apos;F&apos;)&#123; ih = 10 + (ch - &apos;A&apos;); &#125;else if(ch &gt;=&apos;a&apos;&amp;&amp;ch&lt;=&apos;f&apos;)&#123; ih = 10 + (ch - &apos;a&apos;); &#125;else if(ch&gt;&apos;0&apos;&amp;&amp;ch&lt;=&apos;9&apos;)&#123; ih = ch - &apos;0&apos;; &#125; if(cl&gt;=&apos;A&apos;)&#123; il = 10 + (cl - &apos;A&apos;); &#125;else if(cl &gt;=&apos;a&apos;)&#123; il = 10 + (cl - &apos;a&apos;); &#125;else if(cl&gt;&apos;0&apos;)&#123; il = cl - &apos;0&apos;; &#125; v = ((ih&amp;0x0f)&lt;&lt;4)|(il&amp;0x0f); ret[j] = (byte)v; &#125; &#125; &#125; return ret; &#125; Hexè§£ç åŽŸç†åˆ†æž ç›¸å½“äºŽç¼–ç çš„é€†è¿ç®—ï¼Œæ ¹æ®å­—ç¬¦ä¸²æ¯æ¬¡å–ä¸¤ä½ï¼Œè½¬æ¢æˆintï¼Œåœ¨è¿›è¡Œç§»ä½å°†å…¶æ‹¼æˆä¸€ä¸ªå­—èŠ‚ï¼Œæ€Žä¹ˆæ‹¼çš„ï¼Ÿv = ((ih&amp;0x0f)&lt;&lt;4)|(il&amp;0x0f); è¿™ä¸€å¥ï¼Œå‡è®¾æˆ‘ä»¬èŽ·å¾—çš„å­—ç¬¦ä¸²æœ€åŽè½¬åŒ–ç»“æžœæ˜¯10å’Œ5ï¼Œä¹Ÿå°±æ˜¯1010ï¼Œ0101ã€‚10&lt;&lt;4,ç»“æžœæ˜¯10100000ï¼Œç„¶åŽ10100000 | 0101ï¼Œ|è¿ç®—åªè¦æœ‰1åˆ™ä¸º1ï¼Œç»“æžœæ˜¯10100101å°±å®Œæˆäº†æ‹¼æŽ¥å·¥ä½œã€‚ æ€»ç»“ Base64å’ŒHexæ˜¯æ¯”è¾ƒå¸¸è§çš„ç¼–ç æ–¹å¼ï¼Œå¯¹æ¯”ä¸€ä¸‹ï¼ŒBase64æ¯3ä¸ªå­—èŠ‚è½¬åŒ–ä¸º4ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚æµªè´¹2bit,Hexç¼–ç ï¼Œæ¯ä¸ªå­—èŠ‚è½¬åŒ–ä¸ºä¸¤ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚æµªè´¹4bit,æ‰€ä»¥è¯´Base64æ›´åŠ èŠ‚çœç©ºé—´ï¼Œè€Œä¸”ç”¨èµ·æ¥ç®€å•å¾—å¤šã€‚]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AndridStudio ä½¿ç”¨ Freeline åŠ é€Ÿç¼–è¯‘]]></title>
    <url>%2Farticle%2F3239800061%2F</url>
    <content type="text"><![CDATA[buildscript { repositories { jcenter() maven { url â€œhttps://jitpack.ioâ€œ } maven { url â€œhttps://dl.bintray.com/chendongmarch/mavenâ€œ } } dependencies { classpath â€˜com.android.tools.build:gradle:2.2.2â€™ classpath â€˜com.antfortune.freeline:gradle:0.8.1â€™ // NOTE: Do not place your application dependencies here; they belong // in the individual module build.gradle files }} apply plugin: â€˜com.antfortune.freelineâ€™//é˜¿é‡Œå¢žé‡ç¼–è¯‘ freeline { hack true productFlavor â€˜babyphotoâ€™ applicationProxy false }]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>DevEnvironment</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MetrailDesign]]></title>
    <url>%2Farticle%2F3353371585%2F</url>
    <content type="text"><![CDATA[Theme123456789101112131415161718&lt;style name="AppTheme" parent="Theme.AppCompat.Light.NoActionBar"&gt;&lt;!--å¯¼èˆªæ åº•è‰²--&gt;&lt;item name="colorPrimary"&gt;@color/accent_material_dark&lt;/item&gt;&lt;!--çŠ¶æ€æ åº•è‰²--&gt;&lt;item name="colorPrimaryDark"&gt;@color/accent_material_light&lt;/item&gt;&lt;!--å¯¼èˆªæ ä¸Šçš„æ ‡é¢˜é¢œè‰²--&gt;&lt;item name="android:textColorPrimary"&gt;@android:color/black&lt;/item&gt;&lt;!--Activityçª—å£çš„é¢œè‰²--&gt;&lt;item name="android:windowBackground"&gt;@color/white&lt;/item&gt;&lt;!--æŒ‰é’®é€‰ä¸­æˆ–è€…ç‚¹å‡»èŽ·å¾—ç„¦ç‚¹åŽçš„é¢œè‰²--&gt;&lt;item name="colorAccent"&gt;@color/accent_material_light&lt;/item&gt;&lt;!--å’Œ colorAccentç›¸åï¼Œæ­£å¸¸çŠ¶æ€ä¸‹æŒ‰é’®çš„é¢œè‰²,æ‰€æœ‰æŽ§ä»·åœ¨æ²¡æœ‰èŽ·å¾—ç„¦ç‚¹æ—¶çš„é¢œè‰²--&gt;&lt;item name="colorControlNormal"&gt;#ff0000&lt;/item&gt;&lt;!--ButtonæŒ‰é’®æ­£å¸¸çŠ¶æ€é¢œè‰²--&gt;&lt;item name="colorButtonNormal"&gt;@color/accent_material_light&lt;/item&gt;&lt;!--EditText è¾“å…¥æ¡†ä¸­å­—ä½“çš„é¢œè‰²--&gt;&lt;item name="editTextColor"&gt;@android:color/white&lt;/item&gt;&lt;/style&gt; ##TextInputLayout XMLæ–‡ä»¶123456789101112&lt;android.support.design.widget.TextInputLayout android:id="@+id/md_textinputlayout" android:layout_width="match_parent" android:layout_height="wrap_content" &gt; &lt;EditText android:id="@+id/md_edittext" android:layout_width="match_parent" android:layout_height="wrap_content" android:hint="è¯·è¾“å…¥æ–‡æœ¬" /&gt; &lt;/android.support.design.widget.TextInputLayout&gt; ä»£ç æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯,æ–‡æœ¬é¢œè‰²çš„éœ€è¦ä½¿ç”¨Themeä¿®æ”¹1234567891011TextInputLayout tily1=(TextInputLayout) findViewById(R.id.tily1);tily1.setHint("æ–°çš„Hint");tily1.getEditText().addTextChangedListener(new TextWatcher()); //åœ¨ç›‘å¬ä¹‹ä¸­è¿›è¡Œå¦‚ä¸‹è®¾ç½®å¯ä»¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯int num = 0;if (((num = s.toString().length()) &lt; 6) &amp;&amp; num != 0) &#123; textInputLayout.setErrorEnabled(true); textInputLayout.setError("é•¿åº¦ä¸èƒ½å°äºŽ6");&#125; else &#123; textInputLayout.setErrorEnabled(false);&#125; SnackBarä»£ç 1234567891011121314Snackbar snackbar = Snackbar.make(view, "SnackBaræµ‹è¯•", Snackbar.LENGTH_SHORT) //ç‚¹å‡»äº‹ä»¶ä¸­æŒ‰é’®çš„é¢œè‰² .setActionTextColor(Color.WHITE) //è®¾ç½®ç‚¹å‡»äº‹ä»¶ .setAction("SnackBar", new View.OnClickListener() &#123; @Override public void onClick(View v) &#123; Log.i("chendong", "ç‚¹å‡»äº†action"); &#125; &#125;);//ä¿®æ”¹èƒŒæ™¯é¢œè‰²snackbar.getView().setBackgroundColor(Color.GRAY);snackbar.show();&#125; FloatingActionButton123456789101112&lt;android.support.design.widget.FloatingActionButton android:layout_width="wrap_content" android:layout_height="wrap_content" android:src="@mipmap/ic_launcher" android:layout_alignParentRight="true" android:layout_alignParentBottom="true" android:layout_margin="10dp" android:onClick="ClickFloatButton" app:fabSize="normal" app:backgroundTint="#f00" app:elevation="5dp" /&gt; å±žæ€§ //ä¸Šé¢çš„æ–‡ä»¶ä½¿ç”¨ç›¸å¯¹å¸ƒå±€ï¼Œå¯ä»¥ä½¿ç”¨ç›¸å¯¹é”šç‚¹çš„è®¾ç½®å®šä½fab app:layout_anchor=â€@id/md_recyclerviewâ€//é”šç‚¹ï¼ŒåŸºäºŽå“ªä¸ªæŽ§ä»¶å®šä½ app:layout_anchorGravity=â€bottom|right|endâ€//ç›¸å¯¹é”šç‚¹çš„ä½ç½® app:fabSize=â€normalâ€//æŽ§ä»¶å¤§å°ï¼Œåªæ”¯æŒä¸¤ç§å¤§å°ï¼Œmini,normal app:backgroundTint=â€#f00â€//æ”¹å˜èƒŒæ™¯é¢œè‰²ï¼Œä¸è®¾ç½®å¥½åƒæ˜¯é»‘çš„è¿˜æ˜¯è·Ÿéšä¸»é¢˜ app:elevation=â€5dpâ€//é˜´å½±12345678910111213141516171819202122232425## AppBarLayout - AppBarLayoutæœ¬èº«æ˜¯ä¸€ä¸ªåž‚ç›´çš„LinearLayoutï¼Œè¢«ä»–åŒ…è£¹çš„æŽ§ä»¶å°†ä½œä¸ºActionBarå±•ç¤º```xml&lt;android.support.design.widget.AppBarLayout android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot;&gt;&lt;android.support.v7.widget.Toolbar android:id=&quot;@+id/md_toolbar&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;?attr/actionBarSize&quot; android:minHeight=&quot;?attr/actionBarSize&quot; android:background=&quot;?attr/colorPrimary&quot; android:layout_marginBottom=&quot;20dp&quot;&gt;&lt;/android.support.v7.widget.Toolbar&gt;&lt;TextView android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;wrap_content&quot; android:padding=&quot;10dp&quot; android:text=&quot;è¿™æ˜¯appbarlayoutæµ‹è¯•&quot; android:gravity=&quot;center_horizontal&quot; android:textSize=&quot;20sp&quot;/&gt;&lt;/android.support.design.widget.AppBarLayout&gt; CoordinatorLayout è¿™ä¸ªï¼ˆCoordinatorï¼‰å•è¯çš„æ„æ€æ˜¯åè°ƒå™¨ï¼Œå®ƒæ˜¯åè°ƒæŽ§ä»¶ä¹‹é—´åŠ¨ç”»æ•ˆæžœçš„ä¸€ä¸ªå¸ƒå±€ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;android.support.design.widget.CoordinatorLayoutxmlns:android="http://schemas.android.com/apk/res/android"xmlns:tools="http://schemas.android.com/tools"xmlns:app="http://schemas.android.com/apk/res-auto"android:layout_width="match_parent"android:layout_height="match_parent"tools:context="com.awesome.newfeatures.SecondActivity"&gt;&lt;android.support.design.widget.AppBarLayoutandroid:layout_width="match_parent"android:layout_height="wrap_content"&gt;&lt;android.support.v7.widget.Toolbarandroid:id="@+id/md_toolbar"android:layout_width="match_parent"android:layout_height="?attr/actionBarSize"android:minHeight="50dp"android:background="?attr/colorPrimary"android:layout_marginBottom="20dp" app:layout_scrollFlags="scroll|enterAlways"/&gt;&lt;android.support.design.widget.TabLayoutandroid:id="@+id/md_tablayout"android:layout_width="match_parent"android:layout_height="wrap_content"app:tabGravity="fill"app:tabTextColor="#f00"app:tabIndicatorColor="#00f"app:tabMode="fixed"app:tabIndicatorHeight="2dp"/&gt;&lt;/android.support.design.widget.AppBarLayout&gt;&lt;android.support.v7.widget.RecyclerViewandroid:id="@+id/md_recyclerview"android:layout_width="match_parent"android:layout_height="match_parent" app:layout_behavior="@string/appbar_scrolling_view_behavior"/&gt;&lt;android.support.design.widget.FloatingActionButtonandroid:layout_width="wrap_content"android:layout_height="wrap_content"android:src="@mipmap/ic_launcher"app:backgroundTint="#00f"app:elevation="5dp"android:layout_margin="16dp"app:layout_anchor="@id/md_recyclerview"app:layout_anchorGravity="bottom|right|end"android:onClick="Click"/&gt;&lt;/android.support.design.widget.CoordinatorLayout&gt; app:layout_behavior=â€@string/appbar_scrolling_view_behaviorâ€//åœ¨è§†å›¾ä¸­å¯æ»‘åŠ¨çš„ç»„ä»¶ä½¿ç”¨è¯¥å±žæ€§æ ‡ç¤ºï¼Œå¿…é¡»æ˜¯RecyclerViewæˆ–NestedScrollView è¯•éªŒè¡¨æ˜Žï¼Œå¼€å§‹ä½¿ç”¨åŽé¢ä¸¤ä¸ªå±žæ€§å¹¶æ²¡èµ·ä½œç”¨ï¼ŒåŽæ¥å‘çŽ°éœ€è¦å›ºå®štoolbaré«˜åº¦æ‰ä¼šèµ·ä½œç”¨ã€‚ FloatingActionButtonè¢«åŒ…è£¹åœ¨CoordinatorLayoutä¸­æ—¶å¯ä»¥é˜²æ­¢SnackBarè·³å‡ºæ—¶é®æŒ¡Fab app:layout_scrollFlags=â€scroll|enterAlwaysâ€//ä¸‰ç§å–å€¼ å±žæ€§é€‰æ‹© æè¿° scroll æ‰€æœ‰éœ€è¦æ»‘åŠ¨çš„è§†å›¾éœ€è¦å®šä¹‰è¯¥å±žæ€§ï¼Œä¸ä½¿ç”¨è¯¥å±žæ€§çš„è§†å›¾å°†ä¼šå›ºå®šåœ¨å±å¹•é¡¶ç«¯this flag should be set for all views that want to scroll off the screen - for views that do not use this flag, theyâ€™ll remain pinned to the top of the screen enterAlways ä»»æ„å‘ä¸‹çš„æ“ä½œä¼šå¯¼è‡´éšè—è§†å›¾æ˜¾ç¤ºå‡ºæ¥this flag ensures that any downward scroll will cause this view to become visible, enabling the â€˜quick returnâ€™ pattern enterAlwaysCollapsed è¿™ä¸ªflagå®šä¹‰çš„æ˜¯ä½•æ—¶è¿›å…¥ï¼ˆå·²ç»æ¶ˆå¤±ä¹‹åŽä½•æ—¶å†æ¬¡æ˜¾ç¤ºï¼‰ã€‚å‡è®¾ä½ å®šä¹‰äº†ä¸€ä¸ªæœ€å°é«˜åº¦ï¼ˆminHeightï¼‰åŒæ—¶enterAlwaysä¹Ÿå®šä¹‰äº†ï¼Œé‚£ä¹ˆviewå°†åœ¨åˆ°è¾¾è¿™ä¸ªæœ€å°é«˜åº¦çš„æ—¶å€™å¼€å§‹æ˜¾ç¤ºï¼Œå¹¶ä¸”ä»Žè¿™ä¸ªæ—¶å€™å¼€å§‹æ…¢æ…¢å±•å¼€ï¼Œå½“æ»šåŠ¨åˆ°é¡¶éƒ¨çš„æ—¶å€™å±•å¼€å®Œã€‚When your view has declared a minHeight and you use this flag, your View will only enter at its minimum height (i.e., â€˜collapsedâ€™), only re-expanding to its full height when the scrolling view has reached itâ€™s top. exitUntilCollapsed è¿™ä¸ªflagæ—¶å®šä¹‰ä½•æ—¶é€€å‡ºï¼Œå½“ä½ å®šä¹‰äº†ä¸€ä¸ªminHeightï¼Œè¿™ä¸ªviewå°†åœ¨æ»šåŠ¨åˆ°è¾¾è¿™ä¸ªæœ€å°é«˜åº¦çš„æ—¶å€™æ¶ˆå¤±ã€‚ this flag causes the view to scroll off until it is â€˜collapsedâ€™ (its minHeight) before exiting CollapsingToolbarLayout ä½¿ç”¨CollapsingToolbarLayoutç»“åˆCoordinatorLayoutå®žçŽ°å¯ç¼©æ”¾çš„ActionBar,åœ¨ä½¿ç”¨CoordinatorLayoutä¸€ç›´å®žçŽ°ä¸äº†åˆ—è¡¨æ»‘åŠ¨åˆ°é¡¶ç«¯æ‰æ˜¾ç¤ºçš„æ•ˆæžœï¼Œä½¿ç”¨CollapsingToolbarLayoutå¯ä»¥å®žçŽ° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;android.support.design.widget.CoordinatorLayoutxmlns:android="http://schemas.android.com/apk/res/android"xmlns:tools="http://schemas.android.com/tools"xmlns:app="http://schemas.android.com/apk/res-auto"android:layout_width="match_parent"android:layout_height="match_parent"tools:context="com.awesome.newfeatures.SecondActivity"&gt; //éœ€è¦å›ºå®šé«˜åº¦&lt;android.support.design.widget.AppBarLayoutandroid:id="@+id/appbar"android:layout_width="match_parent"android:layout_height="160dp"&gt;&lt;android.support.design.widget.CollapsingToolbarLayoutandroid:layout_width="match_parent"android:layout_height="match_parent"app:contentScrim="?attr/colorPrimary"app:layout_scrollFlags="scroll|exitUntilCollapsed"&gt;&lt;ImageViewandroid:id="@+id/backdrop"android:layout_width="match_parent"android:layout_height="match_parent"android:scaleType="centerCrop"android:src="@mipmap/ic_launcher"app:layout_collapseMode="parallax"/&gt;&lt;android.support.v7.widget.Toolbarandroid:id="@+id/md_toolbar"android:layout_width="match_parent"android:layout_height="?attr/actionBarSize"app:layout_collapseMode="pin"/&gt;&lt;/android.support.design.widget.CollapsingToolbarLayout&gt;&lt;/android.support.design.widget.AppBarLayout&gt; &lt;android.support.v7.widget.RecyclerViewandroid:id="@+id/md_recyclerview"android:layout_width="match_parent"android:layout_height="wrap_content"app:layout_behavior="@string/appbar_scrolling_view_behavior"/&gt; &lt;android.support.design.widget.FloatingActionButtonandroid:layout_width="wrap_content"android:layout_height="wrap_content"android:src="@mipmap/ic_launcher"app:backgroundTint="#00f"app:elevation="5dp"android:layout_margin="16dp"app:layout_anchor="@id/md_recyclerview"app:layout_anchorGravity="bottom|right|end"android:onClick="Click"/&gt;&lt;/android.support.design.widget.CoordinatorLayout&gt; AppBarLayouté«˜åº¦éœ€è¦å›ºå®š CollapsingToolbarLayoutè®¾ç½®app:layout_scrollFlags 1234567- 23.1.0ä»¥åŽæ–°å¢žä¸€ä¸ªsnapå¯ä»¥åœ¨æ‹‰åŠ¨åˆ°åº•éƒ¨æ—¶äº§ç”Ÿç¼©æ”¾æ•ˆæžœ- app:layout_scrollFlags=&quot;scroll|enterAlways&quot;- app:layout_scrollFlags=&quot;scroll|enterAlwaysCollapsed&quot;- ä¸è®ºToolBaræ˜¯å¦è®¾ç½®pinæ¨¡å¼ï¼Œå°†ä¼šå…¨éƒ¨æ»šå‡ºå±å¹•ï¼Œä»»æ„ä¸‹æ‹‰åŠ¨ç”»ä¼šä½¿éšè—çš„è§†å›¾æ˜¾ç¤ºå‡ºæ¥- app:layout_scrollFlags=&quot;scroll|exitUntilCollapsed&quot;- //è®¾ç½®ä¸ºpinæ¨¡å¼çš„å›ºå®šåœ¨é¡¶ç«¯ï¼Œä¸‹æ‹‰åˆ°é¡¶éƒ¨æ‰æ˜¾ç¤ºå‡ºéšè—è§†å›¾- app:layout_collapseMode=&quot;parallax&quot;//éœ€è¦å›ºå®šçš„è§†å›¾ä½¿ç”¨pinæ¨¡å¼ï¼Œéœ€è¦æ»‘åŠ¨çš„è§†å›¾ä½¿ç”¨parallaxæ¨¡å¼ ä¸€äº›å±žæ€§setTitle(CharSequence)//è®¾ç½®å›ºå®šåœ¨é¡¶ç«¯æ—¶æ˜¾ç¤ºçš„titlesetContentScrim(Drawable)app:contentScrim=â€?attr/colorPrimaryâ€//ä¿®æ”¹å›ºå®šåœ¨é¡¶ç«¯çš„èƒŒæ™¯é¢œè‰²setStatusBarScrim(Drawable)//çŠ¶æ€æ èƒŒæ™¯ï¼Œ5.0ä»¥ä¸Šæœ‰æ•ˆapp:layout_collapseParallaxMultiplier=â€0.6â€//æ»‘åŠ¨çš„è§†è§‰å·®ï¼Œäº§ç”Ÿçš„æ•ˆæžœæ˜¯æå‰å°†æŠ˜å çš„è§†å›¾éšè—æŽ‰äº†app:layout_collapseMode=â€parallax|pinâ€//æ»‘åŠ¨æ¨¡å¼ï¼Œç¼©æ”¾æˆ–è€…å›ºå®šcollapsingToolbarLayout.setTitle(&quot;title&quot;);//è®¾ç½®æ ‡é¢˜ï¼Œå°†ä¼šè‡ªåŠ¨è¿›è¡Œç¼©æ”¾//è®¾ç½®é¢œè‰²åŽå°†ä¼šè‡ªåŠ¨è¿›è¡Œé¢œè‰²è¿‡æ¸¡collapsingToolbarLayout.setExpandedTitleColor(Color.WHITE);collapsingToolbarLayout.setCollapsedTitleTextColor(Color.GREEN); DrawerLayout+NavigationView ç»“åˆä¹‹å‰å­¦çš„æ€»ç»“åœ¨ä¸€ä¸ªå¸ƒå±€ä¸­ï¼Œé¦–å…ˆDrawerLayoutéœ€è¦æœ‰ä¸¤ä¸ªå­viewï¼Œä¸Šé¢çš„ä¸€ä¸ªä»£è¡¨content,ä¸‹é¢çš„NavigationViewä»£è¡¨èœå•å¯¼èˆªï¼Œå½“ç„¶ä½ å¯ä»¥æ›¿æ¢æˆè‡ªå·±çš„å¸ƒå±€ï¼Œç”¨æ¥åšå…¶ä»–çš„äº‹æƒ…ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970 &lt;android.support.v4.widget.DrawerLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:tools="http://schemas.android.com/tools" android:id="@+id/md_DrawerLayout" android:layout_width="match_parent" android:layout_height="match_parent" android:fitsSystemWindows="true" tools:context=".MainActivity" &gt; &lt;android.support.design.widget.CoordinatorLayout android:layout_width="match_parent" android:layout_height="wrap_content" &gt; &lt;android.support.design.widget.AppBarLayout android:id="@+id/appbar" android:layout_width="match_parent" android:layout_height="160dp" &gt; &lt;android.support.design.widget.CollapsingToolbarLayout android:id="@+id/md_CollapsingToolbarLayout" android:layout_width="match_parent" android:layout_height="match_parent" app:contentScrim="?attr/colorPrimary" app:layout_scrollFlags="scroll|exitUntilCollapsed" &gt; &lt;ImageView android:id="@+id/backdrop" android:layout_width="match_parent" android:layout_height="match_parent" android:scaleType="centerCrop" android:src="@mipmap/ic_launcher" app:layout_collapseMode="parallax" app:layout_collapseParallaxMultiplier="0.3" /&gt; &lt;android.support.v7.widget.Toolbar android:id="@+id/md_toolbar" android:layout_width="match_parent" android:layout_height="?attr/actionBarSize" app:layout_collapseMode="pin" /&gt; &lt;/android.support.design.widget.CollapsingToolbarLayout&gt; &lt;/android.support.design.widget.AppBarLayout&gt; &lt;android.support.v7.widget.RecyclerView android:id="@+id/md_recyclerview" android:layout_width="match_parent" android:layout_height="wrap_content"app:layout_behavior="@string/appbar_scrolling_view_behavior" /&gt; &lt;android.support.design.widget.FloatingActionButton android:layout_width="wrap_content" android:layout_height="wrap_content" android:src="@mipmap/ic_launcher" app:backgroundTint="#00f" app:elevation="5dp" android:layout_margin="16dp" app:layout_anchor="@id/md_recyclerview" app:layout_anchorGravity="bottom|right|end" android:onClick="Click" /&gt; &lt;/android.support.design.widget.CoordinatorLayout&gt; &lt;android.support.design.widget.NavigationView android:id="@+id/md_NavigationView" android:layout_width="wrap_content" android:layout_height="match_parent" android:layout_gravity="start" app:headerLayout="@layout/header" app:menu="@menu/drawer" /&gt; &lt;/android.support.v4.widget.DrawerLayout&gt; å‡ ä¸ªå±žæ€§1234567891011121314å…³äºŽNavigationViewä¸­itemçš„å­—ä½“é¢œè‰²å’Œiconé€‰ä¸­çŠ¶æ€é¢œè‰²æ˜¯åŽ»å½“å‰ä¸»é¢˜themeä¸­çš„&lt;--æ­£å¸¸çŠ¶æ€ä¸‹å­—ä½“é¢œè‰²å’Œiconé¢œè‰²--&gt;&lt;item name=&quot;android:textColorPrimary&quot;&gt;@android:color/darker_gray&lt;/item&gt;&lt;--é€‰ä¸­çŠ¶æ€iconçš„é¢œè‰²å’Œå­—ä½“é¢œè‰²--&gt;&lt;item name=&quot;colorPrimary&quot;&gt;@color/accent_material_light&lt;/item&gt;å½“ç„¶ä½ å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•æˆ–è€…å±žæ€§æ¥æ”¹å˜è¿™ä¸€çŠ¶æ€ï¼šsetItemBackgroundResource(int)app:itemBackground`//ç»™menuè®¾ç½®èƒŒæ™¯èµ„æºsetItemIconTintList(ColorStateList)app:itemIconTint`//ç»™menuçš„iconè®¾ç½®é¢œè‰²ï¼Œå¯¹åº”çš„å±žæ€§setItemTextColor(ColorStateList)app:itemTextColor`//ç»™menuçš„itemè®¾ç½®å­—ä½“é¢œè‰²ï¼Œå¯¹åº”çš„å±žæ€§app:headerLayout=&quot;@layout/header&quot;//NavigationViewçš„å¤´éƒ¨å¸ƒå±€app:menu=&quot;@menu/drawer&quot;`//NavigationViewçš„èœå•æ–‡ä»¶ ä»£ç 12345678910111213141516171819mDrawerLayout = (DrawerLayout) findViewById(R.id.md_DrawerLayout);//è¿™ä¸ªç»„ä»¶å°†ä¼šå±•ç¤ºä¸€ä¸ªå›¾æ ‡åœ¨å·¦ä¸Šè§’ï¼Œå®ƒæ˜¯ä¸€ä¸ªDrawerListenerçš„å­ç±»ï¼Œä½¿ç”¨å®ƒå¯ä»¥ç®€å•åœ°åˆ›å»ºä¸€ä¸ªæŠ½å±‰çš„æŽ§åˆ¶å›¾æ ‡ï¼Œv4åŒ…ä¸‹çš„è¯¥ç»„ä»¶å¯ä»¥è®¾ç½®å¯¼èˆªå›¾æ ‡ï¼Œä½†æ˜¯å·²ç»è¿‡æ—¶ï¼Œè¿™é‡Œä½¿ç”¨v7åŒ…ä¸‹çš„ç»„ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰äº†è®¾ç½®å›¾æ ‡çš„å‚æ•°ï¼Œå¦‚æžœæƒ³è‡ªå®šä¹‰å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„å›¾æ ‡ï¼Œåœ¨å®žçŽ°DrawerListeneræ—¶åšå¤„ç†ActionBarDrawerToggle mDrawerToggle = new ActionBarDrawerToggle(this, mDrawerLayout, toolbar, R.string.close, R.string.open);//æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„æ–¹æ³•ä¿®æ”¹å›¾æ ‡ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰æ•ˆæžœ mDrawerToggle.setHomeAsUpIndicator(R.mipmap.ic_launcher); //åˆå§‹åŒ–çŠ¶æ€ mDrawerToggle.syncState(); mDrawerLayout.setDrawerListener(mDrawerToggle); //è®¾ç½®å¯¼èˆªæ NavigationViewçš„ç‚¹å‡»äº‹ä»¶ final NavigationView mNavigationView = (NavigationView) findViewById(R.id.md_NavigationView); mNavigationView.setNavigationItemSelectedListener(new NavigationView.OnNavigationItemSelectedListener() &#123; @Override public boolean onNavigationItemSelected(MenuItem menuItem) &#123; //ä½¿ç”¨è¯¥æ–¹æ³•å¯ä»¥é€‰ä¸­Itemï¼Œä½†æ˜¯å‡ºçŽ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œç‚¹å‡»æ—¶æœ‰æ—¶ä¼šé€ æˆé€‰ä¸­æ— æ³•å–æ¶ˆï¼Œè¯•è¿‡ä¸€ä¸ªè§£å†³åŠžæ³•æ˜¯èŽ·å¾—Menuçš„æ‰€æœ‰Itemè®¾ç½®ä¸é€‰ä¸­å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ menuItem.setChecked(true); mDrawerLayout.closeDrawers();//å…³é—­æŠ½å±‰ return true; &#125; &#125;);]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[v4v7 æ–°æŽ§ä»¶]]></title>
    <url>%2Farticle%2F1947623271%2F</url>
    <content type="text"><![CDATA[AlertDialogv7é£Žæ ¼çš„Dialogç›¸å¯¹åŽŸæ¥çš„ç‰ˆæœ¬åŽ»æŽ‰äº†è·³è·ƒå¼¹å‡ºçš„åŠ¨ç”»ï¼Œä¸‹æ–¹æŒ‰é’®åŽ»æŽ‰äº†è¾¹æ¡†ï¼Œèšé›†åœ¨äº†å³ä¾§ï¼Œæ˜¾ç¤ºæ—¶åŽ»æŽ‰äº†åˆ†éš”çº¿ã€‚ ToolBarå–ä»£åŽŸå…ˆçš„ActionBarå®žçŽ°ç›¸å¯¹å®Œç¾Žçš„å®šåˆ¶ xmlæ–‡ä»¶12345678&lt;android.support.v7.widget.Toolbarandroid:id="@+id/md_toolbar"android:layout_width="match_parent"android:layout_height="?attr/actionBarSize"android:minHeight="50dp"android:background="?attr/colorPrimary"android:layout_marginBottom="20dp" &gt; ä»£ç 123456789101112131415161718192021 //éšè—ç³»ç»Ÿé»˜è®¤title,æˆ‘å½“æ—¶ä¿®æ”¹äº†themeç”¨çš„noactionbarçš„Themeæ‰€ä»¥è¿™è¡Œä»£ç å¹¶æ²¡ç”¨getSupportActionBar().setDisplayShowTitleEnabled(false);Toolbar toolbar = (Toolbar) findViewById(R.id.md_toolbar);//æ ‡é¢˜toolbar.setTitle("æµ‹è¯•");//å‰¯æ ‡é¢˜ï¼Œæ˜¾ç¤ºåœ¨æ ‡é¢˜ä¸‹æ–¹toolbar.setSubtitle("å‰¯æ ‡é¢˜");//logo,æ˜¾ç¤ºåœ¨æ ‡é¢˜å·¦ä¾§toolbar.setLogo(R.mipmap.ic_launcher); //å¯¼èˆªå›¾æ ‡ï¼Œæ˜¾ç¤ºåœ¨æœ€å·¦ä¾§ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å›¾æ ‡è°ƒå‡ºèœå•toolbar.setNavigationIcon(android.R.drawable.ic_input_delete);//è¿™ä¸ªå¹¶æ²¡æœ‰ç”¨ï¼Œè®¾ç½®èœå•æ—¶é‡å†™onCreateOptionMenuå³å¯//toolbar.inflateMenu(R.menu.menu_main);setSupportActionBar(toolbar);toolbar.setOnMenuItemClickListener(new OnMenuItemClickListener() &#123; @Override public boolean onMenuItemClick(MenuItem item) &#123;Toast.makeText(MainActivity.this, "ç‚¹å‡»äº†" + item.getItemId(), Toast.LENGTH_SHORT).show(); return false; &#125;&#125;); é¢˜å¤–è¯,å¦‚ä½•åˆ›å»ºèœå•é¡¹12345678910111213141516171819202122232425262728293031323334//é‡å†™è¯¥æ–¹æ³•ï¼Œèœå•å°†ä¼šæ˜¾ç¤ºåœ¨toobarä¸Š@Overridepublic boolean onCreateOptionsMenu(Menu menu) &#123; getMenuInflater().inflate(R.menu.menu_main, menu); //èŽ·å–toolbarä¸Šçš„èœå•view,ä¹Ÿå¯ä»¥åœ¨ä¸Šé¢çš„setOnMenuItemClickListenerå®žçŽ°æ›´åŠ ç®€å•ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªæ¼”ç¤ºã€‚ MenuItem item = menu.findItem(R.id.action_share); //å¼ºè½¬ä¸ºä½ éœ€è¦çš„view View actionView = item.getActionView(); return super.onCreateOptionsMenu(menu);&#125;//èœå•æ–‡ä»¶ï¼Œä¸ºæ²¡æœ‰æŽ¥è§¦è¿‡çš„å°ä¼™ä¼´å‡†å¤‡çš„é¢,ç›¸å…³å±žæ€§è¯·è‡ªè¡ŒæŸ¥æ–‡æ¡£//res/menu/menu_main.xml&lt;menu xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;xmlns:tools=&quot;http://schemas.android.com/tools&quot;tools:context=&quot;.MainActivity&quot;&gt;&lt;itemandroid:id=&quot;@+id/ab_search&quot;android:orderInCategory=&quot;80&quot;android:title=&quot;action_search&quot; app:actionViewClass=&quot;android.support.v7.widget.SearchView&quot;/&gt;&lt;itemandroid:id=&quot;@+id/action_share&quot;android:orderInCategory=&quot;90&quot;android:title=&quot;action_share&quot; app:actionProviderClass=&quot;android.support.v7.widget.ShareActionProvider&quot;app:showAsAction=&quot;ifRoom&quot;/&gt;&lt;itemandroid:id=&quot;@+id/action_settings&quot;android:orderInCategory=&quot;100&quot;android:title=&quot;action_settings&quot;app:showAsAction=&quot;never&quot;/&gt;&lt;/menu&gt; LinearLayoutCompat åœ¨æŽ§ä»¶ä¸­é—´æ·»åŠ åˆ†éš”çº¿ 1234567891011&lt;android.support.v7.widget.LinearLayoutCompatandroid:layout_width="match_parent"android:layout_height="wrap_content"android:layout_gravity="center|center_horizontal"android:orientation="vertical"app:divider="@drawable/line"app:dividerPadding="4dp"app:showDividers="middle"&gt;.....&lt;/android.support.v7.widget.LinearLayoutCompat&gt; app:divider=â€@drawable/lineâ€ ç»™åˆ†éš”çº¿è®¾ç½®é¢œè‰²ï¼Œè¿™é‡Œä½ éœ€è¦åœ¨drawableåœ¨å®šä¹‰shapeèµ„æºï¼Œå¦åˆ™å°†æ²¡æœ‰æ•ˆæžœã€‚ app:dividerPadding=â€25dpâ€ ç»™åˆ†éš”çº¿è®¾ç½®è·ç¦»å·¦å³è¾¹è·çš„è·ç¦»ã€‚ app:showDividers=â€middle|beginning|endâ€ åˆ†éš”çº¿æ˜¾ç¤ºçš„ä½ç½®ï¼Œæœ‰å››ç§å‚æ•°å€¼ï¼šmiddle æ¯ä¸ªitemä¹‹é—´ï¼Œbeginningæœ€é¡¶ç«¯æ˜¾ç¤ºåˆ†éš”çº¿ï¼Œend æœ€åº•ç«¯æ˜¾ç¤ºåˆ†éš”çº¿ï¼Œnoneä¸æ˜¾ç¤ºé—´éš”çº¿ã€‚ ListPopupWindow123456789101112131415161718192021222324public void showListPopup(View view) &#123; String items[] = &#123;"item1", "item2", "item3", "item4", "item5"&#125;; final ListPopupWindow listPopupWindow = new ListPopupWindow(this); //è®¾ç½®ListViewç±»åž‹çš„é€‚é…å™¨ listPopupWindow.setAdapter(new ArrayAdapter&lt;String&gt;(SwipeRefreshActivity.this, android.R.layout.simple_list_item_1, items)); //ç»™æ¯ä¸ªitemè®¾ç½®ç›‘å¬äº‹ä»¶ listPopupWindow.setOnItemClickListener(new AdapterView.OnItemClickListener() &#123; @Override public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) &#123; Toast.makeText(SwipeRefreshActivity.this, "the position is" + position, Toast.LENGTH_SHORT).show(); //listPopupWindow.dismiss(); &#125; &#125;); //è®¾ç½®ListPopupWindowçš„é”šç‚¹,ä¹Ÿå°±æ˜¯å¼¹å‡ºæ¡†çš„ä½ç½®æ˜¯ç›¸å¯¹å½“å‰å‚æ•°Viewçš„ä½ç½®æ¥æ˜¾ç¤ºï¼Œ listPopupWindow.setAnchorView(view); //ListPopupWindow è·é”šç‚¹çš„è·ç¦»ï¼Œä¹Ÿå°±æ˜¯ç›¸å¯¹é”šç‚¹Viewçš„ä½ç½® listPopupWindow.setHorizontalOffset(100); listPopupWindow.setVerticalOffset(100); //è®¾ç½®å¯¹è¯æ¡†çš„å®½é«˜ listPopupWindow.setWidth(300); listPopupWindow.setHeight(600); listPopupWindow.setModal(false); listPopupWindow.show(); &#125; PopupMenu12345678910111213141516public void showPopupMenu(View view) &#123;//å‚æ•°View æ˜¯è®¾ç½®å½“å‰èœå•æ˜¾ç¤ºçš„ç›¸å¯¹äºŽViewç»„ä»¶ä½ç½®ï¼Œå…·ä½“ä½ç½®ç³»ç»Ÿä¼šå¤„ç†PopupMenu popupMenu = new PopupMenu(this, view);//åŠ è½½menuå¸ƒå±€popupMenu.getMenuInflater().inflate(R.menu.menu_main, popupMenu.getMenu());//è®¾ç½®menuä¸­çš„itemç‚¹å‡»äº‹ä»¶popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() &#123;@Overridepublic boolean onMenuItemClick(MenuItem item) &#123;return false;&#125;&#125;);//è®¾ç½®popupWindowæ¶ˆå¤±çš„ç‚¹å‡»äº‹ä»¶popupMenu.setOnDismissListener(this);popupMenu.show();&#125; æ–°é£Žæ ¼Spinner12345&lt;Spinner android:id="@+id/spinner" style="@android:style/Widget.Holo.Light.Spinner" android:layout_width="wrap_content" android:layout_height="wrap_content"&gt;&lt;/Spinner&gt; v4 SwipeRefreshLayout SwipeRefreshLayoutç»§æ‰¿è‡ªViewGroup,ç†è®ºä¸Šå¯ä»¥å®Œæˆä»»ä½•Viewçš„åˆ·æ–° ä»£ç 12345678final SwipeRefreshLayout swipeRefreshLayout = (SwipeRefreshLayout) findViewById(R.id.md_SwipeRefreshLayout);//è®¾ç½®è¿›åº¦æ¡çš„é¢œè‰²swipeRefreshLayout.setColorSchemeColors(Color.RED, Color.BLUE, Color.GREEN);//è®¾ç½®åœ†å½¢è¿›åº¦æ¡å¤§å°swipeRefreshLayout.setSize(SwipeRefreshLayout.LARGE);//è®¾ç½®è¿›åº¦æ¡èƒŒæ™¯é¢œè‰² swipeRefreshLayout.setProgressBackgroundColorSchemeColor(Color.WHITE);//è®¾ç½®ä¸‹æ‹‰å¤šå°‘è·ç¦»ä¹‹åŽå¼€å§‹åˆ·æ–°æ•°æ®ï¼Œä¸è¦è®¾ç½®çš„å¤ªå¤§ï¼Œä¸ç„¶æ€Žä¹ˆæ‹‰éƒ½ä¸åˆ·æ–°swipeRefreshLayout.setDistanceToTriggerSync(5);]]></content>
      <categories>
        <category>Android</category>
        <category>View</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è½¯ä»¶è®¾è®¡åŽŸåˆ™]]></title>
    <url>%2Farticle%2F1361585574%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸»è¦ä»‹ç»è®¾è®¡æ¨¡å¼çš„è®¾è®¡å’Œä½¿ç”¨ã€‚ ç±»æ˜¯ä¸ç¨³å®šçš„ï¼Œä½†æ˜¯æŠ½è±¡ç›¸å¯¹ç¨³å®šï¼Œä¾èµ–äºŽæŠ½è±¡å°†èŽ·å¾—æ›´åŠ ç¨³å®šçš„ç±»ç»“æž„ã€‚ è®¾è®¡åŽŸåˆ™å•ä¸€æŒ‡è´£ æ¯ä¸ªç±»åªè´Ÿè´£å•ä¸€çš„åŠŸèƒ½ï¼Œé¿å…ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½å®Œæˆå¦ä¸€ä¸ªåŠŸèƒ½çš„é”™è¯¯å‡ºçŽ°ã€‚ é‡Œæ°æ›¿æ¢/æŠ½è±¡ç±»åŽŸåˆ™ å­ç±»å®žçŽ°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³• å­ç±»ä¸è¦ä¿®æ”¹çˆ¶ç±»çš„éžæŠ½è±¡æ–¹æ³• å­ç±»å®žçŽ°æŠ½è±¡æ–¹æ³•æ—¶å‰ç½®æ¡ä»¶ï¼ˆå‚æ•°ï¼‰åº”è¯¥æ›´åŠ å®½æ¾ å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•åŽç½®æ¡ä»¶ï¼ˆè¿”å›žå€¼ï¼‰åº”è¯¥æ›´åŠ ä¸¥æ ¼ ä¾èµ–å€’ç½® é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºŽåº•å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºŽæŠ½è±¡ æŠ½è±¡ä¸èƒ½ä¾èµ–äºŽç»†èŠ‚ï¼Œç»†èŠ‚è¦ä¾èµ–æŠ½è±¡ å¤šç”¨æŠ½è±¡çš„æŽ¥å£æè¿°åŠ¨ä½œã€‚æŠ½è±¡éš¾ä»¥æ‰©å±•æˆ–è€…æ‰©å±•å¤æ‚çš„çš„åŠ¨ä½œï¼Œé™ä½ŽåŠ¨ä½œæ‰§è¡Œè€…å’ŒåŠ¨ä½œæ‰¿å—è€…ä¹‹é—´çš„å…³è” è¿ªç±³ç‰¹æ³•åˆ™/æœ€å°‘çŸ¥é“åŽŸåˆ™ æ¯ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½ï¼Œè¢«ä¾èµ–çš„ç±»å¼€æ”¾å…¬å¼€çš„æ–¹æ³•å´å°è£…å†…éƒ¨å¤æ‚çš„é€»è¾‘ å¼€é—­åŽŸåˆ™ å¯¹æ‰©å±•æ˜¯å¼€æ”¾çš„å¯¹ä¿®æ”¹æ˜¯å°é—­çš„ ä½¿ç”¨å¢žåŠ è½¯ä»¶å®žä½“çš„æ–¹æ³•æ¥æ‰©å±•åŠŸèƒ½è€Œä¸è¦ä½¿ç”¨ä¿®æ”¹ä»£ç çš„æ–¹å¼ æŽ¥å£éš”ç¦»åŽŸåˆ™ ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æŽ¥å£ä¸Šï¼Œä¹Ÿå°±æ˜¯ä¸è¦å¼ºè¿«å­ç±»å®žçŽ°ä»–ä¸éœ€è¦çš„åŠŸèƒ½ï¼Œå¦‚æžœéœ€è¦è¿™ä¹ˆåšé‚£ä¹ˆè¯´æ˜Žè¿™ä¸ªæŽ¥å£æœ€å°æŽ¥å£éœ€è¦æ‹†åˆ†]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Androidå¼€å‘é—®é¢˜å¸¸è§é—®é¢˜]]></title>
    <url>%2Farticle%2F1817351074%2F</url>
    <content type="text"><![CDATA[æ–¹æ³•æ•°é‡è¶…å‡ºé™åˆ¶ ä½¿ç”¨åˆ†åŒ…ç­–ç•¥ å‡ºçŽ°exit value 3ä¹‹ç±»çš„é”™è¯¯é€šå¸¸æ˜¯æ–¹æ³•æ•°ç›®è¶…å‡ºé™åˆ¶äº†ï¼Œå»ºè®®ä½¿ç”¨åˆ†åŒ…æœºåˆ¶ï¼Œä½†è¿™ä¸æ˜¯è§£å†³é—®é¢˜çš„æ–¹æ³•,æœ€é‡è¦çš„è¿˜æ˜¯å‡†ç¡®é€‰æ‹©ç±»åº“ï¼Œç²¾ç®€æ–¹æ³•æ•°ã€‚ 1234567891011121314//å¼•å…¥åˆ†åŒ…compile 'com.android.support:multidex:1.0.1'ï¼ï¼æ·»åŠ å…è®¸å¤šæ–¹æ³•defaultConfig &#123; multiDexEnabled true &#125;ï¼ï¼åœ¨Applicationæ·»åŠ åˆ†åŒ…åˆå§‹åŒ–@Overrideprotected void attachBaseContext(Context base) &#123; super.attachBaseContext(base); MultiDex.install(this); ï½ æ–¹æ³•æ•°ç»Ÿè®¡ æŽ¨èä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥è®¡ç®—æ¯ä¸ªåŒ…ä¸‹é¢çš„æ–¹æ³•æ•°ç›® åœ¨app.gradleæ–‡ä»¶å¤´æ·»åŠ ä»¥ä¸‹æ’ä»¶ï¼Œä¼šåœ¨app/build/outputs/dexcount/debug.txtæ–‡ä»¶é‡Œç”Ÿæˆæ¯ä¸ªåŒ…ä¸‹é¢çš„æ–¹æ³•æ•°ï¼Œå¦‚ä¸‹ï¼šapply plugin: â€˜com.getkeepsafe.dexcountâ€™ 123456789101112methods fields package/class name8 0 &lt;unnamed&gt;21186 8027 android6 0 android.accessibilityservice34 0 android.animation556 33 android.app3 0 android.app.usage2 0 android.appwidget488 50 android.content42 43 android.content.pm106 6 android.content.res79 0 android.database ç­¾åé—®é¢˜12345678910111213141516171819202122//æ­£å¼ç­¾åç›¸å…³ä¿¡æ¯signingConfigs &#123; myConfig &#123; storeFile file("ç›¸å¯¹æˆ–è€…ç»å¯¹è·¯å¾„") storePassword "sangular123" keyAlias "sangular" keyPassword "sangular123" &#125;&#125;buildTypes &#123; //releaseç‰ˆæœ¬çš„æ­£å¼ç­¾å release &#123; //minifyEnabled true æ‰“åŒ…å‘å¸ƒæ—¶ä¼šä½¿ç”¨è¯¥ä»£ç  //proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro' signingConfig signingConfigs.myConfig &#125; //debugç‰ˆæœ¬ä¹Ÿç”¨æ­£å¼ç­¾åè°ƒè¯•ï¼Œè¿™æ ·å¯ä»¥åœ¨debugç‰ˆæœ¬ä¸‹ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»é™†ç­‰åŠŸèƒ½ debug &#123; signingConfig signingConfigs.myConfig ï½&#125;]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>AndroidTips</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¸¸è§æŽ’åºåŠæœç´¢ç®—æ³•æ€»ç»“]]></title>
    <url>%2Farticle%2F395850883%2F</url>
    <content type="text"><![CDATA[Arrays.sort()Arrays.sort()ä½¿ç”¨äº†ä¸¤ç§æŽ’åºæ–¹æ³•ï¼Œå¿«é€ŸæŽ’åºå’Œä¼˜åŒ–çš„åˆå¹¶æŽ’åºã€‚ å¿«é€ŸæŽ’åºä¸»è¦æ˜¯å¯¹å“ªäº›åŸºæœ¬ç±»åž‹æ•°æ®ï¼ˆint,short,longç­‰ï¼‰æŽ’åºã€‚ è€Œåˆå¹¶æŽ’åºç”¨äºŽå¯¹å¯¹è±¡ç±»åž‹è¿›è¡ŒæŽ’åºã€‚ åŽŸå› ï¼šä½¿ç”¨ä¸åŒç±»åž‹çš„æŽ’åºç®—æ³•ä¸»è¦æ˜¯ç”±äºŽå¿«é€ŸæŽ’åºæ˜¯ä¸ç¨³å®šçš„ï¼Œè€Œåˆå¹¶æŽ’åºæ˜¯ç¨³å®šçš„ã€‚è¿™é‡Œçš„ç¨³å®šæ˜¯æŒ‡æ¯”è¾ƒç›¸ç­‰çš„æ•°æ®åœ¨æŽ’åºä¹‹åŽä»ç„¶æŒ‰ç…§æŽ’åºä¹‹å‰çš„å‰åŽé¡ºåºæŽ’åˆ—ã€‚å¯¹äºŽåŸºæœ¬æ•°æ®ç±»åž‹ï¼Œç¨³å®šæ€§æ²¡æœ‰æ„ä¹‰ï¼Œè€Œå¯¹äºŽå¯¹è±¡ç±»åž‹ï¼Œç¨³å®šæ€§æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œå› ä¸ºå¯¹è±¡ç›¸ç­‰çš„åˆ¤æ–­å¯èƒ½åªæ˜¯åˆ¤æ–­å…³é”®å±žæ€§ï¼Œæœ€å¥½ä¿æŒç›¸ç­‰å¯¹è±¡çš„éžå…³é”®å±žæ€§çš„é¡ºåºä¸ŽæŽ’åºå‰ä¸€è‡´ã€‚ å¦å¤–ä¸€ä¸ªåŽŸå› æ˜¯ç”±äºŽåˆå¹¶æŽ’åºç›¸å¯¹è€Œè¨€ æ¯”è¾ƒæ¬¡æ•° æ¯”å¿«é€ŸæŽ’åºå°‘ï¼Œ ç§»åŠ¨(å¯¹è±¡å¼•ç”¨çš„ç§»åŠ¨)æ¬¡æ•° æ¯”å¿«é€ŸæŽ’åºå¤šï¼Œè€Œå¯¹äºŽå¯¹è±¡æ¥è¯´ï¼Œç§»åŠ¨æ˜¯ç®€å•çš„ï¼Œåªæ˜¯å¼•ç”¨çš„è½¬æ¢ï¼Œä½†æ˜¯æ¯”è¾ƒç›¸å¯¹æ›´åŠ è€—æ—¶ã€‚ åˆå¹¶æŽ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯n*logn, å¿«é€ŸæŽ’åºçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¹Ÿæ˜¯n*lognï¼Œä½†æ˜¯åˆå¹¶æŽ’åºçš„éœ€è¦é¢å¤–çš„nä¸ªå¼•ç”¨çš„ç©ºé—´ã€‚ æŽ’åºç®—æ³•å®žçŽ°å†’æ³¡æŽ’åº12345678910111213//å†’æ³¡:0 ~ n-1 0 ~ n-1-i//å†’æ³¡æŽ’åº:ä¸¤ä¸¤æ¯”è¾ƒ,æ¯”è¾ƒn-1è¶Ÿ,æ¯ä¸€è¶Ÿæ¯”è¾ƒn-i-1æ¬¡public static void BubbleSort(int a[])&#123; int n = a.length; for(int i = 0; i &lt; n - 1; i++) //æ¯”è¾ƒn-1è¶Ÿ for(int j = 0; j &lt; n - 1 - i; j++)&#123;//æ¯”è¾ƒn-i-1æ¬¡! if(a[j+1] &lt; a[j])&#123; a[j+1] = a[j+1] ^ a[j]; a[j] = a[j] ^ a[j+1]; a[j+1] = a[j] ^ a[j+1]; &#125; &#125;&#125; é€‰æ‹©æŽ’åº123456789101112131415161718//é€‰æ‹©æŽ’åº:éåŽ†å‰n-1ä¸ªå…ƒç´ ,ä¸Ž i+1 ç›´åˆ° n ä¸ªå…ƒç´ æ¯”è¾ƒ,è®°å½•å°æ•°ä¸‹æ ‡public static void SelectSort(int a[])&#123; int n = a.length; for(int i = 0; i &lt; n - 1; i++)&#123; int min = i; for(int j = i + 1; j &lt; n; j++)&#123; if(a[min] &gt; a[j])&#123; min = j; &#125; &#125; if(min != i)&#123; a[i] = a[i] ^ a[min]; a[min] = a[min] ^ a[i]; a[i] = a[min] ^ a[i]; &#125; &#125;&#125; æ’å…¥æŽ’åº1234567891011121314//æ’å…¥æŽ’åº:å·¦è¾¹ä¸ºæœ‰åºåŒºåŸŸ,éåŽ†ç¬¬ä¸€ä¸ªç›´åˆ°ç¬¬nä¸ª,ä¸Žå‰iä¸ªæ¯”è¾ƒ public static void InsertSort(int a[])&#123; int n = a.length; for(int i = 1;i &lt; n; i++) for(int j = i; j &gt; 0; j--)&#123; if(a[j] &lt; a[j-1])&#123; a[j] = a[j] ^ a[j-1]; a[j-1] = a[j-1] ^ a[j]; a[j] = a[j-1] ^ a[j]; &#125; else break; &#125; &#125; å¿«é€ŸæŽ’åº1234567891011121314151617181920212223public static void quicksort(int n[], int left, int right) &#123; int dp; if (left &lt; right) &#123; dp = partition(n, left, right); quicksort(n, left, dp - 1); quicksort(n, dp + 1, right); &#125; &#125;public static int partition(int n[], int left, int right) &#123; int pivot = n[left]; while (left &lt; right) &#123; while (left &lt; right &amp;&amp; n[right] &gt;= pivot) right--; if (left &lt; right) n[left++] = n[right]; while (left &lt; right &amp;&amp; n[left] &lt;= pivot) left++; if (left &lt; right) n[right--] = n[left]; &#125; n[left] = pivot; return left;&#125; æœç´¢ç®—æ³•å®žçŽ°äºŒåˆ†æ³•æœç´¢123456789101112131415161718public static int HalfSearch(int a[],int target)&#123; int bottom = 0; int top = a.length - 1; int middle = (top + bottom) / 2; while(bottom &lt;= top)&#123; if(a[middle] &gt; target)&#123; top = middle - 1; &#125; else if(a[middle] &lt; target)&#123; bottom = middle + 1; &#125; else &#123; return middle; &#125; middle = (top + bottom) / 2; &#125; return -1; &#125;]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
</search>